import{a as Ms,b as Ds,u as Ps,r as Q,s as ge,j as e,L as ls}from"./index-ByaaQl1E.js";import{r as Rs,s as cs}from"./leagueStart-NfK15wFG.js";import{a as $s}from"./leagueAvatars-xOLkuGns.js";var Hs=Ms();function Ws(T,_){return _.forEach((function(z){z&&typeof z!="string"&&!Array.isArray(z)&&Object.keys(z).forEach((function(i){if(i!=="default"&&!(i in T)){var s=Object.getOwnPropertyDescriptor(z,i);Object.defineProperty(T,i,s.get?s:{enumerable:!0,get:function(){return z[i]}})}}))})),Object.freeze(T)}function fs(T,_){return new Promise((function(z,i){let s;return zs(T).then((function(t){try{return s=t,z(new Blob([_.slice(0,2),s,_.slice(2)],{type:"image/jpeg"}))}catch(m){return i(m)}}),i)}))}const zs=T=>new Promise(((_,z)=>{const i=new FileReader;i.addEventListener("load",(({target:{result:s}})=>{const t=new DataView(s);let m=0;if(t.getUint16(m)!==65496)return z("not a valid JPEG");for(m+=2;;){const d=t.getUint16(m);if(d===65498)break;const p=t.getUint16(m+2);if(d===65505&&t.getUint32(m+4)===1165519206){const x=m+10;let n;switch(t.getUint16(x)){case 18761:n=!0;break;case 19789:n=!1;break;default:return z("TIFF header contains invalid endian")}if(t.getUint16(x+2,n)!==42)return z("TIFF header contains invalid version");const a=t.getUint32(x+4,n),r=x+a+2+12*t.getUint16(x+a,n);for(let o=x+a+2;o<r;o+=12)if(t.getUint16(o,n)==274){if(t.getUint16(o+2,n)!==3)return z("Orientation data type is invalid");if(t.getUint32(o+4,n)!==1)return z("Orientation data count is invalid");t.setUint16(o+8,1,n);break}return _(s.slice(m,m+2+p))}m+=2+p}return _(new Blob)})),i.readAsArrayBuffer(T)}));var Pt={},Os={get exports(){return Pt},set exports(T){Pt=T}};(function(T){var _,z,i={};Os.exports=i,i.parse=function(s,t){for(var m=i.bin.readUshort,d=i.bin.readUint,p=0,x={},n=new Uint8Array(s),a=n.length-4;d(n,a)!=101010256;)a--;p=a,p+=4;var r=m(n,p+=4);m(n,p+=2);var o=d(n,p+=2),h=d(n,p+=4);p+=4,p=h;for(var k=0;k<r;k++){d(n,p),p+=4,p+=4,p+=4,d(n,p+=4),o=d(n,p+=4);var E=d(n,p+=4),j=m(n,p+=4),H=m(n,p+2),M=m(n,p+4);p+=6;var S=d(n,p+=8);p+=4,p+=j+H+M,i._readLocal(n,S,x,o,E,t)}return x},i._readLocal=function(s,t,m,d,p,x){var n=i.bin.readUshort,a=i.bin.readUint;a(s,t),n(s,t+=4),n(s,t+=2);var r=n(s,t+=2);a(s,t+=2),a(s,t+=4),t+=4;var o=n(s,t+=8),h=n(s,t+=2);t+=2;var k=i.bin.readUTF8(s,t,o);if(t+=o,t+=h,x)m[k]={size:p,csize:d};else{var E=new Uint8Array(s.buffer,t);if(r==0)m[k]=new Uint8Array(E.buffer.slice(t,t+d));else{if(r!=8)throw"unknown compression method: "+r;var j=new Uint8Array(p);i.inflateRaw(E,j),m[k]=j}}},i.inflateRaw=function(s,t){return i.F.inflate(s,t)},i.inflate=function(s,t){return s[0],s[1],i.inflateRaw(new Uint8Array(s.buffer,s.byteOffset+2,s.length-6),t)},i.deflate=function(s,t){t==null&&(t={level:6});var m=0,d=new Uint8Array(50+Math.floor(1.1*s.length));d[m]=120,d[m+1]=156,m+=2,m=i.F.deflateRaw(s,d,m,t.level);var p=i.adler(s,0,s.length);return d[m+0]=p>>>24&255,d[m+1]=p>>>16&255,d[m+2]=p>>>8&255,d[m+3]=p>>>0&255,new Uint8Array(d.buffer,0,m+4)},i.deflateRaw=function(s,t){t==null&&(t={level:6});var m=new Uint8Array(50+Math.floor(1.1*s.length)),d=i.F.deflateRaw(s,m,d,t.level);return new Uint8Array(m.buffer,0,d)},i.encode=function(s,t){t==null&&(t=!1);var m=0,d=i.bin.writeUint,p=i.bin.writeUshort,x={};for(var n in s){var a=!i._noNeed(n)&&!t,r=s[n],o=i.crc.crc(r,0,r.length);x[n]={cpr:a,usize:r.length,crc:o,file:a?i.deflateRaw(r):r}}for(var n in x)m+=x[n].file.length+30+46+2*i.bin.sizeUTF8(n);m+=22;var h=new Uint8Array(m),k=0,E=[];for(var n in x){var j=x[n];E.push(k),k=i._writeHeader(h,k,n,j,0)}var H=0,M=k;for(var n in x)j=x[n],E.push(k),k=i._writeHeader(h,k,n,j,1,E[H++]);var S=k-M;return d(h,k,101010256),k+=4,p(h,k+=4,H),p(h,k+=2,H),d(h,k+=2,S),d(h,k+=4,M),k+=4,k+=2,h.buffer},i._noNeed=function(s){var t=s.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},i._writeHeader=function(s,t,m,d,p,x){var n=i.bin.writeUint,a=i.bin.writeUshort,r=d.file;return n(s,t,p==0?67324752:33639248),t+=4,p==1&&(t+=2),a(s,t,20),a(s,t+=2,0),a(s,t+=2,d.cpr?8:0),n(s,t+=2,0),n(s,t+=4,d.crc),n(s,t+=4,r.length),n(s,t+=4,d.usize),a(s,t+=4,i.bin.sizeUTF8(m)),a(s,t+=2,0),t+=2,p==1&&(t+=2,t+=2,n(s,t+=6,x),t+=4),t+=i.bin.writeUTF8(s,t,m),p==0&&(s.set(r,t),t+=r.length),t},i.crc={table:(function(){for(var s=new Uint32Array(256),t=0;t<256;t++){for(var m=t,d=0;d<8;d++)1&m?m=3988292384^m>>>1:m>>>=1;s[t]=m}return s})(),update:function(s,t,m,d){for(var p=0;p<d;p++)s=i.crc.table[255&(s^t[m+p])]^s>>>8;return s},crc:function(s,t,m){return 4294967295^i.crc.update(4294967295,s,t,m)}},i.adler=function(s,t,m){for(var d=1,p=0,x=t,n=t+m;x<n;){for(var a=Math.min(x+5552,n);x<a;)p+=d+=s[x++];d%=65521,p%=65521}return p<<16|d},i.bin={readUshort:function(s,t){return s[t]|s[t+1]<<8},writeUshort:function(s,t,m){s[t]=255&m,s[t+1]=m>>8&255},readUint:function(s,t){return 16777216*s[t+3]+(s[t+2]<<16|s[t+1]<<8|s[t])},writeUint:function(s,t,m){s[t]=255&m,s[t+1]=m>>8&255,s[t+2]=m>>16&255,s[t+3]=m>>24&255},readASCII:function(s,t,m){for(var d="",p=0;p<m;p++)d+=String.fromCharCode(s[t+p]);return d},writeASCII:function(s,t,m){for(var d=0;d<m.length;d++)s[t+d]=m.charCodeAt(d)},pad:function(s){return s.length<2?"0"+s:s},readUTF8:function(s,t,m){for(var d,p="",x=0;x<m;x++)p+="%"+i.bin.pad(s[t+x].toString(16));try{d=decodeURIComponent(p)}catch{return i.bin.readASCII(s,t,m)}return d},writeUTF8:function(s,t,m){for(var d=m.length,p=0,x=0;x<d;x++){var n=m.charCodeAt(x);if((4294967168&n)==0)s[t+p]=n,p++;else if((4294965248&n)==0)s[t+p]=192|n>>6,s[t+p+1]=128|n>>0&63,p+=2;else if((4294901760&n)==0)s[t+p]=224|n>>12,s[t+p+1]=128|n>>6&63,s[t+p+2]=128|n>>0&63,p+=3;else{if((4292870144&n)!=0)throw"e";s[t+p]=240|n>>18,s[t+p+1]=128|n>>12&63,s[t+p+2]=128|n>>6&63,s[t+p+3]=128|n>>0&63,p+=4}}return p},sizeUTF8:function(s){for(var t=s.length,m=0,d=0;d<t;d++){var p=s.charCodeAt(d);if((4294967168&p)==0)m++;else if((4294965248&p)==0)m+=2;else if((4294901760&p)==0)m+=3;else{if((4292870144&p)!=0)throw"e";m+=4}}return m}},i.F={},i.F.deflateRaw=function(s,t,m,d){var p=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][d],x=i.F.U,n=i.F._goodIndex;i.F._hash;var a=i.F._putsE,r=0,o=m<<3,h=0,k=s.length;if(d==0){for(;r<k;)a(t,o,r+(N=Math.min(65535,k-r))==k?1:0),o=i.F._copyExact(s,r,N,t,o+8),r+=N;return o>>>3}var E=x.lits,j=x.strt,H=x.prev,M=0,S=0,I=0,g=0,U=0,c=0;for(k>2&&(j[c=i.F._hash(s,0)]=0),r=0;r<k;r++){if(U=c,r+1<k-2){c=i.F._hash(s,r+1);var u=r+1&32767;H[u]=j[c],j[c]=u}if(h<=r){(M>14e3||S>26697)&&k-r>100&&(h<r&&(E[M]=r-h,M+=2,h=r),o=i.F._writeBlock(r==k-1||h==k?1:0,E,M,g,s,I,r-I,t,o),M=S=g=0,I=r);var w=0;r<k-2&&(w=i.F._bestMatch(s,r,H,U,Math.min(p[2],k-r),p[3]));var N=w>>>16,v=65535&w;if(w!=0){v=65535&w;var A=n(N=w>>>16,x.of0);x.lhst[257+A]++;var b=n(v,x.df0);x.dhst[b]++,g+=x.exb[A]+x.dxb[b],E[M]=N<<23|r-h,E[M+1]=v<<16|A<<8|b,M+=2,h=r+N}else x.lhst[s[r]]++;S++}}for(I==r&&s.length!=0||(h<r&&(E[M]=r-h,M+=2,h=r),o=i.F._writeBlock(1,E,M,g,s,I,r-I,t,o),M=0,S=0,M=S=g=0,I=r);(7&o)!=0;)o++;return o>>>3},i.F._bestMatch=function(s,t,m,d,p,x){var n=32767&t,a=m[n],r=n-a+32768&32767;if(a==n||d!=i.F._hash(s,t-r))return 0;for(var o=0,h=0,k=Math.min(32767,t);r<=k&&--x!=0&&a!=n;){if(o==0||s[t+o]==s[t+o-r]){var E=i.F._howLong(s,t,r);if(E>o){if(h=r,(o=E)>=p)break;r+2<E&&(E=r+2);for(var j=0,H=0;H<E-2;H++){var M=t-r+H+32768&32767,S=M-m[M]+32768&32767;S>j&&(j=S,a=M)}}}r+=(n=a)-(a=m[n])+32768&32767}return o<<16|h},i.F._howLong=function(s,t,m){if(s[t]!=s[t-m]||s[t+1]!=s[t+1-m]||s[t+2]!=s[t+2-m])return 0;var d=t,p=Math.min(s.length,t+258);for(t+=3;t<p&&s[t]==s[t-m];)t++;return t-d},i.F._hash=function(s,t){return(s[t]<<8|s[t+1])+(s[t+2]<<4)&65535},i.saved=0,i.F._writeBlock=function(s,t,m,d,p,x,n,a,r){var o,h,k,E,j,H,M,S,I,g=i.F.U,U=i.F._putsF,c=i.F._putsE;g.lhst[256]++,h=(o=i.F.getTrees())[0],k=o[1],E=o[2],j=o[3],H=o[4],M=o[5],S=o[6],I=o[7];var u=32+((r+3&7)==0?0:8-(r+3&7))+(n<<3),w=d+i.F.contSize(g.fltree,g.lhst)+i.F.contSize(g.fdtree,g.dhst),N=d+i.F.contSize(g.ltree,g.lhst)+i.F.contSize(g.dtree,g.dhst);N+=14+3*M+i.F.contSize(g.itree,g.ihst)+(2*g.ihst[16]+3*g.ihst[17]+7*g.ihst[18]);for(var v=0;v<286;v++)g.lhst[v]=0;for(v=0;v<30;v++)g.dhst[v]=0;for(v=0;v<19;v++)g.ihst[v]=0;var A=u<w&&u<N?0:w<N?1:2;if(U(a,r,s),U(a,r+1,A),r+=3,A==0){for(;(7&r)!=0;)r++;r=i.F._copyExact(p,x,n,a,r)}else{var b,C;if(A==1&&(b=g.fltree,C=g.fdtree),A==2){i.F.makeCodes(g.ltree,h),i.F.revCodes(g.ltree,h),i.F.makeCodes(g.dtree,k),i.F.revCodes(g.dtree,k),i.F.makeCodes(g.itree,E),i.F.revCodes(g.itree,E),b=g.ltree,C=g.dtree,c(a,r,j-257),c(a,r+=5,H-1),c(a,r+=5,M-4),r+=4;for(var f=0;f<M;f++)c(a,r+3*f,g.itree[1+(g.ordr[f]<<1)]);r+=3*M,r=i.F._codeTiny(S,g.itree,a,r),r=i.F._codeTiny(I,g.itree,a,r)}for(var l=x,D=0;D<m;D+=2){for(var L=t[D],P=L>>>23,le=l+(8388607&L);l<le;)r=i.F._writeLit(p[l++],b,a,r);if(P!=0){var q=t[D+1],re=q>>16,B=q>>8&255,F=255&q;c(a,r=i.F._writeLit(257+B,b,a,r),P-g.of0[B]),r+=g.exb[B],U(a,r=i.F._writeLit(F,C,a,r),re-g.df0[F]),r+=g.dxb[F],l+=P}}r=i.F._writeLit(256,b,a,r)}return r},i.F._copyExact=function(s,t,m,d,p){var x=p>>>3;return d[x]=m,d[x+1]=m>>>8,d[x+2]=255-d[x],d[x+3]=255-d[x+1],x+=4,d.set(new Uint8Array(s.buffer,t,m),x),p+(m+4<<3)},i.F.getTrees=function(){for(var s=i.F.U,t=i.F._hufTree(s.lhst,s.ltree,15),m=i.F._hufTree(s.dhst,s.dtree,15),d=[],p=i.F._lenCodes(s.ltree,d),x=[],n=i.F._lenCodes(s.dtree,x),a=0;a<d.length;a+=2)s.ihst[d[a]]++;for(a=0;a<x.length;a+=2)s.ihst[x[a]]++;for(var r=i.F._hufTree(s.ihst,s.itree,7),o=19;o>4&&s.itree[1+(s.ordr[o-1]<<1)]==0;)o--;return[t,m,r,p,n,o,d,x]},i.F.getSecond=function(s){for(var t=[],m=0;m<s.length;m+=2)t.push(s[m+1]);return t},i.F.nonZero=function(s){for(var t="",m=0;m<s.length;m+=2)s[m+1]!=0&&(t+=(m>>1)+",");return t},i.F.contSize=function(s,t){for(var m=0,d=0;d<t.length;d++)m+=t[d]*s[1+(d<<1)];return m},i.F._codeTiny=function(s,t,m,d){for(var p=0;p<s.length;p+=2){var x=s[p],n=s[p+1];d=i.F._writeLit(x,t,m,d);var a=x==16?2:x==17?3:7;x>15&&(i.F._putsE(m,d,n,a),d+=a)}return d},i.F._lenCodes=function(s,t){for(var m=s.length;m!=2&&s[m-1]==0;)m-=2;for(var d=0;d<m;d+=2){var p=s[d+1],x=d+3<m?s[d+3]:-1,n=d+5<m?s[d+5]:-1,a=d==0?-1:s[d-1];if(p==0&&x==p&&n==p){for(var r=d+5;r+2<m&&s[r+2]==p;)r+=2;(o=Math.min(r+1-d>>>1,138))<11?t.push(17,o-3):t.push(18,o-11),d+=2*o-2}else if(p==a&&x==p&&n==p){for(r=d+5;r+2<m&&s[r+2]==p;)r+=2;var o=Math.min(r+1-d>>>1,6);t.push(16,o-3),d+=2*o-2}else t.push(p,0)}return m>>>1},i.F._hufTree=function(s,t,m){var d=[],p=s.length,x=t.length,n=0;for(n=0;n<x;n+=2)t[n]=0,t[n+1]=0;for(n=0;n<p;n++)s[n]!=0&&d.push({lit:n,f:s[n]});var a=d.length,r=d.slice(0);if(a==0)return 0;if(a==1){var o=d[0].lit;return r=o==0?1:0,t[1+(o<<1)]=1,t[1+(r<<1)]=1,1}d.sort((function(S,I){return S.f-I.f}));var h=d[0],k=d[1],E=0,j=1,H=2;for(d[0]={lit:-1,f:h.f+k.f,l:h,r:k,d:0};j!=a-1;)h=E!=j&&(H==a||d[E].f<d[H].f)?d[E++]:d[H++],k=E!=j&&(H==a||d[E].f<d[H].f)?d[E++]:d[H++],d[j++]={lit:-1,f:h.f+k.f,l:h,r:k};var M=i.F.setDepth(d[j-1],0);for(M>m&&(i.F.restrictDepth(r,m,M),M=m),n=0;n<a;n++)t[1+(r[n].lit<<1)]=r[n].d;return M},i.F.setDepth=function(s,t){return s.lit!=-1?(s.d=t,t):Math.max(i.F.setDepth(s.l,t+1),i.F.setDepth(s.r,t+1))},i.F.restrictDepth=function(s,t,m){var d=0,p=1<<m-t,x=0;for(s.sort((function(a,r){return r.d==a.d?a.f-r.f:r.d-a.d})),d=0;d<s.length&&s[d].d>t;d++){var n=s[d].d;s[d].d=t,x+=p-(1<<m-n)}for(x>>>=m-t;x>0;)(n=s[d].d)<t?(s[d].d++,x-=1<<t-n-1):d++;for(;d>=0;d--)s[d].d==t&&x<0&&(s[d].d--,x++);x!=0&&console.log("debt left")},i.F._goodIndex=function(s,t){var m=0;return t[16|m]<=s&&(m|=16),t[8|m]<=s&&(m|=8),t[4|m]<=s&&(m|=4),t[2|m]<=s&&(m|=2),t[1|m]<=s&&(m|=1),m},i.F._writeLit=function(s,t,m,d){return i.F._putsF(m,d,t[s<<1]),d+t[1+(s<<1)]},i.F.inflate=function(s,t){var m=Uint8Array;if(s[0]==3&&s[1]==0)return t||new m(0);var d=i.F,p=d._bitsF,x=d._bitsE,n=d._decodeTiny,a=d.makeCodes,r=d.codes2map,o=d._get17,h=d.U,k=t==null;k&&(t=new m(s.length>>>2<<3));for(var E,j,H=0,M=0,S=0,I=0,g=0,U=0,c=0,u=0,w=0;H==0;)if(H=p(s,w,1),M=p(s,w+1,2),w+=3,M!=0){if(k&&(t=i.F._check(t,u+(1<<17))),M==1&&(E=h.flmap,j=h.fdmap,U=511,c=31),M==2){S=x(s,w,5)+257,I=x(s,w+5,5)+1,g=x(s,w+10,4)+4,w+=14;for(var N=0;N<38;N+=2)h.itree[N]=0,h.itree[N+1]=0;var v=1;for(N=0;N<g;N++){var A=x(s,w+3*N,3);h.itree[1+(h.ordr[N]<<1)]=A,A>v&&(v=A)}w+=3*g,a(h.itree,v),r(h.itree,v,h.imap),E=h.lmap,j=h.dmap,w=n(h.imap,(1<<v)-1,S+I,s,w,h.ttree);var b=d._copyOut(h.ttree,0,S,h.ltree);U=(1<<b)-1;var C=d._copyOut(h.ttree,S,I,h.dtree);c=(1<<C)-1,a(h.ltree,b),r(h.ltree,b,E),a(h.dtree,C),r(h.dtree,C,j)}for(;;){var f=E[o(s,w)&U];w+=15&f;var l=f>>>4;if(!(l>>>8))t[u++]=l;else{if(l==256)break;var D=u+l-254;if(l>264){var L=h.ldef[l-257];D=u+(L>>>3)+x(s,w,7&L),w+=7&L}var P=j[o(s,w)&c];w+=15&P;var le=P>>>4,q=h.ddef[le],re=(q>>>4)+p(s,w,15&q);for(w+=15&q,k&&(t=i.F._check(t,u+(1<<17)));u<D;)t[u]=t[u++-re],t[u]=t[u++-re],t[u]=t[u++-re],t[u]=t[u++-re];u=D}}}else{(7&w)!=0&&(w+=8-(7&w));var B=4+(w>>>3),F=s[B-4]|s[B-3]<<8;k&&(t=i.F._check(t,u+F)),t.set(new m(s.buffer,s.byteOffset+B,F),u),w=B+F<<3,u+=F}return t.length==u?t:t.slice(0,u)},i.F._check=function(s,t){var m=s.length;if(t<=m)return s;var d=new Uint8Array(Math.max(m<<1,t));return d.set(s,0),d},i.F._decodeTiny=function(s,t,m,d,p,x){for(var n=i.F._bitsE,a=i.F._get17,r=0;r<m;){var o=s[a(d,p)&t];p+=15&o;var h=o>>>4;if(h<=15)x[r]=h,r++;else{var k=0,E=0;h==16?(E=3+n(d,p,2),p+=2,k=x[r-1]):h==17?(E=3+n(d,p,3),p+=3):h==18&&(E=11+n(d,p,7),p+=7);for(var j=r+E;r<j;)x[r]=k,r++}}return p},i.F._copyOut=function(s,t,m,d){for(var p=0,x=0,n=d.length>>>1;x<m;){var a=s[x+t];d[x<<1]=0,d[1+(x<<1)]=a,a>p&&(p=a),x++}for(;x<n;)d[x<<1]=0,d[1+(x<<1)]=0,x++;return p},i.F.makeCodes=function(s,t){for(var m,d,p,x,n=i.F.U,a=s.length,r=n.bl_count,o=0;o<=t;o++)r[o]=0;for(o=1;o<a;o+=2)r[s[o]]++;var h=n.next_code;for(m=0,r[0]=0,d=1;d<=t;d++)m=m+r[d-1]<<1,h[d]=m;for(p=0;p<a;p+=2)(x=s[p+1])!=0&&(s[p]=h[x],h[x]++)},i.F.codes2map=function(s,t,m){for(var d=s.length,p=i.F.U.rev15,x=0;x<d;x+=2)if(s[x+1]!=0)for(var n=x>>1,a=s[x+1],r=n<<4|a,o=t-a,h=s[x]<<o,k=h+(1<<o);h!=k;)m[p[h]>>>15-t]=r,h++},i.F.revCodes=function(s,t){for(var m=i.F.U.rev15,d=15-t,p=0;p<s.length;p+=2){var x=s[p]<<t-s[p+1];s[p]=m[x]>>>d}},i.F._putsE=function(s,t,m){m<<=7&t;var d=t>>>3;s[d]|=m,s[d+1]|=m>>>8},i.F._putsF=function(s,t,m){m<<=7&t;var d=t>>>3;s[d]|=m,s[d+1]|=m>>>8,s[d+2]|=m>>>16},i.F._bitsE=function(s,t,m){return(s[t>>>3]|s[1+(t>>>3)]<<8)>>>(7&t)&(1<<m)-1},i.F._bitsF=function(s,t,m){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16)>>>(7&t)&(1<<m)-1},i.F._get17=function(s,t){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16)>>>(7&t)},i.F._get25=function(s,t){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16|s[3+(t>>>3)]<<24)>>>(7&t)},i.F.U=(_=Uint16Array,z=Uint32Array,{next_code:new _(16),bl_count:new _(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new _(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new z(32),flmap:new _(512),fltree:[],fdmap:new _(32),fdtree:[],lmap:new _(32768),ltree:[],ttree:[],dmap:new _(32768),dtree:[],imap:new _(512),itree:[],rev15:new _(32768),lhst:new z(286),dhst:new z(30),ihst:new z(19),lits:new z(15e3),strt:new _(65536),prev:new _(32768)}),(function(){for(var s=i.F.U,t=0;t<32768;t++){var m=t;m=(4278255360&(m=(4042322160&(m=(3435973836&(m=(2863311530&m)>>>1|(1431655765&m)<<1))>>>2|(858993459&m)<<2))>>>4|(252645135&m)<<4))>>>8|(16711935&m)<<8,s.rev15[t]=(m>>>16|m<<16)>>>17}function d(p,x,n){for(;x--!=0;)p.push(0,n)}for(t=0;t<32;t++)s.ldef[t]=s.of0[t]<<3|s.exb[t],s.ddef[t]=s.df0[t]<<4|s.dxb[t];d(s.fltree,144,8),d(s.fltree,112,9),d(s.fltree,24,7),d(s.fltree,8,8),i.F.makeCodes(s.fltree,9),i.F.codes2map(s.fltree,9,s.flmap),i.F.revCodes(s.fltree,9),d(s.fdtree,32,5),i.F.makeCodes(s.fdtree,5),i.F.codes2map(s.fdtree,5,s.fdmap),i.F.revCodes(s.fdtree,5),d(s.itree,19,0),d(s.ltree,286,0),d(s.dtree,30,0),d(s.ttree,320,0)})()})();var Bs=Ws({__proto__:null,default:Pt},[Pt]);const nt=(function(){var T={nextZero(n,a){for(;n[a]!=0;)a++;return a},readUshort:(n,a)=>n[a]<<8|n[a+1],writeUshort(n,a,r){n[a]=r>>8&255,n[a+1]=255&r},readUint:(n,a)=>16777216*n[a]+(n[a+1]<<16|n[a+2]<<8|n[a+3]),writeUint(n,a,r){n[a]=r>>24&255,n[a+1]=r>>16&255,n[a+2]=r>>8&255,n[a+3]=255&r},readASCII(n,a,r){let o="";for(let h=0;h<r;h++)o+=String.fromCharCode(n[a+h]);return o},writeASCII(n,a,r){for(let o=0;o<r.length;o++)n[a+o]=r.charCodeAt(o)},readBytes(n,a,r){const o=[];for(let h=0;h<r;h++)o.push(n[a+h]);return o},pad:n=>n.length<2?`0${n}`:n,readUTF8(n,a,r){let o,h="";for(let k=0;k<r;k++)h+=`%${T.pad(n[a+k].toString(16))}`;try{o=decodeURIComponent(h)}catch{return T.readASCII(n,a,r)}return o}};function _(n,a,r,o){const h=a*r,k=t(o),E=Math.ceil(a*k/8),j=new Uint8Array(4*h),H=new Uint32Array(j.buffer),{ctype:M}=o,{depth:S}=o,I=T.readUshort;if(M==6){const L=h<<2;if(S==8)for(var g=0;g<L;g+=4)j[g]=n[g],j[g+1]=n[g+1],j[g+2]=n[g+2],j[g+3]=n[g+3];if(S==16)for(g=0;g<L;g++)j[g]=n[g<<1]}else if(M==2){const L=o.tabs.tRNS;if(L==null){if(S==8)for(g=0;g<h;g++){var U=3*g;H[g]=255<<24|n[U+2]<<16|n[U+1]<<8|n[U]}if(S==16)for(g=0;g<h;g++)U=6*g,H[g]=255<<24|n[U+4]<<16|n[U+2]<<8|n[U]}else{var c=L[0];const P=L[1],le=L[2];if(S==8)for(g=0;g<h;g++){var u=g<<2;U=3*g,H[g]=255<<24|n[U+2]<<16|n[U+1]<<8|n[U],n[U]==c&&n[U+1]==P&&n[U+2]==le&&(j[u+3]=0)}if(S==16)for(g=0;g<h;g++)u=g<<2,U=6*g,H[g]=255<<24|n[U+4]<<16|n[U+2]<<8|n[U],I(n,U)==c&&I(n,U+2)==P&&I(n,U+4)==le&&(j[u+3]=0)}}else if(M==3){const L=o.tabs.PLTE,P=o.tabs.tRNS,le=P?P.length:0;if(S==1)for(var w=0;w<r;w++){var N=w*E,v=w*a;for(g=0;g<a;g++){u=v+g<<2;var A=3*(b=n[N+(g>>3)]>>7-((7&g)<<0)&1);j[u]=L[A],j[u+1]=L[A+1],j[u+2]=L[A+2],j[u+3]=b<le?P[b]:255}}if(S==2)for(w=0;w<r;w++)for(N=w*E,v=w*a,g=0;g<a;g++)u=v+g<<2,A=3*(b=n[N+(g>>2)]>>6-((3&g)<<1)&3),j[u]=L[A],j[u+1]=L[A+1],j[u+2]=L[A+2],j[u+3]=b<le?P[b]:255;if(S==4)for(w=0;w<r;w++)for(N=w*E,v=w*a,g=0;g<a;g++)u=v+g<<2,A=3*(b=n[N+(g>>1)]>>4-((1&g)<<2)&15),j[u]=L[A],j[u+1]=L[A+1],j[u+2]=L[A+2],j[u+3]=b<le?P[b]:255;if(S==8)for(g=0;g<h;g++){var b;u=g<<2,A=3*(b=n[g]),j[u]=L[A],j[u+1]=L[A+1],j[u+2]=L[A+2],j[u+3]=b<le?P[b]:255}}else if(M==4){if(S==8)for(g=0;g<h;g++){u=g<<2;var C=n[f=g<<1];j[u]=C,j[u+1]=C,j[u+2]=C,j[u+3]=n[f+1]}if(S==16)for(g=0;g<h;g++){var f;u=g<<2,C=n[f=g<<2],j[u]=C,j[u+1]=C,j[u+2]=C,j[u+3]=n[f+2]}}else if(M==0)for(c=o.tabs.tRNS?o.tabs.tRNS:-1,w=0;w<r;w++){const L=w*E,P=w*a;if(S==1)for(var l=0;l<a;l++){var D=(C=255*(n[L+(l>>>3)]>>>7-(7&l)&1))==255*c?0:255;H[P+l]=D<<24|C<<16|C<<8|C}else if(S==2)for(l=0;l<a;l++)D=(C=85*(n[L+(l>>>2)]>>>6-((3&l)<<1)&3))==85*c?0:255,H[P+l]=D<<24|C<<16|C<<8|C;else if(S==4)for(l=0;l<a;l++)D=(C=17*(n[L+(l>>>1)]>>>4-((1&l)<<2)&15))==17*c?0:255,H[P+l]=D<<24|C<<16|C<<8|C;else if(S==8)for(l=0;l<a;l++)D=(C=n[L+l])==c?0:255,H[P+l]=D<<24|C<<16|C<<8|C;else if(S==16)for(l=0;l<a;l++)C=n[L+(l<<1)],D=I(n,L+(l<<1))==c?0:255,H[P+l]=D<<24|C<<16|C<<8|C}return j}function z(n,a,r,o){const h=t(n),k=Math.ceil(r*h/8),E=new Uint8Array((k+1+n.interlace)*o);return a=n.tabs.CgBI?s(a,E):i(a,E),n.interlace==0?a=m(a,n,0,r,o):n.interlace==1&&(a=(function(H,M){const S=M.width,I=M.height,g=t(M),U=g>>3,c=Math.ceil(S*g/8),u=new Uint8Array(I*c);let w=0;const N=[0,0,4,0,2,0,1],v=[0,4,0,2,0,1,0],A=[8,8,8,4,4,2,2],b=[8,8,4,4,2,2,1];let C=0;for(;C<7;){const l=A[C],D=b[C];let L=0,P=0,le=N[C];for(;le<I;)le+=l,P++;let q=v[C];for(;q<S;)q+=D,L++;const re=Math.ceil(L*g/8);m(H,M,w,L,P);let B=0,F=N[C];for(;F<I;){let fe=v[C],je=w+B*re<<3;for(;fe<S;){var f;if(g==1&&(f=(f=H[je>>3])>>7-(7&je)&1,u[F*c+(fe>>3)]|=f<<7-((7&fe)<<0)),g==2&&(f=(f=H[je>>3])>>6-(7&je)&3,u[F*c+(fe>>2)]|=f<<6-((3&fe)<<1)),g==4&&(f=(f=H[je>>3])>>4-(7&je)&15,u[F*c+(fe>>1)]|=f<<4-((1&fe)<<2)),g>=8){const be=F*c+fe*U;for(let pe=0;pe<U;pe++)u[be+pe]=H[(je>>3)+pe]}je+=g,fe+=D}B++,F+=l}L*P!=0&&(w+=P*(1+re)),C+=1}return u})(a,n)),a}function i(n,a){return s(new Uint8Array(n.buffer,2,n.length-6),a)}var s=(function(){const n={H:{}};return n.H.N=function(a,r){const o=Uint8Array;let h,k,E=0,j=0,H=0,M=0,S=0,I=0,g=0,U=0,c=0;if(a[0]==3&&a[1]==0)return r||new o(0);const u=n.H,w=u.b,N=u.e,v=u.R,A=u.n,b=u.A,C=u.Z,f=u.m,l=r==null;for(l&&(r=new o(a.length>>>2<<5));E==0;)if(E=w(a,c,1),j=w(a,c+1,2),c+=3,j!=0){if(l&&(r=n.H.W(r,U+(1<<17))),j==1&&(h=f.J,k=f.h,I=511,g=31),j==2){H=N(a,c,5)+257,M=N(a,c+5,5)+1,S=N(a,c+10,4)+4,c+=14;let L=1;for(var D=0;D<38;D+=2)f.Q[D]=0,f.Q[D+1]=0;for(D=0;D<S;D++){const q=N(a,c+3*D,3);f.Q[1+(f.X[D]<<1)]=q,q>L&&(L=q)}c+=3*S,A(f.Q,L),b(f.Q,L,f.u),h=f.w,k=f.d,c=v(f.u,(1<<L)-1,H+M,a,c,f.v);const P=u.V(f.v,0,H,f.C);I=(1<<P)-1;const le=u.V(f.v,H,M,f.D);g=(1<<le)-1,A(f.C,P),b(f.C,P,h),A(f.D,le),b(f.D,le,k)}for(;;){const L=h[C(a,c)&I];c+=15&L;const P=L>>>4;if(!(P>>>8))r[U++]=P;else{if(P==256)break;{let le=U+P-254;if(P>264){const fe=f.q[P-257];le=U+(fe>>>3)+N(a,c,7&fe),c+=7&fe}const q=k[C(a,c)&g];c+=15&q;const re=q>>>4,B=f.c[re],F=(B>>>4)+w(a,c,15&B);for(c+=15&B;U<le;)r[U]=r[U++-F],r[U]=r[U++-F],r[U]=r[U++-F],r[U]=r[U++-F];U=le}}}}else{(7&c)!=0&&(c+=8-(7&c));const L=4+(c>>>3),P=a[L-4]|a[L-3]<<8;l&&(r=n.H.W(r,U+P)),r.set(new o(a.buffer,a.byteOffset+L,P),U),c=L+P<<3,U+=P}return r.length==U?r:r.slice(0,U)},n.H.W=function(a,r){const o=a.length;if(r<=o)return a;const h=new Uint8Array(o<<1);return h.set(a,0),h},n.H.R=function(a,r,o,h,k,E){const j=n.H.e,H=n.H.Z;let M=0;for(;M<o;){const S=a[H(h,k)&r];k+=15&S;const I=S>>>4;if(I<=15)E[M]=I,M++;else{let g=0,U=0;I==16?(U=3+j(h,k,2),k+=2,g=E[M-1]):I==17?(U=3+j(h,k,3),k+=3):I==18&&(U=11+j(h,k,7),k+=7);const c=M+U;for(;M<c;)E[M]=g,M++}}return k},n.H.V=function(a,r,o,h){let k=0,E=0;const j=h.length>>>1;for(;E<o;){const H=a[E+r];h[E<<1]=0,h[1+(E<<1)]=H,H>k&&(k=H),E++}for(;E<j;)h[E<<1]=0,h[1+(E<<1)]=0,E++;return k},n.H.n=function(a,r){const o=n.H.m,h=a.length;let k,E,j,H;const M=o.j;for(var S=0;S<=r;S++)M[S]=0;for(S=1;S<h;S+=2)M[a[S]]++;const I=o.K;for(k=0,M[0]=0,E=1;E<=r;E++)k=k+M[E-1]<<1,I[E]=k;for(j=0;j<h;j+=2)H=a[j+1],H!=0&&(a[j]=I[H],I[H]++)},n.H.A=function(a,r,o){const h=a.length,k=n.H.m.r;for(let E=0;E<h;E+=2)if(a[E+1]!=0){const j=E>>1,H=a[E+1],M=j<<4|H,S=r-H;let I=a[E]<<S;const g=I+(1<<S);for(;I!=g;)o[k[I]>>>15-r]=M,I++}},n.H.l=function(a,r){const o=n.H.m.r,h=15-r;for(let k=0;k<a.length;k+=2){const E=a[k]<<r-a[k+1];a[k]=o[E]>>>h}},n.H.M=function(a,r,o){o<<=7&r;const h=r>>>3;a[h]|=o,a[h+1]|=o>>>8},n.H.I=function(a,r,o){o<<=7&r;const h=r>>>3;a[h]|=o,a[h+1]|=o>>>8,a[h+2]|=o>>>16},n.H.e=function(a,r,o){return(a[r>>>3]|a[1+(r>>>3)]<<8)>>>(7&r)&(1<<o)-1},n.H.b=function(a,r,o){return(a[r>>>3]|a[1+(r>>>3)]<<8|a[2+(r>>>3)]<<16)>>>(7&r)&(1<<o)-1},n.H.Z=function(a,r){return(a[r>>>3]|a[1+(r>>>3)]<<8|a[2+(r>>>3)]<<16)>>>(7&r)},n.H.i=function(a,r){return(a[r>>>3]|a[1+(r>>>3)]<<8|a[2+(r>>>3)]<<16|a[3+(r>>>3)]<<24)>>>(7&r)},n.H.m=(function(){const a=Uint16Array,r=Uint32Array;return{K:new a(16),j:new a(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new a(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new a(512),_:[],h:new a(32),$:[],w:new a(32768),C:[],v:[],d:new a(32768),D:[],u:new a(512),Q:[],r:new a(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new a(65536),g:new a(32768)}})(),(function(){const a=n.H.m;for(var r=0;r<32768;r++){let h=r;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,a.r[r]=(h>>>16|h<<16)>>>17}function o(h,k,E){for(;k--!=0;)h.push(0,E)}for(r=0;r<32;r++)a.q[r]=a.S[r]<<3|a.T[r],a.c[r]=a.p[r]<<4|a.z[r];o(a._,144,8),o(a._,112,9),o(a._,24,7),o(a._,8,8),n.H.n(a._,9),n.H.A(a._,9,a.J),n.H.l(a._,9),o(a.$,32,5),n.H.n(a.$,5),n.H.A(a.$,5,a.h),n.H.l(a.$,5),o(a.Q,19,0),o(a.C,286,0),o(a.D,30,0),o(a.v,320,0)})(),n.H.N})();function t(n){return[1,null,3,1,2,null,4][n.ctype]*n.depth}function m(n,a,r,o,h){let k=t(a);const E=Math.ceil(o*k/8);let j,H;k=Math.ceil(k/8);let M=n[r],S=0;if(M>1&&(n[r]=[0,0,1][M-2]),M==3)for(S=k;S<E;S++)n[S+1]=n[S+1]+(n[S+1-k]>>>1)&255;for(let I=0;I<h;I++)if(j=r+I*E,H=j+I+1,M=n[H-1],S=0,M==0)for(;S<E;S++)n[j+S]=n[H+S];else if(M==1){for(;S<k;S++)n[j+S]=n[H+S];for(;S<E;S++)n[j+S]=n[H+S]+n[j+S-k]}else if(M==2)for(;S<E;S++)n[j+S]=n[H+S]+n[j+S-E];else if(M==3){for(;S<k;S++)n[j+S]=n[H+S]+(n[j+S-E]>>>1);for(;S<E;S++)n[j+S]=n[H+S]+(n[j+S-E]+n[j+S-k]>>>1)}else{for(;S<k;S++)n[j+S]=n[H+S]+d(0,n[j+S-E],0);for(;S<E;S++)n[j+S]=n[H+S]+d(n[j+S-k],n[j+S-E],n[j+S-k-E])}return n}function d(n,a,r){const o=n+a-r,h=o-n,k=o-a,E=o-r;return h*h<=k*k&&h*h<=E*E?n:k*k<=E*E?a:r}function p(n,a,r){r.width=T.readUint(n,a),a+=4,r.height=T.readUint(n,a),a+=4,r.depth=n[a],a++,r.ctype=n[a],a++,r.compress=n[a],a++,r.filter=n[a],a++,r.interlace=n[a],a++}function x(n,a,r,o,h,k,E,j,H){const M=Math.min(a,h),S=Math.min(r,k);let I=0,g=0;for(let C=0;C<S;C++)for(let f=0;f<M;f++)if(E>=0&&j>=0?(I=C*a+f<<2,g=(j+C)*h+E+f<<2):(I=(-j+C)*a-E+f<<2,g=C*h+f<<2),H==0)o[g]=n[I],o[g+1]=n[I+1],o[g+2]=n[I+2],o[g+3]=n[I+3];else if(H==1){var U=n[I+3]*.00392156862745098,c=n[I]*U,u=n[I+1]*U,w=n[I+2]*U,N=o[g+3]*(1/255),v=o[g]*N,A=o[g+1]*N,b=o[g+2]*N;const l=1-U,D=U+N*l,L=D==0?0:1/D;o[g+3]=255*D,o[g+0]=(c+v*l)*L,o[g+1]=(u+A*l)*L,o[g+2]=(w+b*l)*L}else if(H==2)U=n[I+3],c=n[I],u=n[I+1],w=n[I+2],N=o[g+3],v=o[g],A=o[g+1],b=o[g+2],U==N&&c==v&&u==A&&w==b?(o[g]=0,o[g+1]=0,o[g+2]=0,o[g+3]=0):(o[g]=c,o[g+1]=u,o[g+2]=w,o[g+3]=U);else if(H==3){if(U=n[I+3],c=n[I],u=n[I+1],w=n[I+2],N=o[g+3],v=o[g],A=o[g+1],b=o[g+2],U==N&&c==v&&u==A&&w==b)continue;if(U<220&&N>20)return!1}return!0}return{decode:function(a){const r=new Uint8Array(a);let o=8;const h=T,k=h.readUshort,E=h.readUint,j={tabs:{},frames:[]},H=new Uint8Array(r.length);let M,S=0,I=0;const g=[137,80,78,71,13,10,26,10];for(var U=0;U<8;U++)if(r[U]!=g[U])throw"The input is not a PNG file!";for(;o<r.length;){const C=h.readUint(r,o);o+=4;const f=h.readASCII(r,o,4);if(o+=4,f=="IHDR")p(r,o,j);else if(f=="iCCP"){for(var c=o;r[c]!=0;)c++;h.readASCII(r,o,c-o),r[c+1];const l=r.slice(c+2,o+C);let D=null;try{D=i(l)}catch{D=s(l)}j.tabs[f]=D}else if(f=="CgBI")j.tabs[f]=r.slice(o,o+4);else if(f=="IDAT"){for(U=0;U<C;U++)H[S+U]=r[o+U];S+=C}else if(f=="acTL")j.tabs[f]={num_frames:E(r,o),num_plays:E(r,o+4)},M=new Uint8Array(r.length);else if(f=="fcTL"){I!=0&&((b=j.frames[j.frames.length-1]).data=z(j,M.slice(0,I),b.rect.width,b.rect.height),I=0);const l={x:E(r,o+12),y:E(r,o+16),width:E(r,o+4),height:E(r,o+8)};let D=k(r,o+22);D=k(r,o+20)/(D==0?100:D);const L={rect:l,delay:Math.round(1e3*D),dispose:r[o+24],blend:r[o+25]};j.frames.push(L)}else if(f=="fdAT"){for(U=0;U<C-4;U++)M[I+U]=r[o+U+4];I+=C-4}else if(f=="pHYs")j.tabs[f]=[h.readUint(r,o),h.readUint(r,o+4),r[o+8]];else if(f=="cHRM")for(j.tabs[f]=[],U=0;U<8;U++)j.tabs[f].push(h.readUint(r,o+4*U));else if(f=="tEXt"||f=="zTXt"){j.tabs[f]==null&&(j.tabs[f]={});var u=h.nextZero(r,o),w=h.readASCII(r,o,u-o),N=o+C-u-1;if(f=="tEXt")A=h.readASCII(r,u+1,N);else{var v=i(r.slice(u+2,u+2+N));A=h.readUTF8(v,0,v.length)}j.tabs[f][w]=A}else if(f=="iTXt"){j.tabs[f]==null&&(j.tabs[f]={}),u=0,c=o,u=h.nextZero(r,c),w=h.readASCII(r,c,u-c);const l=r[c=u+1];var A;r[c+1],c+=2,u=h.nextZero(r,c),h.readASCII(r,c,u-c),c=u+1,u=h.nextZero(r,c),h.readUTF8(r,c,u-c),N=C-((c=u+1)-o),l==0?A=h.readUTF8(r,c,N):(v=i(r.slice(c,c+N)),A=h.readUTF8(v,0,v.length)),j.tabs[f][w]=A}else if(f=="PLTE")j.tabs[f]=h.readBytes(r,o,C);else if(f=="hIST"){const l=j.tabs.PLTE.length/3;for(j.tabs[f]=[],U=0;U<l;U++)j.tabs[f].push(k(r,o+2*U))}else if(f=="tRNS")j.ctype==3?j.tabs[f]=h.readBytes(r,o,C):j.ctype==0?j.tabs[f]=k(r,o):j.ctype==2&&(j.tabs[f]=[k(r,o),k(r,o+2),k(r,o+4)]);else if(f=="gAMA")j.tabs[f]=h.readUint(r,o)/1e5;else if(f=="sRGB")j.tabs[f]=r[o];else if(f=="bKGD")j.ctype==0||j.ctype==4?j.tabs[f]=[k(r,o)]:j.ctype==2||j.ctype==6?j.tabs[f]=[k(r,o),k(r,o+2),k(r,o+4)]:j.ctype==3&&(j.tabs[f]=r[o]);else if(f=="IEND")break;o+=C,h.readUint(r,o),o+=4}var b;return I!=0&&((b=j.frames[j.frames.length-1]).data=z(j,M.slice(0,I),b.rect.width,b.rect.height)),j.data=z(j,H,j.width,j.height),delete j.compress,delete j.interlace,delete j.filter,j},toRGBA8:function(a){const r=a.width,o=a.height;if(a.tabs.acTL==null)return[_(a.data,r,o,a).buffer];const h=[];a.frames[0].data==null&&(a.frames[0].data=a.data);const k=r*o*4,E=new Uint8Array(k),j=new Uint8Array(k),H=new Uint8Array(k);for(let S=0;S<a.frames.length;S++){const I=a.frames[S],g=I.rect.x,U=I.rect.y,c=I.rect.width,u=I.rect.height,w=_(I.data,c,u,a);if(S!=0)for(var M=0;M<k;M++)H[M]=E[M];if(I.blend==0?x(w,c,u,E,r,o,g,U,0):I.blend==1&&x(w,c,u,E,r,o,g,U,1),h.push(E.buffer.slice(0)),I.dispose!=0){if(I.dispose==1)x(j,c,u,E,r,o,g,U,0);else if(I.dispose==2)for(M=0;M<k;M++)E[M]=H[M]}}return h},_paeth:d,_copyTile:x,_bin:T}})();(function(){const{_copyTile:T}=nt,{_bin:_}=nt,z=nt._paeth;var i={table:(function(){const c=new Uint32Array(256);for(let u=0;u<256;u++){let w=u;for(let N=0;N<8;N++)1&w?w=3988292384^w>>>1:w>>>=1;c[u]=w}return c})(),update(c,u,w,N){for(let v=0;v<N;v++)c=i.table[255&(c^u[w+v])]^c>>>8;return c},crc:(c,u,w)=>4294967295^i.update(4294967295,c,u,w)};function s(c,u,w,N){u[w]+=c[0]*N>>4,u[w+1]+=c[1]*N>>4,u[w+2]+=c[2]*N>>4,u[w+3]+=c[3]*N>>4}function t(c){return Math.max(0,Math.min(255,c))}function m(c,u){const w=c[0]-u[0],N=c[1]-u[1],v=c[2]-u[2],A=c[3]-u[3];return w*w+N*N+v*v+A*A}function d(c,u,w,N,v,A,b){b==null&&(b=1);const C=N.length,f=[];for(var l=0;l<C;l++){const F=N[l];f.push([F>>>0&255,F>>>8&255,F>>>16&255,F>>>24&255])}for(l=0;l<C;l++){let F=4294967295;for(var D=0,L=0;L<C;L++){var P=m(f[l],f[L]);L!=l&&P<F&&(F=P,D=L)}}const le=new Uint32Array(v.buffer),q=new Int16Array(u*w*4),re=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(l=0;l<re.length;l++)re[l]=255*((re[l]+.5)/16-.5);for(let F=0;F<w;F++)for(let fe=0;fe<u;fe++){var B;l=4*(F*u+fe),b!=2?B=[t(c[l]+q[l]),t(c[l+1]+q[l+1]),t(c[l+2]+q[l+2]),t(c[l+3]+q[l+3])]:(P=re[4*(3&F)+(3&fe)],B=[t(c[l]+P),t(c[l+1]+P),t(c[l+2]+P),t(c[l+3]+P)]),D=0;let je=16777215;for(L=0;L<C;L++){const we=m(B,f[L]);we<je&&(je=we,D=L)}const be=f[D],pe=[B[0]-be[0],B[1]-be[1],B[2]-be[2],B[3]-be[3]];b==1&&(fe!=u-1&&s(pe,q,l+4,7),F!=w-1&&(fe!=0&&s(pe,q,l+4*u-4,3),s(pe,q,l+4*u,5),fe!=u-1&&s(pe,q,l+4*u+4,1))),A[l>>2]=D,le[l>>2]=N[D]}}function p(c,u,w,N,v){v==null&&(v={});const{crc:A}=i,b=_.writeUint,C=_.writeUshort,f=_.writeASCII;let l=8;const D=c.frames.length>1;let L,P=!1,le=33+(D?20:0);if(v.sRGB!=null&&(le+=13),v.pHYs!=null&&(le+=21),v.iCCP!=null&&(L=pako.deflate(v.iCCP),le+=21+L.length+4),c.ctype==3){for(var q=c.plte.length,re=0;re<q;re++)c.plte[re]>>>24!=255&&(P=!0);le+=8+3*q+4+(P?8+1*q+4:0)}for(var B=0;B<c.frames.length;B++)D&&(le+=38),le+=(be=c.frames[B]).cimg.length+12,B!=0&&(le+=4);le+=12;const F=new Uint8Array(le),fe=[137,80,78,71,13,10,26,10];for(re=0;re<8;re++)F[re]=fe[re];if(b(F,l,13),l+=4,f(F,l,"IHDR"),l+=4,b(F,l,u),l+=4,b(F,l,w),l+=4,F[l]=c.depth,l++,F[l]=c.ctype,l++,F[l]=0,l++,F[l]=0,l++,F[l]=0,l++,b(F,l,A(F,l-17,17)),l+=4,v.sRGB!=null&&(b(F,l,1),l+=4,f(F,l,"sRGB"),l+=4,F[l]=v.sRGB,l++,b(F,l,A(F,l-5,5)),l+=4),v.iCCP!=null){const pe=13+L.length;b(F,l,pe),l+=4,f(F,l,"iCCP"),l+=4,f(F,l,"ICC profile"),l+=11,l+=2,F.set(L,l),l+=L.length,b(F,l,A(F,l-(pe+4),pe+4)),l+=4}if(v.pHYs!=null&&(b(F,l,9),l+=4,f(F,l,"pHYs"),l+=4,b(F,l,v.pHYs[0]),l+=4,b(F,l,v.pHYs[1]),l+=4,F[l]=v.pHYs[2],l++,b(F,l,A(F,l-13,13)),l+=4),D&&(b(F,l,8),l+=4,f(F,l,"acTL"),l+=4,b(F,l,c.frames.length),l+=4,b(F,l,v.loop!=null?v.loop:0),l+=4,b(F,l,A(F,l-12,12)),l+=4),c.ctype==3){for(b(F,l,3*(q=c.plte.length)),l+=4,f(F,l,"PLTE"),l+=4,re=0;re<q;re++){const pe=3*re,we=c.plte[re],Te=255&we,Ce=we>>>8&255,dt=we>>>16&255;F[l+pe+0]=Te,F[l+pe+1]=Ce,F[l+pe+2]=dt}if(l+=3*q,b(F,l,A(F,l-3*q-4,3*q+4)),l+=4,P){for(b(F,l,q),l+=4,f(F,l,"tRNS"),l+=4,re=0;re<q;re++)F[l+re]=c.plte[re]>>>24&255;l+=q,b(F,l,A(F,l-q-4,q+4)),l+=4}}let je=0;for(B=0;B<c.frames.length;B++){var be=c.frames[B];D&&(b(F,l,26),l+=4,f(F,l,"fcTL"),l+=4,b(F,l,je++),l+=4,b(F,l,be.rect.width),l+=4,b(F,l,be.rect.height),l+=4,b(F,l,be.rect.x),l+=4,b(F,l,be.rect.y),l+=4,C(F,l,N[B]),l+=2,C(F,l,1e3),l+=2,F[l]=be.dispose,l++,F[l]=be.blend,l++,b(F,l,A(F,l-30,30)),l+=4);const pe=be.cimg;b(F,l,(q=pe.length)+(B==0?0:4)),l+=4;const we=l;f(F,l,B==0?"IDAT":"fdAT"),l+=4,B!=0&&(b(F,l,je++),l+=4),F.set(pe,l),l+=q,b(F,l,A(F,we,l-we)),l+=4}return b(F,l,0),l+=4,f(F,l,"IEND"),l+=4,b(F,l,A(F,l-4,4)),l+=4,F.buffer}function x(c,u,w){for(let N=0;N<c.frames.length;N++){const v=c.frames[N];v.rect.width;const A=v.rect.height,b=new Uint8Array(A*v.bpl+A);v.cimg=o(v.img,A,v.bpp,v.bpl,b,u,w)}}function n(c,u,w,N,v){const A=v[0],b=v[1],C=v[2],f=v[3],l=v[4],D=v[5];let L=6,P=8,le=255;for(var q=0;q<c.length;q++){const Fe=new Uint8Array(c[q]);for(var re=Fe.length,B=0;B<re;B+=4)le&=Fe[B+3]}const F=le!=255,fe=(function(Ne,ke,Me,Ee,Ie,He){const Ue=[];for(var ye=0;ye<Ne.length;ye++){const Pe=new Uint8Array(Ne[ye]),Re=new Uint32Array(Pe.buffer);var We;let Ke=0,Xe=0,Be=ke,et=Me,xt=Ee?1:0;if(ye!=0){const zt=He||Ee||ye==1||Ue[ye-2].dispose!=0?1:2;let Ge=0,Et=1e9;for(let pt=0;pt<zt;pt++){var Ve=new Uint8Array(Ne[ye-1-pt]);const _t=new Uint32Array(Ne[ye-1-pt]);let at=ke,$e=Me,ve=-1,mt=-1;for(let tt=0;tt<Me;tt++)for(let st=0;st<ke;st++)Re[De=tt*ke+st]!=_t[De]&&(st<at&&(at=st),st>ve&&(ve=st),tt<$e&&($e=tt),tt>mt&&(mt=tt));ve==-1&&(at=$e=ve=mt=0),Ie&&((1&at)==1&&at--,(1&$e)==1&&$e--);const ht=(ve-at+1)*(mt-$e+1);ht<Et&&(Et=ht,Ge=pt,Ke=at,Xe=$e,Be=ve-at+1,et=mt-$e+1)}Ve=new Uint8Array(Ne[ye-1-Ge]),Ge==1&&(Ue[ye-1].dispose=2),We=new Uint8Array(Be*et*4),T(Ve,ke,Me,We,Be,et,-Ke,-Xe,0),xt=T(Pe,ke,Me,We,Be,et,-Ke,-Xe,3)?1:0,xt==1?r(Pe,ke,Me,We,{x:Ke,y:Xe,width:Be,height:et}):T(Pe,ke,Me,We,Be,et,-Ke,-Xe,0)}else We=Pe.slice(0);Ue.push({rect:{x:Ke,y:Xe,width:Be,height:et},img:We,blend:xt,dispose:0})}if(Ee)for(ye=0;ye<Ue.length;ye++){if((Ze=Ue[ye]).blend==1)continue;const Pe=Ze.rect,Re=Ue[ye-1].rect,Ke=Math.min(Pe.x,Re.x),Xe=Math.min(Pe.y,Re.y),Be={x:Ke,y:Xe,width:Math.max(Pe.x+Pe.width,Re.x+Re.width)-Ke,height:Math.max(Pe.y+Pe.height,Re.y+Re.height)-Xe};Ue[ye-1].dispose=1,ye-1!=0&&a(Ne,ke,Me,Ue,ye-1,Be,Ie),a(Ne,ke,Me,Ue,ye,Be,Ie)}let ft=0;if(Ne.length!=1)for(var De=0;De<Ue.length;De++){var Ze;ft+=(Ze=Ue[De]).rect.width*Ze.rect.height}return Ue})(c,u,w,A,b,C),je={},be=[],pe=[];if(N!=0){const Fe=[];for(B=0;B<fe.length;B++)Fe.push(fe[B].img.buffer);const Ne=(function(Ie){let He=0;for(var Ue=0;Ue<Ie.length;Ue++)He+=Ie[Ue].byteLength;const ye=new Uint8Array(He);let We=0;for(Ue=0;Ue<Ie.length;Ue++){const Ve=new Uint8Array(Ie[Ue]),ft=Ve.length;for(let De=0;De<ft;De+=4){let Ze=Ve[De],Pe=Ve[De+1],Re=Ve[De+2];const Ke=Ve[De+3];Ke==0&&(Ze=Pe=Re=0),ye[We+De]=Ze,ye[We+De+1]=Pe,ye[We+De+2]=Re,ye[We+De+3]=Ke}We+=ft}return ye.buffer})(Fe),ke=k(Ne,N);for(B=0;B<ke.plte.length;B++)be.push(ke.plte[B].est.rgba);let Me=0;for(B=0;B<fe.length;B++){const Ee=(Te=fe[B]).img.length;var we=new Uint8Array(ke.inds.buffer,Me>>2,Ee>>2);pe.push(we);const Ie=new Uint8Array(ke.abuf,Me,Ee);D&&d(Te.img,Te.rect.width,Te.rect.height,be,Ie,we),Te.img.set(Ie),Me+=Ee}}else for(q=0;q<fe.length;q++){var Te=fe[q];const Fe=new Uint32Array(Te.img.buffer);var Ce=Te.rect.width;for(re=Fe.length,we=new Uint8Array(re),pe.push(we),B=0;B<re;B++){const Ne=Fe[B];if(B!=0&&Ne==Fe[B-1])we[B]=we[B-1];else if(B>Ce&&Ne==Fe[B-Ce])we[B]=we[B-Ce];else{let ke=je[Ne];if(ke==null&&(je[Ne]=ke=be.length,be.push(Ne),be.length>=300))break;we[B]=ke}}}const dt=be.length;for(dt<=256&&l==0&&(P=dt<=2?1:dt<=4?2:dt<=16?4:8,P=Math.max(P,f)),q=0;q<fe.length;q++){(Te=fe[q]).rect.x,Te.rect.y,Ce=Te.rect.width;const Fe=Te.rect.height;let Ne=Te.img;new Uint32Array(Ne.buffer);let ke=4*Ce,Me=4;if(dt<=256&&l==0){ke=Math.ceil(P*Ce/8);var qe=new Uint8Array(ke*Fe);const Ee=pe[q];for(let Ie=0;Ie<Fe;Ie++){B=Ie*ke;const He=Ie*Ce;if(P==8)for(var Le=0;Le<Ce;Le++)qe[B+Le]=Ee[He+Le];else if(P==4)for(Le=0;Le<Ce;Le++)qe[B+(Le>>1)]|=Ee[He+Le]<<4-4*(1&Le);else if(P==2)for(Le=0;Le<Ce;Le++)qe[B+(Le>>2)]|=Ee[He+Le]<<6-2*(3&Le);else if(P==1)for(Le=0;Le<Ce;Le++)qe[B+(Le>>3)]|=Ee[He+Le]<<7-1*(7&Le)}Ne=qe,L=3,Me=1}else if(F==0&&fe.length==1){qe=new Uint8Array(Ce*Fe*3);const Ee=Ce*Fe;for(B=0;B<Ee;B++){const Ie=3*B,He=4*B;qe[Ie]=Ne[He],qe[Ie+1]=Ne[He+1],qe[Ie+2]=Ne[He+2]}Ne=qe,L=2,Me=3,ke=3*Ce}Te.img=Ne,Te.bpl=ke,Te.bpp=Me}return{ctype:L,depth:P,plte:be,frames:fe}}function a(c,u,w,N,v,A,b){const C=Uint8Array,f=Uint32Array,l=new C(c[v-1]),D=new f(c[v-1]),L=v+1<c.length?new C(c[v+1]):null,P=new C(c[v]),le=new f(P.buffer);let q=u,re=w,B=-1,F=-1;for(let je=0;je<A.height;je++)for(let be=0;be<A.width;be++){const pe=A.x+be,we=A.y+je,Te=we*u+pe,Ce=le[Te];Ce==0||N[v-1].dispose==0&&D[Te]==Ce&&(L==null||L[4*Te+3]!=0)||(pe<q&&(q=pe),pe>B&&(B=pe),we<re&&(re=we),we>F&&(F=we))}B==-1&&(q=re=B=F=0),b&&((1&q)==1&&q--,(1&re)==1&&re--),A={x:q,y:re,width:B-q+1,height:F-re+1};const fe=N[v];fe.rect=A,fe.blend=1,fe.img=new Uint8Array(A.width*A.height*4),N[v-1].dispose==0?(T(l,u,w,fe.img,A.width,A.height,-A.x,-A.y,0),r(P,u,w,fe.img,A)):T(P,u,w,fe.img,A.width,A.height,-A.x,-A.y,0)}function r(c,u,w,N,v){T(c,u,w,N,v.width,v.height,-v.x,-v.y,2)}function o(c,u,w,N,v,A,b){const C=[];let f,l=[0,1,2,3,4];A!=-1?l=[A]:(u*N>5e5||w==1)&&(l=[0]),b&&(f={level:0});const D=Bs;for(var L=0;L<l.length;L++){for(let q=0;q<u;q++)h(v,c,q,N,w,l[L]);C.push(D.deflate(v,f))}let P,le=1e9;for(L=0;L<C.length;L++)C[L].length<le&&(P=L,le=C[L].length);return C[P]}function h(c,u,w,N,v,A){const b=w*N;let C=b+w;if(c[C]=A,C++,A==0)if(N<500)for(var f=0;f<N;f++)c[C+f]=u[b+f];else c.set(new Uint8Array(u.buffer,b,N),C);else if(A==1){for(f=0;f<v;f++)c[C+f]=u[b+f];for(f=v;f<N;f++)c[C+f]=u[b+f]-u[b+f-v]+256&255}else if(w==0){for(f=0;f<v;f++)c[C+f]=u[b+f];if(A==2)for(f=v;f<N;f++)c[C+f]=u[b+f];if(A==3)for(f=v;f<N;f++)c[C+f]=u[b+f]-(u[b+f-v]>>1)+256&255;if(A==4)for(f=v;f<N;f++)c[C+f]=u[b+f]-z(u[b+f-v],0,0)+256&255}else{if(A==2)for(f=0;f<N;f++)c[C+f]=u[b+f]+256-u[b+f-N]&255;if(A==3){for(f=0;f<v;f++)c[C+f]=u[b+f]+256-(u[b+f-N]>>1)&255;for(f=v;f<N;f++)c[C+f]=u[b+f]+256-(u[b+f-N]+u[b+f-v]>>1)&255}if(A==4){for(f=0;f<v;f++)c[C+f]=u[b+f]+256-z(0,u[b+f-N],0)&255;for(f=v;f<N;f++)c[C+f]=u[b+f]+256-z(u[b+f-v],u[b+f-N],u[b+f-v-N])&255}}}function k(c,u){const w=new Uint8Array(c),N=w.slice(0),v=new Uint32Array(N.buffer),A=E(N,u),b=A[0],C=A[1],f=w.length,l=new Uint8Array(f>>2);let D;if(w.length<2e7)for(var L=0;L<f;L+=4)D=j(b,P=w[L]*(1/255),le=w[L+1]*(1/255),q=w[L+2]*(1/255),re=w[L+3]*(1/255)),l[L>>2]=D.ind,v[L>>2]=D.est.rgba;else for(L=0;L<f;L+=4){var P=w[L]*.00392156862745098,le=w[L+1]*(1/255),q=w[L+2]*(1/255),re=w[L+3]*(1/255);for(D=b;D.left;)D=H(D.est,P,le,q,re)<=0?D.left:D.right;l[L>>2]=D.ind,v[L>>2]=D.est.rgba}return{abuf:N.buffer,inds:l,plte:C}}function E(c,u,w){w==null&&(w=1e-4);const N=new Uint32Array(c.buffer),v={i0:0,i1:c.length,bst:null,est:null,tdst:0,left:null,right:null};v.bst=I(c,v.i0,v.i1),v.est=g(v.bst);const A=[v];for(;A.length<u;){let C=0,f=0;for(var b=0;b<A.length;b++)A[b].est.L>C&&(C=A[b].est.L,f=b);if(C<w)break;const l=A[f],D=M(c,N,l.i0,l.i1,l.est.e,l.est.eMq255);if(l.i0>=D||l.i1<=D){l.est.L=0;continue}const L={i0:l.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};L.bst=I(c,L.i0,L.i1),L.est=g(L.bst);const P={i0:D,i1:l.i1,bst:null,est:null,tdst:0,left:null,right:null};for(P.bst={R:[],m:[],N:l.bst.N-L.bst.N},b=0;b<16;b++)P.bst.R[b]=l.bst.R[b]-L.bst.R[b];for(b=0;b<4;b++)P.bst.m[b]=l.bst.m[b]-L.bst.m[b];P.est=g(P.bst),l.left=L,l.right=P,A[f]=L,A.push(P)}for(A.sort(((C,f)=>f.bst.N-C.bst.N)),b=0;b<A.length;b++)A[b].ind=b;return[v,A]}function j(c,u,w,N,v){if(c.left==null)return c.tdst=(function(L,P,le,q,re){const B=P-L[0],F=le-L[1],fe=q-L[2],je=re-L[3];return B*B+F*F+fe*fe+je*je})(c.est.q,u,w,N,v),c;const A=H(c.est,u,w,N,v);let b=c.left,C=c.right;A>0&&(b=c.right,C=c.left);const f=j(b,u,w,N,v);if(f.tdst<=A*A)return f;const l=j(C,u,w,N,v);return l.tdst<f.tdst?l:f}function H(c,u,w,N,v){const{e:A}=c;return A[0]*u+A[1]*w+A[2]*N+A[3]*v-c.eMq}function M(c,u,w,N,v,A){for(N-=4;w<N;){for(;S(c,w,v)<=A;)w+=4;for(;S(c,N,v)>A;)N-=4;if(w>=N)break;const b=u[w>>2];u[w>>2]=u[N>>2],u[N>>2]=b,w+=4,N-=4}for(;S(c,w,v)>A;)w-=4;return w+4}function S(c,u,w){return c[u]*w[0]+c[u+1]*w[1]+c[u+2]*w[2]+c[u+3]*w[3]}function I(c,u,w){const N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v=[0,0,0,0],A=w-u>>2;for(let b=u;b<w;b+=4){const C=c[b]*.00392156862745098,f=c[b+1]*(1/255),l=c[b+2]*(1/255),D=c[b+3]*(1/255);v[0]+=C,v[1]+=f,v[2]+=l,v[3]+=D,N[0]+=C*C,N[1]+=C*f,N[2]+=C*l,N[3]+=C*D,N[5]+=f*f,N[6]+=f*l,N[7]+=f*D,N[10]+=l*l,N[11]+=l*D,N[15]+=D*D}return N[4]=N[1],N[8]=N[2],N[9]=N[6],N[12]=N[3],N[13]=N[7],N[14]=N[11],{R:N,m:v,N:A}}function g(c){const{R:u}=c,{m:w}=c,{N}=c,v=w[0],A=w[1],b=w[2],C=w[3],f=N==0?0:1/N,l=[u[0]-v*v*f,u[1]-v*A*f,u[2]-v*b*f,u[3]-v*C*f,u[4]-A*v*f,u[5]-A*A*f,u[6]-A*b*f,u[7]-A*C*f,u[8]-b*v*f,u[9]-b*A*f,u[10]-b*b*f,u[11]-b*C*f,u[12]-C*v*f,u[13]-C*A*f,u[14]-C*b*f,u[15]-C*C*f],D=l,L=U;let P=[Math.random(),Math.random(),Math.random(),Math.random()],le=0,q=0;if(N!=0)for(let B=0;B<16&&(P=L.multVec(D,P),q=Math.sqrt(L.dot(P,P)),P=L.sml(1/q,P),!(B!=0&&Math.abs(q-le)<1e-9));B++)le=q;const re=[v*f,A*f,b*f,C*f];return{Cov:l,q:re,e:P,L:le,eMq255:L.dot(L.sml(255,re),P),eMq:L.dot(P,re),rgba:(Math.round(255*re[3])<<24|Math.round(255*re[2])<<16|Math.round(255*re[1])<<8|Math.round(255*re[0])<<0)>>>0}}var U={multVec:(c,u)=>[c[0]*u[0]+c[1]*u[1]+c[2]*u[2]+c[3]*u[3],c[4]*u[0]+c[5]*u[1]+c[6]*u[2]+c[7]*u[3],c[8]*u[0]+c[9]*u[1]+c[10]*u[2]+c[11]*u[3],c[12]*u[0]+c[13]*u[1]+c[14]*u[2]+c[15]*u[3]],dot:(c,u)=>c[0]*u[0]+c[1]*u[1]+c[2]*u[2]+c[3]*u[3],sml:(c,u)=>[c*u[0],c*u[1],c*u[2],c*u[3]]};nt.encode=function(u,w,N,v,A,b,C){v==null&&(v=0),C==null&&(C=!1);const f=n(u,w,N,v,[!1,!1,!1,0,C,!1]);return x(f,-1),p(f,w,N,A,b)},nt.encodeLL=function(u,w,N,v,A,b,C,f){const l={ctype:0+(v==1?0:2)+(A==0?0:4),depth:b,frames:[]},D=(v+A)*b,L=D*w;for(let P=0;P<u.length;P++)l.frames.push({rect:{x:0,y:0,width:w,height:N},img:new Uint8Array(u[P]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil(L/8)});return x(l,0,!0),p(l,w,N,C,f)},nt.encode.compress=n,nt.encode.dither=d,nt.quantize=k,nt.quantize.getKDtree=E,nt.quantize.getNearest=j})();const ms={toArrayBuffer(T,_){const z=T.width,i=T.height,s=z<<2,t=T.getContext("2d").getImageData(0,0,z,i),m=new Uint32Array(t.data.buffer),d=(32*z+31)/32<<2,p=d*i,x=122+p,n=new ArrayBuffer(x),a=new DataView(n),r=1<<20;let o,h,k,E,j=r,H=0,M=0,S=0;function I(c){a.setUint16(M,c,!0),M+=2}function g(c){a.setUint32(M,c,!0),M+=4}function U(c){M+=c}I(19778),g(x),U(4),g(122),g(108),g(z),g(-i>>>0),I(1),I(32),g(3),g(p),g(2835),g(2835),U(8),g(16711680),g(65280),g(255),g(4278190080),g(1466527264),(function c(){for(;H<i&&j>0;){for(E=122+H*d,o=0;o<s;)j--,h=m[S++],k=h>>>24,a.setUint32(E+o,h<<8|k),o+=4;H++}S<m.length?(j=r,setTimeout(c,ms._dly)):_(n)})()},toBlob(T,_){this.toArrayBuffer(T,(z=>{_(new Blob([z],{type:"image/bmp"}))}))},_dly:9};var Qe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Gs={[Qe.CHROME]:16384,[Qe.FIREFOX]:11180,[Qe.DESKTOP_SAFARI]:16384,[Qe.IE]:8192,[Qe.IOS]:4096,[Qe.ETC]:8192};const Jt=typeof window<"u",hs=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Rt=Jt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),qs=(Jt||hs)&&(Rt&&Rt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),gs=(Jt||hs)&&(Rt&&Rt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Vt(T,_,z=Date.now()){return new Promise((i=>{const s=T.split(","),t=s[0].match(/:(.*?);/)[1],m=globalThis.atob(s[1]);let d=m.length;const p=new Uint8Array(d);for(;d--;)p[d]=m.charCodeAt(d);const x=new Blob([p],{type:t});x.name=_,x.lastModified=z,i(x)}))}function xs(T){return new Promise(((_,z)=>{const i=new gs;i.onload=()=>_(i.result),i.onerror=s=>z(s),i.readAsDataURL(T)}))}function ps(T){return new Promise(((_,z)=>{const i=new Image;i.onload=()=>_(i),i.onerror=s=>z(s),i.src=T}))}function vt(){if(vt.cachedResult!==void 0)return vt.cachedResult;let T=Qe.ETC;const{userAgent:_}=navigator;return/Chrom(e|ium)/i.test(_)?T=Qe.CHROME:/iP(ad|od|hone)/i.test(_)&&/WebKit/i.test(_)?T=Qe.IOS:/Safari/i.test(_)?T=Qe.DESKTOP_SAFARI:/Firefox/i.test(_)?T=Qe.FIREFOX:(/MSIE/i.test(_)||document.documentMode)&&(T=Qe.IE),vt.cachedResult=T,vt.cachedResult}function bs(T,_){const z=vt(),i=Gs[z];let s=T,t=_,m=s*t;const d=s>t?t/s:s/t;for(;m>i*i;){const p=(i+s)/2,x=(i+t)/2;p<x?(t=x,s=x*d):(t=p*d,s=p),m=s*t}return{width:s,height:t}}function Wt(T,_){let z,i;try{if(z=new OffscreenCanvas(T,_),i=z.getContext("2d"),i===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{z=document.createElement("canvas"),i=z.getContext("2d")}return z.width=T,z.height=_,[z,i]}function ws(T,_){const{width:z,height:i}=bs(T.width,T.height),[s,t]=Wt(z,i);return _&&/jpe?g/.test(_)&&(t.fillStyle="white",t.fillRect(0,0,s.width,s.height)),t.drawImage(T,0,0,s.width,s.height),s}function Dt(){return Dt.cachedResult!==void 0||(Dt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Dt.cachedResult}function $t(T,_={}){return new Promise((function(z,i){let s,t;var m=function(){try{return t=ws(s,_.fileType||T.type),z([s,t])}catch(p){return i(p)}},d=function(p){try{var x=function(n){try{throw n}catch(a){return i(a)}};try{let n;return xs(T).then((function(a){try{return n=a,ps(n).then((function(r){try{return s=r,(function(){try{return m()}catch(o){return i(o)}})()}catch(o){return x(o)}}),x)}catch(r){return x(r)}}),x)}catch(n){x(n)}}catch(n){return i(n)}};try{if(Dt()||[Qe.DESKTOP_SAFARI,Qe.MOBILE_SAFARI].includes(vt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(T).then((function(p){try{return s=p,m()}catch{return d()}}),d)}catch{d()}}))}function Ht(T,_,z,i,s=1){return new Promise((function(t,m){let d;if(_==="image/png"){let x,n,a;return x=T.getContext("2d"),{data:n}=x.getImageData(0,0,T.width,T.height),a=nt.encode([n.buffer],T.width,T.height,4096*s),d=new Blob([a],{type:_}),d.name=z,d.lastModified=i,p.call(this)}{let x=function(){return p.call(this)};if(_==="image/bmp")return new Promise((n=>ms.toBlob(T,n))).then((function(n){try{return d=n,d.name=z,d.lastModified=i,x.call(this)}catch(a){return m(a)}}).bind(this),m);{let n=function(){return x.call(this)};if(typeof OffscreenCanvas=="function"&&T instanceof OffscreenCanvas)return T.convertToBlob({type:_,quality:s}).then((function(a){try{return d=a,d.name=z,d.lastModified=i,n.call(this)}catch(r){return m(r)}}).bind(this),m);{let a;return a=T.toDataURL(_,s),Vt(a,z,i).then((function(r){try{return d=r,n.call(this)}catch(o){return m(o)}}).bind(this),m)}}}function p(){return t(d)}}))}function ct(T){T.width=0,T.height=0}function kt(){return new Promise((function(T,_){let z,i,s,t;return kt.cachedResult!==void 0?T(kt.cachedResult):Vt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(m){try{return z=m,$t(z).then((function(d){try{return i=d[1],Ht(i,z.type,z.name,z.lastModified).then((function(p){try{return s=p,ct(i),$t(s).then((function(x){try{return t=x[0],kt.cachedResult=t.width===1&&t.height===2,T(kt.cachedResult)}catch(n){return _(n)}}),_)}catch(x){return _(x)}}),_)}catch(p){return _(p)}}),_)}catch(d){return _(d)}}),_)}))}function vs(T){return new Promise(((_,z)=>{const i=new gs;i.onload=s=>{const t=new DataView(s.target.result);if(t.getUint16(0,!1)!=65496)return _(-2);const m=t.byteLength;let d=2;for(;d<m;){if(t.getUint16(d+2,!1)<=8)return _(-1);const p=t.getUint16(d,!1);if(d+=2,p==65505){if(t.getUint32(d+=2,!1)!=1165519206)return _(-1);const x=t.getUint16(d+=6,!1)==18761;d+=t.getUint32(d+4,x);const n=t.getUint16(d,x);d+=2;for(let a=0;a<n;a++)if(t.getUint16(d+12*a,x)==274)return _(t.getUint16(d+12*a+8,x))}else{if((65280&p)!=65280)break;d+=t.getUint16(d,!1)}}return _(-1)},i.onerror=s=>z(s),i.readAsArrayBuffer(T)}))}function ys(T,_){const{width:z}=T,{height:i}=T,{maxWidthOrHeight:s}=_;let t,m=T;return isFinite(s)&&(z>s||i>s)&&([m,t]=Wt(z,i),z>i?(m.width=s,m.height=i/z*s):(m.width=z/i*s,m.height=s),t.drawImage(T,0,0,m.width,m.height),ct(T)),m}function js(T,_){const{width:z}=T,{height:i}=T,[s,t]=Wt(z,i);switch(_>4&&_<9?(s.width=i,s.height=z):(s.width=z,s.height=i),_){case 2:t.transform(-1,0,0,1,z,0);break;case 3:t.transform(-1,0,0,-1,z,i);break;case 4:t.transform(1,0,0,-1,0,i);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,i,0);break;case 7:t.transform(0,-1,-1,0,i,z);break;case 8:t.transform(0,-1,1,0,0,z)}return t.drawImage(T,0,0,z,i),ct(T),s}function ds(T,_,z=0){return new Promise((function(i,s){let t,m,d,p,x,n,a,r,o,h,k,E,j,H,M,S,I,g,U,c;function u(N=5){if(_.signal&&_.signal.aborted)throw _.signal.reason;t+=N,_.onProgress(Math.min(t,100))}function w(N){if(_.signal&&_.signal.aborted)throw _.signal.reason;t=Math.min(Math.max(N,t),100),_.onProgress(t)}return t=z,m=_.maxIteration||10,d=1024*_.maxSizeMB*1024,u(),$t(T,_).then((function(N){try{return[,p]=N,u(),x=ys(p,_),u(),new Promise((function(v,A){var b;if(!(b=_.exifOrientation))return vs(T).then((function(f){try{return b=f,C.call(this)}catch(l){return A(l)}}).bind(this),A);function C(){return v(b)}return C.call(this)})).then((function(v){try{return n=v,u(),kt().then((function(A){try{return a=A?x:js(x,n),u(),r=_.initialQuality||1,o=_.fileType||T.type,Ht(a,o,T.name,T.lastModified,r).then((function(b){try{{let f=function(){if(m--&&(M>d||M>j)){let D,L;return D=c?.95*U.width:U.width,L=c?.95*U.height:U.height,[I,g]=Wt(D,L),g.drawImage(U,0,0,D,L),r*=o==="image/png"?.85:.95,Ht(I,o,T.name,T.lastModified,r).then((function(P){try{return S=P,ct(U),U=I,M=S.size,w(Math.min(99,Math.floor((H-M)/(H-d)*100))),f}catch(le){return s(le)}}),s)}return[1]},l=function(){return ct(U),ct(I),ct(x),ct(a),ct(p),w(100),i(S)};if(h=b,u(),k=h.size>d,E=h.size>T.size,!k&&!E)return w(100),i(h);var C;return j=T.size,H=h.size,M=H,U=a,c=!_.alwaysKeepResolution&&k,(C=(function(D){for(;D;){if(D.then)return void D.then(C,s);try{if(D.pop){if(D.length)return D.pop()?l.call(this):D;D=f}else D=D.call(this)}catch(L){return s(L)}}}).bind(this))(f)}}catch(f){return s(f)}}).bind(this),s)}catch(b){return s(b)}}).bind(this),s)}catch(A){return s(A)}}).bind(this),s)}catch(v){return s(v)}}).bind(this),s)}))}const Ks=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let Yt;function Ys(T,_){return new Promise(((z,i)=>{Yt||(Yt=(function(m){const d=[];return d.push(m),URL.createObjectURL(new Blob(d))})(Ks));const s=new Worker(Yt);s.addEventListener("message",(function(m){if(_.signal&&_.signal.aborted)s.terminate();else if(m.data.progress===void 0){if(m.data.error)return i(new Error(m.data.error)),void s.terminate();z(m.data.file),s.terminate()}else _.onProgress(m.data.progress)})),s.addEventListener("error",i),_.signal&&_.signal.addEventListener("abort",(()=>{i(_.signal.reason),s.terminate()})),s.postMessage({file:T,imageCompressionLibUrl:_.libURL,options:{..._,onProgress:void 0,signal:void 0}})}))}function Oe(T,_){return new Promise((function(z,i){let s,t,m,d,p,x;if(s={..._},m=0,{onProgress:d}=s,s.maxSizeMB=s.maxSizeMB||Number.POSITIVE_INFINITY,p=typeof s.useWebWorker!="boolean"||s.useWebWorker,delete s.useWebWorker,s.onProgress=o=>{m=o,typeof d=="function"&&d(m)},!(T instanceof Blob||T instanceof qs))return i(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(T.type))return i(new Error("The file given is not an image"));if(x=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!p||typeof Worker!="function"||x)return ds(T,s).then((function(o){try{return t=o,r.call(this)}catch(h){return i(h)}}).bind(this),i);var n=(function(){try{return r.call(this)}catch(o){return i(o)}}).bind(this),a=function(o){try{return ds(T,s).then((function(h){try{return t=h,n()}catch(k){return i(k)}}),i)}catch(h){return i(h)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Ys(T,s).then((function(o){try{return t=o,n()}catch{return a()}}),a)}catch{a()}function r(){try{t.name=T.name,t.lastModified=T.lastModified}catch{}try{s.preserveExif&&T.type==="image/jpeg"&&(!s.fileType||s.fileType&&s.fileType===T.type)&&(t=fs(T,t))}catch{}return z(t)}}))}Oe.getDataUrlFromFile=xs,Oe.getFilefromDataUrl=Vt,Oe.loadImage=ps,Oe.drawImageInCanvas=ws,Oe.drawFileInCanvas=$t,Oe.canvasToFile=Ht,Oe.getExifOrientation=vs,Oe.handleMaxWidthOrHeight=ys,Oe.followExifOrientation=js,Oe.cleanupCanvasMemory=ct,Oe.isAutoOrientationInBrowser=kt,Oe.approximateBelowMaximumCanvasSizeOfBrowser=bs,Oe.copyExifWithoutOrientation=fs,Oe.getBrowserName=vt,Oe.version="2.0.2";const Ft=8;function Qs(T,_){if(T==="FINISHED")return"FT";if(T==="PAUSED")return"HT";if(T==="IN_PLAY"){if(_==null)return"LIVE";if(_>=1&&_<=45)return"First Half";if(_>45&&_<=50)return"45+";if(_>50)return"Second Half"}return"LIVE"}function us(T){const _=(T||"?").trim().split(/\s+/);return _.length?_.length===1?_[0].slice(0,1).toUpperCase():(_[0][0]+_[_.length-1][0]).toUpperCase():"?"}function Qt(T){return T.result==="H"||T.result==="D"||T.result==="A"?T.result:typeof T.home_goals=="number"&&typeof T.away_goals=="number"?T.home_goals>T.away_goals?"H":T.home_goals<T.away_goals?"A":"D":null}function Mt({letter:T,correct:_,unicorn:z,hasSubmitted:i}){let s;return _===!0?s="bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":i?s="bg-emerald-600 text-white border-emerald-600":s="bg-slate-100 text-slate-600 border-slate-200",e.jsxs("span",{className:["inline-flex items-center justify-center h-5 min-w-[18px] px-1.5","rounded-full border text-[11px] font-semibold mb-0.5","align-middle",s].join(" "),title:z?"Unicorn!":void 0,children:[T,z?e.jsx("span",{className:"ml-1",children:""}):null]})}function Js({chat:T,userId:_,nameById:z,isMember:i,newMsg:s,setNewMsg:t,onSend:m,leagueCode:d,memberCount:p,maxMembers:x,notificationStatus:n}){const a=Q.useRef(null),r=Q.useRef(null),o=Q.useRef(null),h=Q.useRef(null),[k,E]=Q.useState(0),j=()=>{a.current&&(a.current.scrollTop=a.current.scrollHeight)},H=Q.useCallback((I=[0,100,300,500,700])=>{requestAnimationFrame(()=>{I.forEach(g=>{setTimeout(()=>j(),g)})})},[]);Q.useEffect(()=>{T.length>0&&setTimeout(()=>j(),100)},[T.length]),Q.useEffect(()=>{!s&&o.current&&(o.current.style.height="auto",o.current.style.height="42px")},[s]),Q.useEffect(()=>{const I=window.visualViewport;if(!I)return;let g=null,U=0;const c=()=>{g&&(clearTimeout(g),g=null),g=setTimeout(()=>{const N=window.innerHeight,v=I.height,A=I.offsetTop+v,b=N-A;Math.abs(b-U)<10&&b>0||(U=b,b>100?(E(b),setTimeout(()=>{const C=h.current?.offsetHeight||100,f=b+C+20;a.current&&(a.current.style.paddingBottom=`${f}px`,a.current.offsetHeight,H([0,100,300,500,700]))},100)):(E(0),a.current&&(a.current.style.paddingBottom="",a.current.offsetHeight,H([0,50,150,300]))))},50)};I.addEventListener("resize",c),I.addEventListener("scroll",c);const u=()=>{setTimeout(c,100),setTimeout(c,300)},w=setTimeout(()=>{o.current&&o.current.addEventListener("focus",u)},100);return c(),()=>{g&&clearTimeout(g),clearTimeout(w),I.removeEventListener("resize",c),I.removeEventListener("scroll",c),o.current&&o.current.removeEventListener("focus",u)}},[]);const M=()=>{const I=window.visualViewport;I&&setTimeout(()=>{const g=window.innerHeight,U=I.height,c=I.offsetTop+U,u=g-c;u>100&&(E(u),setTimeout(()=>{const w=h.current?.offsetHeight||100,N=u+w+20;a.current&&(a.current.style.paddingBottom=`${N}px`,a.current.offsetHeight,H([0,200,400,600,800]))},100))},100),H([200,400,600])},S=I=>{const g=I.target;!(g.tagName==="A"||g.tagName==="BUTTON"||g.closest("a, button"))&&o.current&&document.activeElement===o.current&&o.current.blur()};return e.jsxs("div",{className:"flex flex-col chat-container",style:{height:"100%"},children:[e.jsxs("div",{ref:a,className:"flex-1 overflow-y-auto px-3 pt-3 pb-4 min-h-0 messages-container",onClick:S,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:k>0?"0":"auto",cursor:"pointer"},children:[T.map(I=>{const g=I.user_id===_,U=z.get(I.user_id)??"Unknown",c=new Date(I.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.jsx("div",{className:`mb-2 flex ${g?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[75%] rounded-lg px-3 py-2 text-sm ${g?"bg-[#1C8376] text-white":"bg-slate-100 text-slate-900"}`,children:[!g&&e.jsx("div",{className:"font-semibold text-xs text-slate-600 mb-1",children:U}),e.jsx("div",{className:"whitespace-pre-wrap break-words",children:I.content}),e.jsx("div",{className:`mt-1 text-[10px] ${g?"text-emerald-100":"text-slate-500"}`,children:c})]})},I.id)}),e.jsx("div",{ref:r,style:{height:"1px",width:"100%"}})]}),e.jsxs("div",{ref:h,className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:k>0?"fixed":"relative",bottom:k>0?`${k}px`:"auto",left:k>0?"0":"auto",right:k>0?"0":"auto",width:k>0?"100%":"auto",zIndex:k>0?1e3:"auto"},children:[i?e.jsxs("form",{onSubmit:I=>{I.preventDefault(),m()},className:"flex items-center gap-2",children:[e.jsx("textarea",{ref:o,value:s,onChange:I=>{t(I.target.value),o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},onFocus:M,onKeyDown:I=>{I.key==="Enter"&&!I.shiftKey&&(I.preventDefault(),s.trim()&&m())},placeholder:"Start typing...",maxLength:2e3,rows:1,className:"flex-1 rounded-xl border border-slate-300 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-transparent resize-none overflow-hidden",style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),e.jsx("button",{type:"submit",className:"flex-shrink-0 w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s.trim(),style:{backgroundColor:s.trim()?"#1C8376":"#94a3b8"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})})]}):e.jsx("div",{className:"rounded-md border border-amber-200 bg-amber-50 text-amber-800 p-3 text-sm",children:"Join this league to chat with other members."}),n&&e.jsx("div",{className:`w-full rounded px-2 py-1 text-xs mt-2 ${n.type==="success"?"bg-green-50 text-green-700 border border-green-200":n.type==="warning"?"bg-amber-50 text-amber-700 border border-amber-200":"bg-red-50 text-red-700 border border-red-200"}`,children:n.message})]})]})}function er(){const{code:T=""}=Ds(),{user:_}=Ps(),[z]=Q.useState(()=>{const y=localStorage.getItem("oldSchoolMode");return y?JSON.parse(y):!1});Q.useEffect(()=>{localStorage.setItem("oldSchoolMode",JSON.stringify(z))},[z]),Q.useEffect(()=>{const y=K=>{const G=K.target;(G.tagName==="INPUT"||G.tagName==="TEXTAREA")&&setTimeout(()=>{window.scrollTo(0,0);const Z=document.querySelector(".league-header-fixed");Z&&(Z.style.top="0")},100)},O=()=>{const K=document.querySelector(".league-header-fixed");K&&(K.style.top="0")};return document.addEventListener("focusin",y),window.addEventListener("resize",O),window.addEventListener("orientationchange",O),()=>{document.removeEventListener("focusin",y),window.removeEventListener("resize",O),window.removeEventListener("orientationchange",O)}},[]);const[i,s]=Q.useState(null),[t,m]=Q.useState([]),[d,p]=Q.useState(!0),[x,n]=Q.useState("chat"),[a,r]=Q.useState(!1),o=Q.useRef(!1),[h,k]=Q.useState(!1),[E,j]=Q.useState(!1),[H,M]=Q.useState(!1),[S,I]=Q.useState(null),[g,U]=Q.useState(null),[c,u]=Q.useState(null),[w,N]=Q.useState([]),[v,A]=Q.useState({}),b=Q.useRef(new Map),[C,f]=Q.useState(new Set),[l,D]=Q.useState(!1),[L,P]=Q.useState(!1),[le,q]=Q.useState(!1),[re,B]=Q.useState(!1),[F,fe]=Q.useState(!1),[je,be]=Q.useState(!1),[pe,we]=Q.useState(null),[Te,Ce]=Q.useState(!1),[dt,qe]=Q.useState(!1),[Le,Fe]=Q.useState(!1),[Ne,ke]=Q.useState(!1),[Me,Ee]=Q.useState(!1),[Ie,He]=Q.useState(!1),[Ue,ye]=Q.useState(!1),[We,Ve]=Q.useState(null),[ft,De]=Q.useState(!1),[Ze,Pe]=Q.useState(!1),[Re,Ke]=Q.useState(null),[Xe,Be]=Q.useState([]),[et,xt]=Q.useState(""),[zt,Ge]=Q.useState(null),Et=Q.useMemo(()=>!!_?.id&&t.some(y=>y.id===_.id),[_?.id,t]),pt=Q.useMemo(()=>{const y=new Map;return t.forEach(O=>y.set(O.id,O.name)),y},[t]),[_t,at]=Q.useState(new Map);Q.useEffect(()=>{(async()=>{const y=new Map,{data:O}=await ge.from("fixtures").select("gw, kickoff_time").order("gw",{ascending:!0}),{data:K}=await ge.from("test_api_fixtures").select("test_gw, kickoff_time").eq("test_gw",1).order("fixture_index",{ascending:!0}),G=new Map;if(O&&O.forEach(Z=>{(!G.has(Z.gw)||Z.kickoff_time&&new Date(Z.kickoff_time)<new Date(G.get(Z.gw)))&&Z.kickoff_time&&G.set(Z.gw,Z.kickoff_time)}),K&&K.length>0){const Z=K.find(Y=>Y.kickoff_time)?.kickoff_time;if(Z){const Y=G.get(1);(!Y||new Date(Z)<new Date(Y))&&G.set(1,Z)}}G.forEach((Z,Y)=>{const $=new Date(Z),ne=new Date($.getTime()-4500*1e3);y.set(Y,ne)}),at(y)})()},[]),Q.useEffect(()=>{const y=O=>{const K=O.target;l&&!K.closest(".gw-dropdown-container")&&D(!1)};return l&&document.addEventListener("click",y),()=>document.removeEventListener("click",y)},[l]),Q.useEffect(()=>{let y=!0;return(async()=>{const{data:O}=await ge.from("meta").select("current_gw").eq("id",1).maybeSingle();if(!y)return;I(O?.current_gw??null);const{data:K}=await ge.from("gw_results").select("gw").order("gw",{ascending:!1}).limit(1);if(!y)return;U(K&&K.length?K[0].gw:null);const{data:G}=await ge.from("gw_results").select("gw").order("gw",{ascending:!1});if(!y)return;const Z=G?[...new Set(G.map(Y=>Y.gw))].sort((Y,$)=>$-Y):[];N(Z),Z.length>0&&u(Z[0])})(),()=>{y=!1}},[]);const $e=Q.useMemo(()=>t.map(y=>y.id),[t]),[ve,mt]=Q.useState([]),[ht,tt]=Q.useState([]),[st,Ot]=Q.useState([]),[Zt,Bt]=Q.useState([]),[Gt,At]=Q.useState([]),[Xt,St]=Q.useState(!1);Q.useEffect(()=>{let y=!0;return(async()=>{p(!0);const{data:O}=await ge.from("leagues").select("id,name,code,created_at").eq("code",T).maybeSingle();if(!y)return;if(!O){s(null),m([]),p(!1);return}s(O);const{data:K}=await ge.from("league_members").select("users(id,name),created_at").eq("league_id",O.id).order("created_at",{ascending:!0}),G=K?.map($=>({id:$.users.id,name:$.users.name??"(no name)"}))??[],Z=[...G].sort(($,ne)=>$.name.localeCompare(ne.name));m(Z);const Y=G[0];Ke(Y),_?.id&&!G.some($=>$.id===_.id)&&Fe(!0),p(!1)})(),()=>{y=!1}},[T]),Q.useEffect(()=>{},[i,x]);const es=Q.useCallback(async(y,O=!1)=>{const{data:K,error:G}=await ge.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",y).order("created_at",{ascending:!1}).limit(500);if(!G&&K){const Y=(K??[]).reverse();O&&console.log("[Chat] Loaded messages:",Y.length,"from database (most recent)"),Be($=>{const ne=new Set($.map(ie=>ie.id)),ue=Y.filter(ie=>!ne.has(ie.id));if($.length===0)return O&&console.log("[Chat] Initial load, setting",Y.length,"messages"),Y;const ee=[...$,...ue].sort((ie,xe)=>new Date(ie.created_at).getTime()-new Date(xe.created_at).getTime()),te=ee.length>500?ee.slice(-500):ee;return O&&console.log("[Chat] Merged messages. Previous:",$.length,"New from DB:",ue.length,"Total:",ee.length,"After limit:",te.length),te})}else G&&console.error("[Chat] Error loading messages:",G)},[]);Q.useEffect(()=>{if(!i?.id)return;let y=!0;const O=async()=>{y&&await es(i.id,!0)};O();const K=ge.channel(`league-messages:${i.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${i.id}`},Y=>{const $=Y.new;console.log("[Chat] Realtime message received:",$.id,$.content.substring(0,50)),Be(ne=>{if(ne.some(W=>W.id===$.id))return console.log("[Chat] Message already exists, skipping"),ne;const ue=[...ne,$];return console.log("[Chat] Added realtime message. Total messages:",ue.length),ue})}).subscribe(),G=()=>{!document.hidden&&i?.id&&y&&(console.log("[Chat] App became visible, refetching messages..."),O())},Z=()=>{i?.id&&y&&(console.log("[Chat] Window gained focus, refetching messages..."),O())};return document.addEventListener("visibilitychange",G),window.addEventListener("focus",Z),()=>{y=!1,ge.removeChannel(K),document.removeEventListener("visibilitychange",G),window.removeEventListener("focus",Z)}},[i?.id]),Q.useEffect(()=>{if(x!=="chat"||!i?.id||!_?.id)return;es(i.id,!1),(async()=>{await ge.from("league_message_reads").upsert({league_id:i.id,user_id:_.id,last_read_at:new Date().toISOString()},{onConflict:"league_id,user_id"})})()},[x,i?.id,_?.id]);const Ns=async y=>{if(!i||!_?.id||!Ct){we("Only admins can upload avatars");return}be(!0),we(null),Ce(!1);try{const{data:{session:O},error:K}=await ge.auth.getSession();if(K||!O)throw console.error("[Avatar Upload] No Supabase session:",K),new Error("You must be logged in to upload avatars. Please refresh the page and try again.");const G="https://gyjagrtwrhctmgkootjj.supabase.co",Z=G?.match(/https:\/\/([^.]+)\.supabase\.co/)?.[1];if(console.log("[Avatar Upload] Supabase project:",{url:G,projectRef:Z,userId:O.user.id}),!["image/png","image/jpeg","image/jpg","image/webp"].includes(y.type))throw new Error("Invalid file type. Please upload PNG, JPG, or WebP images.");const $=2*1024*1024;if(y.size>$)throw new Error("File size too large. Please upload an image smaller than 2MB.");let ne=y;const ue=60,W=80*1024;console.log(`[Avatar Upload] Starting compression. Original size: ${(y.size/1024).toFixed(1)}KB`);const te=document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0?"image/webp":"image/jpeg",ie=[{maxWidthOrHeight:256,initialQuality:.85,format:te},{maxWidthOrHeight:256,initialQuality:.75,format:te},{maxWidthOrHeight:256,initialQuality:.65,format:"image/jpeg"},{maxWidthOrHeight:200,initialQuality:.6,format:"image/jpeg"},{maxWidthOrHeight:200,initialQuality:.5,format:"image/jpeg"}];let xe=!1;for(let ae=0;ae<ie.length;ae++){const he=ie[ae];try{const _e={maxSizeMB:ue/1024,maxWidthOrHeight:he.maxWidthOrHeight,useWebWorker:!0,fileType:he.format,initialQuality:he.initialQuality};ne=await Oe(y,_e);const oe=ne.size/1024;if(console.log(`[Avatar Upload] Attempt ${ae+1}: ${oe.toFixed(1)}KB (target: ${ue}KB, format: ${he.format})`),ne.size<=W){xe=!0,console.log(`[Avatar Upload] Compression successful: ${oe.toFixed(1)}KB`);break}}catch(_e){console.warn(`[Avatar Upload] Compression attempt ${ae+1} failed:`,_e.message)}}if(!xe||ne.size>W){const ae=(ne.size/1024).toFixed(1);if(ne.size<=100*1024)console.warn(`[Avatar Upload] Image slightly over target (${ae}KB) but acceptable`),xe=!0;else throw new Error(`Image is too large (${ae}KB). Please use a smaller or simpler image. Recommended: images under 2MB before upload, with less detail or fewer colors.`)}let R="jpg";ne.type.includes("webp")?R="webp":ne.type.includes("png")&&(R="png");const J=`${i.id}.${R}`,{data:se,error:X}=await ge.storage.listBuckets();if(X)console.warn("[Avatar Upload] Could not list buckets (this is OK if you lack list permissions):",X);else{const ae=se?.some(he=>{const _e=he.id==="league-avatars",oe=he.name==="league-avatars";return(_e||oe)&&console.log("[Avatar Upload] Found bucket:",{id:he.id,name:he.name}),_e||oe});console.log("[Avatar Upload] Available buckets:",se?.map(he=>({id:he.id,name:he.name}))),se&&se.length>0&&!ae&&console.warn(`[Avatar Upload] Bucket 'league-avatars' not in list. Available: ${se.map(he=>he.id||he.name).join(", ")}`)}console.log("[Avatar Upload] Attempting upload to bucket: league-avatars");const{error:ce,data:V}=await ge.storage.from("league-avatars").upload(J,ne,{upsert:!0,contentType:ne.type});if(ce)throw console.error("[Avatar Upload] Upload error details:",{message:ce.message,error:ce}),new Error(`Upload failed: ${ce.message}`);console.log("[Avatar Upload] Upload successful:",V);const{data:me}=ge.storage.from("league-avatars").getPublicUrl(J);if(!me?.publicUrl)throw new Error("Failed to get public URL for uploaded avatar");const{error:de}=await ge.from("leagues").update({avatar:me.publicUrl}).eq("id",i.id);if(de)throw new Error(`Failed to update league: ${de.message}`);const{data:Ae}=await ge.from("leagues").select("*").eq("id",i.id).single();Ae&&s(Ae),Ce(!0),setTimeout(()=>{fe(!1),Ce(!1)},2e3)}catch(O){console.error("Avatar upload error:",O),we(O.message||"Failed to upload avatar. Please try again.")}finally{be(!1)}},ks=async()=>{if(!(!i||!_?.id||!Ct)){be(!0),we(null);try{const{error:y}=await ge.from("leagues").update({avatar:null}).eq("id",i.id);if(y)throw new Error(`Failed to remove avatar: ${y.message}`);const{data:O}=await ge.from("leagues").select("*").eq("id",i.id).single();O&&s(O),fe(!1)}catch(y){console.error("Remove avatar error:",y),we(y.message||"Failed to remove avatar. Please try again.")}finally{be(!1)}}};async function _s(){if(!(!i||!_?.id)){M(!0);try{const{error:y}=await ge.from("league_members").delete().eq("league_id",i.id).eq("user_id",_.id);if(y)throw y;window.location.href="/leagues"}catch(y){console.error("Error leaving league:",y),alert("Failed to leave league. Please try again.")}finally{M(!1),j(!1)}}}async function As(){if(!(!i||!_?.id)){ke(!0);try{if(t.length>=Ft){alert("League is full (max 8 members)."),Fe(!1);return}const{error:y}=await ge.from("league_members").insert({league_id:i.id,user_id:_.id});if(y)throw y;window.location.reload()}catch(y){alert(y?.message??"Failed to join league.")}finally{ke(!1)}}}const Ct=Q.useMemo(()=>i?.created_by===_?.id||Re&&Re.id===_?.id&&!i?.created_by,[i?.created_by,_?.id,Re]),Ss=Q.useMemo(()=>i?.created_by?t.find(y=>y.id===i.created_by)?.name||"Unknown":Re?Re.name:"Unknown",[i?.created_by,t,Re]);async function Cs(){if(!(!We||!i||!_?.id)){De(!0);try{const{error:y}=await ge.from("league_members").delete().eq("league_id",i.id).eq("user_id",We.id);if(y)throw y;window.location.reload()}catch(y){alert(y?.message??"Failed to remove member.")}finally{De(!1),He(!1),Ve(null)}}}async function Ls(){if(!(!i||!_?.id)){Pe(!0);try{const{error:y}=await ge.from("league_members").delete().eq("league_id",i.id);if(y)throw y;const{error:O}=await ge.from("leagues").delete().eq("id",i.id);if(O)throw O;window.location.href="/leagues"}catch(y){alert(y?.message??"Failed to end league.")}finally{Pe(!1),ye(!1)}}}function ts(){if(!i)return;const y=`Join my mini league "${i.name}" on TotL!`,O=`${window.location.origin}/league/${i.code}`;navigator.share?navigator.share({title:`Join ${i.name}`,text:y,url:O}).catch(console.error):navigator.clipboard.writeText(`${y}

${O}`).then(()=>{alert("League link copied to clipboard!")}).catch(()=>{prompt("Share this league code:",i.code)})}const Ts=Q.useCallback(async()=>{if(!i||!_?.id)return;const y=et.trim();if(!y)return;xt("");const{data:O,error:K}=await ge.from("league_messages").insert({league_id:i.id,user_id:_.id,content:y}).select("id, league_id, user_id, content, created_at").single();K?(console.error(K),alert("Failed to send message.")):O&&Be(Z=>[...Z,O]),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||setTimeout(async()=>{try{const Z=_.user_metadata?.display_name||_.email||"User",Y=await fetch("/.netlify/functions/notifyLeagueMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:i.id,senderId:_.id,senderName:Z,content:y})}),$=await Y.json().catch(()=>({}));$.ok===!0?$.sent&&$.sent>0?Ge({message:` Message sent to ${$.sent} device${$.sent===1?"":"s"}`,type:"success"}):$.message==="No subscribed devices"?Ge({message:` No subscribed devices (${$.eligibleRecipients||0} eligible recipient${$.eligibleRecipients===1?"":"s"})`,type:"warning"}):$.message==="No devices"?Ge({message:` No devices registered (${$.eligibleRecipients||0} eligible recipient${$.eligibleRecipients===1?"":"s"})`,type:"warning"}):$.message==="No eligible recipients"?Ge({message:" All members are currently active",type:"success"}):Ge({message:` ${$.message||"Notification sent"}`,type:"success"}):$.ok===!1||$.error?Ge({message:` Failed to send notification: ${$.error||"Unknown error"}`,type:"error"}):Y.ok||Ge({message:` Notification error (HTTP ${Y.status})`,type:"error"}),setTimeout(()=>Ge(null),5e3)}catch(Z){console.error("[Chat] Notification exception:",Z),Ge({message:" Failed to send notification",type:"error"}),setTimeout(()=>Ge(null),5e3)}},100)},[i,_,et,xt,Be,Ge]);Q.useEffect(()=>{let y=!0;return(async()=>{const O=i?.name==="API Test",K=O&&(x==="gw"||x==="gwr");console.log("[League] Data fetch:",{isApiTestLeague:O,tab:x,useTestFixtures:K,leagueName:i?.name,willUseTestTables:K,willUseMainTables:!K});let G=x==="gwr"?c:S;if(O&&(x==="gw"||x==="gwr")&&(G=1),x==="gw"&&!O&&$e.length>0){const{data:ue}=await ge.from("gw_submissions").select("gw").in("user_id",$e).not("submitted_at","is",null).order("gw",{ascending:!1}).limit(10);if(ue&&ue.length>0){const W=[...new Set(ue.map(ee=>ee.gw))].sort((ee,te)=>(te||0)-(ee||0));for(const ee of W)if(ee){const{data:te}=await ge.from("fixtures").select("gw").eq("gw",ee).limit(1);if(te&&te.length>0){console.log("[League] Found fixtures for GW",ee,"from submissions - using this GW (currentGw was",G,")"),G=ee;break}}}!G&&S&&(G=S,console.log("[League] Using currentGw as fallback:",S))}if(console.log("[League] gwForData:",G,"memberIds:",$e),!G&&!K){mt([]),tt([]),Ot([]),Bt([]);return}let Z;if(K){const{data:ue}=await ge.from("test_api_fixtures").select("id,test_gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,kickoff_time,api_match_id").eq("test_gw",1).order("fixture_index",{ascending:!0});Z=ue?.map(W=>({...W,gw:W.test_gw}))||null}else{console.log("[League] Fetching from MAIN database table (fixtures) for regular league, GW:",G);const{data:ue}=await ge.from("fixtures").select("id,gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,kickoff_time").eq("gw",G).order("fixture_index",{ascending:!0});Z=ue?.map(W=>({...W,api_match_id:null}))||null,console.log("[League] Fetched fixtures from main database:",ue?.length||0,"fixtures")}if(!y)return;if(mt(Z??[]),!$e.length){tt([]),Ot([]),Bt([]);return}let Y=null,$;if(K){const{data:ue}=await ge.from("test_api_picks").select("user_id,matchday,fixture_index,pick").eq("matchday",1).in("user_id",$e);Y=ue?.map(R=>({...R,gw:R.matchday}))||null;const{data:W,error:ee}=await ge.from("test_api_submissions").select("user_id,matchday,submitted_at").eq("matchday",1).not("submitted_at","is",null).in("user_id",$e);ee&&console.error("Error fetching test_api_submissions:",ee);const{data:te}=await ge.from("test_api_fixtures").select("fixture_index,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",1).order("fixture_index",{ascending:!0}),ie=new Set((te||[]).map(R=>R.fixture_index));console.log("[League] Current fixture indices from test_api_fixtures:",Array.from(ie)),console.log("[League] Current fixtures:",te?.map(R=>({index:R.fixture_index,home:R.home_team,away:R.away_team})));const xe=[];if(W&&Y&&te){const R=ie.size;console.log("[League] Required fixture count for valid submission:",R);const J=(te||[]).map(ce=>ce.kickoff_time?new Date(ce.kickoff_time):null).filter(ce=>ce!==null&&!isNaN(ce.getTime())),se=J.length>0?new Date(Math.min(...J.map(ce=>ce.getTime()))):null,X=new Date("2025-11-18T00:00:00Z");console.log("[League] Submission cutoff date (submissions before this are old):",X.toISOString()),console.log("[League] Earliest kickoff:",se?.toISOString()),W.forEach(ce=>{const V=(Y||[]).filter(oe=>oe.user_id===ce.user_id&&oe.matchday===1),me=V.filter(oe=>ie.has(oe.fixture_index)),de=me.length===R&&R>0,Ae=new Set(me.map(oe=>oe.fixture_index)),ae=Ae.size===R,he=ce.submitted_at?new Date(ce.submitted_at):null,_e=he&&he>=X;if(de&&ae&&_e)xe.push(ce),console.log("[League]  VALID submission (has picks for ALL current fixtures AND recent submission):",{user_id:ce.user_id,submitted_at:ce.submitted_at,submissionDate:he?.toISOString(),cutoffDate:X.toISOString(),picksCount:V.length,picksForCurrentFixtures:me.length,uniqueIndices:Ae.size,requiredCount:R});else{const oe=[];de||oe.push("missing picks"),ae||oe.push("duplicate/extra picks"),_e||oe.push(`old submission (${he?.toISOString()} < ${X.toISOString()})`),console.log("[League]  INVALID submission:",{user_id:ce.user_id,submitted_at:ce.submitted_at,submissionDate:he?.toISOString(),cutoffDate:X.toISOString(),picksCount:V.length,picksForCurrentFixtures:me.length,uniqueIndices:Ae.size,requiredCount:R,hasAllRequired:de,hasExactMatch:ae,isRecent:_e,reason:oe.join(", ")})}})}$=xe.map(R=>({...R,gw:R.matchday}))||null,console.log("[League] Test API submissions fetched (filtered to only current fixtures):",$),console.log("[League] Valid submissions count:",xe.length,"out of",W?.length||0,"total")}else{console.log("[League] Fetching from MAIN database tables (picks, gw_submissions) for regular league");const{data:ue}=await ge.from("picks").select("user_id,gw,fixture_index,pick").eq("gw",G).in("user_id",$e);Y=ue,console.log("[League] Fetched picks from main database:",ue?.length||0,"picks");const{data:W}=await ge.from("gw_submissions").select("user_id,gw,submitted_at").eq("gw",G).in("user_id",$e);$=W,console.log("[League] Fetched submissions from main database:",W?.length||0,"submissions")}if(!y)return;tt(Y??[]),Ot($??[]);const{data:ne}=await ge.from("gw_results").select("gw,fixture_index,result").eq("gw",K?1:G||0);y&&Bt(ne??[])})(),()=>{y=!1}},[x,S,g,c,$e]);const ss=async(y,O)=>{try{console.log("[League] fetchLiveScore called for matchId:",y,"kickoffTime:",O);const{data:K,error:G}=await ge.from("live_scores").select("*").eq("api_match_id",y).single();if(G)return G.code==="PGRST116"?(console.log("[League] No live score found in Supabase for match",y,"- scheduled function may not have run yet"),null):(console.error("[League] Error fetching live score from Supabase:",G),null);if(!K)return console.warn("[League] No live score data in Supabase"),null;console.log("[League] Live score from Supabase:",K);const Z=K.home_score??0,Y=K.away_score??0,$=K.status||"SCHEDULED";let ne=K.minute;if(ne==null&&($==="IN_PLAY"||$==="PAUSED")&&O)try{const W=new Date(O),te=Math.floor((new Date().getTime()-W.getTime())/(1e3*60));te>0&&te<120&&($==="PAUSED"?ne=null:$==="IN_PLAY"&&(te<=50?ne=te:ne=46+Math.max(0,te-50)))}catch(W){console.warn("[League] Error calculating minute from kickoff time:",W)}const ue={homeScore:Z,awayScore:Y,status:$,minute:ne,retryAfter:null};return console.log("[League] Returning score data from Supabase:",ue),ue}catch(K){return console.error("[League] Error fetching live score from Supabase:",K?.message||K,K?.stack),null}};Q.useEffect(()=>{if(!ve.length||x!=="gwr")return;const y=ve.filter(K=>K.api_match_id);if(y.length===0)return;(async()=>{console.log("[League] Loading existing live scores from Supabase for",y.length,"fixtures");const K=y.map(async Z=>{const Y=await ss(Z.api_match_id,Z.kickoff_time);return Y?{fixtureIndex:Z.fixture_index,scoreData:Y}:null}),G=await Promise.all(K);A(Z=>{const Y={...Z};return G.forEach($=>{$&&(Y[$.fixtureIndex]={homeScore:$.scoreData.homeScore,awayScore:$.scoreData.awayScore,status:$.scoreData.status,minute:$.scoreData.minute??null})}),Y}),console.log("[League] Loaded",G.filter(Z=>Z!==null).length,"existing live scores")})()},[ve.map(y=>`${y.fixture_index}-${y.api_match_id}`).join(","),x]),Q.useEffect(()=>{if(!ve.length||x!=="gwr")return;const y=ve.slice(0,3).filter(Y=>Y.api_match_id&&Y.kickoff_time);if(y.length===0)return;const O=new Map,K=Y=>{const $=Y.fixture_index;if(O.has($))return;const ne=async()=>{const W=await ss(Y.api_match_id,Y.kickoff_time);if(!W)return;const ee=W.status==="FINISHED";if(A(te=>({...te,[$]:{homeScore:W.homeScore,awayScore:W.awayScore,status:W.status,minute:W.minute??null}})),ee){const te=O.get($);te&&(clearInterval(te),O.delete($))}};ne();const ue=setInterval(ne,10*1e3);O.set($,ue)},G=()=>{const Y=new Date;y.forEach($=>{if(!$.api_match_id||!$.kickoff_time)return;const ne=$.fixture_index,W=new Date($.kickoff_time).getTime()<=Y.getTime(),ee=O.has(ne),ie=v[ne]?.status==="FINISHED";if(ie&&ee){console.log(`[League] Stopping polling for fixture ${ne} (finished)`);const xe=O.get(ne);xe&&(clearInterval(xe),O.delete(ne));return}W&&!ie&&!ee&&K($)})};G();const Z=setInterval(G,6e4);return()=>{O.forEach(clearInterval),clearInterval(Z)}},[i?.name,ve.map(y=>y.api_match_id).join(","),x,v]),Q.useEffect(()=>{if(a||o.current||!ve.length||x!=="chat")return;const O=i?.name==="API Test"?!0:c===S||c===null;if(!O){r(!0);return}const K=new Date,G=ve[0],Z=G?.kickoff_time?new Date(G.kickoff_time):null,Y=Z&&Z<=K,$=ve[ve.length-1],ne=$?.kickoff_time?new Date($.kickoff_time):null,ue=$?.fixture_index,W=ue!==void 0?v[ue]:null,ee=W?.status==="FINISHED";let te=!1;if(ee&&ne){const xe=new Date(ne.getTime()+72e5),R=(K.getTime()-xe.getTime())/(1e3*60*60);te=R<=12&&R>=0}const ie=Object.values(v).some(xe=>xe.status==="IN_PLAY"||xe.status==="PAUSED");(Y||te||ie)&&(console.log("[League] Setting default tab to GW Results:",{firstGameStarted:Y,lastGameFinishedWithin12Hours:te,hasLiveGame:ie,lastFixtureScore:W?.status,viewingCurrentGw:O}),n("gwr")),r(!0)},[ve,v,a,S,c,i?.name]);const ze=Q.useMemo(()=>{const y=new Map;return console.log("[League] Building submittedMap from subs:",st),st.forEach(O=>{if(O.submitted_at){const K=`${O.user_id}:${O.gw}`;console.log(`[League] Adding submission key: ${K}`,O),y.set(K,!0)}else console.log("[League] Skipping submission with null submitted_at:",O)}),console.log("[League] Final submittedMap:",Array.from(y.entries())),y},[st]),It=Q.useCallback(y=>y.map(O=>({user_id:O.id,name:O.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]})),[]);Q.useEffect(()=>{let y=!0;return(async()=>{if(!t.length){At([]);return}if(i?.name==="API Test"){At(It(t)),St(!1);return}if(S===null)return;St(!0);const{data:O}=await ge.from("gw_results").select("gw,fixture_index,result"),K=O??[],G=new Map;if(K.forEach(V=>{const me=Qt(V);me&&G.set(`${V.gw}:${V.fixture_index}`,me)}),G.size===0){At(It(t)),St(!1);return}const Z=[...new Set(Array.from(G.keys()).map(V=>parseInt(V.split(":")[0],10)))].sort((V,me)=>V-me),Y=["Prem Predictions","FC Football","Easy League"],$=["The Bird league"],ne=await Rs(i,S),ue=Z.filter(V=>V>=ne);if(!Y.includes(i?.name||"")&&!$.includes(i?.name||"")&&ue.length===0){At(It(t)),St(!1);return}const{data:W}=await ge.from("picks").select("user_id,gw,fixture_index,pick").in("user_id",t.map(V=>V.id)).in("gw",ue),ee=W??[],te=new Map;ue.forEach(V=>{const me=new Map;t.forEach(de=>me.set(de.id,{user_id:de.id,score:0,unicorns:0})),te.set(V,me)}),ue.forEach(V=>{Array.from(G.entries()).filter(([de])=>parseInt(de.split(":")[0],10)===V).map(([de,Ae])=>({idx:parseInt(de.split(":")[1],10),out:Ae})).forEach(({idx:de,out:Ae})=>{const ae=ee.filter(oe=>oe.gw===V&&oe.fixture_index===de),he=ae.filter(oe=>oe.pick===Ae).map(oe=>oe.user_id),_e=te.get(V);if(ae.forEach(oe=>{if(oe.pick===Ae){const yt=_e.get(oe.user_id);yt.score+=1}}),he.length===1&&t.length>=3){const oe=he[0],yt=_e.get(oe);yt.unicorns+=1}})});const ie=new Map,xe=new Map,R=new Map,J=new Map,se=new Map,X=new Map;t.forEach(V=>{ie.set(V.id,0),xe.set(V.id,0),R.set(V.id,0),J.set(V.id,0),se.set(V.id,0),X.set(V.id,[])}),ue.forEach(V=>{const me=Array.from(te.get(V).values());if(me.forEach(ae=>{xe.set(ae.user_id,(xe.get(ae.user_id)??0)+ae.score),R.set(ae.user_id,(R.get(ae.user_id)??0)+ae.unicorns)}),me.sort((ae,he)=>he.score-ae.score||he.unicorns-ae.unicorns),!me.length)return;const de=me[0],Ae=me.filter(ae=>ae.score===de.score&&ae.unicorns===de.unicorns);Ae.length===1?(ie.set(de.user_id,(ie.get(de.user_id)??0)+3),J.set(de.user_id,(J.get(de.user_id)??0)+1),X.get(de.user_id).push("W"),me.slice(1).forEach(ae=>X.get(ae.user_id).push("L"))):(Ae.forEach(ae=>{ie.set(ae.user_id,(ie.get(ae.user_id)??0)+1),se.set(ae.user_id,(se.get(ae.user_id)??0)+1),X.get(ae.user_id).push("D")}),me.filter(ae=>!Ae.find(he=>he.user_id===ae.user_id)).forEach(ae=>X.get(ae.user_id).push("L")))});const ce=t.map(V=>({user_id:V.id,name:V.name,mltPts:ie.get(V.id)??0,ocp:xe.get(V.id)??0,unicorns:R.get(V.id)??0,wins:J.get(V.id)??0,draws:se.get(V.id)??0,form:X.get(V.id)??[]}));ce.sort((V,me)=>me.mltPts-V.mltPts||me.unicorns-V.unicorns||me.ocp-V.ocp||V.name.localeCompare(me.name)),y&&(At(ce),St(!1))})(),()=>{y=!1}},[t,i,S,It]);function Es(){const y=$=>{const ne=$.slice(-5),ue=5-ne.length;return e.jsxs("div",{className:"flex items-center justify-between w-full",children:[Array.from({length:ue}).map((W,ee)=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-200"},`dot-${ee}`)),ne.map((W,ee)=>e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold ${W==="W"?"bg-green-100 text-green-700":W==="D"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:W},ee))]})},O=["Prem Predictions","FC Football","Easy League"],K=["The Bird league"],G=["gregVjofVcarl","Let Down"],Z=i&&!O.includes(i.name)&&!K.includes(i.name)&&!G.includes(i.name),Y=Gt.length?Gt:t.map($=>({user_id:$.id,name:$.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]}));return t.length===1?e.jsxs("div",{className:"text-center p-8 bg-white rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Invite at least one more user to make the ML start"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Share your league code with friends to get the competition going!"}),e.jsx("button",{onClick:()=>qe(!0),className:"px-4 py-2 bg-[#1C8376] text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors",children:"Share League Code"})]}):e.jsxs("div",{className:"pt-4",children:[e.jsx("style",{children:`
          .mlt-table tbody tr:last-child {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table tbody tr:last-child td {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table tbody tr:last-child th {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table {
            border-bottom: none !important;
          }
          .mlt-table tbody {
            border-bottom: none !important;
          }
          .mlt-table-container {
            border-bottom: none !important;
          }
          .mlt-table-container table {
            border-bottom: none !important;
          }
          .mlt-table-container tbody {
            border-bottom: none !important;
          }
          .mlt-table-container tbody tr:last-child {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table-container tbody tr:last-child td {
            border-bottom: none !important;
            border: none !important;
          }
        `}),e.jsx("div",{className:"mlt-table-container overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x bg-slate-50",style:{backgroundColor:"#f8fafc",borderBottom:"none",boxShadow:"none"},children:e.jsxs("table",{className:"mlt-table w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc",border:"none",borderBottom:"none"},children:[e.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[e.jsx("th",{className:"py-3 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),e.jsx("th",{className:"py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:"Player"}),h?e.jsx("th",{className:"px-4 py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8"},children:"Form"}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"W"}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"D"}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:Z?"CP":"OCP"}),t.length>=3&&e.jsx("th",{className:"py-3 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"PTS"})]})]})}),e.jsxs("tbody",{children:[Y.map(($,ne)=>{const ue=$.user_id===_?.id,W=ne===Y.length-1;return e.jsxs("tr",{className:ue?"flash-user-row":"",style:{position:"relative",backgroundColor:"#f8fafc",...W?{}:{borderBottom:"1px solid #e2e8f0"}},children:[e.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:ne+1}),e.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:$.name}),h?e.jsx("td",{className:"px-4 py-4",style:{backgroundColor:"#f8fafc"},children:y($.form)}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:$.wins}),e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:$.draws}),e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:$.ocp}),t.length>=3&&e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:$.unicorns}),e.jsx("td",{className:"py-4 text-center tabular-nums font-bold",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:$.mltPts})]})]},$.user_id)}),Xt&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:h?3:t.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"Calculating"})}),!Xt&&!Gt.length&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:h?3:t.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"No gameweeks completed yet  this will populate after the first results are saved."})})]})]})}),e.jsx("div",{className:"mt-6 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-0.5 shadow-sm border border-slate-200",children:[e.jsx("button",{onClick:()=>k(!1),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${h?"text-slate-600 hover:text-slate-900 hover:bg-white/50":"bg-[#1C8376] text-white shadow-sm"}`,children:"Points"}),e.jsx("button",{onClick:()=>k(!0),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${h?"bg-[#1C8376] text-white shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:"Form"})]}),e.jsxs("button",{onClick:()=>{console.log("Button clicked, setting modal to true"),q(!0)},className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[e.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),e.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),i?.name==="API Test"&&e.jsx("div",{className:"mt-4",style:{marginLeft:"-1rem",marginRight:"-1rem",width:"calc(100% + 2rem)",paddingLeft:0,paddingRight:0},children:e.jsx("video",{src:"/assets/Animation/Unicorn_Small.mov",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"auto",display:"block",padding:0,margin:0}})})]})}function Is(){const y=i?.name==="API Test"?1:S;if(!y)return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No current game week available."});if(!cs(i,y,_t))return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Predictions Available"}),e.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),e.jsxs("div",{className:"text-sm",children:["GW",y," predictions are not included in this league."]})]})});const O=new Map;Zt.forEach(R=>{if(R.gw!==y)return;const J=Qt(R);J&&O.set(R.fixture_index,J)});const K=Q.useMemo(()=>{const R=X=>{if(!X)return"Fixtures";const ce=new Date(X);return isNaN(ce.getTime())?"Fixtures":ce.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})},J=new Map;ve.filter(X=>X.gw===y).forEach(X=>{const ce=R(X.kickoff_time),V=X.kickoff_time?new Date(X.kickoff_time).getTime():Number.MAX_SAFE_INTEGER;J.has(ce)||J.set(ce,{label:ce,key:V,items:[]}),J.get(ce).items.push(X)});const se=Array.from(J.values());return se.forEach(X=>X.items.sort((ce,V)=>ce.fixture_index-V.fixture_index)),se.sort((X,ce)=>X.key-ce.key),se},[ve,y]),G=new Set(ve.filter(R=>R.gw===y).map(R=>R.fixture_index)),Z=i?.name==="API Test",Y=t.length>0&&t.every(R=>ze.get(`${R.id}:${y}`));if(Z&&y===1){console.log("[League] API Test filtering:",{currentFixtureIndices:Array.from(G),totalPicks:ht.length,picksForGw:ht.filter(J=>J.gw===y).length,submittedMapSize:ze.size,allSubmitted:Y,members:t.map(J=>({id:J.id,name:J.name,submitted:ze.get(`${J.id}:${y}`)})),fixturesCount:ve.filter(J=>J.gw===y).length});const R=ht.filter(J=>J.gw===y);console.log("[League] All picks for GW1:",R.map(J=>({user_id:J.user_id,userName:t.find(se=>se.id===J.user_id)?.name,fixture_index:J.fixture_index,pick:J.pick,hasSubmitted:!!ze.get(`${J.user_id}:${y}`),inCurrentFixtures:G.has(J.fixture_index)})))}const $=new Map;!Z||Y?ht.forEach(R=>{if(R.gw!==y)return;if(Z&&!ze.get(`${R.user_id}:${y}`)){y===1&&console.log("[League] API Test: Filtering out unsubmitted pick:",{user_id:R.user_id,fixture_index:R.fixture_index,userName:t.find(X=>X.id===R.user_id)?.name});return}if(!G.has(R.fixture_index)){Z&&y===1&&console.log("[League] Filtering out old pick (not in current fixtures):",{fixture_index:R.fixture_index,currentIndices:Array.from(G),userName:t.find(se=>se.id===R.user_id)?.name});return}const J=$.get(R.fixture_index)??[];J.push(R),$.set(R.fixture_index,J)}):console.log("[League] API Test: Not all submitted - skipping ALL picks processing. allSubmitted=",Y);const ne=g!==null&&g>=y,ue=t.filter(R=>!ze.get(`${R.id}:${y}`)).length,W=t.filter(R=>!ze.get(`${R.id}:${y}`)).map(R=>R.name),ee=_t.get(y),te=ee?new Date>=ee:!1;if(Z&&y===1){const R=t.map(X=>{const ce=`${X.id}:${y}`,V=ze.get(ce);return{id:X.id,name:X.name,submitted:!!V,key:ce}});console.log(`[League] ===== API Test GW${y} SUBMISSION CHECK =====`),console.log("[League] All submitted:",Y),console.log("[League] Remaining:",ue),console.log("[League] Who didn't submit:",W),console.log("[League] Member submission status:",R),console.log("[League] Submitted map entries:",Array.from(ze.entries())),console.log("[League] ================================================");const J=t.find(X=>X.name.toLowerCase().includes("steve")||X.name.toLowerCase().includes("s")),se=t.find(X=>X.name.toLowerCase().includes("jof")||X.name.toLowerCase().includes("j"));if(J){const X=`${J.id}:${y}`;console.log(`[League] STEVE (${J.name}):`,{id:J.id,submitted:!!ze.get(X),key:X})}if(se){const X=`${se.id}:${y}`;console.log(`[League] JOF (${se.name}):`,{id:se.id,submitted:!!ze.get(X),key:X})}}console.log(`GW${y} deadline check:`,{gwDeadline:ee,now:new Date,deadlinePassed:te,allSubmitted:Y,willShowPredictions:Y||te});const ie=Z?!Y:!Y&&!te;return(Z?!Y:!Y&&!te)?(console.log(`[League] Not all submitted, showing ONLY "Who's submitted" view. Blocking all predictions/fixtures.`,{isApiTestLeague:Z,allSubmitted:Y,deadlinePassed:te,remaining:ue}),e.jsxs("div",{className:"mt-2 pt-2",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700",children:e.jsxs(e.Fragment,{children:["Waiting for ",e.jsx("span",{className:"font-semibold",children:ue})," of ",t.length," to submit."]})}),e.jsxs("button",{onClick:()=>{const R=`Game Week ${y} Predictions Reminder!

DEADLINE: THIS ${(()=>{const se=new Date(ve.find(_e=>_e.gw===y)?.kickoff_time||""),X=new Date(se.getTime()-4500*1e3),ce=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],V=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],me=ce[X.getUTCDay()],de=X.getUTCDate(),Ae=V[X.getUTCMonth()],ae=X.getUTCHours().toString().padStart(2,"0"),he=X.getUTCMinutes().toString().padStart(2,"0");return`${me} ${de} ${Ae}, ${ae}:${he} BST`})()}

Don't forget!
playtotl.com`,J=`https://wa.me/?text=${encodeURIComponent(R)}`;try{window.open(J,"_blank")}catch{navigator.clipboard.writeText(R).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+R)})}},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),(()=>{const R=ve.map(oe=>oe.kickoff_time).filter(oe=>!!oe).map(oe=>new Date(oe)).filter(oe=>!isNaN(oe.getTime()));if(R.length===0)return null;const J=new Date(Math.min(...R.map(oe=>oe.getTime()))),se=new Date(J.getTime()-4500*1e3),X=new Date>=se,ce=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],me=ce[se.getUTCDay()],de=se.getUTCDate(),Ae=V[se.getUTCMonth()],ae=se.getUTCHours().toString().padStart(2,"0"),he=se.getUTCMinutes().toString().padStart(2,"0"),_e=`${me} ${de} ${Ae}, ${ae}:${he} BST`;return e.jsxs("div",{className:`mb-3 text-xs font-medium ${X?"text-orange-600":"text-slate-600"} flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),X?"Deadline Passed: ":"Deadline: ",_e]})})(),e.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white",children:e.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),e.jsx("tbody",{children:t.slice().sort((R,J)=>R.name.localeCompare(J.name)).map(R=>{const J=`${R.id}:${y}`,se=!!ze.get(J);return e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:R.name}),e.jsx("td",{className:"px-4 py-3",children:se?e.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2.5 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submitted"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2.5 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Not yet"]})})]},R.id)})})]})})]})):e.jsxs("div",{className:"mt-2 pt-2",children:[ie?e.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-700",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{children:Y?e.jsxs(e.Fragment,{children:["All ",t.length," members have submitted."]}):e.jsxs(e.Fragment,{children:["Waiting for ",e.jsx("span",{className:"font-semibold",children:ue})," of ",t.length," to submit."]})}),!Y&&e.jsxs("button",{onClick:()=>{const R=`Game Week ${y} Predictions Reminder!

DEADLINE: THIS ${(()=>{const se=new Date(ve.find(_e=>_e.gw===y)?.kickoff_time||""),X=new Date(se.getTime()-4500*1e3),ce=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],V=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],me=ce[X.getUTCDay()],de=X.getUTCDate(),Ae=V[X.getUTCMonth()],ae=X.getUTCHours().toString().padStart(2,"0"),he=X.getUTCMinutes().toString().padStart(2,"0");return`${me} ${de} ${Ae}, ${ae}:${he} BST`})()}

Don't forget!
playtotl.com`,J=`https://wa.me/?text=${encodeURIComponent(R)}`;try{window.open(J,"_blank")}catch{navigator.clipboard.writeText(R).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+R)})}},className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),(()=>{const R=ve.map(oe=>oe.kickoff_time).filter(oe=>!!oe).map(oe=>new Date(oe)).filter(oe=>!isNaN(oe.getTime()));if(R.length===0)return null;const J=new Date(Math.min(...R.map(oe=>oe.getTime()))),se=new Date(J.getTime()-4500*1e3),X=new Date>=se,ce=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],me=ce[se.getUTCDay()],de=se.getUTCDate(),Ae=V[se.getUTCMonth()],ae=se.getUTCHours().toString().padStart(2,"0"),he=se.getUTCMinutes().toString().padStart(2,"0"),_e=`${me} ${de} ${Ae}, ${ae}:${he} BST`;return e.jsxs("div",{className:`mb-3 text-sm ${X?"text-orange-600 font-semibold":"text-slate-600"}`,children:[X?" Deadline Passed: ":" Deadline: ",_e]})})(),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),e.jsx("tbody",{children:t.slice().sort((R,J)=>R.name.localeCompare(J.name)).map(R=>{const J=`${R.id}:${y}`,se=!!ze.get(J);return R.name==="Jof"&&console.log(`Checking Jof submission: key=${J}, submitted=${se}, submittedMap has:`,ze.has(J),"picksGw=",y),e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:R.name}),e.jsx("td",{className:"px-4 py-3",children:se?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:" Submitted"}):e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:" Not yet"})})]},R.id)})})]})})]}):null,i?.name==="API Test"&&Y&&K.length>0&&!ie&&(()=>{const R=v,J=K.flatMap(V=>V.items).slice(0,3),se=J.some(V=>{const me=R[V.fixture_index];return me&&(me.status==="IN_PLAY"||me.status==="PAUSED")}),X=J.length>0&&J.every(V=>{const me=R[V.fixture_index];return me&&me.status==="FINISHED"}),ce=se||X||J.some(V=>R[V.fixture_index]);return e.jsx("div",{className:"mt-3 space-y-6",children:K.map((V,me)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-slate-700 font-normal text-lg",children:V.label}),me===0&&e.jsxs(e.Fragment,{children:[se&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-red-600 text-white text-sm font-bold border border-red-700 shadow-sm",style:{marginTop:"-2px"},children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),"LIVE"]}),X&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),!ce&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"})]})]}),e.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:e.jsxs("ul",{children:[V.items.map((de,Ae)=>{try{const ae=de.home_team||de.home_name||"Home",he=de.away_team||de.away_name||"Away",_e=(de.home_code||de.home_team||de.home_name||"").toUpperCase(),oe=(de.away_code||de.away_team||de.away_name||"").toUpperCase(),qt=(Ye=>{if(!Ye)return"";const ot=new Date(Ye);if(isNaN(ot.getTime()))return"";const lt=String(ot.getUTCHours()).padStart(2,"0"),Nt=String(ot.getUTCMinutes()).padStart(2,"0");return`${lt}:${Nt}`})(de.kickoff_time),ut=de.fixture_index,it=$.get(ut)??[],Se=R[ut],gt=Se&&Se.status==="IN_PLAY",bt=Se&&(Se.status==="PAUSED"||Se.status==="HALF_TIME"||Se.status==="HT"),jt=Se&&Se.status==="FINISHED",Je=gt||bt,wt=Ye=>{const ot=it.filter(rt=>rt.pick===Ye);let lt=null;i?.name==="API Test"&&y===1?Se&&(Se.homeScore>Se.awayScore?lt="H":Se.awayScore>Se.homeScore?lt="A":Se.homeScore===Se.awayScore&&(lt="D")):lt=O.get(ut)||null;const Nt=it.length===t.length&&ot.length===t.length,Lt=4,Tt=[];for(let rt=0;rt<ot.length;rt+=Lt){const Kt=ot.slice(rt,rt+Lt);Tt.push(Kt)}return e.jsx("div",{className:"flex flex-col gap-1",children:Tt.map((rt,Kt)=>e.jsx("div",{className:"flex items-center justify-center",children:rt.map((Ut,rs)=>{const Fs=t.find(os=>os.id===Ut.user_id),ns=us(Fs?.name??"?"),as=ze.has(`${Ut.user_id}:${y}`),is=lt&&lt===Ye?!0:null;return Nt?e.jsx("span",{className:"inline-block",style:{marginLeft:rs>0?"-8px":"0",position:"relative",zIndex:rs},children:e.jsx(Mt,{letter:ns,correct:is,unicorn:!1,hasSubmitted:as})},Ut.user_id):e.jsx(Mt,{letter:ns,correct:is,unicorn:!1,hasSubmitted:as},Ut.user_id)})},Kt))})};return e.jsx("li",{className:Ae>0?"border-t":"",children:e.jsxs("div",{className:"p-4 bg-white relative",children:[(gt||bt)&&e.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-bold text-red-600",children:"LIVE"})]}),jt&&!gt&&!bt&&e.jsx("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"FT"})}),e.jsxs("div",{className:`grid grid-cols-3 items-center ${Je?"pt-4":""}`,children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:ae})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_e&&e.jsx("img",{src:`/assets/badges/${_e}.png`,alt:`${ae} badge`,className:"h-6 w-6 object-contain",onError:Ye=>{Ye.currentTarget.style.opacity="0.35"}}),e.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:Se&&(gt||bt||jt)?e.jsxs("span",{className:"font-bold text-base text-slate-900",children:[Se.homeScore," - ",Se.awayScore]}):e.jsx("span",{children:qt})}),oe&&e.jsx("img",{src:`/assets/badges/${oe}.png`,alt:`${he} badge`,className:"h-6 w-6 object-contain",onError:Ye=>{Ye.currentTarget.style.opacity="0.35"}})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:he})})]}),Se&&(Je||jt)&&e.jsx("div",{className:"flex justify-center mt-1",children:e.jsx("span",{className:`text-[10px] font-semibold ${Je?"text-red-600":"text-slate-500"}`,children:Qs(Se.status,Se.minute)})}),e.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:wt("H")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:wt("D")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:wt("A")})})]})]})},`${de.gw}-${de.fixture_index}`)}catch(ae){return console.error("Error rendering fixture:",ae,de),e.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",de.fixture_index]},`${de.gw}-${de.fixture_index}`)}}),!V.items.length&&e.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]},me))})})(),K.length>0&&i?.name!=="API Test"&&e.jsx("div",{className:"mt-3 space-y-6",children:K.map((R,J)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-slate-700 font-normal text-lg",children:R.label}),J===0&&Y&&ne&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),J===0&&Y&&!ne&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),J===0&&te&&!Y&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-orange-100 text-orange-800 text-sm font-bold border border-orange-300 shadow-sm",style:{marginTop:"-2px"},children:["Deadline Passed ",W.length>0&&`(${W.join(", ")} didn't submit)`]})]}),e.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:e.jsxs("ul",{children:[R.items.map((se,X)=>{try{const ce=se.home_name||se.home_team||"Home",V=se.away_name||se.away_team||"Away",me=se.home_code||"",de=se.away_code||"",ae=(ut=>{if(!ut)return"";const it=new Date(ut);if(isNaN(it.getTime()))return"";const Se=String(it.getUTCHours()).padStart(2,"0"),gt=String(it.getUTCMinutes()).padStart(2,"0");return`${Se}:${gt}`})(se.kickoff_time),he=se.fixture_index,_e=$.get(he)??[],oe=ut=>{const it=_e.filter(Je=>Je.pick===ut),Se=O.get(he),gt=_e.length===t.length&&it.length===t.length,bt=4,jt=[];for(let Je=0;Je<it.length;Je+=bt){const wt=it.slice(Je,Je+bt);jt.push(wt)}return e.jsx("div",{className:"flex flex-col gap-1",children:jt.map((Je,wt)=>e.jsx("div",{className:"flex items-center justify-center",children:Je.map((Ye,ot)=>{const lt=t.find(rt=>rt.id===Ye.user_id),Nt=us(lt?.name??"?"),Lt=ze.has(`${Ye.user_id}:${y}`),Tt=Se&&Se===ut?!0:null;return gt?e.jsx("span",{className:"inline-block",style:{marginLeft:ot>0?"-8px":"0",position:"relative",zIndex:ot},children:e.jsx(Mt,{letter:Nt,correct:Tt,unicorn:!1,hasSubmitted:Lt})},Ye.user_id):e.jsx(Mt,{letter:Nt,correct:Tt,unicorn:!1,hasSubmitted:Lt},Ye.user_id)})},wt))})},yt=`/assets/badges/${me.toUpperCase()}.png`,qt=`/assets/badges/${de.toUpperCase()}.png`;return e.jsx("li",{className:X>0?"border-t":"",children:e.jsxs("div",{className:"p-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:ce})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("img",{src:yt,alt:`${ce} badge`,className:"h-6 w-6"}),e.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:ae}),e.jsx("img",{src:qt,alt:`${V} badge`,className:"h-6 w-6"})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:V})})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:oe("H")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:oe("D")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:oe("A")})})]})]})},`${se.gw}-${se.fixture_index}`)}catch(ce){return console.error("Error rendering fixture:",ce,se),e.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",se.fixture_index]},`${se.gw}-${se.fixture_index}`)}}),!R.items.length&&e.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]},J))}),!K.length&&!ie&&e.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-500",children:["No fixtures for GW ",y,"."]})]})}function Us(){const y=i?.name==="API Test"?1:c;if(!y||w.length===0&&i?.name!=="API Test")return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No game week selected."});if(!cs(i,y,_t))return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Results Available"}),e.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),e.jsxs("div",{className:"text-sm",children:["GW",y," results are not included in this league."]})]})});const O=new Map,K=i?.name==="API Test";K&&y===1?ve.slice(0,3).forEach(ee=>{const te=v[ee.fixture_index];te&&(te.status==="IN_PLAY"||te.status==="PAUSED"||te.status==="FINISHED")&&(te.homeScore>te.awayScore?O.set(ee.fixture_index,"H"):te.awayScore>te.homeScore?O.set(ee.fixture_index,"A"):O.set(ee.fixture_index,"D"))}):Zt.forEach(W=>{if(W.gw!==y)return;const ee=Qt(W);ee&&O.set(W.fixture_index,ee)});const G=t.map(W=>({user_id:W.id,name:W.name,score:0,unicorns:0})),Z=new Map;ht.forEach(W=>{if(W.gw!==y)return;const ee=Z.get(W.fixture_index)??[];ee.push(W),Z.set(W.fixture_index,ee)}),Array.from(O.entries()).forEach(([W,ee])=>{const ie=(Z.get(W)??[]).filter(xe=>xe.pick===ee).map(xe=>xe.user_id);if(ie.forEach(xe=>{const R=G.find(J=>J.user_id===xe);R.score+=1}),ie.length===1&&t.length>=3){const xe=G.find(R=>R.user_id===ie[0]);xe.unicorns+=1}}),G.sort((W,ee)=>ee.score-W.score||ee.unicorns-W.unicorns||W.name.localeCompare(ee.name)),Q.useEffect(()=>{if(G.length===0)return;const W=new Map;G.forEach((te,ie)=>{W.set(te.user_id,ie)});const ee=new Set;if(W.forEach((te,ie)=>{const xe=b.current.get(ie);xe!==void 0&&xe!==te&&ee.add(ie)}),b.current=W,ee.size>0){f(ee);const te=setTimeout(()=>{f(new Set)},2e3);return()=>clearTimeout(te)}},[G.map(W=>`${W.user_id}-${W.score}-${W.unicorns}`).join(",")]);let Y=!1,$=!1,ne=!1,ue=!1;if(K&&y===1){const W=ve.slice(0,3);if(W.length>0&&(Y=W.every(te=>{const ie=v[te.fixture_index];return ie&&ie.status==="FINISHED"}),$=!!W.find(te=>{const ie=v[te.fixture_index];return ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED")}),ue=W.some(te=>{const ie=v[te.fixture_index];return ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED"||ie.status==="FINISHED")}),!Y)){const te=new Date;ne=W.some(ie=>{if(!ie.kickoff_time)return!1;const R=new Date(ie.kickoff_time).getTime()-te.getTime(),J=v[ie.fixture_index];return(!J||J.status!=="IN_PLAY"&&J.status!=="PAUSED"&&J.status!=="FINISHED")&&R>0&&R<=1440*60*1e3})}}else{const W=ve.filter(ee=>ee.gw===y);W.length>0&&(Y=W.every(ee=>O.has(ee.fixture_index)))}return e.jsxs("div",{children:[e.jsx("style",{children:`
          @keyframes flash {
            0%, 100% {
              background-color: rgb(209, 250, 229);
            }
            25% {
              background-color: rgb(167, 243, 208);
            }
            50% {
              background-color: rgb(209, 250, 229);
            }
            75% {
              background-color: rgb(167, 243, 208);
            }
          }
          @keyframes pulse-score {
            0%, 100% {
              opacity: 1;
            }
            50% {
              opacity: 0.7;
            }
          }
          @keyframes position-change {
            0% {
              background-color: rgb(254, 243, 199);
            }
            50% {
              background-color: rgb(253, 230, 138);
            }
            100% {
              background-color: transparent;
            }
          }
          .flash-user-row {
            animation: flash 1.5s ease-in-out 3;
          }
          .pulse-live-score {
            animation: pulse-score 2s ease-in-out infinite;
          }
          .position-changed {
            animation: position-change 1.5s ease-out;
          }
          .full-width-header-border::after {
            content: '';
            position: absolute;
            left: -1rem;
            right: -1rem;
            bottom: 0;
            height: 1px;
            background-color: #cbd5e1;
            z-index: 1;
          }
        `}),G.length>0&&Y&&e.jsx("div",{className:"mt-4 mb-4 py-6 px-6 rounded-xl bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 shadow-2xl shadow-slate-600/50 relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:animate-[shimmer_2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/30 after:to-transparent after:animate-[shimmer_2.5s_ease-in-out_infinite_0.6s]",children:e.jsx("div",{className:"text-center relative z-10",children:G[0].score===G[1]?.score&&G[0].unicorns===G[1]?.unicorns?e.jsx("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:" It's a Draw!"}):e.jsxs("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:[G[0].name," Wins!"]})})}),e.jsx("div",{className:"overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x border-b border-slate-200 bg-slate-50 shadow-sm",style:{backgroundColor:"#f8fafc"},children:e.jsxs("table",{className:"w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc"},children:[e.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[e.jsx("th",{className:"py-4 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),e.jsx("th",{className:"py-4 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-2",children:["Player",K&&$&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-600 text-white shadow-md shadow-red-500/30",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-medium",children:"LIVE"})]}),K&&!Y&&ne&&!$&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500 text-white shadow-md shadow-amber-500/30",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-[10px] font-medium",children:ue?"Next Game Starting Soon":"Starting soon"})]})]})}),e.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8"},children:"Score"}),t.length>=3&&e.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""})]})}),e.jsxs("tbody",{children:[G.map((W,ee)=>{const te=W.user_id===_?.id,ie=ee===G.length-1,xe=C.has(W.user_id);return e.jsxs("tr",{className:`${te?"flash-user-row":""} ${xe?"position-changed":""}`,style:{position:"relative",backgroundColor:"#f8fafc",...ie?{}:{borderBottom:"1px solid #e2e8f0"}},children:[e.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:ee+1}),e.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[K&&$&&e.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full animate-pulse flex-shrink-0",style:{minWidth:"8px",minHeight:"8px"}}),K&&!$&&ne&&e.jsx("svg",{className:"w-3 h-3 text-amber-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:W.name})]})}),e.jsx("td",{className:`py-4 text-center tabular-nums font-bold ${K&&$?"pulse-live-score":""}`,style:{width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:W.score}),t.length>=3&&e.jsx("td",{className:`py-4 text-center tabular-nums ${K&&$?"pulse-live-score":""}`,style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:W.unicorns})]},W.user_id)}),!G.length&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsxs("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:t.length>=3?4:3,style:{backgroundColor:"#f8fafc"},children:["No results recorded for GW ",y," yet."]})})]})]})}),w.length>1&&e.jsx("div",{className:"mt-6 mb-4 flex flex-col items-center gap-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 w-full max-w-sm",children:[e.jsx("div",{className:"flex-1",children:e.jsx("select",{value:y,onChange:W=>u(parseInt(W.target.value,10)),className:"gw-selector w-full bg-white rounded-full border-2 border-slate-300 px-3 py-2 text-xs font-normal text-slate-600 text-center focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-[#1C8376] active:bg-slate-50 transition-colors",style:{fontSize:"12px",minHeight:"40px",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b' stroke-width='2.5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"1em 1em",paddingRight:"2.5rem"},children:w.map(W=>e.jsxs("option",{value:W,style:{fontSize:"12px",padding:"0.5rem",fontWeight:"normal",color:"#64748b",textTransform:"uppercase"},children:["GAME WEEK ",W]},W))})}),e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[e.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),e.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>B(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:W=>W.stopPropagation(),children:[e.jsx("button",{onClick:()=>B(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Weekly Winner"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:" How to Win the Week:"}),e.jsxs("p",{className:"text-[#1C8376]/80",children:["The player with the ",e.jsx("strong",{children:"most correct predictions"})," wins that gameweek."]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-purple-800 mb-2",children:" Unicorn Rule"}),e.jsxs("p",{className:"text-purple-700",children:["In Mini-Leagues with ",e.jsx("strong",{children:"3 or more players"}),", if you're the ",e.jsx("strong",{children:"only person"})," to correctly predict a fixture, that's a ",e.jsx("strong",{children:" Unicorn"}),". In ties, the player with most ",e.jsx("strong",{children:" Unicorns"})," wins!"]})]})]})]})]})})]})}return Q.useEffect(()=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"auto"})},[x]),d?e.jsx("div",{className:"max-w-5xl mx-auto px-4 py-10",children:e.jsx("div",{className:"text-slate-500",children:"Loading"})}):!i&&!d?e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-10",children:e.jsxs("div",{className:"rounded border bg-white p-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"League not found"}),e.jsx(ls,{to:"/leagues",className:"text-slate-600 underline",children:"Back to Mini Leagues"})]})}):i?e.jsxs("div",{className:`${z?"oldschool-theme":"bg-slate-50"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",maxHeight:"100vh",overflow:"hidden"},children:[e.jsx("style",{children:`
        .league-header-fixed {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          z-index: 50 !important;
          transform: translate3d(0, 0, 0) !important;
          -webkit-transform: translate3d(0, 0, 0) !important;
          will-change: transform !important;
          contain: layout style paint !important;
        }
        .league-header-fixed .relative {
          position: relative !important;
          z-index: 100 !important;
        }
        @supports (height: 100dvh) {
          .league-header-fixed {
            top: env(safe-area-inset-top, 0px) !important;
          }
        }
        .league-content-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
          left: 0;
          right: 0;
          bottom: 0;
          overflow-y: auto;
          overflow-x: hidden;
          -webkit-overflow-scrolling: touch;
          overscroll-behavior: contain;
          padding-bottom: 2rem;
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .league-content-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
        }
        @media (max-width: 768px) {
          .league-content-wrapper {
            top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
            padding-bottom: 2rem;
            padding-left: 1rem;
            padding-right: 1rem;
          }
          .league-content-wrapper.has-banner {
            top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
          }
        }
        /* Chat tab - full height layout */
        .chat-tab-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px));
          left: 0;
          right: 0;
          bottom: 0;
          height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          z-index: 10;
          overflow: visible;
          pointer-events: none;
        }
        .chat-tab-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px));
          height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
        }
        .chat-tab-wrapper > * {
          pointer-events: auto;
        }
        @supports (height: 100dvh) {
          .chat-tab-wrapper {
            height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          }
          .chat-tab-wrapper.has-banner {
            height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          }
        }
      `}),e.jsx("div",{className:"league-header-fixed bg-white border-b border-slate-200 shadow-sm",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-14",children:[e.jsx(ls,{to:"/leagues",className:"flex items-center text-slate-600 hover:text-slate-900 transition-colors -ml-2 px-2 py-1",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-lg font-normal text-slate-900 truncate flex-1 text-left px-2",children:i.name}),e.jsx("div",{className:"relative",style:{zIndex:100},children:e.jsx("button",{onClick:()=>Ee(!Me),className:"flex items-center justify-center w-8 h-8 rounded-full hover:bg-slate-100 transition-colors -mr-2","aria-label":"Menu",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 bg-white",children:[e.jsxs("button",{onClick:()=>{o.current=!0,r(!0),n("chat")},className:"flex-1 px-3 sm:px-6 py-3 text-sm font-semibold transition-colors relative "+(x==="chat"?"text-[#1C8376]":"text-slate-400"),children:["Chat",x==="chat"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(w.length>0||i?.name==="API Test")&&e.jsxs("button",{onClick:()=>{o.current=!0,r(!0),n("gwr")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight flex items-center justify-center gap-1.5 "+(x==="gwr"?"text-[#1C8376]":"text-slate-400"),children:[(()=>{const y=i?.name==="API Test"?1:c||S,O=new Date,K=ve[0],G=K?.kickoff_time?new Date(K.kickoff_time):null,Z=G&&G<=O,$=ve[ve.length-1]?.fixture_index,ue=($!==void 0?v[$]:null)?.status==="FINISHED",W=Z&&!ue,ee=W?"Live Table":"Results";return e.jsxs(e.Fragment,{children:[W&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:y?`GW ${y} ${ee}`:`GW ${ee}`}),e.jsx("span",{className:"sm:hidden whitespace-pre-line text-center",children:y?`GW${y}
${ee}`:`GW
${ee}`})]})})(),x==="gwr"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(S||i?.name==="API Test")&&e.jsxs("button",{onClick:()=>{o.current=!0,r(!0),n("gw")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight "+(x==="gw"?"text-[#1C8376]":"text-slate-400"),children:[e.jsx("span",{className:"hidden sm:inline",children:i?.name==="API Test"?"GW 1 Predictions":S?`GW ${S} Predictions`:"GW Predictions"}),e.jsx("span",{className:"sm:hidden whitespace-pre-line",children:i?.name==="API Test"?`GW1
Predictions`:S?`GW${S}
Predictions`:`GW
Predictions`}),x==="gw"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),e.jsxs("button",{onClick:()=>{o.current=!0,r(!0),n("mlt")},className:"flex-1 px-3 sm:px-6 py-3 text-sm font-semibold transition-colors relative "+(x==="mlt"?"text-[#1C8376]":"text-slate-400"),children:["Table",x==="mlt"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]})]})]})}),Me&&typeof document<"u"&&document.body&&Hs.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0",onClick:()=>Ee(!1),style:{backgroundColor:"transparent",zIndex:99998}}),e.jsxs("div",{className:"fixed w-56 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",style:{zIndex:99999,top:"calc(3.5rem + 0.5rem + env(safe-area-inset-top, 0px))",right:"1rem"},children:[Ct&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-100",children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Admin:"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:Ss})]}),e.jsx("button",{onClick:()=>{P(!0),Ee(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Manage"}),e.jsx("button",{onClick:()=>{fe(!0),Ee(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Upload avatar"})]}),e.jsx("button",{onClick:()=>{qe(!0),Ee(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Invite players"}),e.jsx("button",{onClick:()=>{ts(),Ee(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:"Share league code"}),e.jsx("button",{onClick:()=>{j(!0),Ee(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Leave"})]})]}),document.body),x==="chat"?e.jsx("div",{className:"chat-tab-wrapper",children:e.jsx(Js,{chat:Xe,userId:_?.id,nameById:pt,isMember:Et,newMsg:et,setNewMsg:xt,onSend:Ts,leagueCode:i?.code,memberCount:t.length,maxMembers:Ft,notificationStatus:zt})}):e.jsx("div",{className:"league-content-wrapper",children:e.jsxs("div",{className:"px-1 sm:px-2",children:[x==="mlt"&&e.jsx(Es,{}),x==="gw"&&e.jsx(Is,{}),x==="gwr"&&e.jsx(Us,{})]})}),Ct&&L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>P(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:y=>y.stopPropagation(),children:[e.jsx("button",{onClick:()=>P(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-slate-600 mb-3 font-semibold",children:"Remove Members:"}),e.jsxs("div",{className:"space-y-2",children:[t.filter(y=>y.id!==_?.id).map(y=>e.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800",children:y.name}),e.jsx("button",{onClick:()=>{Ve(y),He(!0),P(!1)},className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium",children:"Remove"})]},y.id)),t.filter(y=>y.id!==_?.id).length===0&&e.jsx("div",{className:"text-sm text-slate-500 italic py-4 text-center",children:"No other members to remove"})]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-200",children:e.jsx("button",{onClick:()=>{ye(!0),P(!1)},className:"w-full px-4 py-3 text-sm bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium flex items-center justify-center gap-2",children:" End League"})})]})]})]})}),Ct&&F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>fe(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:y=>y.stopPropagation(),children:[e.jsx("button",{onClick:()=>{fe(!1),we(null),Ce(!1)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Upload League Avatar"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm text-slate-600 mb-2 font-medium",children:"Current Avatar:"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-slate-100 flex items-center justify-center",children:e.jsx("img",{src:i?$s(i):"/assets/league-avatars/ML-avatar-1.png",alt:"League avatar",className:"w-full h-full object-cover",onError:y=>{const O=y.target;O.src="/assets/league-avatars/ML-avatar-1.png"}})}),i?.avatar&&e.jsx("button",{onClick:ks,disabled:je,className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium disabled:opacity-50",children:"Remove Avatar"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Upload New Avatar"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:y=>{const O=y.target.files?.[0];O&&Ns(O)},disabled:je,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#1C8376] file:text-white hover:file:bg-emerald-700 file:cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Images will be automatically compressed to ~60KB and resized to 256x256px. Max file size: 2MB before compression."})]}),je&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#1C8376]"}),e.jsx("span",{children:"Processing and uploading..."})]}),Te&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800",children:" Avatar uploaded successfully!"}),pe&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:pe})]})]})]})}),le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>q(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:y=>y.stopPropagation(),children:[e.jsx("button",{onClick:()=>q(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Points"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:"League Points:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Win the week"}),"  3 points"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Draw"}),"  1 point"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Lose"}),"  0 points"]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:" Ties"}),e.jsxs("p",{className:"text-blue-700",children:["If two or more players are tied on Points, the player with the most overall ",e.jsx("strong",{children:" Unicorns"})," in the mini league is ranked higher."]})]})]}),i&&(["The Bird league"].includes(i.name)||["gregVjofVcarl","Let Down"].includes(i.name))&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-blue-700 text-sm",children:[e.jsx("strong",{children:"Note:"}),' This mini league started after GW1, so the "CP" column shows correct predictions since this mini league began.']})})]})]})}),dt&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Invite players"}),e.jsxs("p",{className:"text-slate-600 text-sm",children:["Share this code (up to ",Ft," members):"]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("code",{className:"font-mono text-lg font-bold",children:i.code}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(i.code)},className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Copy"}),e.jsx("button",{onClick:ts,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Share"})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:[t.length,"/",Ft," members"]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>qe(!1),className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-50",children:"Close"})})]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Leave League"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:['Are you sure you want to leave "',i?.name,`"? You'll need the league code to rejoin later.`]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:H,children:"Cancel"}),e.jsx("button",{onClick:_s,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:H,children:H?"Leaving...":"Leave League"})]})]})}),Le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Join Mini League"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:["You are about to join ",e.jsxs("strong",{children:['"',i?.name,'"']}),". Are you sure?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Fe(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Ne,children:"Cancel"}),e.jsx("button",{onClick:As,className:"flex-1 px-4 py-2 bg-[#1C8376] text-white rounded-md hover:bg-emerald-700 transition-colors disabled:opacity-50",disabled:Ne,children:Ne?"Joining...":"Join League"})]})]})}),Ie&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Remove Member"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:["Are you sure you want to remove ",e.jsxs("strong",{children:['"',We?.name,'"']})," from the league? They will need the league code to rejoin."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>He(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:ft,children:"Cancel"}),e.jsx("button",{onClick:Cs,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:ft,children:ft?"Removing...":"Remove Member"})]})]})}),Ue&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:" End League"}),e.jsxs("p",{className:"text-slate-600 mb-4",children:["Are you absolutely sure you want to ",e.jsx("strong",{children:"permanently end"})," the league ",e.jsxs("strong",{children:['"',i?.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-red-600 mb-6",children:"This will remove all members and delete the league forever. This action cannot be undone!"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>ye(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Ze,children:"Cancel"}),e.jsx("button",{onClick:Ls,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:Ze,children:Ze?"Ending...":"Yes, End League"})]})]})}),i?.name==="API Test"&&e.jsx("div",{className:"mt-6 mb-4 px-4 py-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:" Test League:"})," This league uses test API data and starts from Test GW 1 with zero points. It does not affect your main game scores."]})})]}):null}export{er as default};
