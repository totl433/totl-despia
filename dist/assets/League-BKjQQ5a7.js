import{r as Es,a as D,s as ne,j as t,u as os,g as Qt,D as Ts,b as Ms,c as Is,d as Us,L as Jt,e as Fs,f as Zt}from"./index-DSeN78nc.js";import{T as Xt}from"./TeamBadge-sNkC7s8o.js";var Ds=Es();function Rs(m,p){return p.forEach((function(T){T&&typeof T!="string"&&!Array.isArray(T)&&Object.keys(T).forEach((function(r){if(r!=="default"&&!(r in m)){var e=Object.getOwnPropertyDescriptor(T,r);Object.defineProperty(m,r,e.get?e:{enumerable:!0,get:function(){return T[r]}})}}))})),Object.freeze(m)}function ls(m,p){return new Promise((function(T,r){let e;return Ps(m).then((function(s){try{return e=s,T(new Blob([p.slice(0,2),e,p.slice(2)],{type:"image/jpeg"}))}catch(f){return r(f)}}),r)}))}const Ps=m=>new Promise(((p,T)=>{const r=new FileReader;r.addEventListener("load",(({target:{result:e}})=>{const s=new DataView(e);let f=0;if(s.getUint16(f)!==65496)return T("not a valid JPEG");for(f+=2;;){const c=s.getUint16(f);if(c===65498)break;const y=s.getUint16(f+2);if(c===65505&&s.getUint32(f+4)===1165519206){const v=f+10;let a;switch(s.getUint16(v)){case 18761:a=!0;break;case 19789:a=!1;break;default:return T("TIFF header contains invalid endian")}if(s.getUint16(v+2,a)!==42)return T("TIFF header contains invalid version");const i=s.getUint32(v+4,a),n=v+i+2+12*s.getUint16(v+i,a);for(let o=v+i+2;o<n;o+=12)if(s.getUint16(o,a)==274){if(s.getUint16(o+2,a)!==3)return T("Orientation data type is invalid");if(s.getUint32(o+4,a)!==1)return T("Orientation data count is invalid");s.setUint16(o+8,1,a);break}return p(e.slice(f,f+2+y))}f+=2+y}return p(new Blob)})),r.readAsArrayBuffer(m)}));var Lt={},$s={get exports(){return Lt},set exports(m){Lt=m}};(function(m){var p,T,r={};$s.exports=r,r.parse=function(e,s){for(var f=r.bin.readUshort,c=r.bin.readUint,y=0,v={},a=new Uint8Array(e),i=a.length-4;c(a,i)!=101010256;)i--;y=i,y+=4;var n=f(a,y+=4);f(a,y+=2);var o=c(a,y+=2),g=c(a,y+=4);y+=4,y=g;for(var N=0;N<n;N++){c(a,y),y+=4,y+=4,y+=4,c(a,y+=4),o=c(a,y+=4);var E=c(a,y+=4),j=f(a,y+=4),F=f(a,y+2),U=f(a,y+4);y+=6;var A=c(a,y+=8);y+=4,y+=j+F+U,r._readLocal(a,A,v,o,E,s)}return v},r._readLocal=function(e,s,f,c,y,v){var a=r.bin.readUshort,i=r.bin.readUint;i(e,s),a(e,s+=4),a(e,s+=2);var n=a(e,s+=2);i(e,s+=2),i(e,s+=4),s+=4;var o=a(e,s+=8),g=a(e,s+=2);s+=2;var N=r.bin.readUTF8(e,s,o);if(s+=o,s+=g,v)f[N]={size:y,csize:c};else{var E=new Uint8Array(e.buffer,s);if(n==0)f[N]=new Uint8Array(E.buffer.slice(s,s+c));else{if(n!=8)throw"unknown compression method: "+n;var j=new Uint8Array(y);r.inflateRaw(E,j),f[N]=j}}},r.inflateRaw=function(e,s){return r.F.inflate(e,s)},r.inflate=function(e,s){return e[0],e[1],r.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),s)},r.deflate=function(e,s){s==null&&(s={level:6});var f=0,c=new Uint8Array(50+Math.floor(1.1*e.length));c[f]=120,c[f+1]=156,f+=2,f=r.F.deflateRaw(e,c,f,s.level);var y=r.adler(e,0,e.length);return c[f+0]=y>>>24&255,c[f+1]=y>>>16&255,c[f+2]=y>>>8&255,c[f+3]=y>>>0&255,new Uint8Array(c.buffer,0,f+4)},r.deflateRaw=function(e,s){s==null&&(s={level:6});var f=new Uint8Array(50+Math.floor(1.1*e.length)),c=r.F.deflateRaw(e,f,c,s.level);return new Uint8Array(f.buffer,0,c)},r.encode=function(e,s){s==null&&(s=!1);var f=0,c=r.bin.writeUint,y=r.bin.writeUshort,v={};for(var a in e){var i=!r._noNeed(a)&&!s,n=e[a],o=r.crc.crc(n,0,n.length);v[a]={cpr:i,usize:n.length,crc:o,file:i?r.deflateRaw(n):n}}for(var a in v)f+=v[a].file.length+30+46+2*r.bin.sizeUTF8(a);f+=22;var g=new Uint8Array(f),N=0,E=[];for(var a in v){var j=v[a];E.push(N),N=r._writeHeader(g,N,a,j,0)}var F=0,U=N;for(var a in v)j=v[a],E.push(N),N=r._writeHeader(g,N,a,j,1,E[F++]);var A=N-U;return c(g,N,101010256),N+=4,y(g,N+=4,F),y(g,N+=2,F),c(g,N+=2,A),c(g,N+=4,U),N+=4,N+=2,g.buffer},r._noNeed=function(e){var s=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(s)!=-1},r._writeHeader=function(e,s,f,c,y,v){var a=r.bin.writeUint,i=r.bin.writeUshort,n=c.file;return a(e,s,y==0?67324752:33639248),s+=4,y==1&&(s+=2),i(e,s,20),i(e,s+=2,0),i(e,s+=2,c.cpr?8:0),a(e,s+=2,0),a(e,s+=4,c.crc),a(e,s+=4,n.length),a(e,s+=4,c.usize),i(e,s+=4,r.bin.sizeUTF8(f)),i(e,s+=2,0),s+=2,y==1&&(s+=2,s+=2,a(e,s+=6,v),s+=4),s+=r.bin.writeUTF8(e,s,f),y==0&&(e.set(n,s),s+=n.length),s},r.crc={table:(function(){for(var e=new Uint32Array(256),s=0;s<256;s++){for(var f=s,c=0;c<8;c++)1&f?f=3988292384^f>>>1:f>>>=1;e[s]=f}return e})(),update:function(e,s,f,c){for(var y=0;y<c;y++)e=r.crc.table[255&(e^s[f+y])]^e>>>8;return e},crc:function(e,s,f){return 4294967295^r.crc.update(4294967295,e,s,f)}},r.adler=function(e,s,f){for(var c=1,y=0,v=s,a=s+f;v<a;){for(var i=Math.min(v+5552,a);v<i;)y+=c+=e[v++];c%=65521,y%=65521}return y<<16|c},r.bin={readUshort:function(e,s){return e[s]|e[s+1]<<8},writeUshort:function(e,s,f){e[s]=255&f,e[s+1]=f>>8&255},readUint:function(e,s){return 16777216*e[s+3]+(e[s+2]<<16|e[s+1]<<8|e[s])},writeUint:function(e,s,f){e[s]=255&f,e[s+1]=f>>8&255,e[s+2]=f>>16&255,e[s+3]=f>>24&255},readASCII:function(e,s,f){for(var c="",y=0;y<f;y++)c+=String.fromCharCode(e[s+y]);return c},writeASCII:function(e,s,f){for(var c=0;c<f.length;c++)e[s+c]=f.charCodeAt(c)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,s,f){for(var c,y="",v=0;v<f;v++)y+="%"+r.bin.pad(e[s+v].toString(16));try{c=decodeURIComponent(y)}catch{return r.bin.readASCII(e,s,f)}return c},writeUTF8:function(e,s,f){for(var c=f.length,y=0,v=0;v<c;v++){var a=f.charCodeAt(v);if((4294967168&a)==0)e[s+y]=a,y++;else if((4294965248&a)==0)e[s+y]=192|a>>6,e[s+y+1]=128|a>>0&63,y+=2;else if((4294901760&a)==0)e[s+y]=224|a>>12,e[s+y+1]=128|a>>6&63,e[s+y+2]=128|a>>0&63,y+=3;else{if((4292870144&a)!=0)throw"e";e[s+y]=240|a>>18,e[s+y+1]=128|a>>12&63,e[s+y+2]=128|a>>6&63,e[s+y+3]=128|a>>0&63,y+=4}}return y},sizeUTF8:function(e){for(var s=e.length,f=0,c=0;c<s;c++){var y=e.charCodeAt(c);if((4294967168&y)==0)f++;else if((4294965248&y)==0)f+=2;else if((4294901760&y)==0)f+=3;else{if((4292870144&y)!=0)throw"e";f+=4}}return f}},r.F={},r.F.deflateRaw=function(e,s,f,c){var y=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][c],v=r.F.U,a=r.F._goodIndex;r.F._hash;var i=r.F._putsE,n=0,o=f<<3,g=0,N=e.length;if(c==0){for(;n<N;)i(s,o,n+(S=Math.min(65535,N-n))==N?1:0),o=r.F._copyExact(e,n,S,s,o+8),n+=S;return o>>>3}var E=v.lits,j=v.strt,F=v.prev,U=0,A=0,P=0,x=0,M=0,l=0;for(N>2&&(j[l=r.F._hash(e,0)]=0),n=0;n<N;n++){if(M=l,n+1<N-2){l=r.F._hash(e,n+1);var d=n+1&32767;F[d]=j[l],j[l]=d}if(g<=n){(U>14e3||A>26697)&&N-n>100&&(g<n&&(E[U]=n-g,U+=2,g=n),o=r.F._writeBlock(n==N-1||g==N?1:0,E,U,x,e,P,n-P,s,o),U=A=x=0,P=n);var _=0;n<N-2&&(_=r.F._bestMatch(e,n,F,M,Math.min(y[2],N-n),y[3]));var S=_>>>16,b=65535&_;if(_!=0){b=65535&_;var k=a(S=_>>>16,v.of0);v.lhst[257+k]++;var w=a(b,v.df0);v.dhst[w]++,x+=v.exb[k]+v.dxb[w],E[U]=S<<23|n-g,E[U+1]=b<<16|k<<8|w,U+=2,g=n+S}else v.lhst[e[n]]++;A++}}for(P==n&&e.length!=0||(g<n&&(E[U]=n-g,U+=2,g=n),o=r.F._writeBlock(1,E,U,x,e,P,n-P,s,o),U=0,A=0,U=A=x=0,P=n);(7&o)!=0;)o++;return o>>>3},r.F._bestMatch=function(e,s,f,c,y,v){var a=32767&s,i=f[a],n=a-i+32768&32767;if(i==a||c!=r.F._hash(e,s-n))return 0;for(var o=0,g=0,N=Math.min(32767,s);n<=N&&--v!=0&&i!=a;){if(o==0||e[s+o]==e[s+o-n]){var E=r.F._howLong(e,s,n);if(E>o){if(g=n,(o=E)>=y)break;n+2<E&&(E=n+2);for(var j=0,F=0;F<E-2;F++){var U=s-n+F+32768&32767,A=U-f[U]+32768&32767;A>j&&(j=A,i=U)}}}n+=(a=i)-(i=f[a])+32768&32767}return o<<16|g},r.F._howLong=function(e,s,f){if(e[s]!=e[s-f]||e[s+1]!=e[s+1-f]||e[s+2]!=e[s+2-f])return 0;var c=s,y=Math.min(e.length,s+258);for(s+=3;s<y&&e[s]==e[s-f];)s++;return s-c},r.F._hash=function(e,s){return(e[s]<<8|e[s+1])+(e[s+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(e,s,f,c,y,v,a,i,n){var o,g,N,E,j,F,U,A,P,x=r.F.U,M=r.F._putsF,l=r.F._putsE;x.lhst[256]++,g=(o=r.F.getTrees())[0],N=o[1],E=o[2],j=o[3],F=o[4],U=o[5],A=o[6],P=o[7];var d=32+((n+3&7)==0?0:8-(n+3&7))+(a<<3),_=c+r.F.contSize(x.fltree,x.lhst)+r.F.contSize(x.fdtree,x.dhst),S=c+r.F.contSize(x.ltree,x.lhst)+r.F.contSize(x.dtree,x.dhst);S+=14+3*U+r.F.contSize(x.itree,x.ihst)+(2*x.ihst[16]+3*x.ihst[17]+7*x.ihst[18]);for(var b=0;b<286;b++)x.lhst[b]=0;for(b=0;b<30;b++)x.dhst[b]=0;for(b=0;b<19;b++)x.ihst[b]=0;var k=d<_&&d<S?0:_<S?1:2;if(M(i,n,e),M(i,n+1,k),n+=3,k==0){for(;(7&n)!=0;)n++;n=r.F._copyExact(y,v,a,i,n)}else{var w,L;if(k==1&&(w=x.fltree,L=x.fdtree),k==2){r.F.makeCodes(x.ltree,g),r.F.revCodes(x.ltree,g),r.F.makeCodes(x.dtree,N),r.F.revCodes(x.dtree,N),r.F.makeCodes(x.itree,E),r.F.revCodes(x.itree,E),w=x.ltree,L=x.dtree,l(i,n,j-257),l(i,n+=5,F-1),l(i,n+=5,U-4),n+=4;for(var h=0;h<U;h++)l(i,n+3*h,x.itree[1+(x.ordr[h]<<1)]);n+=3*U,n=r.F._codeTiny(A,x.itree,i,n),n=r.F._codeTiny(P,x.itree,i,n)}for(var u=v,$=0;$<f;$+=2){for(var I=s[$],H=I>>>23,X=u+(8388607&I);u<X;)n=r.F._writeLit(y[u++],w,i,n);if(H!=0){var O=s[$+1],Y=O>>16,B=O>>8&255,R=255&O;l(i,n=r.F._writeLit(257+B,w,i,n),H-x.of0[B]),n+=x.exb[B],M(i,n=r.F._writeLit(R,L,i,n),Y-x.df0[R]),n+=x.dxb[R],u+=H}}n=r.F._writeLit(256,w,i,n)}return n},r.F._copyExact=function(e,s,f,c,y){var v=y>>>3;return c[v]=f,c[v+1]=f>>>8,c[v+2]=255-c[v],c[v+3]=255-c[v+1],v+=4,c.set(new Uint8Array(e.buffer,s,f),v),y+(f+4<<3)},r.F.getTrees=function(){for(var e=r.F.U,s=r.F._hufTree(e.lhst,e.ltree,15),f=r.F._hufTree(e.dhst,e.dtree,15),c=[],y=r.F._lenCodes(e.ltree,c),v=[],a=r.F._lenCodes(e.dtree,v),i=0;i<c.length;i+=2)e.ihst[c[i]]++;for(i=0;i<v.length;i+=2)e.ihst[v[i]]++;for(var n=r.F._hufTree(e.ihst,e.itree,7),o=19;o>4&&e.itree[1+(e.ordr[o-1]<<1)]==0;)o--;return[s,f,n,y,a,o,c,v]},r.F.getSecond=function(e){for(var s=[],f=0;f<e.length;f+=2)s.push(e[f+1]);return s},r.F.nonZero=function(e){for(var s="",f=0;f<e.length;f+=2)e[f+1]!=0&&(s+=(f>>1)+",");return s},r.F.contSize=function(e,s){for(var f=0,c=0;c<s.length;c++)f+=s[c]*e[1+(c<<1)];return f},r.F._codeTiny=function(e,s,f,c){for(var y=0;y<e.length;y+=2){var v=e[y],a=e[y+1];c=r.F._writeLit(v,s,f,c);var i=v==16?2:v==17?3:7;v>15&&(r.F._putsE(f,c,a,i),c+=i)}return c},r.F._lenCodes=function(e,s){for(var f=e.length;f!=2&&e[f-1]==0;)f-=2;for(var c=0;c<f;c+=2){var y=e[c+1],v=c+3<f?e[c+3]:-1,a=c+5<f?e[c+5]:-1,i=c==0?-1:e[c-1];if(y==0&&v==y&&a==y){for(var n=c+5;n+2<f&&e[n+2]==y;)n+=2;(o=Math.min(n+1-c>>>1,138))<11?s.push(17,o-3):s.push(18,o-11),c+=2*o-2}else if(y==i&&v==y&&a==y){for(n=c+5;n+2<f&&e[n+2]==y;)n+=2;var o=Math.min(n+1-c>>>1,6);s.push(16,o-3),c+=2*o-2}else s.push(y,0)}return f>>>1},r.F._hufTree=function(e,s,f){var c=[],y=e.length,v=s.length,a=0;for(a=0;a<v;a+=2)s[a]=0,s[a+1]=0;for(a=0;a<y;a++)e[a]!=0&&c.push({lit:a,f:e[a]});var i=c.length,n=c.slice(0);if(i==0)return 0;if(i==1){var o=c[0].lit;return n=o==0?1:0,s[1+(o<<1)]=1,s[1+(n<<1)]=1,1}c.sort((function(A,P){return A.f-P.f}));var g=c[0],N=c[1],E=0,j=1,F=2;for(c[0]={lit:-1,f:g.f+N.f,l:g,r:N,d:0};j!=i-1;)g=E!=j&&(F==i||c[E].f<c[F].f)?c[E++]:c[F++],N=E!=j&&(F==i||c[E].f<c[F].f)?c[E++]:c[F++],c[j++]={lit:-1,f:g.f+N.f,l:g,r:N};var U=r.F.setDepth(c[j-1],0);for(U>f&&(r.F.restrictDepth(n,f,U),U=f),a=0;a<i;a++)s[1+(n[a].lit<<1)]=n[a].d;return U},r.F.setDepth=function(e,s){return e.lit!=-1?(e.d=s,s):Math.max(r.F.setDepth(e.l,s+1),r.F.setDepth(e.r,s+1))},r.F.restrictDepth=function(e,s,f){var c=0,y=1<<f-s,v=0;for(e.sort((function(i,n){return n.d==i.d?i.f-n.f:n.d-i.d})),c=0;c<e.length&&e[c].d>s;c++){var a=e[c].d;e[c].d=s,v+=y-(1<<f-a)}for(v>>>=f-s;v>0;)(a=e[c].d)<s?(e[c].d++,v-=1<<s-a-1):c++;for(;c>=0;c--)e[c].d==s&&v<0&&(e[c].d--,v++);v!=0&&console.log("debt left")},r.F._goodIndex=function(e,s){var f=0;return s[16|f]<=e&&(f|=16),s[8|f]<=e&&(f|=8),s[4|f]<=e&&(f|=4),s[2|f]<=e&&(f|=2),s[1|f]<=e&&(f|=1),f},r.F._writeLit=function(e,s,f,c){return r.F._putsF(f,c,s[e<<1]),c+s[1+(e<<1)]},r.F.inflate=function(e,s){var f=Uint8Array;if(e[0]==3&&e[1]==0)return s||new f(0);var c=r.F,y=c._bitsF,v=c._bitsE,a=c._decodeTiny,i=c.makeCodes,n=c.codes2map,o=c._get17,g=c.U,N=s==null;N&&(s=new f(e.length>>>2<<3));for(var E,j,F=0,U=0,A=0,P=0,x=0,M=0,l=0,d=0,_=0;F==0;)if(F=y(e,_,1),U=y(e,_+1,2),_+=3,U!=0){if(N&&(s=r.F._check(s,d+(1<<17))),U==1&&(E=g.flmap,j=g.fdmap,M=511,l=31),U==2){A=v(e,_,5)+257,P=v(e,_+5,5)+1,x=v(e,_+10,4)+4,_+=14;for(var S=0;S<38;S+=2)g.itree[S]=0,g.itree[S+1]=0;var b=1;for(S=0;S<x;S++){var k=v(e,_+3*S,3);g.itree[1+(g.ordr[S]<<1)]=k,k>b&&(b=k)}_+=3*x,i(g.itree,b),n(g.itree,b,g.imap),E=g.lmap,j=g.dmap,_=a(g.imap,(1<<b)-1,A+P,e,_,g.ttree);var w=c._copyOut(g.ttree,0,A,g.ltree);M=(1<<w)-1;var L=c._copyOut(g.ttree,A,P,g.dtree);l=(1<<L)-1,i(g.ltree,w),n(g.ltree,w,E),i(g.dtree,L),n(g.dtree,L,j)}for(;;){var h=E[o(e,_)&M];_+=15&h;var u=h>>>4;if(!(u>>>8))s[d++]=u;else{if(u==256)break;var $=d+u-254;if(u>264){var I=g.ldef[u-257];$=d+(I>>>3)+v(e,_,7&I),_+=7&I}var H=j[o(e,_)&l];_+=15&H;var X=H>>>4,O=g.ddef[X],Y=(O>>>4)+y(e,_,15&O);for(_+=15&O,N&&(s=r.F._check(s,d+(1<<17)));d<$;)s[d]=s[d++-Y],s[d]=s[d++-Y],s[d]=s[d++-Y],s[d]=s[d++-Y];d=$}}}else{(7&_)!=0&&(_+=8-(7&_));var B=4+(_>>>3),R=e[B-4]|e[B-3]<<8;N&&(s=r.F._check(s,d+R)),s.set(new f(e.buffer,e.byteOffset+B,R),d),_=B+R<<3,d+=R}return s.length==d?s:s.slice(0,d)},r.F._check=function(e,s){var f=e.length;if(s<=f)return e;var c=new Uint8Array(Math.max(f<<1,s));return c.set(e,0),c},r.F._decodeTiny=function(e,s,f,c,y,v){for(var a=r.F._bitsE,i=r.F._get17,n=0;n<f;){var o=e[i(c,y)&s];y+=15&o;var g=o>>>4;if(g<=15)v[n]=g,n++;else{var N=0,E=0;g==16?(E=3+a(c,y,2),y+=2,N=v[n-1]):g==17?(E=3+a(c,y,3),y+=3):g==18&&(E=11+a(c,y,7),y+=7);for(var j=n+E;n<j;)v[n]=N,n++}}return y},r.F._copyOut=function(e,s,f,c){for(var y=0,v=0,a=c.length>>>1;v<f;){var i=e[v+s];c[v<<1]=0,c[1+(v<<1)]=i,i>y&&(y=i),v++}for(;v<a;)c[v<<1]=0,c[1+(v<<1)]=0,v++;return y},r.F.makeCodes=function(e,s){for(var f,c,y,v,a=r.F.U,i=e.length,n=a.bl_count,o=0;o<=s;o++)n[o]=0;for(o=1;o<i;o+=2)n[e[o]]++;var g=a.next_code;for(f=0,n[0]=0,c=1;c<=s;c++)f=f+n[c-1]<<1,g[c]=f;for(y=0;y<i;y+=2)(v=e[y+1])!=0&&(e[y]=g[v],g[v]++)},r.F.codes2map=function(e,s,f){for(var c=e.length,y=r.F.U.rev15,v=0;v<c;v+=2)if(e[v+1]!=0)for(var a=v>>1,i=e[v+1],n=a<<4|i,o=s-i,g=e[v]<<o,N=g+(1<<o);g!=N;)f[y[g]>>>15-s]=n,g++},r.F.revCodes=function(e,s){for(var f=r.F.U.rev15,c=15-s,y=0;y<e.length;y+=2){var v=e[y]<<s-e[y+1];e[y]=f[v]>>>c}},r.F._putsE=function(e,s,f){f<<=7&s;var c=s>>>3;e[c]|=f,e[c+1]|=f>>>8},r.F._putsF=function(e,s,f){f<<=7&s;var c=s>>>3;e[c]|=f,e[c+1]|=f>>>8,e[c+2]|=f>>>16},r.F._bitsE=function(e,s,f){return(e[s>>>3]|e[1+(s>>>3)]<<8)>>>(7&s)&(1<<f)-1},r.F._bitsF=function(e,s,f){return(e[s>>>3]|e[1+(s>>>3)]<<8|e[2+(s>>>3)]<<16)>>>(7&s)&(1<<f)-1},r.F._get17=function(e,s){return(e[s>>>3]|e[1+(s>>>3)]<<8|e[2+(s>>>3)]<<16)>>>(7&s)},r.F._get25=function(e,s){return(e[s>>>3]|e[1+(s>>>3)]<<8|e[2+(s>>>3)]<<16|e[3+(s>>>3)]<<24)>>>(7&s)},r.F.U=(p=Uint16Array,T=Uint32Array,{next_code:new p(16),bl_count:new p(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new p(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new T(32),flmap:new p(512),fltree:[],fdmap:new p(32),fdtree:[],lmap:new p(32768),ltree:[],ttree:[],dmap:new p(32768),dtree:[],imap:new p(512),itree:[],rev15:new p(32768),lhst:new T(286),dhst:new T(30),ihst:new T(19),lits:new T(15e3),strt:new p(65536),prev:new p(32768)}),(function(){for(var e=r.F.U,s=0;s<32768;s++){var f=s;f=(4278255360&(f=(4042322160&(f=(3435973836&(f=(2863311530&f)>>>1|(1431655765&f)<<1))>>>2|(858993459&f)<<2))>>>4|(252645135&f)<<4))>>>8|(16711935&f)<<8,e.rev15[s]=(f>>>16|f<<16)>>>17}function c(y,v,a){for(;v--!=0;)y.push(0,a)}for(s=0;s<32;s++)e.ldef[s]=e.of0[s]<<3|e.exb[s],e.ddef[s]=e.df0[s]<<4|e.dxb[s];c(e.fltree,144,8),c(e.fltree,112,9),c(e.fltree,24,7),c(e.fltree,8,8),r.F.makeCodes(e.fltree,9),r.F.codes2map(e.fltree,9,e.flmap),r.F.revCodes(e.fltree,9),c(e.fdtree,32,5),r.F.makeCodes(e.fdtree,5),r.F.codes2map(e.fdtree,5,e.fdmap),r.F.revCodes(e.fdtree,5),c(e.itree,19,0),c(e.ltree,286,0),c(e.dtree,30,0),c(e.ttree,320,0)})()})();var Hs=Rs({__proto__:null,default:Lt},[Lt]);const tt=(function(){var m={nextZero(a,i){for(;a[i]!=0;)i++;return i},readUshort:(a,i)=>a[i]<<8|a[i+1],writeUshort(a,i,n){a[i]=n>>8&255,a[i+1]=255&n},readUint:(a,i)=>16777216*a[i]+(a[i+1]<<16|a[i+2]<<8|a[i+3]),writeUint(a,i,n){a[i]=n>>24&255,a[i+1]=n>>16&255,a[i+2]=n>>8&255,a[i+3]=255&n},readASCII(a,i,n){let o="";for(let g=0;g<n;g++)o+=String.fromCharCode(a[i+g]);return o},writeASCII(a,i,n){for(let o=0;o<n.length;o++)a[i+o]=n.charCodeAt(o)},readBytes(a,i,n){const o=[];for(let g=0;g<n;g++)o.push(a[i+g]);return o},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,i,n){let o,g="";for(let N=0;N<n;N++)g+=`%${m.pad(a[i+N].toString(16))}`;try{o=decodeURIComponent(g)}catch{return m.readASCII(a,i,n)}return o}};function p(a,i,n,o){const g=i*n,N=s(o),E=Math.ceil(i*N/8),j=new Uint8Array(4*g),F=new Uint32Array(j.buffer),{ctype:U}=o,{depth:A}=o,P=m.readUshort;if(U==6){const I=g<<2;if(A==8)for(var x=0;x<I;x+=4)j[x]=a[x],j[x+1]=a[x+1],j[x+2]=a[x+2],j[x+3]=a[x+3];if(A==16)for(x=0;x<I;x++)j[x]=a[x<<1]}else if(U==2){const I=o.tabs.tRNS;if(I==null){if(A==8)for(x=0;x<g;x++){var M=3*x;F[x]=255<<24|a[M+2]<<16|a[M+1]<<8|a[M]}if(A==16)for(x=0;x<g;x++)M=6*x,F[x]=255<<24|a[M+4]<<16|a[M+2]<<8|a[M]}else{var l=I[0];const H=I[1],X=I[2];if(A==8)for(x=0;x<g;x++){var d=x<<2;M=3*x,F[x]=255<<24|a[M+2]<<16|a[M+1]<<8|a[M],a[M]==l&&a[M+1]==H&&a[M+2]==X&&(j[d+3]=0)}if(A==16)for(x=0;x<g;x++)d=x<<2,M=6*x,F[x]=255<<24|a[M+4]<<16|a[M+2]<<8|a[M],P(a,M)==l&&P(a,M+2)==H&&P(a,M+4)==X&&(j[d+3]=0)}}else if(U==3){const I=o.tabs.PLTE,H=o.tabs.tRNS,X=H?H.length:0;if(A==1)for(var _=0;_<n;_++){var S=_*E,b=_*i;for(x=0;x<i;x++){d=b+x<<2;var k=3*(w=a[S+(x>>3)]>>7-((7&x)<<0)&1);j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255}}if(A==2)for(_=0;_<n;_++)for(S=_*E,b=_*i,x=0;x<i;x++)d=b+x<<2,k=3*(w=a[S+(x>>2)]>>6-((3&x)<<1)&3),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255;if(A==4)for(_=0;_<n;_++)for(S=_*E,b=_*i,x=0;x<i;x++)d=b+x<<2,k=3*(w=a[S+(x>>1)]>>4-((1&x)<<2)&15),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255;if(A==8)for(x=0;x<g;x++){var w;d=x<<2,k=3*(w=a[x]),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255}}else if(U==4){if(A==8)for(x=0;x<g;x++){d=x<<2;var L=a[h=x<<1];j[d]=L,j[d+1]=L,j[d+2]=L,j[d+3]=a[h+1]}if(A==16)for(x=0;x<g;x++){var h;d=x<<2,L=a[h=x<<2],j[d]=L,j[d+1]=L,j[d+2]=L,j[d+3]=a[h+2]}}else if(U==0)for(l=o.tabs.tRNS?o.tabs.tRNS:-1,_=0;_<n;_++){const I=_*E,H=_*i;if(A==1)for(var u=0;u<i;u++){var $=(L=255*(a[I+(u>>>3)]>>>7-(7&u)&1))==255*l?0:255;F[H+u]=$<<24|L<<16|L<<8|L}else if(A==2)for(u=0;u<i;u++)$=(L=85*(a[I+(u>>>2)]>>>6-((3&u)<<1)&3))==85*l?0:255,F[H+u]=$<<24|L<<16|L<<8|L;else if(A==4)for(u=0;u<i;u++)$=(L=17*(a[I+(u>>>1)]>>>4-((1&u)<<2)&15))==17*l?0:255,F[H+u]=$<<24|L<<16|L<<8|L;else if(A==8)for(u=0;u<i;u++)$=(L=a[I+u])==l?0:255,F[H+u]=$<<24|L<<16|L<<8|L;else if(A==16)for(u=0;u<i;u++)L=a[I+(u<<1)],$=P(a,I+(u<<1))==l?0:255,F[H+u]=$<<24|L<<16|L<<8|L}return j}function T(a,i,n,o){const g=s(a),N=Math.ceil(n*g/8),E=new Uint8Array((N+1+a.interlace)*o);return i=a.tabs.CgBI?e(i,E):r(i,E),a.interlace==0?i=f(i,a,0,n,o):a.interlace==1&&(i=(function(F,U){const A=U.width,P=U.height,x=s(U),M=x>>3,l=Math.ceil(A*x/8),d=new Uint8Array(P*l);let _=0;const S=[0,0,4,0,2,0,1],b=[0,4,0,2,0,1,0],k=[8,8,8,4,4,2,2],w=[8,8,4,4,2,2,1];let L=0;for(;L<7;){const u=k[L],$=w[L];let I=0,H=0,X=S[L];for(;X<P;)X+=u,H++;let O=b[L];for(;O<A;)O+=$,I++;const Y=Math.ceil(I*x/8);f(F,U,_,I,H);let B=0,R=S[L];for(;R<P;){let re=b[L],xe=_+B*Y<<3;for(;re<A;){var h;if(x==1&&(h=(h=F[xe>>3])>>7-(7&xe)&1,d[R*l+(re>>3)]|=h<<7-((7&re)<<0)),x==2&&(h=(h=F[xe>>3])>>6-(7&xe)&3,d[R*l+(re>>2)]|=h<<6-((3&re)<<1)),x==4&&(h=(h=F[xe>>3])>>4-(7&xe)&15,d[R*l+(re>>1)]|=h<<4-((1&re)<<2)),x>=8){const ue=R*l+re*M;for(let oe=0;oe<M;oe++)d[ue+oe]=F[(xe>>3)+oe]}xe+=x,re+=$}B++,R+=u}I*H!=0&&(_+=H*(1+Y)),L+=1}return d})(i,a)),i}function r(a,i){return e(new Uint8Array(a.buffer,2,a.length-6),i)}var e=(function(){const a={H:{}};return a.H.N=function(i,n){const o=Uint8Array;let g,N,E=0,j=0,F=0,U=0,A=0,P=0,x=0,M=0,l=0;if(i[0]==3&&i[1]==0)return n||new o(0);const d=a.H,_=d.b,S=d.e,b=d.R,k=d.n,w=d.A,L=d.Z,h=d.m,u=n==null;for(u&&(n=new o(i.length>>>2<<5));E==0;)if(E=_(i,l,1),j=_(i,l+1,2),l+=3,j!=0){if(u&&(n=a.H.W(n,M+(1<<17))),j==1&&(g=h.J,N=h.h,P=511,x=31),j==2){F=S(i,l,5)+257,U=S(i,l+5,5)+1,A=S(i,l+10,4)+4,l+=14;let I=1;for(var $=0;$<38;$+=2)h.Q[$]=0,h.Q[$+1]=0;for($=0;$<A;$++){const O=S(i,l+3*$,3);h.Q[1+(h.X[$]<<1)]=O,O>I&&(I=O)}l+=3*A,k(h.Q,I),w(h.Q,I,h.u),g=h.w,N=h.d,l=b(h.u,(1<<I)-1,F+U,i,l,h.v);const H=d.V(h.v,0,F,h.C);P=(1<<H)-1;const X=d.V(h.v,F,U,h.D);x=(1<<X)-1,k(h.C,H),w(h.C,H,g),k(h.D,X),w(h.D,X,N)}for(;;){const I=g[L(i,l)&P];l+=15&I;const H=I>>>4;if(!(H>>>8))n[M++]=H;else{if(H==256)break;{let X=M+H-254;if(H>264){const re=h.q[H-257];X=M+(re>>>3)+S(i,l,7&re),l+=7&re}const O=N[L(i,l)&x];l+=15&O;const Y=O>>>4,B=h.c[Y],R=(B>>>4)+_(i,l,15&B);for(l+=15&B;M<X;)n[M]=n[M++-R],n[M]=n[M++-R],n[M]=n[M++-R],n[M]=n[M++-R];M=X}}}}else{(7&l)!=0&&(l+=8-(7&l));const I=4+(l>>>3),H=i[I-4]|i[I-3]<<8;u&&(n=a.H.W(n,M+H)),n.set(new o(i.buffer,i.byteOffset+I,H),M),l=I+H<<3,M+=H}return n.length==M?n:n.slice(0,M)},a.H.W=function(i,n){const o=i.length;if(n<=o)return i;const g=new Uint8Array(o<<1);return g.set(i,0),g},a.H.R=function(i,n,o,g,N,E){const j=a.H.e,F=a.H.Z;let U=0;for(;U<o;){const A=i[F(g,N)&n];N+=15&A;const P=A>>>4;if(P<=15)E[U]=P,U++;else{let x=0,M=0;P==16?(M=3+j(g,N,2),N+=2,x=E[U-1]):P==17?(M=3+j(g,N,3),N+=3):P==18&&(M=11+j(g,N,7),N+=7);const l=U+M;for(;U<l;)E[U]=x,U++}}return N},a.H.V=function(i,n,o,g){let N=0,E=0;const j=g.length>>>1;for(;E<o;){const F=i[E+n];g[E<<1]=0,g[1+(E<<1)]=F,F>N&&(N=F),E++}for(;E<j;)g[E<<1]=0,g[1+(E<<1)]=0,E++;return N},a.H.n=function(i,n){const o=a.H.m,g=i.length;let N,E,j,F;const U=o.j;for(var A=0;A<=n;A++)U[A]=0;for(A=1;A<g;A+=2)U[i[A]]++;const P=o.K;for(N=0,U[0]=0,E=1;E<=n;E++)N=N+U[E-1]<<1,P[E]=N;for(j=0;j<g;j+=2)F=i[j+1],F!=0&&(i[j]=P[F],P[F]++)},a.H.A=function(i,n,o){const g=i.length,N=a.H.m.r;for(let E=0;E<g;E+=2)if(i[E+1]!=0){const j=E>>1,F=i[E+1],U=j<<4|F,A=n-F;let P=i[E]<<A;const x=P+(1<<A);for(;P!=x;)o[N[P]>>>15-n]=U,P++}},a.H.l=function(i,n){const o=a.H.m.r,g=15-n;for(let N=0;N<i.length;N+=2){const E=i[N]<<n-i[N+1];i[N]=o[E]>>>g}},a.H.M=function(i,n,o){o<<=7&n;const g=n>>>3;i[g]|=o,i[g+1]|=o>>>8},a.H.I=function(i,n,o){o<<=7&n;const g=n>>>3;i[g]|=o,i[g+1]|=o>>>8,i[g+2]|=o>>>16},a.H.e=function(i,n,o){return(i[n>>>3]|i[1+(n>>>3)]<<8)>>>(7&n)&(1<<o)-1},a.H.b=function(i,n,o){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)&(1<<o)-1},a.H.Z=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)},a.H.i=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16|i[3+(n>>>3)]<<24)>>>(7&n)},a.H.m=(function(){const i=Uint16Array,n=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=a.H.m;for(var n=0;n<32768;n++){let g=n;g=(2863311530&g)>>>1|(1431655765&g)<<1,g=(3435973836&g)>>>2|(858993459&g)<<2,g=(4042322160&g)>>>4|(252645135&g)<<4,g=(4278255360&g)>>>8|(16711935&g)<<8,i.r[n]=(g>>>16|g<<16)>>>17}function o(g,N,E){for(;N--!=0;)g.push(0,E)}for(n=0;n<32;n++)i.q[n]=i.S[n]<<3|i.T[n],i.c[n]=i.p[n]<<4|i.z[n];o(i._,144,8),o(i._,112,9),o(i._,24,7),o(i._,8,8),a.H.n(i._,9),a.H.A(i._,9,i.J),a.H.l(i._,9),o(i.$,32,5),a.H.n(i.$,5),a.H.A(i.$,5,i.h),a.H.l(i.$,5),o(i.Q,19,0),o(i.C,286,0),o(i.D,30,0),o(i.v,320,0)})(),a.H.N})();function s(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function f(a,i,n,o,g){let N=s(i);const E=Math.ceil(o*N/8);let j,F;N=Math.ceil(N/8);let U=a[n],A=0;if(U>1&&(a[n]=[0,0,1][U-2]),U==3)for(A=N;A<E;A++)a[A+1]=a[A+1]+(a[A+1-N]>>>1)&255;for(let P=0;P<g;P++)if(j=n+P*E,F=j+P+1,U=a[F-1],A=0,U==0)for(;A<E;A++)a[j+A]=a[F+A];else if(U==1){for(;A<N;A++)a[j+A]=a[F+A];for(;A<E;A++)a[j+A]=a[F+A]+a[j+A-N]}else if(U==2)for(;A<E;A++)a[j+A]=a[F+A]+a[j+A-E];else if(U==3){for(;A<N;A++)a[j+A]=a[F+A]+(a[j+A-E]>>>1);for(;A<E;A++)a[j+A]=a[F+A]+(a[j+A-E]+a[j+A-N]>>>1)}else{for(;A<N;A++)a[j+A]=a[F+A]+c(0,a[j+A-E],0);for(;A<E;A++)a[j+A]=a[F+A]+c(a[j+A-N],a[j+A-E],a[j+A-N-E])}return a}function c(a,i,n){const o=a+i-n,g=o-a,N=o-i,E=o-n;return g*g<=N*N&&g*g<=E*E?a:N*N<=E*E?i:n}function y(a,i,n){n.width=m.readUint(a,i),i+=4,n.height=m.readUint(a,i),i+=4,n.depth=a[i],i++,n.ctype=a[i],i++,n.compress=a[i],i++,n.filter=a[i],i++,n.interlace=a[i],i++}function v(a,i,n,o,g,N,E,j,F){const U=Math.min(i,g),A=Math.min(n,N);let P=0,x=0;for(let L=0;L<A;L++)for(let h=0;h<U;h++)if(E>=0&&j>=0?(P=L*i+h<<2,x=(j+L)*g+E+h<<2):(P=(-j+L)*i-E+h<<2,x=L*g+h<<2),F==0)o[x]=a[P],o[x+1]=a[P+1],o[x+2]=a[P+2],o[x+3]=a[P+3];else if(F==1){var M=a[P+3]*.00392156862745098,l=a[P]*M,d=a[P+1]*M,_=a[P+2]*M,S=o[x+3]*(1/255),b=o[x]*S,k=o[x+1]*S,w=o[x+2]*S;const u=1-M,$=M+S*u,I=$==0?0:1/$;o[x+3]=255*$,o[x+0]=(l+b*u)*I,o[x+1]=(d+k*u)*I,o[x+2]=(_+w*u)*I}else if(F==2)M=a[P+3],l=a[P],d=a[P+1],_=a[P+2],S=o[x+3],b=o[x],k=o[x+1],w=o[x+2],M==S&&l==b&&d==k&&_==w?(o[x]=0,o[x+1]=0,o[x+2]=0,o[x+3]=0):(o[x]=l,o[x+1]=d,o[x+2]=_,o[x+3]=M);else if(F==3){if(M=a[P+3],l=a[P],d=a[P+1],_=a[P+2],S=o[x+3],b=o[x],k=o[x+1],w=o[x+2],M==S&&l==b&&d==k&&_==w)continue;if(M<220&&S>20)return!1}return!0}return{decode:function(i){const n=new Uint8Array(i);let o=8;const g=m,N=g.readUshort,E=g.readUint,j={tabs:{},frames:[]},F=new Uint8Array(n.length);let U,A=0,P=0;const x=[137,80,78,71,13,10,26,10];for(var M=0;M<8;M++)if(n[M]!=x[M])throw"The input is not a PNG file!";for(;o<n.length;){const L=g.readUint(n,o);o+=4;const h=g.readASCII(n,o,4);if(o+=4,h=="IHDR")y(n,o,j);else if(h=="iCCP"){for(var l=o;n[l]!=0;)l++;g.readASCII(n,o,l-o),n[l+1];const u=n.slice(l+2,o+L);let $=null;try{$=r(u)}catch{$=e(u)}j.tabs[h]=$}else if(h=="CgBI")j.tabs[h]=n.slice(o,o+4);else if(h=="IDAT"){for(M=0;M<L;M++)F[A+M]=n[o+M];A+=L}else if(h=="acTL")j.tabs[h]={num_frames:E(n,o),num_plays:E(n,o+4)},U=new Uint8Array(n.length);else if(h=="fcTL"){P!=0&&((w=j.frames[j.frames.length-1]).data=T(j,U.slice(0,P),w.rect.width,w.rect.height),P=0);const u={x:E(n,o+12),y:E(n,o+16),width:E(n,o+4),height:E(n,o+8)};let $=N(n,o+22);$=N(n,o+20)/($==0?100:$);const I={rect:u,delay:Math.round(1e3*$),dispose:n[o+24],blend:n[o+25]};j.frames.push(I)}else if(h=="fdAT"){for(M=0;M<L-4;M++)U[P+M]=n[o+M+4];P+=L-4}else if(h=="pHYs")j.tabs[h]=[g.readUint(n,o),g.readUint(n,o+4),n[o+8]];else if(h=="cHRM")for(j.tabs[h]=[],M=0;M<8;M++)j.tabs[h].push(g.readUint(n,o+4*M));else if(h=="tEXt"||h=="zTXt"){j.tabs[h]==null&&(j.tabs[h]={});var d=g.nextZero(n,o),_=g.readASCII(n,o,d-o),S=o+L-d-1;if(h=="tEXt")k=g.readASCII(n,d+1,S);else{var b=r(n.slice(d+2,d+2+S));k=g.readUTF8(b,0,b.length)}j.tabs[h][_]=k}else if(h=="iTXt"){j.tabs[h]==null&&(j.tabs[h]={}),d=0,l=o,d=g.nextZero(n,l),_=g.readASCII(n,l,d-l);const u=n[l=d+1];var k;n[l+1],l+=2,d=g.nextZero(n,l),g.readASCII(n,l,d-l),l=d+1,d=g.nextZero(n,l),g.readUTF8(n,l,d-l),S=L-((l=d+1)-o),u==0?k=g.readUTF8(n,l,S):(b=r(n.slice(l,l+S)),k=g.readUTF8(b,0,b.length)),j.tabs[h][_]=k}else if(h=="PLTE")j.tabs[h]=g.readBytes(n,o,L);else if(h=="hIST"){const u=j.tabs.PLTE.length/3;for(j.tabs[h]=[],M=0;M<u;M++)j.tabs[h].push(N(n,o+2*M))}else if(h=="tRNS")j.ctype==3?j.tabs[h]=g.readBytes(n,o,L):j.ctype==0?j.tabs[h]=N(n,o):j.ctype==2&&(j.tabs[h]=[N(n,o),N(n,o+2),N(n,o+4)]);else if(h=="gAMA")j.tabs[h]=g.readUint(n,o)/1e5;else if(h=="sRGB")j.tabs[h]=n[o];else if(h=="bKGD")j.ctype==0||j.ctype==4?j.tabs[h]=[N(n,o)]:j.ctype==2||j.ctype==6?j.tabs[h]=[N(n,o),N(n,o+2),N(n,o+4)]:j.ctype==3&&(j.tabs[h]=n[o]);else if(h=="IEND")break;o+=L,g.readUint(n,o),o+=4}var w;return P!=0&&((w=j.frames[j.frames.length-1]).data=T(j,U.slice(0,P),w.rect.width,w.rect.height)),j.data=T(j,F,j.width,j.height),delete j.compress,delete j.interlace,delete j.filter,j},toRGBA8:function(i){const n=i.width,o=i.height;if(i.tabs.acTL==null)return[p(i.data,n,o,i).buffer];const g=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const N=n*o*4,E=new Uint8Array(N),j=new Uint8Array(N),F=new Uint8Array(N);for(let A=0;A<i.frames.length;A++){const P=i.frames[A],x=P.rect.x,M=P.rect.y,l=P.rect.width,d=P.rect.height,_=p(P.data,l,d,i);if(A!=0)for(var U=0;U<N;U++)F[U]=E[U];if(P.blend==0?v(_,l,d,E,n,o,x,M,0):P.blend==1&&v(_,l,d,E,n,o,x,M,1),g.push(E.buffer.slice(0)),P.dispose!=0){if(P.dispose==1)v(j,l,d,E,n,o,x,M,0);else if(P.dispose==2)for(U=0;U<N;U++)E[U]=F[U]}}return g},_paeth:c,_copyTile:v,_bin:m}})();(function(){const{_copyTile:m}=tt,{_bin:p}=tt,T=tt._paeth;var r={table:(function(){const l=new Uint32Array(256);for(let d=0;d<256;d++){let _=d;for(let S=0;S<8;S++)1&_?_=3988292384^_>>>1:_>>>=1;l[d]=_}return l})(),update(l,d,_,S){for(let b=0;b<S;b++)l=r.table[255&(l^d[_+b])]^l>>>8;return l},crc:(l,d,_)=>4294967295^r.update(4294967295,l,d,_)};function e(l,d,_,S){d[_]+=l[0]*S>>4,d[_+1]+=l[1]*S>>4,d[_+2]+=l[2]*S>>4,d[_+3]+=l[3]*S>>4}function s(l){return Math.max(0,Math.min(255,l))}function f(l,d){const _=l[0]-d[0],S=l[1]-d[1],b=l[2]-d[2],k=l[3]-d[3];return _*_+S*S+b*b+k*k}function c(l,d,_,S,b,k,w){w==null&&(w=1);const L=S.length,h=[];for(var u=0;u<L;u++){const R=S[u];h.push([R>>>0&255,R>>>8&255,R>>>16&255,R>>>24&255])}for(u=0;u<L;u++){let R=4294967295;for(var $=0,I=0;I<L;I++){var H=f(h[u],h[I]);I!=u&&H<R&&(R=H,$=I)}}const X=new Uint32Array(b.buffer),O=new Int16Array(d*_*4),Y=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<Y.length;u++)Y[u]=255*((Y[u]+.5)/16-.5);for(let R=0;R<_;R++)for(let re=0;re<d;re++){var B;u=4*(R*d+re),w!=2?B=[s(l[u]+O[u]),s(l[u+1]+O[u+1]),s(l[u+2]+O[u+2]),s(l[u+3]+O[u+3])]:(H=Y[4*(3&R)+(3&re)],B=[s(l[u]+H),s(l[u+1]+H),s(l[u+2]+H),s(l[u+3]+H)]),$=0;let xe=16777215;for(I=0;I<L;I++){const pe=f(B,h[I]);pe<xe&&(xe=pe,$=I)}const ue=h[$],oe=[B[0]-ue[0],B[1]-ue[1],B[2]-ue[2],B[3]-ue[3]];w==1&&(re!=d-1&&e(oe,O,u+4,7),R!=_-1&&(re!=0&&e(oe,O,u+4*d-4,3),e(oe,O,u+4*d,5),re!=d-1&&e(oe,O,u+4*d+4,1))),k[u>>2]=$,X[u>>2]=S[$]}}function y(l,d,_,S,b){b==null&&(b={});const{crc:k}=r,w=p.writeUint,L=p.writeUshort,h=p.writeASCII;let u=8;const $=l.frames.length>1;let I,H=!1,X=33+($?20:0);if(b.sRGB!=null&&(X+=13),b.pHYs!=null&&(X+=21),b.iCCP!=null&&(I=pako.deflate(b.iCCP),X+=21+I.length+4),l.ctype==3){for(var O=l.plte.length,Y=0;Y<O;Y++)l.plte[Y]>>>24!=255&&(H=!0);X+=8+3*O+4+(H?8+1*O+4:0)}for(var B=0;B<l.frames.length;B++)$&&(X+=38),X+=(ue=l.frames[B]).cimg.length+12,B!=0&&(X+=4);X+=12;const R=new Uint8Array(X),re=[137,80,78,71,13,10,26,10];for(Y=0;Y<8;Y++)R[Y]=re[Y];if(w(R,u,13),u+=4,h(R,u,"IHDR"),u+=4,w(R,u,d),u+=4,w(R,u,_),u+=4,R[u]=l.depth,u++,R[u]=l.ctype,u++,R[u]=0,u++,R[u]=0,u++,R[u]=0,u++,w(R,u,k(R,u-17,17)),u+=4,b.sRGB!=null&&(w(R,u,1),u+=4,h(R,u,"sRGB"),u+=4,R[u]=b.sRGB,u++,w(R,u,k(R,u-5,5)),u+=4),b.iCCP!=null){const oe=13+I.length;w(R,u,oe),u+=4,h(R,u,"iCCP"),u+=4,h(R,u,"ICC profile"),u+=11,u+=2,R.set(I,u),u+=I.length,w(R,u,k(R,u-(oe+4),oe+4)),u+=4}if(b.pHYs!=null&&(w(R,u,9),u+=4,h(R,u,"pHYs"),u+=4,w(R,u,b.pHYs[0]),u+=4,w(R,u,b.pHYs[1]),u+=4,R[u]=b.pHYs[2],u++,w(R,u,k(R,u-13,13)),u+=4),$&&(w(R,u,8),u+=4,h(R,u,"acTL"),u+=4,w(R,u,l.frames.length),u+=4,w(R,u,b.loop!=null?b.loop:0),u+=4,w(R,u,k(R,u-12,12)),u+=4),l.ctype==3){for(w(R,u,3*(O=l.plte.length)),u+=4,h(R,u,"PLTE"),u+=4,Y=0;Y<O;Y++){const oe=3*Y,pe=l.plte[Y],he=255&pe,Le=pe>>>8&255,qe=pe>>>16&255;R[u+oe+0]=he,R[u+oe+1]=Le,R[u+oe+2]=qe}if(u+=3*O,w(R,u,k(R,u-3*O-4,3*O+4)),u+=4,H){for(w(R,u,O),u+=4,h(R,u,"tRNS"),u+=4,Y=0;Y<O;Y++)R[u+Y]=l.plte[Y]>>>24&255;u+=O,w(R,u,k(R,u-O-4,O+4)),u+=4}}let xe=0;for(B=0;B<l.frames.length;B++){var ue=l.frames[B];$&&(w(R,u,26),u+=4,h(R,u,"fcTL"),u+=4,w(R,u,xe++),u+=4,w(R,u,ue.rect.width),u+=4,w(R,u,ue.rect.height),u+=4,w(R,u,ue.rect.x),u+=4,w(R,u,ue.rect.y),u+=4,L(R,u,S[B]),u+=2,L(R,u,1e3),u+=2,R[u]=ue.dispose,u++,R[u]=ue.blend,u++,w(R,u,k(R,u-30,30)),u+=4);const oe=ue.cimg;w(R,u,(O=oe.length)+(B==0?0:4)),u+=4;const pe=u;h(R,u,B==0?"IDAT":"fdAT"),u+=4,B!=0&&(w(R,u,xe++),u+=4),R.set(oe,u),u+=O,w(R,u,k(R,pe,u-pe)),u+=4}return w(R,u,0),u+=4,h(R,u,"IEND"),u+=4,w(R,u,k(R,u-4,4)),u+=4,R.buffer}function v(l,d,_){for(let S=0;S<l.frames.length;S++){const b=l.frames[S];b.rect.width;const k=b.rect.height,w=new Uint8Array(k*b.bpl+k);b.cimg=o(b.img,k,b.bpp,b.bpl,w,d,_)}}function a(l,d,_,S,b){const k=b[0],w=b[1],L=b[2],h=b[3],u=b[4],$=b[5];let I=6,H=8,X=255;for(var O=0;O<l.length;O++){const Ue=new Uint8Array(l[O]);for(var Y=Ue.length,B=0;B<Y;B+=4)X&=Ue[B+3]}const R=X!=255,re=(function(be,ge,Ee,Fe,we,He){const Ce=[];for(var ye=0;ye<be.length;ye++){const Ie=new Uint8Array(be[ye]),Ge=new Uint32Array(Ie.buffer);var Re;let De=0,Xe=0,Qe=ge,Je=Ee,ft=Fe?1:0;if(ye!=0){const pt=He||Fe||ye==1||Ce[ye-2].dispose!=0?1:2;let bt=0,We=1e9;for(let mt=0;mt<pt;mt++){var Ke=new Uint8Array(be[ye-1-mt]);const at=new Uint32Array(be[ye-1-mt]);let rt=ge,et=Ee,it=-1,ht=-1;for(let ot=0;ot<Ee;ot++)for(let lt=0;lt<ge;lt++)Ge[Te=ot*ge+lt]!=at[Te]&&(lt<rt&&(rt=lt),lt>it&&(it=lt),ot<et&&(et=ot),ot>ht&&(ht=ot));it==-1&&(rt=et=it=ht=0),we&&((1&rt)==1&&rt--,(1&et)==1&&et--);const jt=(it-rt+1)*(ht-et+1);jt<We&&(We=jt,bt=mt,De=rt,Xe=et,Qe=it-rt+1,Je=ht-et+1)}Ke=new Uint8Array(be[ye-1-bt]),bt==1&&(Ce[ye-1].dispose=2),Re=new Uint8Array(Qe*Je*4),m(Ke,ge,Ee,Re,Qe,Je,-De,-Xe,0),ft=m(Ie,ge,Ee,Re,Qe,Je,-De,-Xe,3)?1:0,ft==1?n(Ie,ge,Ee,Re,{x:De,y:Xe,width:Qe,height:Je}):m(Ie,ge,Ee,Re,Qe,Je,-De,-Xe,0)}else Re=Ie.slice(0);Ce.push({rect:{x:De,y:Xe,width:Qe,height:Je},img:Re,blend:ft,dispose:0})}if(Fe)for(ye=0;ye<Ce.length;ye++){if((st=Ce[ye]).blend==1)continue;const Ie=st.rect,Ge=Ce[ye-1].rect,De=Math.min(Ie.x,Ge.x),Xe=Math.min(Ie.y,Ge.y),Qe={x:De,y:Xe,width:Math.max(Ie.x+Ie.width,Ge.x+Ge.width)-De,height:Math.max(Ie.y+Ie.height,Ge.y+Ge.height)-Xe};Ce[ye-1].dispose=1,ye-1!=0&&i(be,ge,Ee,Ce,ye-1,Qe,we),i(be,ge,Ee,Ce,ye,Qe,we)}let ut=0;if(be.length!=1)for(var Te=0;Te<Ce.length;Te++){var st;ut+=(st=Ce[Te]).rect.width*st.rect.height}return Ce})(l,d,_,k,w,L),xe={},ue=[],oe=[];if(S!=0){const Ue=[];for(B=0;B<re.length;B++)Ue.push(re[B].img.buffer);const be=(function(we){let He=0;for(var Ce=0;Ce<we.length;Ce++)He+=we[Ce].byteLength;const ye=new Uint8Array(He);let Re=0;for(Ce=0;Ce<we.length;Ce++){const Ke=new Uint8Array(we[Ce]),ut=Ke.length;for(let Te=0;Te<ut;Te+=4){let st=Ke[Te],Ie=Ke[Te+1],Ge=Ke[Te+2];const De=Ke[Te+3];De==0&&(st=Ie=Ge=0),ye[Re+Te]=st,ye[Re+Te+1]=Ie,ye[Re+Te+2]=Ge,ye[Re+Te+3]=De}Re+=ut}return ye.buffer})(Ue),ge=N(be,S);for(B=0;B<ge.plte.length;B++)ue.push(ge.plte[B].est.rgba);let Ee=0;for(B=0;B<re.length;B++){const Fe=(he=re[B]).img.length;var pe=new Uint8Array(ge.inds.buffer,Ee>>2,Fe>>2);oe.push(pe);const we=new Uint8Array(ge.abuf,Ee,Fe);$&&c(he.img,he.rect.width,he.rect.height,ue,we,pe),he.img.set(we),Ee+=Fe}}else for(O=0;O<re.length;O++){var he=re[O];const Ue=new Uint32Array(he.img.buffer);var Le=he.rect.width;for(Y=Ue.length,pe=new Uint8Array(Y),oe.push(pe),B=0;B<Y;B++){const be=Ue[B];if(B!=0&&be==Ue[B-1])pe[B]=pe[B-1];else if(B>Le&&be==Ue[B-Le])pe[B]=pe[B-Le];else{let ge=xe[be];if(ge==null&&(xe[be]=ge=ue.length,ue.push(be),ue.length>=300))break;pe[B]=ge}}}const qe=ue.length;for(qe<=256&&u==0&&(H=qe<=2?1:qe<=4?2:qe<=16?4:8,H=Math.max(H,h)),O=0;O<re.length;O++){(he=re[O]).rect.x,he.rect.y,Le=he.rect.width;const Ue=he.rect.height;let be=he.img;new Uint32Array(be.buffer);let ge=4*Le,Ee=4;if(qe<=256&&u==0){ge=Math.ceil(H*Le/8);var Ye=new Uint8Array(ge*Ue);const Fe=oe[O];for(let we=0;we<Ue;we++){B=we*ge;const He=we*Le;if(H==8)for(var _e=0;_e<Le;_e++)Ye[B+_e]=Fe[He+_e];else if(H==4)for(_e=0;_e<Le;_e++)Ye[B+(_e>>1)]|=Fe[He+_e]<<4-4*(1&_e);else if(H==2)for(_e=0;_e<Le;_e++)Ye[B+(_e>>2)]|=Fe[He+_e]<<6-2*(3&_e);else if(H==1)for(_e=0;_e<Le;_e++)Ye[B+(_e>>3)]|=Fe[He+_e]<<7-1*(7&_e)}be=Ye,I=3,Ee=1}else if(R==0&&re.length==1){Ye=new Uint8Array(Le*Ue*3);const Fe=Le*Ue;for(B=0;B<Fe;B++){const we=3*B,He=4*B;Ye[we]=be[He],Ye[we+1]=be[He+1],Ye[we+2]=be[He+2]}be=Ye,I=2,Ee=3,ge=3*Le}he.img=be,he.bpl=ge,he.bpp=Ee}return{ctype:I,depth:H,plte:ue,frames:re}}function i(l,d,_,S,b,k,w){const L=Uint8Array,h=Uint32Array,u=new L(l[b-1]),$=new h(l[b-1]),I=b+1<l.length?new L(l[b+1]):null,H=new L(l[b]),X=new h(H.buffer);let O=d,Y=_,B=-1,R=-1;for(let xe=0;xe<k.height;xe++)for(let ue=0;ue<k.width;ue++){const oe=k.x+ue,pe=k.y+xe,he=pe*d+oe,Le=X[he];Le==0||S[b-1].dispose==0&&$[he]==Le&&(I==null||I[4*he+3]!=0)||(oe<O&&(O=oe),oe>B&&(B=oe),pe<Y&&(Y=pe),pe>R&&(R=pe))}B==-1&&(O=Y=B=R=0),w&&((1&O)==1&&O--,(1&Y)==1&&Y--),k={x:O,y:Y,width:B-O+1,height:R-Y+1};const re=S[b];re.rect=k,re.blend=1,re.img=new Uint8Array(k.width*k.height*4),S[b-1].dispose==0?(m(u,d,_,re.img,k.width,k.height,-k.x,-k.y,0),n(H,d,_,re.img,k)):m(H,d,_,re.img,k.width,k.height,-k.x,-k.y,0)}function n(l,d,_,S,b){m(l,d,_,S,b.width,b.height,-b.x,-b.y,2)}function o(l,d,_,S,b,k,w){const L=[];let h,u=[0,1,2,3,4];k!=-1?u=[k]:(d*S>5e5||_==1)&&(u=[0]),w&&(h={level:0});const $=Hs;for(var I=0;I<u.length;I++){for(let O=0;O<d;O++)g(b,l,O,S,_,u[I]);L.push($.deflate(b,h))}let H,X=1e9;for(I=0;I<L.length;I++)L[I].length<X&&(H=I,X=L[I].length);return L[H]}function g(l,d,_,S,b,k){const w=_*S;let L=w+_;if(l[L]=k,L++,k==0)if(S<500)for(var h=0;h<S;h++)l[L+h]=d[w+h];else l.set(new Uint8Array(d.buffer,w,S),L);else if(k==1){for(h=0;h<b;h++)l[L+h]=d[w+h];for(h=b;h<S;h++)l[L+h]=d[w+h]-d[w+h-b]+256&255}else if(_==0){for(h=0;h<b;h++)l[L+h]=d[w+h];if(k==2)for(h=b;h<S;h++)l[L+h]=d[w+h];if(k==3)for(h=b;h<S;h++)l[L+h]=d[w+h]-(d[w+h-b]>>1)+256&255;if(k==4)for(h=b;h<S;h++)l[L+h]=d[w+h]-T(d[w+h-b],0,0)+256&255}else{if(k==2)for(h=0;h<S;h++)l[L+h]=d[w+h]+256-d[w+h-S]&255;if(k==3){for(h=0;h<b;h++)l[L+h]=d[w+h]+256-(d[w+h-S]>>1)&255;for(h=b;h<S;h++)l[L+h]=d[w+h]+256-(d[w+h-S]+d[w+h-b]>>1)&255}if(k==4){for(h=0;h<b;h++)l[L+h]=d[w+h]+256-T(0,d[w+h-S],0)&255;for(h=b;h<S;h++)l[L+h]=d[w+h]+256-T(d[w+h-b],d[w+h-S],d[w+h-b-S])&255}}}function N(l,d){const _=new Uint8Array(l),S=_.slice(0),b=new Uint32Array(S.buffer),k=E(S,d),w=k[0],L=k[1],h=_.length,u=new Uint8Array(h>>2);let $;if(_.length<2e7)for(var I=0;I<h;I+=4)$=j(w,H=_[I]*(1/255),X=_[I+1]*(1/255),O=_[I+2]*(1/255),Y=_[I+3]*(1/255)),u[I>>2]=$.ind,b[I>>2]=$.est.rgba;else for(I=0;I<h;I+=4){var H=_[I]*.00392156862745098,X=_[I+1]*(1/255),O=_[I+2]*(1/255),Y=_[I+3]*(1/255);for($=w;$.left;)$=F($.est,H,X,O,Y)<=0?$.left:$.right;u[I>>2]=$.ind,b[I>>2]=$.est.rgba}return{abuf:S.buffer,inds:u,plte:L}}function E(l,d,_){_==null&&(_=1e-4);const S=new Uint32Array(l.buffer),b={i0:0,i1:l.length,bst:null,est:null,tdst:0,left:null,right:null};b.bst=P(l,b.i0,b.i1),b.est=x(b.bst);const k=[b];for(;k.length<d;){let L=0,h=0;for(var w=0;w<k.length;w++)k[w].est.L>L&&(L=k[w].est.L,h=w);if(L<_)break;const u=k[h],$=U(l,S,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=$||u.i1<=$){u.est.L=0;continue}const I={i0:u.i0,i1:$,bst:null,est:null,tdst:0,left:null,right:null};I.bst=P(l,I.i0,I.i1),I.est=x(I.bst);const H={i0:$,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(H.bst={R:[],m:[],N:u.bst.N-I.bst.N},w=0;w<16;w++)H.bst.R[w]=u.bst.R[w]-I.bst.R[w];for(w=0;w<4;w++)H.bst.m[w]=u.bst.m[w]-I.bst.m[w];H.est=x(H.bst),u.left=I,u.right=H,k[h]=I,k.push(H)}for(k.sort(((L,h)=>h.bst.N-L.bst.N)),w=0;w<k.length;w++)k[w].ind=w;return[b,k]}function j(l,d,_,S,b){if(l.left==null)return l.tdst=(function(I,H,X,O,Y){const B=H-I[0],R=X-I[1],re=O-I[2],xe=Y-I[3];return B*B+R*R+re*re+xe*xe})(l.est.q,d,_,S,b),l;const k=F(l.est,d,_,S,b);let w=l.left,L=l.right;k>0&&(w=l.right,L=l.left);const h=j(w,d,_,S,b);if(h.tdst<=k*k)return h;const u=j(L,d,_,S,b);return u.tdst<h.tdst?u:h}function F(l,d,_,S,b){const{e:k}=l;return k[0]*d+k[1]*_+k[2]*S+k[3]*b-l.eMq}function U(l,d,_,S,b,k){for(S-=4;_<S;){for(;A(l,_,b)<=k;)_+=4;for(;A(l,S,b)>k;)S-=4;if(_>=S)break;const w=d[_>>2];d[_>>2]=d[S>>2],d[S>>2]=w,_+=4,S-=4}for(;A(l,_,b)>k;)_-=4;return _+4}function A(l,d,_){return l[d]*_[0]+l[d+1]*_[1]+l[d+2]*_[2]+l[d+3]*_[3]}function P(l,d,_){const S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[0,0,0,0],k=_-d>>2;for(let w=d;w<_;w+=4){const L=l[w]*.00392156862745098,h=l[w+1]*(1/255),u=l[w+2]*(1/255),$=l[w+3]*(1/255);b[0]+=L,b[1]+=h,b[2]+=u,b[3]+=$,S[0]+=L*L,S[1]+=L*h,S[2]+=L*u,S[3]+=L*$,S[5]+=h*h,S[6]+=h*u,S[7]+=h*$,S[10]+=u*u,S[11]+=u*$,S[15]+=$*$}return S[4]=S[1],S[8]=S[2],S[9]=S[6],S[12]=S[3],S[13]=S[7],S[14]=S[11],{R:S,m:b,N:k}}function x(l){const{R:d}=l,{m:_}=l,{N:S}=l,b=_[0],k=_[1],w=_[2],L=_[3],h=S==0?0:1/S,u=[d[0]-b*b*h,d[1]-b*k*h,d[2]-b*w*h,d[3]-b*L*h,d[4]-k*b*h,d[5]-k*k*h,d[6]-k*w*h,d[7]-k*L*h,d[8]-w*b*h,d[9]-w*k*h,d[10]-w*w*h,d[11]-w*L*h,d[12]-L*b*h,d[13]-L*k*h,d[14]-L*w*h,d[15]-L*L*h],$=u,I=M;let H=[Math.random(),Math.random(),Math.random(),Math.random()],X=0,O=0;if(S!=0)for(let B=0;B<16&&(H=I.multVec($,H),O=Math.sqrt(I.dot(H,H)),H=I.sml(1/O,H),!(B!=0&&Math.abs(O-X)<1e-9));B++)X=O;const Y=[b*h,k*h,w*h,L*h];return{Cov:u,q:Y,e:H,L:X,eMq255:I.dot(I.sml(255,Y),H),eMq:I.dot(H,Y),rgba:(Math.round(255*Y[3])<<24|Math.round(255*Y[2])<<16|Math.round(255*Y[1])<<8|Math.round(255*Y[0])<<0)>>>0}}var M={multVec:(l,d)=>[l[0]*d[0]+l[1]*d[1]+l[2]*d[2]+l[3]*d[3],l[4]*d[0]+l[5]*d[1]+l[6]*d[2]+l[7]*d[3],l[8]*d[0]+l[9]*d[1]+l[10]*d[2]+l[11]*d[3],l[12]*d[0]+l[13]*d[1]+l[14]*d[2]+l[15]*d[3]],dot:(l,d)=>l[0]*d[0]+l[1]*d[1]+l[2]*d[2]+l[3]*d[3],sml:(l,d)=>[l*d[0],l*d[1],l*d[2],l*d[3]]};tt.encode=function(d,_,S,b,k,w,L){b==null&&(b=0),L==null&&(L=!1);const h=a(d,_,S,b,[!1,!1,!1,0,L,!1]);return v(h,-1),y(h,_,S,k,w)},tt.encodeLL=function(d,_,S,b,k,w,L,h){const u={ctype:0+(b==1?0:2)+(k==0?0:4),depth:w,frames:[]},$=(b+k)*w,I=$*_;for(let H=0;H<d.length;H++)u.frames.push({rect:{x:0,y:0,width:_,height:S},img:new Uint8Array(d[H]),blend:0,dispose:1,bpp:Math.ceil($/8),bpl:Math.ceil(I/8)});return v(u,0,!0),y(u,_,S,L,h)},tt.encode.compress=a,tt.encode.dither=c,tt.quantize=N,tt.quantize.getKDtree=E,tt.quantize.getNearest=j})();const cs={toArrayBuffer(m,p){const T=m.width,r=m.height,e=T<<2,s=m.getContext("2d").getImageData(0,0,T,r),f=new Uint32Array(s.data.buffer),c=(32*T+31)/32<<2,y=c*r,v=122+y,a=new ArrayBuffer(v),i=new DataView(a),n=1<<20;let o,g,N,E,j=n,F=0,U=0,A=0;function P(l){i.setUint16(U,l,!0),U+=2}function x(l){i.setUint32(U,l,!0),U+=4}function M(l){U+=l}P(19778),x(v),M(4),x(122),x(108),x(T),x(-r>>>0),P(1),P(32),x(3),x(y),x(2835),x(2835),M(8),x(16711680),x(65280),x(255),x(4278190080),x(1466527264),(function l(){for(;F<r&&j>0;){for(E=122+F*c,o=0;o<e;)j--,g=f[A++],N=g>>>24,i.setUint32(E+o,g<<8|N),o+=4;F++}A<f.length?(j=n,setTimeout(l,cs._dly)):p(a)})()},toBlob(m,p){this.toArrayBuffer(m,(T=>{p(new Blob([T],{type:"image/bmp"}))}))},_dly:9};var Oe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},zs={[Oe.CHROME]:16384,[Oe.FIREFOX]:11180,[Oe.DESKTOP_SAFARI]:16384,[Oe.IE]:8192,[Oe.IOS]:4096,[Oe.ETC]:8192};const Gt=typeof window<"u",ds=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Et=Gt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),Bs=(Gt||ds)&&(Et&&Et.getOriginalSymbol(window,"File")||typeof File<"u"&&File),us=(Gt||ds)&&(Et&&Et.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Wt(m,p,T=Date.now()){return new Promise((r=>{const e=m.split(","),s=e[0].match(/:(.*?);/)[1],f=globalThis.atob(e[1]);let c=f.length;const y=new Uint8Array(c);for(;c--;)y[c]=f.charCodeAt(c);const v=new Blob([y],{type:s});v.name=p,v.lastModified=T,r(v)}))}function fs(m){return new Promise(((p,T)=>{const r=new us;r.onload=()=>p(r.result),r.onerror=e=>T(e),r.readAsDataURL(m)}))}function ms(m){return new Promise(((p,T)=>{const r=new Image;r.onload=()=>p(r),r.onerror=e=>T(e),r.src=m}))}function gt(){if(gt.cachedResult!==void 0)return gt.cachedResult;let m=Oe.ETC;const{userAgent:p}=navigator;return/Chrom(e|ium)/i.test(p)?m=Oe.CHROME:/iP(ad|od|hone)/i.test(p)&&/WebKit/i.test(p)?m=Oe.IOS:/Safari/i.test(p)?m=Oe.DESKTOP_SAFARI:/Firefox/i.test(p)?m=Oe.FIREFOX:(/MSIE/i.test(p)||document.documentMode)&&(m=Oe.IE),gt.cachedResult=m,gt.cachedResult}function hs(m,p){const T=gt(),r=zs[T];let e=m,s=p,f=e*s;const c=e>s?s/e:e/s;for(;f>r*r;){const y=(r+e)/2,v=(r+s)/2;y<v?(s=v,e=v*c):(s=y*c,e=y),f=e*s}return{width:e,height:s}}function It(m,p){let T,r;try{if(T=new OffscreenCanvas(m,p),r=T.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{T=document.createElement("canvas"),r=T.getContext("2d")}return T.width=m,T.height=p,[T,r]}function gs(m,p){const{width:T,height:r}=hs(m.width,m.height),[e,s]=It(T,r);return p&&/jpe?g/.test(p)&&(s.fillStyle="white",s.fillRect(0,0,e.width,e.height)),s.drawImage(m,0,0,e.width,e.height),e}function At(){return At.cachedResult!==void 0||(At.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),At.cachedResult}function Tt(m,p={}){return new Promise((function(T,r){let e,s;var f=function(){try{return s=gs(e,p.fileType||m.type),T([e,s])}catch(y){return r(y)}},c=function(y){try{var v=function(a){try{throw a}catch(i){return r(i)}};try{let a;return fs(m).then((function(i){try{return a=i,ms(a).then((function(n){try{return e=n,(function(){try{return f()}catch(o){return r(o)}})()}catch(o){return v(o)}}),v)}catch(n){return v(n)}}),v)}catch(a){v(a)}}catch(a){return r(a)}};try{if(At()||[Oe.DESKTOP_SAFARI,Oe.MOBILE_SAFARI].includes(gt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(m).then((function(y){try{return e=y,f()}catch{return c()}}),c)}catch{c()}}))}function Mt(m,p,T,r,e=1){return new Promise((function(s,f){let c;if(p==="image/png"){let v,a,i;return v=m.getContext("2d"),{data:a}=v.getImageData(0,0,m.width,m.height),i=tt.encode([a.buffer],m.width,m.height,4096*e),c=new Blob([i],{type:p}),c.name=T,c.lastModified=r,y.call(this)}{let v=function(){return y.call(this)};if(p==="image/bmp")return new Promise((a=>cs.toBlob(m,a))).then((function(a){try{return c=a,c.name=T,c.lastModified=r,v.call(this)}catch(i){return f(i)}}).bind(this),f);{let a=function(){return v.call(this)};if(typeof OffscreenCanvas=="function"&&m instanceof OffscreenCanvas)return m.convertToBlob({type:p,quality:e}).then((function(i){try{return c=i,c.name=T,c.lastModified=r,a.call(this)}catch(n){return f(n)}}).bind(this),f);{let i;return i=m.toDataURL(p,e),Wt(i,T,r).then((function(n){try{return c=n,a.call(this)}catch(o){return f(o)}}).bind(this),f)}}}function y(){return s(c)}}))}function nt(m){m.width=0,m.height=0}function xt(){return new Promise((function(m,p){let T,r,e,s;return xt.cachedResult!==void 0?m(xt.cachedResult):Wt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(f){try{return T=f,Tt(T).then((function(c){try{return r=c[1],Mt(r,T.type,T.name,T.lastModified).then((function(y){try{return e=y,nt(r),Tt(e).then((function(v){try{return s=v[0],xt.cachedResult=s.width===1&&s.height===2,m(xt.cachedResult)}catch(a){return p(a)}}),p)}catch(v){return p(v)}}),p)}catch(y){return p(y)}}),p)}catch(c){return p(c)}}),p)}))}function xs(m){return new Promise(((p,T)=>{const r=new us;r.onload=e=>{const s=new DataView(e.target.result);if(s.getUint16(0,!1)!=65496)return p(-2);const f=s.byteLength;let c=2;for(;c<f;){if(s.getUint16(c+2,!1)<=8)return p(-1);const y=s.getUint16(c,!1);if(c+=2,y==65505){if(s.getUint32(c+=2,!1)!=1165519206)return p(-1);const v=s.getUint16(c+=6,!1)==18761;c+=s.getUint32(c+4,v);const a=s.getUint16(c,v);c+=2;for(let i=0;i<a;i++)if(s.getUint16(c+12*i,v)==274)return p(s.getUint16(c+12*i+8,v))}else{if((65280&y)!=65280)break;c+=s.getUint16(c,!1)}}return p(-1)},r.onerror=e=>T(e),r.readAsArrayBuffer(m)}))}function ps(m,p){const{width:T}=m,{height:r}=m,{maxWidthOrHeight:e}=p;let s,f=m;return isFinite(e)&&(T>e||r>e)&&([f,s]=It(T,r),T>r?(f.width=e,f.height=r/T*e):(f.width=T/r*e,f.height=e),s.drawImage(m,0,0,f.width,f.height),nt(m)),f}function bs(m,p){const{width:T}=m,{height:r}=m,[e,s]=It(T,r);switch(p>4&&p<9?(e.width=r,e.height=T):(e.width=T,e.height=r),p){case 2:s.transform(-1,0,0,1,T,0);break;case 3:s.transform(-1,0,0,-1,T,r);break;case 4:s.transform(1,0,0,-1,0,r);break;case 5:s.transform(0,1,1,0,0,0);break;case 6:s.transform(0,1,-1,0,r,0);break;case 7:s.transform(0,-1,-1,0,r,T);break;case 8:s.transform(0,-1,1,0,0,T)}return s.drawImage(m,0,0,T,r),nt(m),e}function es(m,p,T=0){return new Promise((function(r,e){let s,f,c,y,v,a,i,n,o,g,N,E,j,F,U,A,P,x,M,l;function d(S=5){if(p.signal&&p.signal.aborted)throw p.signal.reason;s+=S,p.onProgress(Math.min(s,100))}function _(S){if(p.signal&&p.signal.aborted)throw p.signal.reason;s=Math.min(Math.max(S,s),100),p.onProgress(s)}return s=T,f=p.maxIteration||10,c=1024*p.maxSizeMB*1024,d(),Tt(m,p).then((function(S){try{return[,y]=S,d(),v=ps(y,p),d(),new Promise((function(b,k){var w;if(!(w=p.exifOrientation))return xs(m).then((function(h){try{return w=h,L.call(this)}catch(u){return k(u)}}).bind(this),k);function L(){return b(w)}return L.call(this)})).then((function(b){try{return a=b,d(),xt().then((function(k){try{return i=k?v:bs(v,a),d(),n=p.initialQuality||1,o=p.fileType||m.type,Mt(i,o,m.name,m.lastModified,n).then((function(w){try{{let h=function(){if(f--&&(U>c||U>j)){let $,I;return $=l?.95*M.width:M.width,I=l?.95*M.height:M.height,[P,x]=It($,I),x.drawImage(M,0,0,$,I),n*=o==="image/png"?.85:.95,Mt(P,o,m.name,m.lastModified,n).then((function(H){try{return A=H,nt(M),M=P,U=A.size,_(Math.min(99,Math.floor((F-U)/(F-c)*100))),h}catch(X){return e(X)}}),e)}return[1]},u=function(){return nt(M),nt(P),nt(v),nt(i),nt(y),_(100),r(A)};if(g=w,d(),N=g.size>c,E=g.size>m.size,!N&&!E)return _(100),r(g);var L;return j=m.size,F=g.size,U=F,M=i,l=!p.alwaysKeepResolution&&N,(L=(function($){for(;$;){if($.then)return void $.then(L,e);try{if($.pop){if($.length)return $.pop()?u.call(this):$;$=h}else $=$.call(this)}catch(I){return e(I)}}}).bind(this))(h)}}catch(h){return e(h)}}).bind(this),e)}catch(w){return e(w)}}).bind(this),e)}catch(k){return e(k)}}).bind(this),e)}catch(b){return e(b)}}).bind(this),e)}))}const Gs=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let $t;function Ws(m,p){return new Promise(((T,r)=>{$t||($t=(function(f){const c=[];return c.push(f),URL.createObjectURL(new Blob(c))})(Gs));const e=new Worker($t);e.addEventListener("message",(function(f){if(p.signal&&p.signal.aborted)e.terminate();else if(f.data.progress===void 0){if(f.data.error)return r(new Error(f.data.error)),void e.terminate();T(f.data.file),e.terminate()}else p.onProgress(f.data.progress)})),e.addEventListener("error",r),p.signal&&p.signal.addEventListener("abort",(()=>{r(p.signal.reason),e.terminate()})),e.postMessage({file:m,imageCompressionLibUrl:p.libURL,options:{...p,onProgress:void 0,signal:void 0}})}))}function $e(m,p){return new Promise((function(T,r){let e,s,f,c,y,v;if(e={...p},f=0,{onProgress:c}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,y=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=o=>{f=o,typeof c=="function"&&c(f)},!(m instanceof Blob||m instanceof Bs))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(m.type))return r(new Error("The file given is not an image"));if(v=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!y||typeof Worker!="function"||v)return es(m,e).then((function(o){try{return s=o,n.call(this)}catch(g){return r(g)}}).bind(this),r);var a=(function(){try{return n.call(this)}catch(o){return r(o)}}).bind(this),i=function(o){try{return es(m,e).then((function(g){try{return s=g,a()}catch(N){return r(N)}}),r)}catch(g){return r(g)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",Ws(m,e).then((function(o){try{return s=o,a()}catch{return i()}}),i)}catch{i()}function n(){try{s.name=m.name,s.lastModified=m.lastModified}catch{}try{e.preserveExif&&m.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===m.type)&&(s=ls(m,s))}catch{}return T(s)}}))}$e.getDataUrlFromFile=fs,$e.getFilefromDataUrl=Wt,$e.loadImage=ms,$e.drawImageInCanvas=gs,$e.drawFileInCanvas=Tt,$e.canvasToFile=Mt,$e.getExifOrientation=xs,$e.handleMaxWidthOrHeight=ps,$e.followExifOrientation=bs,$e.cleanupCanvasMemory=nt,$e.isAutoOrientationInBrowser=xt,$e.approximateBelowMaximumCanvasSizeOfBrowser=hs,$e.copyExifWithoutOrientation=ls,$e.getBrowserName=gt,$e.version="2.0.2";const Pe=[];for(let m=0;m<256;++m)Pe.push((m+256).toString(16).slice(1));function Os(m,p=0){return(Pe[m[p+0]]+Pe[m[p+1]]+Pe[m[p+2]]+Pe[m[p+3]]+"-"+Pe[m[p+4]]+Pe[m[p+5]]+"-"+Pe[m[p+6]]+Pe[m[p+7]]+"-"+Pe[m[p+8]]+Pe[m[p+9]]+"-"+Pe[m[p+10]]+Pe[m[p+11]]+Pe[m[p+12]]+Pe[m[p+13]]+Pe[m[p+14]]+Pe[m[p+15]]).toLowerCase()}let Ht;const qs=new Uint8Array(16);function Ks(){if(!Ht){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ht=crypto.getRandomValues.bind(crypto)}return Ht(qs)}const Vs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ts={randomUUID:Vs};function Ys(m,p,T){m=m||{};const r=m.random??m.rng?.()??Ks();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Os(r)}function Qs(m,p,T){return ts.randomUUID&&!m?ts.randomUUID():Ys(m)}const ss=50,zt=m=>({id:m.id,league_id:m.league_id,user_id:m.user_id,content:m.content,created_at:m.created_at??new Date().toISOString(),status:"sent"}),Ct=m=>{const p=new Map;for(const T of m)p.set(T.id,T);return Array.from(p.values()).sort((T,r)=>new Date(T.created_at).getTime()-new Date(r.created_at).getTime())};function Js(m,p={}){const{userId:T,enabled:r=!0,autoSubscribe:e=!0}=p,[s,f]=D.useState([]),[c,y]=D.useState(!1),[v,a]=D.useState(!1),[i,n]=D.useState(!0),[o,g]=D.useState(null),N=D.useRef(null),E=D.useCallback(x=>{f(M=>{const l=x(M);return N.current=l.length?l[0].created_at:null,l})},[]),j=D.useCallback(async({before:x,append:M})=>{if(!m||!r)return;const l=ne.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",m).order("created_at",{ascending:!1}).limit(ss);x&&l.lt("created_at",x);const{data:d,error:_}=await l;if(_)throw _;const S=(d??[]).map(zt).reverse();E(b=>Ct(M?[...S,...b]:S)),(d??[]).length<ss?n(!1):M||n(!0)},[m,r,E]),F=D.useCallback(async()=>{if(!m||!r){f([]),n(!0);return}y(!0),g(null),N.current=null;try{await j({append:!1})}catch(x){g(x?.message??"Failed to load chat")}finally{y(!1)}},[m,r,j]);D.useEffect(()=>{if(!m||!r){f([]),n(!0);return}let x=!0;if(F(),!e)return()=>{x=!1};const M=ne.channel(`league-messages:${m}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${m}`},l=>{if(!x)return;const d=zt(l.new);E(_=>_.some(S=>S.id===d.id)?_:Ct([..._,d]))}).subscribe();return()=>{x=!1,ne.removeChannel(M)}},[m,r,e,F,E]);const U=D.useCallback(async()=>{if(!m||!r||!i||v)return;const x=N.current??s[0]?.created_at;if(x){a(!0);try{await j({before:x,append:!0})}catch(M){g(M?.message??"Failed to load more messages")}finally{a(!1)}}},[m,r,i,v,j,s]),A=D.useCallback(async x=>{if(!m||!T)throw new Error("Missing league or user");const M=x.trim();if(!M)return;const l=Qs(),d=`optimistic-${l}`,_={id:d,client_msg_id:l,league_id:m,user_id:T,content:M,created_at:new Date().toISOString(),status:"sending"};E(k=>Ct([...k,_]));const{data:S,error:b}=await ne.from("league_messages").insert({league_id:m,user_id:T,content:M}).select("id, league_id, user_id, content, created_at").single();if(b)throw E(k=>k.map(w=>w.id===d?{...w,status:"error"}:w)),b;if(S){const k=zt(S);k.client_msg_id=l,E(w=>w.map(L=>L.id===d?{...k,status:"sent",client_msg_id:l}:L))}},[m,T,E]),P=D.useMemo(()=>s.slice(-5),[s]);return{messages:s,previewMessages:P,loading:c,loadingMore:v,hasMore:i,error:o,refresh:F,loadMore:U,sendMessage:A}}const Zs={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",middle:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",bottom:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]"},Xs={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[4px] rounded-bl-[12px]",middle:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[4px] rounded-bl-[12px]",bottom:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[12px] rounded-bl-[12px]"};function ws({author:m,text:p,time:T,isOwnMessage:r,shape:e="single"}){const s=r?"text-right":"text-left",f=r?"bg-[#1C8376] text-white":"bg-white text-slate-900",c=r?Xs:Zs;return t.jsxs("div",{className:`inline-block w-fit px-3 py-2 text-sm leading-snug shadow-sm max-w-[70%] whitespace-normal break-words ${s} ${f} ${c[e]}`,children:[m&&!r&&t.jsx("div",{className:"text-[11px] font-semibold text-slate-600 mb-1",children:m}),t.jsx("div",{children:p}),t.jsx("div",{className:"text-[11px] text-[#DCDCDD] mt-1",children:T})]})}function er({author:m,messages:p,isOwnMessage:T,avatarInitials:r}){const e=T?"justify-end":"justify-start";return t.jsxs("div",{className:`flex items-end gap-3 w-full ${e}`,children:[T?t.jsx("div",{className:"w-8 flex-shrink-0"}):t.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-[13px] font-semibold text-slate-500 flex-shrink-0",children:(r||m.charAt(0)).toUpperCase()}),t.jsx("div",{className:"flex flex-col gap-1 flex-1",children:p.map((s,f)=>{const c=p.length===1?"single":f===0?"top":f===p.length-1?"bottom":"middle";return t.jsxs("div",{className:`flex w-full ${T?"justify-end":"justify-start"}`,children:[t.jsx(ws,{author:!T&&f===0?m:void 0,text:s.text,time:s.time,isOwnMessage:T,shape:c}),s.status&&t.jsx("div",{className:`text-[11px] ml-2 ${s.status==="error"?"text-red-500":"text-slate-400"}`,children:s.status==="error"?"Failed":"Sending"})]},s.id)})})]})}function tr({groups:m}){return t.jsx("div",{className:"flex flex-col gap-5",children:m.map(p=>t.jsxs("div",{className:"flex flex-col gap-3",children:[p.dayLabel&&t.jsx("div",{className:"text-center text-xs uppercase tracking-wide text-slate-400",children:p.dayLabel}),t.jsx(er,{author:p.author,avatarInitials:p.avatarInitials,isOwnMessage:p.isOwnMessage,messages:p.messages})]},p.id))})}const sr=m=>new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),rr=m=>new Date(m).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),nr=m=>{const p=m.trim().split(/\s+/);return p.length===1?p[0][0]?.toUpperCase()??"?":`${p[0][0]?.toUpperCase()??""}${p[p.length-1][0]?.toUpperCase()??""}`},ar=(m,p)=>p?p instanceof Map?p.get(m)??"":p[m]??"":"";function ir({miniLeagueId:m,memberNames:p}){const{user:T}=os(),{messages:r,loading:e,loadingMore:s,hasMore:f,error:c,loadMore:y,sendMessage:v}=Js(m,{userId:T?.id,enabled:!!m}),[a,i]=D.useState(""),[n,o]=D.useState(!1),g=D.useRef(null),N=D.useRef(null),E=D.useRef(null),[j,F]=D.useState(0),U=D.useCallback(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[]),A=D.useCallback((b=[0,100,300,500,700])=>{requestAnimationFrame(()=>{b.forEach(k=>{setTimeout(()=>U(),k)})})},[U]);D.useEffect(()=>{r.length>0&&A([0,150,300])},[r.length,A]),D.useEffect(()=>{!a&&N.current&&(N.current.style.height="auto",N.current.style.height="42px")},[a]);const P=D.useCallback((b,k=[0,100,300,500,700])=>{if(b>0){if(F(b),g.current){const w=Math.max(b+(N.current?.offsetHeight||0)+16,80);g.current.style.paddingBottom=`${w}px`}}else F(0),g.current&&(g.current.style.paddingBottom="");A(k)},[A]);D.useEffect(()=>{const b=window.visualViewport;if(!b)return;let k=null,w=0;const L=()=>{k&&(clearTimeout(k),k=null),k=setTimeout(()=>{const $=window.innerHeight,I=b.height,H=b.offsetTop+I,X=$-H;Math.abs(X-w)<10&&X>0||(w=X,P(X))},50)};b.addEventListener("resize",L),b.addEventListener("scroll",L);const h=()=>{setTimeout(L,100),setTimeout(L,300)},u=setTimeout(()=>{N.current&&N.current.addEventListener("focus",h)},100);return L(),()=>{k&&clearTimeout(k),clearTimeout(u),b.removeEventListener("resize",L),b.removeEventListener("scroll",L),N.current&&N.current.removeEventListener("focus",h)}},[P]),D.useEffect(()=>{if(typeof window>"u")return;const b=window.innerHeight,k=()=>{const w=b-window.innerHeight;P(w>0?w:0)};return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[P]),D.useEffect(()=>{if(!g.current||!E.current)return;const b=E.current.offsetHeight??72;g.current.style.paddingBottom=`${b+24}px`},[]);const x=()=>{const b=window.visualViewport;b&&setTimeout(()=>{const k=window.innerHeight,w=b.height,L=b.offsetTop+w,h=k-L;P(h,[0,200,400,600,800])},100),A([200,400,600])},M=b=>{const k=b.target;!(k.tagName==="A"||k.tagName==="BUTTON"||k.closest("a, button"))&&N.current&&document.activeElement===N.current&&N.current.blur()},l=D.useMemo(()=>{if(!T)return"";const b=T.user_metadata??{};return b.display_name||b.full_name||T.email||""},[T]),d=D.useMemo(()=>{if(!r.length)return[];const b=[];let k=null;return r.forEach(w=>{const L=w.user_id===T?.id,$=ar(w.user_id,p)||(L?l:"")||(L?"You":"Unknown"),I=L?void 0:nr($),X=new Date(w.created_at).toDateString(),O=X!==k;O&&(k=X);const Y={id:w.id,text:w.content,time:sr(w.created_at),status:w.status&&w.status!=="sent"?w.status:void 0},B=b[b.length-1];B&&!O&&B.isOwnMessage===L&&B.author===$?B.messages.push(Y):b.push({id:w.id,author:$,avatarInitials:I,isOwnMessage:L,dayLabel:O?rr(w.created_at):void 0,messages:[Y]})}),b},[l,p,r,T?.id]),_=D.useCallback(async b=>{if(!m||!T?.id||typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"))return;const w=T.user_metadata?.display_name||T.user_metadata?.full_name||T.email||"User";try{await fetch("/.netlify/functions/notifyLeagueMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:m,senderId:T.id,senderName:w,content:b})})}catch(L){console.error("[MiniLeagueChatBeta] notifyLeagueMessage failed:",L)}},[m,T?.id]),S=D.useCallback(async()=>{const b=a.trim();if(!(!m||!b||n))try{o(!0),await v(b),await _(b),i(""),A([0,150,300])}catch(k){console.error("[MiniLeagueChatBeta] Failed to send message",k)}finally{o(!1)}},[a,m,_,A,v,n]);return t.jsxs("div",{className:"flex flex-col h-full bg-[#f5f6fb] w-full",children:[t.jsxs("div",{ref:g,className:"flex-1 overflow-y-auto px-4 py-5",onClick:M,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:j>0?"0":"auto",cursor:"pointer"},children:[f&&m&&t.jsx("button",{className:"mx-auto mb-2 text-xs font-semibold text-[#1C8376] bg-white px-3 py-1 rounded-full shadow disabled:opacity-40",onClick:y,disabled:s,children:s?"Loading earlier":"Load earlier messages"}),d.length===0&&!e?t.jsx("div",{className:"text-center text-sm text-slate-500 mt-8",children:"Say hi to kick off this chat!"}):t.jsx(tr,{groups:d})]}),t.jsxs("div",{ref:E,className:"flex-shrink-0 border-t border-slate-200 bg-white px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:j>0?"fixed":"relative",bottom:j>0?`${j}px`:"auto",left:j>0?0:"auto",right:j>0?0:"auto",width:j>0?"100%":"auto",maxWidth:j>0?"440px":"none",marginLeft:j>0?"auto":void 0,marginRight:j>0?"auto":void 0,zIndex:j>0?1e3:"auto"},children:[t.jsxs("div",{className:"flex items-end gap-3 bg-slate-100 rounded-2xl px-3 py-2",children:[t.jsx("textarea",{ref:N,className:"flex-1 bg-transparent resize-none focus:outline-none text-sm text-slate-800 placeholder:text-slate-400",rows:1,value:a,disabled:!m||n,placeholder:m?"Start typing a message":"Join this league to chat",onChange:b=>{i(b.target.value),N.current&&(N.current.style.height="auto",N.current.style.height=`${Math.min(N.current.scrollHeight,120)}px`)},onFocus:x,onKeyDown:b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),S())},style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),t.jsx("button",{type:"button",onClick:S,disabled:!m||n||!a.trim(),className:"w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-40",children:t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14M12 5l7 7-7 7"})})})]}),c&&t.jsxs("div",{className:"text-xs text-red-500 mt-2 text-center",children:[c,"  try again or switch to the classic chat tab."]})]})]})}function rs({onClick:m,className:p=""}){return t.jsxs("button",{onClick:m,className:`flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2 ${p}`,children:[t.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),t.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})}function or({winnerName:m,isDraw:p}){return t.jsx("div",{className:"mt-4 mb-4 py-6 px-6 rounded-xl bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 shadow-2xl shadow-slate-600/50 relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:animate-[shimmer_2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/30 after:to-transparent after:animate-[shimmer_2.5s_ease-in-out_infinite_0.6s]",children:t.jsx("div",{className:"text-center relative z-10",children:p?t.jsx("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:" It's a Draw!"}):t.jsxs("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:[m," Wins!"]})})})}function lr({availableGws:m,selectedGw:p,onChange:T,className:r=""}){return m.length<=1?null:t.jsx("div",{className:`flex-1 ${r}`,children:t.jsx("select",{value:p||void 0,onChange:e=>{const s=parseInt(e.target.value,10);T(s)},className:"gw-selector w-full bg-white rounded-full border-2 border-slate-300 px-3 py-2 text-xs font-normal text-slate-600 text-center focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-[#1C8376] active:bg-slate-50 transition-colors",style:{fontSize:"12px",minHeight:"40px",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b' stroke-width='2.5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"1em 1em",paddingRight:"2.5rem"},children:m.map(e=>t.jsxs("option",{value:e,style:{fontSize:"12px",padding:"0.5rem",fontWeight:"normal",color:"#64748b",textTransform:"uppercase"},children:["GAME WEEK ",e]},e))})})}function cr({showForm:m,onToggle:p}){return t.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-0.5 shadow-sm border border-slate-200",children:[t.jsx("button",{onClick:()=>p(!1),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${m?"text-slate-600 hover:text-slate-900 hover:bg-white/50":"bg-[#1C8376] text-white shadow-sm"}`,children:"Points"}),t.jsx("button",{onClick:()=>p(!0),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${m?"bg-[#1C8376] text-white shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:"Form"})]})}function dr({form:m}){const p=m.slice(-5),T=5-p.length;return t.jsxs("div",{className:"flex items-center justify-between w-full",children:[Array.from({length:T}).map((r,e)=>t.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-200"},`dot-${e}`)),p.map((r,e)=>t.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold ${r==="W"?"bg-green-100 text-green-700":r==="D"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:r},e))]})}function ur({rows:m,members:p,showForm:T,currentUserId:r,loading:e,isLateStartingLeague:s}){return t.jsxs("div",{className:"pt-4",children:[t.jsx("style",{children:`
        .mlt-table tbody tr:last-child {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table tbody tr:last-child td {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table tbody tr:last-child th {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table {
          border-bottom: none !important;
        }
        .mlt-table tbody {
          border-bottom: none !important;
        }
        .mlt-table-container {
          border-bottom: none !important;
        }
        .mlt-table-container table {
          border-bottom: none !important;
        }
        .mlt-table-container tbody {
          border-bottom: none !important;
        }
        .mlt-table-container tbody tr:last-child {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table-container tbody tr:last-child td {
          border-bottom: none !important;
          border: none !important;
        }
      `}),t.jsx("div",{className:"mlt-table-container overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x bg-slate-50",style:{backgroundColor:"#f8fafc",borderBottom:"none",boxShadow:"none"},children:t.jsxs("table",{className:"mlt-table w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc",border:"none",borderBottom:"none"},children:[t.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:t.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[t.jsx("th",{className:"py-3 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),t.jsx("th",{className:"py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:"Player"}),T?t.jsx("th",{className:"px-4 py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8"},children:"Form"}):t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"W"}),t.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"D"}),t.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:s?"CP":"OCP"}),p.length>=3&&t.jsx("th",{className:"py-3 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""}),t.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"PTS"})]})]})}),t.jsxs("tbody",{children:[m.map((f,c)=>{const y=f.user_id===r,v=c===m.length-1;return t.jsxs("tr",{className:y?"flash-user-row":"",style:{position:"relative",backgroundColor:"#f8fafc",...v?{}:{borderBottom:"1px solid #e2e8f0"}},children:[t.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:c+1}),t.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:f.name}),T?t.jsx("td",{className:"px-4 py-4",style:{backgroundColor:"#f8fafc"},children:t.jsx(dr,{form:f.form})}):t.jsxs(t.Fragment,{children:[t.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:f.wins}),t.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:f.draws}),t.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:f.ocp}),p.length>=3&&t.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:f.unicorns}),t.jsx("td",{className:"py-4 text-center tabular-nums font-bold",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:f.mltPts})]})]},f.user_id)}),e&&t.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:t.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:T?3:p.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"Calculating"})}),!e&&!m.length&&t.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:t.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:T?3:p.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"No gameweeks completed yet  this will populate after the first results are saved."})})]})]})})]})}function fr({rows:m,members:p,currentUserId:T,positionChangeKeys:r,isApiTestLeague:e,hasLiveFixtures:s,hasStartingSoonFixtures:f,hasStartedFixtures:c,allFixturesFinished:y,resGw:v}){return t.jsxs("div",{children:[t.jsx("style",{children:`
        @keyframes flash {
          0%, 100% {
            background-color: rgb(209, 250, 229);
          }
          25% {
            background-color: rgb(167, 243, 208);
          }
          50% {
            background-color: rgb(209, 250, 229);
          }
          75% {
            background-color: rgb(167, 243, 208);
          }
        }
        @keyframes pulse-score {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.7;
          }
        }
        @keyframes position-change {
          0% {
            background-color: rgb(254, 243, 199);
          }
          50% {
            background-color: rgb(253, 230, 138);
          }
          100% {
            background-color: transparent;
          }
        }
        .flash-user-row {
          animation: flash 1.5s ease-in-out 3;
        }
        .pulse-live-score {
          animation: pulse-score 2s ease-in-out infinite;
        }
        .position-changed {
          animation: position-change 1.5s ease-out;
        }
        .full-width-header-border::after {
          content: '';
          position: absolute;
          left: -1rem;
          right: -1rem;
          bottom: 0;
          height: 1px;
          background-color: #cbd5e1;
          z-index: 1;
        }
      `}),t.jsx("div",{className:"overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x border-b border-slate-200 bg-slate-50 shadow-sm",style:{backgroundColor:"#f8fafc"},children:t.jsxs("table",{className:"w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc"},children:[t.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:t.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[t.jsx("th",{className:"py-4 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),t.jsx("th",{className:"py-4 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:t.jsxs("div",{className:"flex items-center gap-2",children:["Player",e&&s&&t.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-600 text-white shadow-md shadow-red-500/30",children:[t.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),t.jsx("span",{className:"text-[10px] font-medium",children:"LIVE"})]}),e&&!y&&f&&!s&&t.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500 text-white shadow-md shadow-amber-500/30",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{className:"text-[10px] font-medium",children:c?"Next Game Starting Soon":"Starting soon"})]})]})}),t.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8"},children:"Score"}),p.length>=3&&t.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""})]})}),t.jsxs("tbody",{children:[m.map((a,i)=>{const n=a.user_id===T,o=i===m.length-1,g=r.has(a.user_id);return t.jsxs("tr",{className:`${n?"flash-user-row":""} ${g?"position-changed":""}`,style:{position:"relative",backgroundColor:"#f8fafc",...o?{}:{borderBottom:"1px solid #e2e8f0"}},children:[t.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:i+1}),t.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:t.jsxs("div",{className:"flex items-center gap-2",children:[e&&s&&t.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full animate-pulse flex-shrink-0",style:{minWidth:"8px",minHeight:"8px"}}),e&&!s&&f&&t.jsx("svg",{className:"w-3 h-3 text-amber-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.jsx("span",{children:a.name})]})}),t.jsx("td",{className:`py-4 text-center tabular-nums font-bold ${e&&s?"pulse-live-score":""}`,style:{width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:a.score}),p.length>=3&&t.jsx("td",{className:`py-4 text-center tabular-nums ${e&&s?"pulse-live-score":""}`,style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:a.unicorns})]},a.user_id)}),!m.length&&t.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:t.jsxs("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:p.length>=3?4:3,style:{backgroundColor:"#f8fafc"},children:["No results recorded for GW ",v," yet."]})})]})]})})]})}function mr(m,p){const T=new Date(p.find(i=>i.gw===m)?.kickoff_time||""),r=new Date(T.getTime()-4500*1e3),e=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],s=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],f=e[r.getUTCDay()],c=r.getUTCDate(),y=s[r.getUTCMonth()],v=r.getUTCHours().toString().padStart(2,"0"),a=r.getUTCMinutes().toString().padStart(2,"0");return`Game Week ${m} Predictions Reminder!

DEADLINE: THIS ${f} ${c} ${y}, ${v}:${a} BST

Don't forget!
playtotl.com`}function hr(m,p){const T=mr(m,p),r=`https://wa.me/?text=${encodeURIComponent(T)}`;try{window.open(r,"_blank")}catch{navigator.clipboard.writeText(T).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+T)})}}function ns({members:m,submittedMap:p,picksGw:T,allSubmitted:r,remaining:e,fixtures:s,onShareReminder:f,variant:c="full"}){const y=f||(()=>hr(T,s)),v=s.map(g=>g.kickoff_time).filter(g=>!!g).map(g=>new Date(g)).filter(g=>!isNaN(g.getTime())),a=v.length>0?new Date(Math.min(...v.map(g=>g.getTime()))):null,i=a?new Date(a.getTime()-4500*1e3):null,n=i?new Date>=i:!1;let o="";if(i){const g=c==="compact"?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],E=g[i.getUTCDay()],j=i.getUTCDate(),F=N[i.getUTCMonth()],U=i.getUTCHours().toString().padStart(2,"0"),A=i.getUTCMinutes().toString().padStart(2,"0");o=`${E} ${j} ${F}, ${U}:${A} BST`}return c==="compact"?t.jsxs("div",{className:"mt-2 pt-2",children:[t.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[t.jsx("div",{className:"text-sm font-medium text-slate-700",children:t.jsxs(t.Fragment,{children:["Waiting for ",t.jsx("span",{className:"font-semibold",children:e})," of ",m.length," to submit."]})}),!r&&t.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),o&&t.jsxs("div",{className:`mb-3 text-xs font-medium ${n?"text-orange-600":"text-slate-600"} flex items-center gap-1.5`,children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),n?"Deadline Passed: ":"Deadline: ",o]}),t.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white",children:t.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[t.jsx("thead",{className:"bg-slate-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),t.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),t.jsx("tbody",{children:m.slice().sort((g,N)=>g.name.localeCompare(N.name)).map(g=>{const N=`${g.id}:${T}`,E=!!p.get(N);return t.jsxs("tr",{className:"border-t border-slate-200",children:[t.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:g.name}),t.jsx("td",{className:"px-4 py-3",children:E?t.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2.5 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submitted"]}):t.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2.5 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:[t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Not yet"]})})]},g.id)})})]})})]}):t.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-700",children:[t.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[t.jsx("div",{children:r?t.jsxs(t.Fragment,{children:["All ",m.length," members have submitted."]}):t.jsxs(t.Fragment,{children:["Waiting for ",t.jsx("span",{className:"font-semibold",children:e})," of ",m.length," to submit."]})}),!r&&t.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[t.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),o&&t.jsxs("div",{className:`mb-3 text-sm ${n?"text-orange-600 font-semibold":"text-slate-600"}`,children:[n?" Deadline Passed: ":" Deadline: ",o]}),t.jsx("div",{className:"overflow-hidden rounded-lg border",children:t.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[t.jsx("thead",{className:"bg-slate-50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),t.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),t.jsx("tbody",{children:m.slice().sort((g,N)=>g.name.localeCompare(N.name)).map(g=>{const N=`${g.id}:${T}`,E=!!p.get(N);return t.jsxs("tr",{className:"border-t border-slate-200",children:[t.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:g.name}),t.jsx("td",{className:"px-4 py-3",children:E?t.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:" Submitted"}):t.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:" Not yet"})})]},g.id)})})]})})]})}function as({letter:m,correct:p,unicorn:T,hasSubmitted:r,isLive:e,isOngoing:s,isFinished:f}){let c;return p===!0?e||s?c="bg-emerald-600 text-white border-emerald-600 animate-pulse shadow-lg shadow-emerald-500/50":f?c="bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 relative overflow-hidden animate-pulse before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s]":c="bg-emerald-600 text-white border-emerald-600":r?c="bg-emerald-600 text-white border-emerald-600":c="bg-slate-100 text-slate-600 border-slate-200",t.jsx("span",{className:["inline-flex items-center justify-center h-5 min-w-[18px] px-1.5","rounded-full border text-[11px] font-semibold mb-0.5","align-middle",c].join(" "),title:T?"Correct!":void 0,children:m})}function gr(m,p){if(m==="FINISHED")return"FT";if(m==="PAUSED")return"HT";if(m==="IN_PLAY"){if(p==null)return"LIVE";if(p>=1&&p<=45)return"First Half";if(p>45&&p<=50)return"45+";if(p>50)return"Second Half"}return"LIVE"}function xr(m){const p=(m||"?").trim().split(/\s+/);return p.length?p.length===1?p[0].slice(0,1).toUpperCase():(p[0][0]+p[p.length-1][0]).toUpperCase():"?"}function pr({fixture:m,picks:p,members:T,outcome:r,liveScore:e,submittedMap:s,picksGw:f,isApiTestLeague:c=!1}){const y=m.home_code||m.home_team||m.home_name||"",v=m.away_code||m.away_team||m.away_name||"",a=Qt(y)||m.home_name||m.home_team||"Home",i=Qt(v)||m.away_name||m.away_team||"Away",o=(A=>{if(!A)return"";const P=new Date(A);if(isNaN(P.getTime()))return"";const x=String(P.getUTCHours()).padStart(2,"0"),M=String(P.getUTCMinutes()).padStart(2,"0");return`${x}:${M}`})(m.kickoff_time),g=!!(e&&e.status==="IN_PLAY"),N=!!(e&&(e.status==="PAUSED"||e.status==="HALF_TIME"||e.status==="HT")),E=!!(e&&e.status==="FINISHED"),j=g||N;let F=null;c&&e?e.homeScore>e.awayScore?F="H":e.awayScore>e.homeScore?F="A":e.homeScore===e.awayScore&&(F="D"):F=r;const U=A=>{const P=p.filter(d=>d.pick===A),x=p.length===T.length&&P.length===T.length,M=4,l=[];for(let d=0;d<P.length;d+=M){const _=P.slice(d,d+M);l.push(_)}return t.jsx("div",{className:"flex flex-col gap-1",children:l.map((d,_)=>t.jsx("div",{className:"flex items-center justify-center",children:d.map((S,b)=>{const k=T.find(u=>u.id===S.user_id),w=xr(k?.name??"?"),L=s.has(`${S.user_id}:${f}`),h=F&&F===A?!0:null;return x?t.jsx("span",{className:"inline-block",style:{marginLeft:b>0?"-8px":"0",position:"relative",zIndex:b},children:t.jsx(as,{letter:w,correct:h,unicorn:h===!0,hasSubmitted:L,isLive:g,isOngoing:j,isFinished:E})},S.user_id):t.jsx(as,{letter:w,correct:h,unicorn:h===!0,hasSubmitted:L,isLive:g,isOngoing:j,isFinished:E},S.user_id)})},_))})};return t.jsx("li",{className:"border-t first:border-t-0",children:t.jsxs("div",{className:"p-4 bg-white relative",children:[(g||N)&&t.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:[t.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-xs font-bold text-red-600",children:"LIVE"})]}),E&&!g&&!N&&t.jsx("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:t.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"FT"})}),t.jsxs("div",{className:`grid grid-cols-3 items-center ${j?"pt-4":""}`,children:[t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:a})}),t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx(Xt,{code:m.home_code||void 0,crest:m.home_crest||void 0,size:24,className:"h-6 w-6"}),t.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:e&&(g||N||E)?t.jsxs("span",{className:"font-bold text-base text-slate-900",children:[e.homeScore," - ",e.awayScore]}):t.jsx("span",{children:o})}),t.jsx(Xt,{code:m.away_code||void 0,crest:m.away_crest||void 0,size:24,className:"h-6 w-6"})]}),t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:i})})]}),e&&(j||E)&&t.jsx("div",{className:"flex justify-center mt-1",children:t.jsx("span",{className:`text-[10px] font-semibold ${j?"text-red-600":"text-slate-500"}`,children:gr(e.status,e.minute)})}),t.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[t.jsx("div",{className:"relative min-h-6",children:t.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("H")})}),t.jsx("div",{className:"relative min-h-6",children:t.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("D")})}),t.jsx("div",{className:"relative min-h-6",children:t.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("A")})})]})]})})}function is({label:m,fixtures:p,picksByFixture:T,members:r,outcomes:e,liveScores:s,submittedMap:f,picksGw:c,isApiTestLeague:y=!1,isFirstSection:v=!1,hasLiveGames:a=!1,allGamesFinished:i=!1,allSubmitted:n=!1,resultsPublished:o=!1,deadlinePassed:g=!1,whoDidntSubmit:N=[],liveFixturesCount:E,hasStarted:j=!1}){return t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx(Ts,{date:m,className:"text-lg font-normal"}),v&&t.jsxs(t.Fragment,{children:[y&&a&&E!==void 0&&t.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-600 text-white text-sm font-bold border border-red-700 shadow-sm",style:{marginTop:"-2px"},children:[t.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),t.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"Live"}),t.jsxs("span",{className:"flex items-baseline gap-0.5",children:[t.jsx("span",{className:"text-base sm:text-lg font-extrabold",children:E}),t.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"/"}),t.jsx("span",{className:"text-sm sm:text-base font-semibold opacity-80",children:p.length})]})]}),y&&i&&t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),y&&!j&&t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),!y&&n&&o&&t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),!y&&n&&!o&&t.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),!y&&g&&!n&&t.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-orange-100 text-orange-800 text-sm font-bold border border-orange-300 shadow-sm",style:{marginTop:"-2px"},children:["Deadline Passed ",N.length>0&&`(${N.join(", ")} didn't submit)`]})]})]}),t.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:t.jsxs("ul",{children:[p.map(F=>{try{const U=T.get(F.fixture_index)??[],A=e.get(F.fixture_index)||null,P=s[F.fixture_index]||null;return t.jsx(pr,{fixture:F,picks:U,members:r,outcome:A,liveScore:P,submittedMap:f,picksGw:c,isApiTestLeague:y},`${F.gw}-${F.fixture_index}`)}catch(U){return console.error("Error rendering fixture:",U,F),t.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",F.fixture_index]},`${F.gw}-${F.fixture_index}`)}}),!p.length&&t.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]})}const St=8;function Bt(m){return m.result==="H"||m.result==="D"||m.result==="A"?m.result:typeof m.home_goals=="number"&&typeof m.away_goals=="number"?m.home_goals>m.away_goals?"H":m.home_goals<m.away_goals?"A":"D":null}function br({chat:m,userId:p,nameById:T,isMember:r,newMsg:e,setNewMsg:s,onSend:f,leagueCode:c,memberCount:y,maxMembers:v,notificationStatus:a}){const i=D.useRef(null),n=D.useRef(null),o=D.useRef(null),g=D.useRef(null),[N,E]=D.useState(0),j=()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},F=D.useCallback((x=[0,100,300,500,700])=>{requestAnimationFrame(()=>{x.forEach(M=>{setTimeout(()=>j(),M)})})},[]),U=D.useCallback((x,M=[0,100,300,500,700])=>{if(x>0){if(E(x),i.current){const l=Math.max(x+(o.current?.offsetHeight||0)+16,80);i.current.style.paddingBottom=`${l}px`}}else E(0),i.current&&(i.current.style.paddingBottom="");F(M)},[F]);D.useEffect(()=>{m.length>0&&setTimeout(()=>j(),100)},[m.length]),D.useEffect(()=>{!e&&o.current&&(o.current.style.height="auto",o.current.style.height="42px")},[e]),D.useEffect(()=>{const x=window.visualViewport;if(!x)return;let M=null,l=0;const d=()=>{M&&(clearTimeout(M),M=null),M=setTimeout(()=>{const b=window.innerHeight,k=x.height,w=x.offsetTop+k,L=b-w;Math.abs(L-l)<10&&L>0||(l=L,U(L))},50)};x.addEventListener("resize",d),x.addEventListener("scroll",d);const _=()=>{setTimeout(d,100),setTimeout(d,300)},S=setTimeout(()=>{o.current&&o.current.addEventListener("focus",_)},100);return d(),()=>{M&&clearTimeout(M),clearTimeout(S),x.removeEventListener("resize",d),x.removeEventListener("scroll",d),o.current&&o.current.removeEventListener("focus",_)}},[U]);const A=()=>{const x=window.visualViewport;x&&setTimeout(()=>{const M=window.innerHeight,l=x.height,d=x.offsetTop+l,_=M-d;U(_,[0,200,400,600,800])},100),F([200,400,600])};D.useEffect(()=>{if(typeof window>"u")return;const x=window.innerHeight,M=()=>{const l=x-window.innerHeight;U(l>0?l:0)};return window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[U]);const P=x=>{const M=x.target;!(M.tagName==="A"||M.tagName==="BUTTON"||M.closest("a, button"))&&o.current&&document.activeElement===o.current&&o.current.blur()};return t.jsxs("div",{className:"flex flex-col chat-container",style:{height:"100%"},children:[t.jsxs("div",{ref:i,className:"flex-1 overflow-y-auto px-3 pt-3 pb-4 min-h-0 messages-container",onClick:P,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:N>0?"0":"auto",cursor:"pointer"},children:[m.map((x,M)=>{const l=x.user_id===p,d=T.get(x.user_id)??"Unknown",_=new Date(x.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),S=m[M-1],b=m[M+1],k=S?.user_id===x.user_id,w=b?.user_id===x.user_id,L=!k,h=!w,u=!k&&!w,$=L&&w,I=k&&h,H=!l&&(u||I),X=d.split(/\s+/).map(B=>B[0]).join("").toUpperCase(),O=l?"flex justify-end":"flex items-end gap-2",Y=u?"single":$?"top":I?"bottom":"middle";return t.jsxs("div",{className:O,style:{marginTop:L?24:4},children:[!l&&t.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex justify-center self-end",children:H?t.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs font-semibold text-slate-500",children:X}):t.jsx("div",{className:"w-8 h-8"})}),t.jsx("div",{className:`flex flex-col gap-1 ${l?"items-end":"items-start"}`,children:t.jsx(ws,{author:!l&&L?d:void 0,text:x.content,time:_,isOwnMessage:l,shape:Y})})]},x.id)}),t.jsx("div",{ref:n,style:{height:"1px",width:"100%"}})]}),t.jsxs("div",{ref:g,className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:N>0?"fixed":"relative",bottom:N>0?`${N}px`:"auto",left:N>0?"0":"auto",right:N>0?"0":"auto",width:N>0?"100%":"auto",zIndex:N>0?1e3:"auto"},children:[r?t.jsxs("form",{onSubmit:x=>{x.preventDefault(),f()},className:"flex items-center gap-2",children:[t.jsx("textarea",{ref:o,value:e,onChange:x=>{s(x.target.value),o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},onFocus:A,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),e.trim()&&f())},placeholder:"Start typing...",maxLength:2e3,rows:1,className:"flex-1 rounded-xl border border-slate-300 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-transparent resize-none overflow-hidden",style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),t.jsx("button",{type:"submit",className:"flex-shrink-0 w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e.trim(),style:{backgroundColor:e.trim()?"#1C8376":"#94a3b8"},children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})})]}):t.jsx("div",{className:"rounded-md border border-amber-200 bg-amber-50 text-amber-800 p-3 text-sm",children:"Join this league to chat with other members."}),a&&t.jsx("div",{className:`w-full rounded px-2 py-1 text-xs mt-2 ${a.type==="success"?"bg-green-50 text-green-700 border border-green-200":a.type==="warning"?"bg-amber-50 text-amber-700 border border-amber-200":"bg-red-50 text-red-700 border border-red-200"}`,children:a.message})]})]})}function yr(){const{code:m=""}=Ms(),{user:p}=os(),[T]=D.useState(()=>{const C=localStorage.getItem("oldSchoolMode");return C?JSON.parse(C):!1});D.useEffect(()=>{localStorage.setItem("oldSchoolMode",JSON.stringify(T))},[T]),D.useEffect(()=>{const C=q=>{const J=q.target;(J.tagName==="INPUT"||J.tagName==="TEXTAREA")&&setTimeout(()=>{window.scrollTo(0,0);const V=document.querySelector(".league-header-fixed");V&&(V.style.top="0")},100)},z=()=>{const q=document.querySelector(".league-header-fixed");q&&(q.style.top="0")};return document.addEventListener("focusin",C),window.addEventListener("resize",z),window.addEventListener("orientationchange",z),()=>{document.removeEventListener("focusin",C),window.removeEventListener("resize",z),window.removeEventListener("orientationchange",z)}},[]),D.useEffect(()=>{if(typeof window>"u")return;const C=window.visualViewport;if(!C)return;let z=null;const q=()=>{const V=o.current;if(!V)return;const Z=C.offsetTop??0;V.style.setProperty("transform",`translate3d(0, ${Z}px, 0)`,"important")},J=()=>{z&&cancelAnimationFrame(z),z=window.requestAnimationFrame(q)};return J(),C.addEventListener("resize",J),C.addEventListener("scroll",J),()=>{z&&cancelAnimationFrame(z),C.removeEventListener("resize",J),C.removeEventListener("scroll",J),o.current&&o.current.style.removeProperty("transform")}},[]);const[r,e]=D.useState(null),[s,f]=D.useState([]),[c,y]=D.useState(!0),[v,a]=D.useState("chat-beta"),i=D.useRef(!1),n=D.useRef(!1),o=D.useRef(null),[g,N]=D.useState(!1),[E,j]=D.useState(!1),[F,U]=D.useState(!1),[A,P]=D.useState(null),[x,M]=D.useState(null),[l,d]=D.useState(null),[_,S]=D.useState([]),b=D.useRef({}),k=D.useRef(new Map),[w,L]=D.useState(new Set),[h,u]=D.useState(!1),[$,I]=D.useState(!1),[H,X]=D.useState(0),[O,Y]=D.useState(!1),[B,R]=D.useState(!1),[re,xe]=D.useState(!1),[ue,oe]=D.useState(!1),[pe,he]=D.useState(null),[Le,qe]=D.useState(!1),[Ye,_e]=D.useState(!1),[Ue,be]=D.useState(!1),[ge,Ee]=D.useState(!1),[Fe,we]=D.useState(!1),[He,Ce]=D.useState(!1),[ye,Re]=D.useState(!1),[Ke,ut]=D.useState(null),[Te,st]=D.useState(!1),[Ie,Ge]=D.useState(!1),[De,Xe]=D.useState(null),[Qe,Je]=D.useState([]),[ft,pt]=D.useState(""),[bt,We]=D.useState(null),mt=D.useMemo(()=>!!p?.id&&s.some(C=>C.id===p.id),[p?.id,s]),at=D.useMemo(()=>!!p?.id&&!!De&&De.id===p.id,[p?.id,De]),rt=D.useMemo(()=>De?.name??"League admin",[De]),et=D.useMemo(()=>{const C=new Map;return s.forEach(z=>C.set(z.id,z.name)),C},[s]),it=D.useCallback(()=>{if(!r?.code||typeof window>"u"||typeof navigator>"u")return;const C=`Join my mini league "${r.name}" on TotL!`,z=`${window.location.origin}/league/${r.code}`,q=navigator;if(typeof q.share=="function"){q.share({title:`Join ${r.name}`,text:C,url:z}).catch(V=>{console.warn("[League] Share cancelled",V)});return}const J=`${C}
${z}`;navigator.clipboard?.writeText?navigator.clipboard.writeText(J).then(()=>window.alert?.("League link copied to clipboard!")).catch(()=>{window.prompt?.("Share this league code:",r.code)}):window.prompt?.("Share this league code:",r.code)},[r]),ht=D.useCallback(async()=>{if(!(!r?.id||!p?.id)){U(!0);try{const{error:C}=await ne.from("league_members").delete().eq("league_id",r.id).eq("user_id",p.id);if(C)throw C;typeof window<"u"&&(window.location.href="/leagues")}catch(C){console.error("[League] Error leaving league:",C),typeof window<"u"&&window.alert?.(C?.message??"Failed to leave league. Please try again.")}finally{U(!1),j(!1)}}},[r?.id,p?.id]),jt=D.useCallback(async()=>{if(!(!r?.id||!p?.id)){Ee(!0);try{if(s.length>=St){typeof window<"u"&&window.alert?.("League is full (max 8 members)."),be(!1);return}const{error:C}=await ne.from("league_members").insert({league_id:r.id,user_id:p.id});if(C)throw C;typeof window<"u"&&window.location.reload()}catch(C){console.error("[League] Error joining league:",C),typeof window<"u"&&window.alert?.(C?.message??"Failed to join league.")}finally{Ee(!1)}}},[r?.id,p?.id,s.length]),ot=D.useCallback(async()=>{if(!(!Ke||!r?.id||!p?.id)){st(!0);try{const{error:C}=await ne.from("league_members").delete().eq("league_id",r.id).eq("user_id",Ke.id);if(C)throw C;typeof window<"u"&&window.location.reload()}catch(C){console.error("[League] Error removing member:",C),typeof window<"u"&&window.alert?.(C?.message??"Failed to remove member.")}finally{st(!1),Ce(!1),ut(null)}}},[r?.id,Ke,p?.id]),lt=D.useCallback(async()=>{if(!(!r?.id||!p?.id)){Ge(!0);try{const{error:C}=await ne.from("league_members").delete().eq("league_id",r.id);if(C)throw C;const{error:z}=await ne.from("leagues").delete().eq("id",r.id);if(z)throw z;typeof window<"u"&&(window.location.href="/leagues")}catch(C){console.error("[League] Error ending league:",C),typeof window<"u"&&window.alert?.(C?.message??"Failed to end league.")}finally{Ge(!1),Re(!1)}}},[r?.id,p?.id]),vs=D.useCallback(async C=>{if(!r?.id||!at){he("Only league admins can upload avatars.");return}if(!new Set(["image/png","image/jpeg","image/jpg","image/webp"]).has(C.type)){he("Please upload a PNG, JPG, or WebP image.");return}if(C.size>2*1024*1024){he("Please choose an image smaller than 2MB.");return}he(null),qe(!1),oe(!0);try{const q=await $e(C,{maxSizeMB:.02,maxWidthOrHeight:256,useWebWorker:!0,initialQuality:.8});if(q.size>20*1024)throw new Error("Compressed image is still larger than 20KB. Try a smaller image.");const V={"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp"}[q.type]??"jpg",Z=`${r.id}-${Date.now()}.${V}`,{error:te}=await ne.storage.from("league-avatars").upload(Z,q,{cacheControl:"3600",upsert:!0,contentType:q.type});if(te)throw te;const{data:fe}=ne.storage.from("league-avatars").getPublicUrl(Z),Ne=fe?.publicUrl;if(!Ne)throw new Error("Unable to get public URL for avatar.");const{error:me}=await ne.from("leagues").update({avatar:Ne}).eq("id",r.id);if(me)throw me;e(ce=>ce&&{...ce,avatar:Ne}),qe(!0)}catch(q){console.error("[League] Error uploading avatar:",q),he(q?.message??"Failed to upload avatar. Please try again.")}finally{oe(!1)}},[at,r?.id]),ys=D.useCallback(async()=>{if(!(!r?.id||!at)){he(null),qe(!1),oe(!0);try{const{error:C}=await ne.from("leagues").update({avatar:null}).eq("id",r.id);if(C)throw C;e(z=>z&&{...z,avatar:null}),qe(!0)}catch(C){console.error("[League] Error removing avatar:",C),he(C?.message??"Failed to remove avatar. Please try again.")}finally{oe(!1)}}},[at,r?.id]),[Ut,js]=D.useState(new Map);D.useEffect(()=>{(async()=>{const C=new Map,{data:z}=await ne.from("app_fixtures").select("gw, kickoff_time").order("gw",{ascending:!0}),{data:q}=await ne.from("app_fixtures").select("gw, kickoff_time").eq("gw",1).order("fixture_index",{ascending:!0}),J=new Map;if(z&&z.forEach(V=>{(!J.has(V.gw)||V.kickoff_time&&new Date(V.kickoff_time)<new Date(J.get(V.gw)))&&V.kickoff_time&&J.set(V.gw,V.kickoff_time)}),q&&q.length>0){const V=q.find(Z=>Z.kickoff_time)?.kickoff_time;if(V){const Z=J.get(1);(!Z||new Date(V)<new Date(Z))&&J.set(1,V)}}J.forEach((V,Z)=>{const te=new Date(V),fe=new Date(te.getTime()-4500*1e3);C.set(Z,fe)}),js(C)})()},[]),D.useEffect(()=>{const C=z=>{const q=z.target;h&&!q.closest(".gw-dropdown-container")&&u(!1)};return h&&document.addEventListener("click",C),()=>document.removeEventListener("click",C)},[h]),D.useEffect(()=>{let C=!0;return(async()=>{const{data:z}=await ne.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(!C)return;P(z?.current_gw??null);const{data:q}=await ne.from("app_gw_results").select("gw").order("gw",{ascending:!1}).limit(1);if(!C)return;M(q&&q.length?q[0].gw:null);const{data:J}=await ne.from("app_gw_results").select("gw").order("gw",{ascending:!1});if(!C)return;const V=J?[...new Set(J.map(te=>te.gw))].sort((te,fe)=>fe-te):[],Z=z?.current_gw;Z&&!V.includes(Z)&&V.unshift(Z),S(V),V.length>0&&d(V[0])})(),()=>{C=!1}},[]);const ct=D.useMemo(()=>s.map(C=>C.id),[s]),[Se,Ot]=D.useState([]),[wt,Ft]=D.useState([]),[Dt,Rt]=D.useState([]),[_t,Pt]=D.useState([]),qt=D.useMemo(()=>!Se||Se.length===0?[]:Se.map(C=>C.api_match_id).filter(C=>C!=null),[Se]),Nt=D.useMemo(()=>r?.name==="API Test",[r?.name]),[Ze,Kt]=D.useState(null);D.useEffect(()=>{if(!Nt){Kt(null);return}let C=!0;return(async()=>{const{data:z}=await ne.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();let q=z?.current_test_gw??1;if(q&&q!==1){const{data:J}=await ne.from("app_fixtures").select("gw").eq("gw",q).limit(1).maybeSingle();if(!J){const{data:V}=await ne.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();V&&(q=1)}}C&&Kt(q)})(),()=>{C=!1}},[Nt]);const _s=D.useMemo(()=>Nt&&Ze!==null?Ze:A||l||void 0,[Nt,Ze,A,l]),{liveScores:Vt}=Is(_s,qt.length>0?qt:void 0),ze=D.useMemo(()=>{const C={};return!Se||Se.length===0||Se.forEach(z=>{const q=z.api_match_id;if(q){const J=Vt.get(q);J&&(C[z.fixture_index]={homeScore:J.home_score??0,awayScore:J.away_score??0,status:J.status||"SCHEDULED",minute:J.minute??null})}}),C},[Vt,Se]),[Yt,vt]=D.useState([]),[Ns,yt]=D.useState(!1);D.useEffect(()=>{let C=!0;return(async()=>{y(!0);const{data:z}=await ne.from("leagues").select("id,name,code,created_at").eq("code",m).maybeSingle();if(!C)return;if(!z){e(null),f([]),y(!1);return}e(z);const{data:q}=await ne.from("league_members").select("users(id,name),created_at").eq("league_id",z.id).order("created_at",{ascending:!0}),J=q?.map(te=>({id:te.users.id,name:te.users.name??"(no name)"}))??[],V=[...J].sort((te,fe)=>te.name.localeCompare(fe.name));f(V);const Z=J[0];Xe(Z),p?.id&&!J.some(te=>te.id===p.id)&&be(!0),y(!1)})(),()=>{C=!1}},[m]),D.useEffect(()=>{},[r,v]),D.useEffect(()=>{if(v!=="chat"&&v!=="chat-beta"||!r?.id||!p?.id)return;(async()=>{await ne.from("league_message_reads").upsert({league_id:r.id,user_id:p.id,last_read_at:new Date().toISOString()},{onConflict:"league_id,user_id"})})()},[v,r?.id,p?.id]);const ks=D.useCallback(async(C,z=!1)=>{const{data:q,error:J}=await ne.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",C).order("created_at",{ascending:!1}).limit(500);if(!J&&q){const Z=(q??[]).reverse();z&&console.log("[Chat] Loaded messages:",Z.length,"from database (most recent)"),Je(te=>{const fe=new Set(te.map(Q=>Q.id)),Ne=Z.filter(Q=>!fe.has(Q.id));if(te.length===0)return z&&console.log("[Chat] Initial load, setting",Z.length,"messages"),Z;const ce=[...te,...Ne].sort((Q,ke)=>new Date(Q.created_at).getTime()-new Date(ke.created_at).getTime()),G=ce.length>500?ce.slice(-500):ce;return z&&console.log("[Chat] Merged messages. Previous:",te.length,"New from DB:",Ne.length,"Total:",ce.length,"After limit:",G.length),G})}else J&&console.error("[Chat] Error loading messages:",J)},[]);D.useEffect(()=>{if(!r?.id)return;let C=!0;const z=async()=>{C&&await ks(r.id,!0)};z();const q=ne.channel(`league-messages:${r.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${r.id}`},Z=>{const te=Z.new;console.log("[Chat] Realtime message received:",te.id,te.content.substring(0,50)),Je(fe=>{if(fe.some(me=>me.id===te.id))return console.log("[Chat] Message already exists, skipping"),fe;const Ne=[...fe,te];return console.log("[Chat] Added realtime message. Total messages:",Ne.length),Ne})}).subscribe(),J=()=>{!document.hidden&&r?.id&&C&&(console.log("[Chat] App became visible, refetching messages..."),z())},V=()=>{r?.id&&C&&(console.log("[Chat] Window gained focus, refetching messages..."),z())};return document.addEventListener("visibilitychange",J),window.addEventListener("focus",V),()=>{C=!1,ne.removeChannel(q),document.removeEventListener("visibilitychange",J),window.removeEventListener("focus",V)}},[r?.id]);const Cs=D.useCallback(async()=>{if(!r||!p?.id)return;const C=ft.trim();if(!C)return;pt("");const{data:z,error:q}=await ne.from("league_messages").insert({league_id:r.id,user_id:p.id,content:C}).select("id, league_id, user_id, content, created_at").single();q?(console.error(q),alert("Failed to send message.")):z&&Je(V=>[...V,z]),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||setTimeout(async()=>{try{const V=p.user_metadata?.display_name||p.email||"User",Z=await fetch("/.netlify/functions/notifyLeagueMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:r.id,senderId:p.id,senderName:V,content:C})}),te=await Z.json().catch(()=>({}));te.ok===!0?te.sent&&te.sent>0?We({message:` Message sent to ${te.sent} device${te.sent===1?"":"s"}`,type:"success"}):te.message==="No subscribed devices"?We({message:` No subscribed devices (${te.eligibleRecipients||0} eligible recipient${te.eligibleRecipients===1?"":"s"})`,type:"warning"}):te.message==="No devices"?We({message:` No devices registered (${te.eligibleRecipients||0} eligible recipient${te.eligibleRecipients===1?"":"s"})`,type:"warning"}):te.message==="No eligible recipients"?We({message:" All members are currently active",type:"success"}):We({message:` ${te.message||"Notification sent"}`,type:"success"}):te.ok===!1||te.error?We({message:` Failed to send notification: ${te.error||"Unknown error"}`,type:"error"}):Z.ok||We({message:` Notification error (HTTP ${Z.status})`,type:"error"}),setTimeout(()=>We(null),5e3)}catch(V){console.error("[Chat] Notification exception:",V),We({message:" Failed to send notification",type:"error"}),setTimeout(()=>We(null),5e3)}},100)},[r,p,ft,pt,Je,We]);D.useEffect(()=>{let C=!0;return(async()=>{const z=r?.name==="API Test";let q=Ze??1;if(z){const{data:me}=await ne.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();if(q=me?.current_test_gw??1,q&&q!==1){const{data:ce}=await ne.from("app_fixtures").select("gw").eq("gw",q).limit(1).maybeSingle();if(ce)console.log("[League] Using current_test_gw from meta:",q);else{const{data:G}=await ne.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();G&&(q=1,console.log("[League] No fixtures for current_test_gw, falling back to GW T1"))}}else console.log("[League] Using GW T1 or current_test_gw:",q)}const J=z&&(v==="gw"||v==="gwr");console.log("[League] Data fetch:",{isApiTestLeague:z,tab:v,useTestFixtures:J,leagueName:r?.name,testGwForData:q,willUseTestTables:J,willUseMainTables:!J});let V=v==="gwr"?n.current?l:A||l:A;if(z&&(v==="gw"||v==="gwr")&&(V=q),console.log("[League] gwForData calculation:",{tab:v,manualGwSelected:n.current,selectedGw:l,currentGw:A,gwForData:V,isApiTestLeague:z}),v==="gw"&&!z&&ct.length>0){const{data:me}=await ne.from("app_gw_submissions").select("gw").in("user_id",ct).not("submitted_at","is",null).order("gw",{ascending:!1}).limit(10);if(me&&me.length>0){const ce=[...new Set(me.map(G=>G.gw))].sort((G,Q)=>(Q||0)-(G||0));for(const G of ce)if(G){const{data:Q}=await ne.from("app_fixtures").select("gw").eq("gw",G).limit(1);if(Q&&Q.length>0){console.log("[League] Found fixtures for GW",G,"from submissions - using this GW (currentGw was",V,")"),V=G;break}}}!V&&A&&(V=A,console.log("[League] Using currentGw as fallback:",A))}if(console.log("[League] gwForData:",V,"memberIds:",ct),!V&&!J){Ot([]),Ft([]),Rt([]),Pt([]);return}let Z;if(J){const{data:me}=await ne.from("app_fixtures").select("id,test_gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,home_crest,away_crest,kickoff_time,api_match_id").eq("test_gw",q).order("fixture_index",{ascending:!0});Z=me?.map(ce=>({...ce,gw:ce.test_gw}))||null}else{console.log("[League] Fetching from MAIN database table (app_fixtures) for regular league, GW:",V);const{data:me}=await ne.from("app_fixtures").select("id,gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,kickoff_time,api_match_id").eq("gw",V).order("fixture_index",{ascending:!0});Z=me||null,console.log("[League] Fetched fixtures from main database:",me?.length||0,"fixtures")}if(!C)return;if(Ot(Z??[]),!ct.length){Ft([]),Rt([]),Pt([]);return}let te=null,fe;if(J){const{data:me}=await ne.from("app_picks").select("user_id,matchday,fixture_index,pick").eq("matchday",q).in("user_id",ct);te=me?.map(K=>({...K,gw:K.matchday}))||null;const{data:ce,error:G}=await ne.from("app_gw_submissions").select("user_id,matchday,submitted_at").eq("matchday",q).not("submitted_at","is",null).in("user_id",ct);G&&console.error("Error fetching test_api_submissions:",G);const{data:Q}=await ne.from("app_fixtures").select("fixture_index,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",q).order("fixture_index",{ascending:!0}),ke=new Set((Q||[]).map(K=>K.fixture_index));console.log("[League] Current fixture indices from test_api_fixtures:",Array.from(ke)),console.log("[League] Current fixtures:",Q?.map(K=>({index:K.fixture_index,home:K.home_team,away:K.away_team})));const W=[];if(ce&&te&&Q){const K=ke.size;console.log("[League] Required fixture count for valid submission:",K);const le=(Q||[]).map(ee=>ee.kickoff_time?new Date(ee.kickoff_time):null).filter(ee=>ee!==null&&!isNaN(ee.getTime())),se=le.length>0?new Date(Math.min(...le.map(ee=>ee.getTime()))):null,je=new Date("2025-11-18T00:00:00Z");console.log("[League] Submission cutoff date (submissions before this are old):",je.toISOString()),console.log("[League] Earliest kickoff:",se?.toISOString()),ce.forEach(ee=>{const ve=(te||[]).filter(Ae=>Ae.user_id===ee.user_id&&Ae.matchday===q),ae=ve.filter(Ae=>ke.has(Ae.fixture_index)),ie=ae.length===K&&K>0,de=new Set(ae.map(Ae=>Ae.fixture_index)),Ve=de.size===K,dt=ee.submitted_at?new Date(ee.submitted_at):null,Me=dt&&dt>=je;if(ie&&Ve&&Me)W.push(ee),console.log("[League]  VALID submission (has picks for ALL current fixtures AND recent submission):",{user_id:ee.user_id,submitted_at:ee.submitted_at,submissionDate:dt?.toISOString(),cutoffDate:je.toISOString(),picksCount:ve.length,picksForCurrentFixtures:ae.length,uniqueIndices:de.size,requiredCount:K});else{const Ae=[];ie||Ae.push("missing picks"),Ve||Ae.push("duplicate/extra picks"),Me||Ae.push(`old submission (${dt?.toISOString()} < ${je.toISOString()})`),console.log("[League]  INVALID submission:",{user_id:ee.user_id,submitted_at:ee.submitted_at,submissionDate:dt?.toISOString(),cutoffDate:je.toISOString(),picksCount:ve.length,picksForCurrentFixtures:ae.length,uniqueIndices:de.size,requiredCount:K,hasAllRequired:ie,hasExactMatch:Ve,isRecent:Me,reason:Ae.join(", ")})}})}fe=W.map(K=>({...K,gw:K.matchday}))||null,console.log("[League] Test API submissions fetched (filtered to only current fixtures):",fe),console.log("[League] Valid submissions count:",W.length,"out of",ce?.length||0,"total")}else{console.log("[League] Fetching from MAIN database tables (picks, gw_submissions) for regular league");const{data:me}=await ne.from("app_picks").select("user_id,gw,fixture_index,pick").eq("gw",V).in("user_id",ct);te=me,console.log("[League] Fetched picks from main database:",me?.length||0,"picks");const{data:ce}=await ne.from("app_gw_submissions").select("user_id,gw,submitted_at").eq("gw",V).in("user_id",ct);fe=ce,console.log("[League] Fetched submissions from main database:",ce?.length||0,"submissions")}if(!C)return;Ft(te??[]),Rt(fe??[]);const{data:Ne}=await ne.from("app_gw_results").select("gw,fixture_index,result").eq("gw",J?1:V||0);C&&Pt(Ne??[])})(),()=>{C=!1}},[v,A,x,l,ct]),D.useEffect(()=>{b.current=ze},[ze]);const Be=D.useMemo(()=>{const C=new Map;return console.log("[League] Building submittedMap from subs:",Dt),Dt.forEach(z=>{if(z.submitted_at){const q=`${z.user_id}:${z.gw}`;console.log(`[League] Adding submission key: ${q}`,z),C.set(q,!0)}else console.log("[League] Skipping submission with null submitted_at:",z)}),console.log("[League] Final submittedMap:",Array.from(C.entries())),C},[Dt]),kt=D.useCallback(C=>C.map(z=>({user_id:z.id,name:z.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]})),[]);D.useEffect(()=>{const C=ne.channel("gw-results-changes").on("postgres_changes",{event:"*",schema:"public",table:"gw_results"},()=>{X(z=>z+1)}).subscribe();return()=>{ne.removeChannel(C)}},[]),D.useEffect(()=>{let C=!0;return(async()=>{if(!s.length){vt([]);return}if(r?.name==="API Test"){vt(kt(s)),yt(!1);return}if(A===null)return;yt(!0);const{data:z}=await ne.from("gw_results").select("gw,fixture_index,result"),q=z??[],J=new Map;if(q.forEach(ee=>{const ve=Bt(ee);ve&&J.set(`${ee.gw}:${ee.fixture_index}`,ve)}),J.size===0){vt(kt(s)),yt(!1);return}const V=[...new Set(Array.from(J.keys()).map(ee=>parseInt(ee.split(":")[0],10)))].sort((ee,ve)=>ee-ve),Z=["Prem Predictions","FC Football","Easy League"],te=["The Bird league"],fe=await Us(r,A),Ne=V.filter(ee=>ee>=fe);if(!Z.includes(r?.name||"")&&!te.includes(r?.name||"")&&Ne.length===0){vt(kt(s)),yt(!1);return}const{data:me}=await ne.from("picks").select("user_id,gw,fixture_index,pick").in("user_id",s.map(ee=>ee.id)).in("gw",Ne),ce=me??[],G=new Map;Ne.forEach(ee=>{const ve=new Map;s.forEach(ae=>ve.set(ae.id,{user_id:ae.id,score:0,unicorns:0})),G.set(ee,ve)}),Ne.forEach(ee=>{Array.from(J.entries()).filter(([ae])=>parseInt(ae.split(":")[0],10)===ee).map(([ae,ie])=>({idx:parseInt(ae.split(":")[1],10),out:ie})).forEach(({idx:ae,out:ie})=>{const de=ce.filter(Me=>Me.gw===ee&&Me.fixture_index===ae),Ve=de.filter(Me=>Me.pick===ie).map(Me=>Me.user_id),dt=G.get(ee);if(de.forEach(Me=>{if(Me.pick===ie){const Ae=dt.get(Me.user_id);Ae.score+=1}}),Ve.length===1&&s.length>=3){const Me=Ve[0],Ae=dt.get(Me);Ae.unicorns+=1}})});const Q=new Map,ke=new Map,W=new Map,K=new Map,le=new Map,se=new Map;s.forEach(ee=>{Q.set(ee.id,0),ke.set(ee.id,0),W.set(ee.id,0),K.set(ee.id,0),le.set(ee.id,0),se.set(ee.id,[])}),Ne.forEach(ee=>{const ve=Array.from(G.get(ee).values());if(ve.forEach(de=>{ke.set(de.user_id,(ke.get(de.user_id)??0)+de.score),W.set(de.user_id,(W.get(de.user_id)??0)+de.unicorns)}),ve.sort((de,Ve)=>Ve.score-de.score||Ve.unicorns-de.unicorns),!ve.length)return;const ae=ve[0],ie=ve.filter(de=>de.score===ae.score&&de.unicorns===ae.unicorns);ie.length===1?(Q.set(ae.user_id,(Q.get(ae.user_id)??0)+3),K.set(ae.user_id,(K.get(ae.user_id)??0)+1),se.get(ae.user_id).push("W"),ve.slice(1).forEach(de=>se.get(de.user_id).push("L"))):(ie.forEach(de=>{Q.set(de.user_id,(Q.get(de.user_id)??0)+1),le.set(de.user_id,(le.get(de.user_id)??0)+1),se.get(de.user_id).push("D")}),ve.filter(de=>!ie.find(Ve=>Ve.user_id===de.user_id)).forEach(de=>se.get(de.user_id).push("L")))});const je=s.map(ee=>({user_id:ee.id,name:ee.name,mltPts:Q.get(ee.id)??0,ocp:ke.get(ee.id)??0,unicorns:W.get(ee.id)??0,wins:K.get(ee.id)??0,draws:le.get(ee.id)??0,form:se.get(ee.id)??[]}));je.sort((ee,ve)=>ve.mltPts-ee.mltPts||ve.unicorns-ee.unicorns||ve.ocp-ee.ocp||ee.name.localeCompare(ve.name)),C&&(vt(je),yt(!1))})(),()=>{C=!1}},[s,r,A,kt,H]);function Ss(){const C=["Prem Predictions","FC Football","Easy League"],z=["The Bird league"],q=["gregVjofVcarl","Let Down"],J=!!(r&&!C.includes(r.name)&&!z.includes(r.name)&&!q.includes(r.name)),V=Yt.length?Yt:s.map(Z=>({user_id:Z.id,name:Z.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]}));return s.length===1?t.jsxs("div",{className:"text-center p-8 bg-white rounded-xl border border-slate-200 shadow-sm",children:[t.jsx("div",{className:"text-6xl mb-4",children:""}),t.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Invite at least one more user to make the ML start"}),t.jsx("p",{className:"text-slate-600 mb-4",children:"Share your league code with friends to get the competition going!"}),t.jsx("button",{onClick:()=>_e(!0),className:"px-4 py-2 bg-[#1C8376] text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors",children:"Share League Code"})]}):t.jsxs("div",{className:"pt-4",children:[t.jsx(ur,{rows:V,members:s,showForm:g,currentUserId:p?.id,loading:Ns,isLateStartingLeague:J}),t.jsx("div",{className:"mt-6 flex justify-between items-center",children:t.jsxs("div",{className:"flex items-center justify-between w-full",children:[t.jsx(cr,{showForm:g,onToggle:N}),t.jsx(rs,{onClick:()=>{console.log("Button clicked, setting modal to true"),Y(!0)}})]})}),r?.name==="API Test"&&t.jsx("div",{className:"mt-4",style:{marginLeft:"-1rem",marginRight:"-1rem",width:"calc(100% + 2rem)",paddingLeft:0,paddingRight:0},children:t.jsx("video",{src:"/assets/Animation/Unicorn_Small.mov",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"auto",display:"block",padding:0,margin:0}})})]})}function As(){const C=r?.name==="API Test"?Ze??1:A;if(!C)return t.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No current game week available."});if(!Zt(r,C,Ut))return t.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Predictions Available"}),t.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),t.jsxs("div",{className:"text-sm",children:["GW",C," predictions are not included in this league."]})]})});const z=new Map;_t.forEach(W=>{if(W.gw!==C)return;const K=Bt(W);K&&z.set(W.fixture_index,K)}),Se.forEach(W=>{if(W.gw!==C)return;const K=ze[W.fixture_index];K&&(K.status==="IN_PLAY"||K.status==="PAUSED"||K.status==="FINISHED")&&(K.homeScore>K.awayScore?z.set(W.fixture_index,"H"):K.awayScore>K.homeScore?z.set(W.fixture_index,"A"):z.set(W.fixture_index,"D"))});const q=D.useMemo(()=>{const W=se=>{if(!se)return"Fixtures";const je=new Date(se);return isNaN(je.getTime())?"Fixtures":je.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})},K=new Map;Se.filter(se=>se.gw===C).forEach(se=>{const je=W(se.kickoff_time),ee=se.kickoff_time?new Date(se.kickoff_time).getTime():Number.MAX_SAFE_INTEGER;K.has(je)||K.set(je,{label:je,key:ee,items:[]}),K.get(je).items.push(se)});const le=Array.from(K.values());return le.forEach(se=>se.items.sort((je,ee)=>je.fixture_index-ee.fixture_index)),le.sort((se,je)=>se.key-je.key),le},[Se,C]),J=new Set(Se.filter(W=>W.gw===C).map(W=>W.fixture_index)),V=r?.name==="API Test",Z=s.length>0&&s.every(W=>Be.get(`${W.id}:${C}`));if(V&&C===(Ze??1)){console.log("[League] API Test filtering:",{currentFixtureIndices:Array.from(J),totalPicks:wt.length,picksForGw:wt.filter(K=>K.gw===C).length,submittedMapSize:Be.size,allSubmitted:Z,members:s.map(K=>({id:K.id,name:K.name,submitted:Be.get(`${K.id}:${C}`)})),fixturesCount:Se.filter(K=>K.gw===C).length});const W=wt.filter(K=>K.gw===C);console.log(`[League] All picks for GW${C}:`,W.map(K=>({user_id:K.user_id,userName:s.find(le=>le.id===K.user_id)?.name,fixture_index:K.fixture_index,pick:K.pick,hasSubmitted:!!Be.get(`${K.user_id}:${C}`),inCurrentFixtures:J.has(K.fixture_index)})))}const te=new Map;!V||Z?wt.forEach(W=>{if(W.gw!==C)return;if(V&&!Be.get(`${W.user_id}:${C}`)){C===1&&console.log("[League] API Test: Filtering out unsubmitted pick:",{user_id:W.user_id,fixture_index:W.fixture_index,userName:s.find(se=>se.id===W.user_id)?.name});return}if(!J.has(W.fixture_index)){V&&C===1&&console.log("[League] Filtering out old pick (not in current fixtures):",{fixture_index:W.fixture_index,currentIndices:Array.from(J),userName:s.find(le=>le.id===W.user_id)?.name});return}const K=te.get(W.fixture_index)??[];K.push(W),te.set(W.fixture_index,K)}):console.log("[League] API Test: Not all submitted - skipping ALL picks processing. allSubmitted=",Z);const fe=x!==null&&x>=C,Ne=s.filter(W=>!Be.get(`${W.id}:${C}`)).length,me=s.filter(W=>!Be.get(`${W.id}:${C}`)).map(W=>W.name),ce=Ut.get(C),G=ce?new Date>=ce:!1;if(V&&C===1){const W=s.map(se=>{const je=`${se.id}:${C}`,ee=Be.get(je);return{id:se.id,name:se.name,submitted:!!ee,key:je}});console.log(`[League] ===== API Test GW${C} SUBMISSION CHECK =====`),console.log("[League] All submitted:",Z),console.log("[League] Remaining:",Ne),console.log("[League] Who didn't submit:",me),console.log("[League] Member submission status:",W),console.log("[League] Submitted map entries:",Array.from(Be.entries())),console.log("[League] ================================================");const K=s.find(se=>se.name.toLowerCase().includes("steve")||se.name.toLowerCase().includes("s")),le=s.find(se=>se.name.toLowerCase().includes("jof")||se.name.toLowerCase().includes("j"));if(K){const se=`${K.id}:${C}`;console.log(`[League] STEVE (${K.name}):`,{id:K.id,submitted:!!Be.get(se),key:se})}if(le){const se=`${le.id}:${C}`;console.log(`[League] JOF (${le.name}):`,{id:le.id,submitted:!!Be.get(se),key:se})}}console.log(`GW${C} deadline check:`,{gwDeadline:ce,now:new Date,deadlinePassed:G,allSubmitted:Z,willShowPredictions:Z||G});const Q=V?!Z:!Z&&!G;return(V?!Z:!Z&&!G)?(console.log(`[League] Not all submitted, showing ONLY "Who's submitted" view. Blocking all predictions/fixtures.`,{isApiTestLeague:V,allSubmitted:Z,deadlinePassed:G,remaining:Ne}),t.jsx(ns,{members:s,submittedMap:Be,picksGw:C,allSubmitted:Z,remaining:Ne,fixtures:Se.filter(W=>W.gw===C),variant:"compact"})):t.jsxs("div",{className:"mt-2 pt-2",children:[Q?t.jsx(ns,{members:s,submittedMap:Be,picksGw:C,allSubmitted:Z,remaining:Ne,fixtures:Se.filter(W=>W.gw===C),variant:"full"}):null,r?.name==="API Test"&&Z&&q.length>0&&!Q&&(()=>{const W=q.flatMap(ae=>ae.items),K=new Set(W.map(ae=>ae.fixture_index)),le={};Object.keys(ze).forEach(ae=>{const ie=parseInt(ae,10);K.has(ie)&&(le[ie]=ze[ie])});const se=W.some(ae=>{const ie=le[ae.fixture_index];return ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED")}),je=W.length>0&&W.every(ae=>{const ie=le[ae.fixture_index];return ie&&ie.status==="FINISHED"}),ee=se||je||W.some(ae=>le[ae.fixture_index]);let ve=0;return p?.id&&W.forEach(ae=>{const ie=le[ae.fixture_index],de=ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED"),Ve=ie&&ie.status==="FINISHED";if(ie&&(de||Ve)){const Me=(te.get(ae.fixture_index)??[]).find(Ae=>Ae.user_id===p.id);if(Me){let Ae=!1;(Me.pick==="H"&&ie.homeScore>ie.awayScore||Me.pick==="A"&&ie.awayScore>ie.homeScore||Me.pick==="D"&&ie.homeScore===ie.awayScore)&&(Ae=!0),Ae&&ve++}}}),t.jsx("div",{className:"mt-3 space-y-6",children:q.map((ae,ie)=>t.jsx(is,{label:ae.label,fixtures:ae.items,picksByFixture:te,members:s,outcomes:z,liveScores:le,submittedMap:Be,picksGw:C,isApiTestLeague:!0,isFirstSection:ie===0,hasLiveGames:se,allGamesFinished:je,hasStarted:ee,liveFixturesCount:ve},ie))})})(),q.length>0&&r?.name!=="API Test"&&t.jsx("div",{className:"mt-3 space-y-6",children:q.map((W,K)=>t.jsx(is,{label:W.label,fixtures:W.items,picksByFixture:te,members:s,outcomes:z,liveScores:ze,submittedMap:Be,picksGw:C,isApiTestLeague:!1,isFirstSection:K===0,allSubmitted:Z,resultsPublished:fe,deadlinePassed:G,whoDidntSubmit:me},K))}),!q.length&&!Q&&t.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-500",children:["No fixtures for GW ",C,"."]})]})}function Ls(){const C=r?.name==="API Test"?Ze??1:v==="gwr"?n.current?l:A||l:l;if(!C||_.length===0&&r?.name!=="API Test")return t.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No game week selected."});if(!Zt(r,C,Ut))return t.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Results Available"}),t.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),t.jsxs("div",{className:"text-sm",children:["GW",C," results are not included in this league."]})]})});const z=new Map,q=r?.name==="API Test",J=Se.filter(G=>G.gw===C),V=J.some(G=>{const Q=ze[G.fixture_index];return Q&&(Q.status==="IN_PLAY"||Q.status==="PAUSED"||Q.status==="FINISHED")});console.log("[League] Live Table calculation:",{resGw:C,currentGw:A,selectedGw:l,hasLiveScores:V,liveScoresCount:Object.keys(ze).length,isApiTestLeague:q,fixturesCount:Se.length,fixturesForGwCount:J.length,manualGwSelected:n.current}),q&&C===(Ze??1)?J.forEach(G=>{const Q=ze[G.fixture_index];Q&&(Q.status==="IN_PLAY"||Q.status==="PAUSED"||Q.status==="FINISHED")&&(Q.homeScore>Q.awayScore?z.set(G.fixture_index,"H"):Q.awayScore>Q.homeScore?z.set(G.fixture_index,"A"):z.set(G.fixture_index,"D"))}):V&&C===A?(console.log("[League] Using live scores for regular league GW",C),J.forEach(G=>{const Q=ze[G.fixture_index];Q&&(Q.status==="IN_PLAY"||Q.status==="PAUSED"||Q.status==="FINISHED")&&(Q.homeScore>Q.awayScore?z.set(G.fixture_index,"H"):Q.awayScore>Q.homeScore?z.set(G.fixture_index,"A"):z.set(G.fixture_index,"D"))}),console.log("[League] Outcomes from live scores:",Array.from(z.entries()))):(console.log("[League] Using results table for GW",C,{hasLiveScores:V,resGwEqualsCurrentGw:C===A,resultsCount:_t.length,resultsForThisGw:_t.filter(G=>G.gw===C).length,manualGwSelected:n.current,selectedGw:l}),_t.forEach(G=>{if(G.gw!==C)return;const Q=Bt(G);Q&&z.set(G.fixture_index,Q)}),console.log("[League] Outcomes from results:",Array.from(z.entries())));const Z=s.map(G=>({user_id:G.id,name:G.name,score:0,unicorns:0})),te=new Map;wt.forEach(G=>{if(G.gw!==C)return;const Q=te.get(G.fixture_index)??[];Q.push(G),te.set(G.fixture_index,Q)}),Array.from(z.entries()).forEach(([G,Q])=>{const W=(te.get(G)??[]).filter(K=>K.pick===Q).map(K=>K.user_id);if(W.forEach(K=>{const le=Z.find(se=>se.user_id===K);le.score+=1}),W.length===1&&s.length>=3){const K=Z.find(le=>le.user_id===W[0]);K.unicorns+=1}}),Z.sort((G,Q)=>Q.score-G.score||Q.unicorns-G.unicorns||G.name.localeCompare(Q.name)),D.useEffect(()=>{if(Z.length===0)return;const G=new Map;Z.forEach((ke,W)=>{G.set(ke.user_id,W)});const Q=new Set;if(G.forEach((ke,W)=>{const K=k.current.get(W);K!==void 0&&K!==ke&&Q.add(W)}),k.current=G,Q.size>0){L(Q);const ke=setTimeout(()=>{L(new Set)},2e3);return()=>clearTimeout(ke)}},[Z.map(G=>`${G.user_id}-${G.score}-${G.unicorns}`).join(",")]);let fe=!1,Ne=!1,me=!1,ce=!1;if(q&&C===(Ze??1)){const G=Se;if(G.length>0&&(fe=G.every(ke=>{const W=ze[ke.fixture_index];return W&&W.status==="FINISHED"}),Ne=!!G.find(ke=>{const W=ze[ke.fixture_index];return W&&(W.status==="IN_PLAY"||W.status==="PAUSED")}),ce=G.some(ke=>{const W=ze[ke.fixture_index];return W&&(W.status==="IN_PLAY"||W.status==="PAUSED"||W.status==="FINISHED")}),!fe)){const ke=new Date;me=G.some(W=>{if(!W.kickoff_time)return!1;const le=new Date(W.kickoff_time).getTime()-ke.getTime(),se=ze[W.fixture_index];return(!se||se.status!=="IN_PLAY"&&se.status!=="PAUSED"&&se.status!=="FINISHED")&&le>0&&le<=1440*60*1e3})}}else{const G=Se.filter(Q=>Q.gw===C);G.length>0&&(fe=G.every(Q=>z.has(Q.fixture_index)))}return t.jsxs("div",{children:[t.jsx("style",{children:`
          @keyframes flash {
            0%, 100% {
              background-color: rgb(209, 250, 229);
            }
            25% {
              background-color: rgb(167, 243, 208);
            }
            50% {
              background-color: rgb(209, 250, 229);
            }
            75% {
              background-color: rgb(167, 243, 208);
            }
          }
          @keyframes pulse-score {
            0%, 100% {
              opacity: 1;
            }
            50% {
              opacity: 0.7;
            }
          }
          @keyframes position-change {
            0% {
              background-color: rgb(254, 243, 199);
            }
            50% {
              background-color: rgb(253, 230, 138);
            }
            100% {
              background-color: transparent;
            }
          }
          .flash-user-row {
            animation: flash 1.5s ease-in-out 3;
          }
          .pulse-live-score {
            animation: pulse-score 2s ease-in-out infinite;
          }
          .position-changed {
            animation: position-change 1.5s ease-out;
          }
          .full-width-header-border::after {
            content: '';
            position: absolute;
            left: -1rem;
            right: -1rem;
            bottom: 0;
            height: 1px;
            background-color: #cbd5e1;
            z-index: 1;
          }
        `}),Z.length>0&&fe&&t.jsx(or,{winnerName:Z[0].name,isDraw:Z[0].score===Z[1]?.score&&Z[0].unicorns===Z[1]?.unicorns}),t.jsx(fr,{rows:Z,members:s,currentUserId:p?.id,positionChangeKeys:w,isApiTestLeague:q,hasLiveFixtures:Ne,hasStartingSoonFixtures:me,hasStartedFixtures:ce,allFixturesFinished:fe,resGw:C}),_.length>1&&t.jsx("div",{className:"mt-6 mb-4 flex flex-col items-center gap-3 px-4",children:t.jsxs("div",{className:"flex items-center justify-center gap-3 w-full max-w-sm",children:[t.jsx(lr,{availableGws:_,selectedGw:C,onChange:G=>{n.current=!0,d(G)}}),t.jsx(rs,{onClick:()=>R(!0)})]})}),B&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>R(!1),children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:G=>G.stopPropagation(),children:[t.jsx("button",{onClick:()=>R(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{className:"p-6 pt-8",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Weekly Winner"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:" How to Win the Week:"}),t.jsxs("p",{className:"text-[#1C8376]/80",children:["The player with the ",t.jsx("strong",{children:"most correct predictions"})," wins that gameweek."]})]}),t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-purple-800 mb-2",children:" Unicorn Rule"}),t.jsxs("p",{className:"text-purple-700",children:["In Mini-Leagues with ",t.jsx("strong",{children:"3 or more players"}),", if you're the ",t.jsx("strong",{children:"only person"})," to correctly predict a fixture, that's a ",t.jsx("strong",{children:" Unicorn"}),". In ties, the player with most ",t.jsx("strong",{children:" Unicorns"})," wins!"]})]})]})]})]})})]})}return D.useEffect(()=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"auto"})},[v]),c?t.jsx("div",{className:"max-w-5xl mx-auto px-4 py-10",children:t.jsx("div",{className:"text-slate-500",children:"Loading"})}):!r&&!c?t.jsx("div",{className:"max-w-3xl mx-auto px-4 py-10",children:t.jsxs("div",{className:"rounded border bg-white p-6",children:[t.jsx("div",{className:"font-semibold mb-2",children:"League not found"}),t.jsx(Jt,{to:"/leagues",className:"text-slate-600 underline",children:"Back to Mini Leagues"})]})}):r?t.jsxs("div",{className:`${T?"oldschool-theme":"bg-slate-50"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",maxHeight:"100vh",overflow:"hidden"},children:[t.jsx("style",{children:`
        .league-header-fixed {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          z-index: 50 !important;
          transform: translate3d(0, 0, 0) !important;
          -webkit-transform: translate3d(0, 0, 0) !important;
          will-change: transform !important;
          contain: layout style paint !important;
        }
        .league-header-fixed .relative {
          position: relative !important;
          z-index: 100 !important;
        }
        @supports (height: 100dvh) {
          .league-header-fixed {
            top: env(safe-area-inset-top, 0px) !important;
          }
        }
        .league-content-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
          left: 0;
          right: 0;
          bottom: 0;
          overflow-y: auto;
          overflow-x: hidden;
          -webkit-overflow-scrolling: touch;
          overscroll-behavior: contain;
          padding-bottom: 2rem;
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .league-content-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
        }
        @media (max-width: 768px) {
          .league-content-wrapper {
            top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
            padding-bottom: 2rem;
            padding-left: 1rem;
            padding-right: 1rem;
          }
          .league-content-wrapper.has-banner {
            top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
          }
        }
        /* Chat tab - full height layout */
        .chat-tab-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px));
          left: 0;
          right: 0;
          bottom: 0;
          height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          z-index: 10;
          overflow: visible;
          pointer-events: none;
        }
        .chat-tab-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px));
          height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
        }
        .chat-tab-wrapper > * {
          pointer-events: auto;
        }
        @supports (height: 100dvh) {
          .chat-tab-wrapper {
            height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          }
          .chat-tab-wrapper.has-banner {
            height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          }
        }
      `}),t.jsx("div",{ref:o,className:"league-header-fixed bg-white border-b border-slate-200 shadow-sm",children:t.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[t.jsxs("div",{className:"flex items-center justify-between h-14",children:[t.jsx(Jt,{to:"/leagues",className:"flex items-center text-slate-600 hover:text-slate-900 transition-colors -ml-2 px-2 py-1",children:t.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),t.jsx("h1",{className:"text-lg font-normal text-slate-900 truncate flex-1 text-left px-2",children:r.name}),t.jsx("div",{className:"relative",style:{zIndex:100},children:t.jsx("button",{onClick:()=>we(!Fe),className:"flex items-center justify-center w-8 h-8 rounded-full hover:bg-slate-100 transition-colors -mr-2","aria-label":"Menu",children:t.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]}),t.jsxs("div",{className:"flex border-b border-slate-200 bg-white",children:[t.jsxs("button",{onClick:()=>{i.current=!0,a("chat-beta")},className:"flex-1 px-3 sm:px-6 py-3 text-[12px] font-semibold transition-colors relative "+(v==="chat-beta"?"text-[#1C8376]":"text-slate-400"),children:["Chat (beta)",v==="chat-beta"&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(_.length>0||r?.name==="API Test")&&t.jsxs("button",{onClick:()=>{i.current=!0,a("gwr")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight flex items-center justify-center gap-1.5 "+(v==="gwr"?"text-[#1C8376]":"text-slate-400"),children:[(()=>{const C=r?.name==="API Test"?Ze??1:A||l,z=r?.name==="API Test"?`T${C}`:C,q=new Date,J=Se[0],V=J?.kickoff_time?new Date(J.kickoff_time):null,Z=V&&V<=q,fe=Se[Se.length-1]?.fixture_index,me=(fe!==void 0?ze[fe]:null)?.status==="FINISHED",ce=Z&&!me,G=ce?"Live Table":"Results";return t.jsxs(t.Fragment,{children:[ce&&t.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse flex-shrink-0"}),t.jsx("span",{className:"hidden sm:inline",children:z?`GW ${z} ${G}`:`GW ${G}`}),t.jsx("span",{className:"sm:hidden whitespace-pre-line text-center",children:z?`GW${z}
${G}`:`GW
${G}`})]})})(),v==="gwr"&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(A||r?.name==="API Test")&&t.jsxs("button",{onClick:()=>{i.current=!0,a("gw")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight "+(v==="gw"?"text-[#1C8376]":"text-slate-400"),children:[t.jsx("span",{className:"hidden sm:inline",children:r?.name==="API Test"?`GW T${Ze??1} Predictions`:A?`GW ${A} Predictions`:"GW Predictions"}),t.jsx("span",{className:"sm:hidden whitespace-pre-line",children:r?.name==="API Test"?`GWT${Ze??1}
Predictions`:A?`GW${A}
Predictions`:`GW
Predictions`}),v==="gw"&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),t.jsxs("button",{onClick:()=>{i.current=!0,a("mlt")},className:"flex-1 px-3 sm:px-6 py-3 text-sm font-semibold transition-colors relative "+(v==="mlt"?"text-[#1C8376]":"text-slate-400"),children:["Table",v==="mlt"&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]})]})]})}),Fe&&typeof document<"u"&&document.body&&Ds.createPortal(t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0",onClick:()=>we(!1),style:{backgroundColor:"transparent",zIndex:99998}}),t.jsxs("div",{className:"fixed w-56 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",style:{zIndex:99999,top:"calc(3.5rem + 0.5rem + env(safe-area-inset-top, 0px))",right:"1rem"},children:[at&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"px-4 py-3 border-b border-slate-100",children:[t.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Admin:"}),t.jsx("div",{className:"text-sm font-semibold text-slate-800",children:rt})]}),t.jsx("button",{onClick:()=>{I(!0),we(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Manage"}),t.jsx("button",{onClick:()=>{xe(!0),we(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Upload avatar"})]}),t.jsx("button",{onClick:()=>{_e(!0),we(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Invite players"}),t.jsx("button",{onClick:()=>{it(),we(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:"Share league code"}),t.jsx("button",{onClick:()=>{j(!0),we(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Leave"})]})]}),document.body),v==="chat"?t.jsx("div",{className:"chat-tab-wrapper",children:t.jsx(br,{chat:Qe,userId:p?.id,nameById:et,isMember:mt,newMsg:ft,setNewMsg:pt,onSend:Cs,leagueCode:r?.code,memberCount:s.length,maxMembers:St,notificationStatus:bt})}):v==="chat-beta"?t.jsx("div",{className:"chat-tab-wrapper",children:t.jsx(ir,{miniLeagueId:r?.id??null,memberNames:et})}):t.jsx("div",{className:"league-content-wrapper",children:t.jsxs("div",{className:"px-1 sm:px-2",children:[v==="mlt"&&t.jsx(Ss,{}),v==="gw"&&t.jsx(As,{}),v==="gwr"&&t.jsx(Ls,{})]})}),at&&$&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>I(!1),children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:C=>C.stopPropagation(),children:[t.jsx("button",{onClick:()=>I(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{className:"p-6 pt-8",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Management"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm text-slate-600 mb-3 font-semibold",children:"Remove Members:"}),t.jsxs("div",{className:"space-y-2",children:[s.filter(C=>C.id!==p?.id).map(C=>t.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded-lg",children:[t.jsx("span",{className:"text-sm font-medium text-slate-800",children:C.name}),t.jsx("button",{onClick:()=>{ut(C),Ce(!0),I(!1)},className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium",children:"Remove"})]},C.id)),s.filter(C=>C.id!==p?.id).length===0&&t.jsx("div",{className:"text-sm text-slate-500 italic py-4 text-center",children:"No other members to remove"})]})]}),t.jsx("div",{className:"pt-4 border-t border-slate-200",children:t.jsx("button",{onClick:()=>{Re(!0),I(!1)},className:"w-full px-4 py-3 text-sm bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium flex items-center justify-center gap-2",children:" End League"})})]})]})]})}),at&&re&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>xe(!1),children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:C=>C.stopPropagation(),children:[t.jsx("button",{onClick:()=>{xe(!1),he(null),qe(!1)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{className:"p-6 pt-8",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Upload League Avatar"}),t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"text-sm text-slate-600 mb-2 font-medium",children:"Current Avatar:"}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-slate-100 flex items-center justify-center",children:t.jsx("img",{src:r?Fs(r):"/assets/league-avatars/ML-avatar-1.png",alt:"League avatar",className:"w-full h-full object-cover",onError:C=>{const z=C.target;z.src="/assets/league-avatars/ML-avatar-1.png"}})}),r?.avatar&&t.jsx("button",{onClick:ys,disabled:ue,className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium disabled:opacity-50",children:"Remove Avatar"})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Upload New Avatar"}),t.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:C=>{const z=C.target.files?.[0];z&&vs(z)},disabled:ue,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#1C8376] file:text-white hover:file:bg-emerald-700 file:cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),t.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Images will be automatically compressed to ~60KB and resized to 256x256px. Max file size: 2MB before compression."})]}),ue&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#1C8376]"}),t.jsx("span",{children:"Processing and uploading..."})]}),Le&&t.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800",children:" Avatar uploaded successfully!"}),pe&&t.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:pe})]})]})]})}),O&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>Y(!1),children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:C=>C.stopPropagation(),children:[t.jsx("button",{onClick:()=>Y(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),t.jsxs("div",{className:"p-6 pt-8",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Points"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:"League Points:"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),t.jsxs("span",{className:"text-[#1C8376]/80",children:[t.jsx("strong",{children:"Win the week"}),"  3 points"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),t.jsxs("span",{className:"text-[#1C8376]/80",children:[t.jsx("strong",{children:"Draw"}),"  1 point"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),t.jsxs("span",{className:"text-[#1C8376]/80",children:[t.jsx("strong",{children:"Lose"}),"  0 points"]})]})]})]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:" Ties"}),t.jsxs("p",{className:"text-blue-700",children:["If two or more players are tied on Points, the player with the most overall ",t.jsx("strong",{children:" Unicorns"})," in the mini league is ranked higher."]})]})]}),r&&(["The Bird league"].includes(r.name)||["gregVjofVcarl","Let Down"].includes(r.name))&&t.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsxs("p",{className:"text-blue-700 text-sm",children:[t.jsx("strong",{children:"Note:"}),' This mini league started after GW1, so the "CP" column shows correct predictions since this mini league began.']})})]})]})}),Ye&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Invite players"}),t.jsxs("p",{className:"text-slate-600 text-sm",children:["Share this code (up to ",St," members):"]}),t.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[t.jsx("code",{className:"font-mono text-lg font-bold",children:r.code}),t.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.code)},className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Copy"}),t.jsx("button",{onClick:it,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Share"})]}),t.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:[s.length,"/",St," members"]}),t.jsx("div",{className:"mt-6 flex justify-end",children:t.jsx("button",{onClick:()=>_e(!1),className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-50",children:"Close"})})]})}),E&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Leave League"}),t.jsxs("p",{className:"text-slate-600 mb-6",children:['Are you sure you want to leave "',r?.name,`"? You'll need the league code to rejoin later.`]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:F,children:"Cancel"}),t.jsx("button",{onClick:ht,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:F,children:F?"Leaving...":"Leave League"})]})]})}),Ue&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Join Mini League"}),t.jsxs("p",{className:"text-slate-600 mb-6",children:["You are about to join ",t.jsxs("strong",{children:['"',r?.name,'"']}),". Are you sure?"]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>be(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:ge,children:"Cancel"}),t.jsx("button",{onClick:jt,className:"flex-1 px-4 py-2 bg-[#1C8376] text-white rounded-md hover:bg-emerald-700 transition-colors disabled:opacity-50",disabled:ge,children:ge?"Joining...":"Join League"})]})]})}),He&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Remove Member"}),t.jsxs("p",{className:"text-slate-600 mb-6",children:["Are you sure you want to remove ",t.jsxs("strong",{children:['"',Ke?.name,'"']})," from the league? They will need the league code to rejoin."]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>Ce(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Te,children:"Cancel"}),t.jsx("button",{onClick:ot,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:Te,children:Te?"Removing...":"Remove Member"})]})]})}),ye&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:" End League"}),t.jsxs("p",{className:"text-slate-600 mb-4",children:["Are you absolutely sure you want to ",t.jsx("strong",{children:"permanently end"})," the league ",t.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),t.jsx("p",{className:"text-sm text-red-600 mb-6",children:"This will remove all members and delete the league forever. This action cannot be undone!"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>Re(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Ie,children:"Cancel"}),t.jsx("button",{onClick:lt,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:Ie,children:Ie?"Ending...":"Yes, End League"})]})]})}),r?.name==="API Test"&&t.jsx("div",{className:"mt-6 mb-4 px-4 py-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:t.jsxs("div",{className:"text-sm text-yellow-800",children:[t.jsx("strong",{children:" Test League:"})," This league uses test API data and starts from Test GW 1 with zero points. It does not affect your main game scores."]})})]}):null}export{yr as default};
