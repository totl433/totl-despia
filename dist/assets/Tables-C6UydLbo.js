import{u as Pe,r as _,s as m,j as e,L as De}from"./index-D_YpmWng.js";import{g as je,a as Te,b as Ge}from"./leagueAvatars-xOLkuGns.js";function Fe(a){const d=["th","st","nd","rd"],l=a%100;return a+(d[(l-20)%10]||d[l]||d[0])}function Re(a){const d=(a||"?").trim().split(/\s+/);return d.length?d.length===1?d[0].slice(0,1).toUpperCase():(d[0][0]+d[d.length-1][0]).toUpperCase():"?"}function We(a){return a.result==="H"||a.result==="D"||a.result==="A"?a.result:typeof a.home_goals=="number"&&typeof a.away_goals=="number"?a.home_goals>a.away_goals?"H":a.home_goals<a.away_goals?"A":"D":null}function ke(a){return a?a instanceof Set?a:new Set(a):new Set}let M=null;function He(){const{user:a}=Pe(),[d,l]=_.useState([]),[te,k]=_.useState(!0),[ne,B]=_.useState(!0),[me,se]=_.useState(!1),[ie,ge]=_.useState(""),[U,F]=_.useState(""),[I,S]=_.useState(""),[ae,$]=_.useState({}),[y,V]=_.useState({}),[we,fe]=_.useState({}),[H,Ce]=_.useState(null);async function he(){k(!0),S("");try{if(!a?.id){l([]),k(!1);return}const{data:c,error:v}=await m.from("league_members").select("league_id").eq("user_id",a.id);if(v)throw v;const N=(c??[]).map(n=>n.league_id);if(!N.length){l([]),k(!1);return}let f=[];const{data:z,error:pe}=await m.from("leagues").select("id,name,code,created_at,avatar,start_gw").in("id",N).order("created_at",{ascending:!0});if(pe){console.error("Error fetching leagues with avatar:",pe);const{data:n,error:h}=await m.from("leagues").select("id,name,code,created_at").in("id",N).order("created_at",{ascending:!0});if(h)throw h;f=n??[]}else f=z??[];const J=f.filter(n=>!n.avatar||n.avatar===null||n.avatar==="");if(J.length>0&&(J.forEach(n=>{n.avatar=je(n.id)}),Promise.all(J.map(n=>{const h=je(n.id);return Promise.resolve(m.from("leagues").update({avatar:h}).eq("id",n.id).then(()=>console.log(`Assigned avatar ${h} to league ${n.name}`))).catch(w=>console.warn(`Failed to assign avatar to league ${n.id}:`,w))})).catch(()=>{})),!f.length){l([]),k(!1);return}const{data:E,error:oe}=await m.from("league_members").select("league_id,user_id").in("league_id",f.map(n=>n.id));if(oe)throw oe;const R=new Map;(E??[]).forEach(n=>{const h=R.get(n.league_id)??[];h.push(n.user_id),R.set(n.league_id,h)});const{data:X}=await m.from("fixtures").select("gw").order("gw",{ascending:!1}),T=X??[],be=T.length?Math.max(...T.map(n=>n.gw)):1,O={},le=Array.from(new Set(Array.from(R.values()).flat())),W=f.find(n=>n.name==="API Test");let xe=null,de=new Set;if(W){const{data:n}=await m.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();xe=n?.current_test_gw??1;const h=R.get(W.id)??[];if(h.length>0){const{data:w}=await m.from("test_api_submissions").select("user_id").eq("matchday",xe).in("user_id",h).not("submitted_at","is",null);de=new Set((w??[]).map(u=>u.user_id))}}if(le.length>0){const n=W?le.filter(u=>!R.get(W.id)?.includes(u)):le,{data:h}=n.length>0?await m.from("gw_submissions").select("user_id").eq("gw",be).in("user_id",n):{data:[]},w=new Set((h??[]).map(u=>u.user_id));for(const u of f){const t=R.get(u.id)??[],r=t.length,p=u.id===W?.id?t.filter(g=>de.has(g)).length:t.filter(g=>w.has(g)).length;O[u.id]={allSubmitted:p===r&&r>0,submittedCount:p,totalCount:r}}}else for(const n of f)O[n.id]={allSubmitted:!1,submittedCount:0,totalCount:0};$(O);const Z={};try{const{data:n}=await m.from("league_message_reads").select("league_id,last_read_at").eq("user_id",a.id),h=new Map;(n??[]).forEach(u=>h.set(u.league_id,u.last_read_at));const w=f.map(u=>u.id);if(w.length>0){const u=new Map;w.forEach(g=>{u.set(g,h.get(g)??"1970-01-01T00:00:00Z")});const t=Math.min(...Array.from(u.values()).map(g=>new Date(g).getTime())),r=new Date(t).toISOString(),{data:p}=await m.from("league_messages").select("id,league_id,created_at").in("league_id",w).gte("created_at",r);w.forEach(g=>{const b=u.get(g),A=(p??[]).filter(P=>P.league_id===g&&new Date(P.created_at)>new Date(b)).length;Z[g]=A})}}catch(n){console.warn("Failed to fetch unread counts:",n)}fe(Z);const ce=f.map(n=>{const h=R.get(n.id)??[];return{id:n.id,name:n.name,code:n.code,memberCount:h.length,avatar:n.avatar,created_at:n.created_at,start_gw:n.start_gw}});ce.sort((n,h)=>{const w=Z[n.id]??0,u=Z[h.id]??0;return w>0&&u===0?-1:w===0&&u>0?1:0}),l(ce),a?.id&&(M={rows:ce,leagueSubmissions:O,leagueData:{},unreadByLeague:Z,lastFetched:Date.now(),userId:a.id})}catch(c){S(c?.message??"Failed to load leagues.")}finally{k(!1)}}_.useEffect(()=>{if(!a?.id){k(!1);return}if(M&&M.userId===a.id&&M.rows.length>0){const c=Date.now()-M.lastFetched,v=30*1e3;if(c<v){if(l(M.rows),$(M.leagueSubmissions),V(M.leagueData),fe(M.unreadByLeague),k(!1),B(!1),c<30*1e3)return;he();return}}he()},[a?.id]),_.useEffect(()=>{if(!d.length||!a?.id){B(!1);return}B(!0);let c=!0;return(async()=>{const[v,N]=await Promise.all([m.from("meta").select("current_gw").eq("id",1).maybeSingle(),m.from("gw_results").select("gw,fixture_index,result")]),f=v.data?.current_gw??1;c&&Ce(f);const{data:z}=N,pe=z??[],J=new Map;pe.forEach(t=>{const r=We(t);r&&J.set(`${t.gw}:${t.fixture_index}`,r)});const E={},oe=d.map(t=>t.id),{data:R}=await m.from("league_members").select("league_id,user_id, users(id, name)").in("league_id",oe),X=new Map;(R??[]).forEach(t=>{if(!t.users?.name)return;const r=X.get(t.league_id)??[];r.push({id:t.user_id,name:t.users.name}),X.set(t.league_id,r)});const T=[...new Set(Array.from(J.keys()).map(t=>parseInt(t.split(":")[0],10)))].sort((t,r)=>t-r),{data:be}=await m.from("leagues").select("id,name,created_at,start_gw").in("id",oe),O=new Map;(be??[]).forEach(t=>{O.set(t.id,t)});const{data:le}=await m.from("fixtures").select("gw,kickoff_time").in("gw",T).order("gw",{ascending:!0}).order("kickoff_time",{ascending:!0}),W=new Map;(le??[]).forEach(t=>{const r=W.get(t.gw)??[];r.push(t.kickoff_time),W.set(t.gw,r)});const xe=new Set,de=new Map;for(const t of d){const r=O.get(t.id),p={id:t.id,name:r?.name??t.name,created_at:(r?.created_at??t.created_at)||null,start_gw:r?.start_gw??t.start_gw};let g=f;const b={"Prem Predictions":0,"FC Football":0,"Easy League":0,"API Test":999,"The Bird league":7,gregVjofVcarl:8,"Let Down":8},A=p.name?b[p.name]:void 0;if(typeof A=="number")g=A;else if(p.start_gw!==null&&p.start_gw!==void 0)g=p.start_gw;else if(p.created_at&&T.length>0){const j=new Date(p.created_at),K=75;for(const q of T){const C=W.get(q);if(C&&C.length>0){const Y=new Date(C[0]),G=new Date(Y.getTime()-K*60*1e3);if(j<=G){g=q;break}}}g===f&&T.length>0&&(g=Math.max(...T)+1)}de.set(t.id,g),T.filter(j=>j>=g).forEach(j=>xe.add(j))}const Z=Array.from(new Set(Array.from(X.values()).flat().map(t=>t.id))),{data:ce}=Z.length>0?await m.from("gw_submissions").select("user_id").eq("gw",f).in("user_id",Z):{data:[]},n=new Set((ce??[]).map(t=>t.user_id)),h=d.find(t=>t.name==="API Test"),w=new Set;let u=1;if(h){const{data:t}=await m.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();u=t?.current_test_gw??1;const r=X.get(h.id)?.map(p=>p.id)??[];if(r.length>0){const{data:p}=await m.from("test_api_submissions").select("user_id,submitted_at").eq("matchday",u).in("user_id",r).not("submitted_at","is",null),{data:g}=await m.from("test_api_picks").select("user_id,fixture_index").eq("matchday",u).in("user_id",r),{data:b}=await m.from("test_api_fixtures").select("fixture_index").eq("test_gw",u).order("fixture_index",{ascending:!0});if(b&&g&&p){const A=new Set(b.map(j=>j.fixture_index)),P=A.size;console.log(`[Tables] Checking Test API submissions for GW ${u}:`,{currentTestGw:u,submissionCount:p.length,fixtureCount:P,fixtureIndices:Array.from(A)}),p.forEach(j=>{const K=(g??[]).filter(re=>re.user_id===j.user_id),q=K.filter(re=>A.has(re.fixture_index)),C=q.length===P&&P>0,G=new Set(q.map(re=>re.fixture_index)).size===P;console.log(`[Tables] User ${j.user_id} submission check:`,{userPicksCount:K.length,picksForCurrentFixtures:q.length,requiredCount:P,hasAllRequiredPicks:C,hasExactMatch:G,willBeCounted:C&&G}),C&&G&&w.add(j.user_id)}),console.log(`[Tables] Final Test API submitted users for GW ${u}:`,Array.from(w))}else console.log("[Tables] Missing data for Test API validation:",{hasCurrentTestFixtures:!!b,hasTestApiPicks:!!g,hasTestSubsData:!!p})}}await Promise.all(d.map(async t=>{try{const r=(X.get(t.id)??[]).filter(s=>s.name!=="Unknown"),p=O.get(t.id);if(t.name==="API Test"||p?.name==="API Test"){const s=r.sort((o,L)=>o.name.localeCompare(L.name)).map(o=>o.id),i=new Set;r.forEach(o=>{w.has(o.id)&&i.add(o.id)}),console.log(`[Tables] API Test league submittedMembers for GW ${u??"unknown"}:`,{testApiSubmittedUserIds:Array.from(w),submittedMembers:Array.from(i),memberIds:r.map(o=>o.id)}),E[t.id]={id:t.id,members:r.sort((o,L)=>o.name.localeCompare(L.name)),userPosition:s.indexOf(a.id)+1||null,positionChange:null,sortedMemberIds:s,latestGwWinners:new Set,latestRelevantGw:null,submittedMembers:i};return}if(r.length===0){E[t.id]={id:t.id,members:[],userPosition:null,positionChange:null,sortedMemberIds:[],latestGwWinners:new Set};return}if(J.size===0){const s=r.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>i.id);E[t.id]={id:t.id,members:r.sort((i,o)=>i.name.localeCompare(o.name)),userPosition:null,positionChange:null,sortedMemberIds:s,latestGwWinners:new Set};return}const g=de.get(t.id)??f,b=T.filter(s=>s>=g);if(b.length===0){const s=r.sort((i,o)=>i.name.localeCompare(o.name)).map(i=>i.id);E[t.id]={id:t.id,members:r.sort((i,o)=>i.name.localeCompare(o.name)),userPosition:null,positionChange:null,sortedMemberIds:s,latestGwWinners:new Set};return}const A=r.map(s=>s.id),{data:P}=await m.from("picks").select("user_id,gw,fixture_index,pick").in("user_id",A).in("gw",b),j=P??[],K=new Map,q=new Map;b.forEach(s=>{const i=new Map;r.forEach(o=>i.set(o.id,{user_id:o.id,score:0,unicorns:0})),K.set(s,i)}),b.forEach(s=>{Array.from(J.entries()).filter(([o])=>parseInt(o.split(":")[0],10)===s).map(([o,L])=>({idx:parseInt(o.split(":")[1],10),out:L})).forEach(({idx:o,out:L})=>{const x=j.filter(D=>D.gw===s&&D.fixture_index===o),ue=x.filter(D=>D.pick===L).map(D=>D.user_id),ye=K.get(s);if(x.forEach(D=>{if(D.pick===L){const ve=ye.get(D.user_id);ve.score+=1}}),ue.length===1&&r.length>=3){const D=ue[0],ve=ye.get(D);ve.unicorns+=1}})});const C=new Map,Y=new Map,G=new Map;r.forEach(s=>{C.set(s.id,0),Y.set(s.id,0),G.set(s.id,0)}),b.forEach(s=>{const i=Array.from(K.get(s).values());if(i.forEach(x=>{Y.set(x.user_id,(Y.get(x.user_id)??0)+x.score),G.set(x.user_id,(G.get(x.user_id)??0)+x.unicorns)}),i.sort((x,ue)=>ue.score-x.score||ue.unicorns-x.unicorns),!i.length)return;const o=i[0],L=i.filter(x=>x.score===o.score&&x.unicorns===o.unicorns);q.set(s,new Set(L.map(x=>x.user_id))),L.length===1?C.set(o.user_id,(C.get(o.user_id)??0)+3):L.forEach(x=>{C.set(x.user_id,(C.get(x.user_id)??0)+1)})});const Q=[...r.map(s=>({user_id:s.id,name:s.name,mltPts:C.get(s.id)??0,unicorns:G.get(s.id)??0,ocp:Y.get(s.id)??0}))].sort((s,i)=>i.mltPts-s.mltPts||i.unicorns-s.unicorns||i.ocp-s.ocp||s.name.localeCompare(i.name));let ee=Q.findIndex(s=>s.user_id===a.id);if(ee===-1){const s=r.findIndex(i=>i.id===a.id);s!==-1&&(Q.push({user_id:a.id,name:r[s].name,mltPts:0,unicorns:0,ocp:0}),Q.sort((i,o)=>o.mltPts-i.mltPts||o.unicorns-i.unicorns||o.ocp-i.ocp||i.name.localeCompare(o.name)),ee=Q.findIndex(i=>i.user_id===a.id))}const Me=Q.map(s=>s.user_id);console.log(`[${t.name}] Position calculation:`,{userId:a.id,userIndex:ee,userPosition:ee!==-1?ee+1:null,rowsCount:Q.length,rows:Q.map((s,i)=>({index:i+1,name:s.name,userId:s.user_id,mltPts:s.mltPts,unicorns:s.unicorns,ocp:s.ocp})),sortedMemberIds:Me,memberIds:r.map(s=>s.id),userInMembers:r.some(s=>s.id===a.id),userInRows:Q.some(s=>s.user_id===a.id),leagueStartGw:g,relevantGws:b,picksCount:j.length,currentGw:f});const Le=ee!==-1?ee+1:null,_e=b.length?Math.max(...b):null,Ee=_e!==null?q.get(_e)??new Set:new Set,Se=new Set;A.forEach(s=>{n.has(s)&&Se.add(s)});const Ae={id:t.id,members:r.sort((s,i)=>s.name.localeCompare(i.name)),userPosition:Le,positionChange:null,submittedMembers:Se,sortedMemberIds:[...Me],latestGwWinners:new Set(Ee),latestRelevantGw:_e};E[t.id]=Ae}catch(r){console.error(`Error loading data for league ${t.id} (${t.name}):`,r),console.error("Error details:",r instanceof Error?r.message:r),E[t.id]={id:t.id,members:[],userPosition:null,positionChange:null,sortedMemberIds:[],latestGwWinners:new Set,latestRelevantGw:null}}})),c&&(V(E),B(!1),a?.id&&(M&&M.userId===a.id?(M.leagueData=E,M.lastFetched=Date.now()):M={rows:d,leagueSubmissions:{},leagueData:E,unreadByLeague:{},lastFetched:Date.now(),userId:a.id}))})(),()=>{c=!1}},[d,a?.id]);async function Ie(){if(!(!U.trim()||!a?.id)){se(!0),S("");try{const c=U.trim(),v=await Ue(),{data:N,error:f}=await m.from("leagues").insert({name:c,code:v}).select("id,code").single();if(f)throw f;const z=je(N.id);await m.from("leagues").update({avatar:z}).eq("id",N.id),await m.from("league_members").insert({league_id:N.id,user_id:a.id}),F(""),await he()}catch(c){S(c?.message??"Failed to create league.")}finally{se(!1)}}}async function Ne(){const c=ie.trim().toUpperCase();if(!(!c||!a?.id)){S("");try{const{data:v,error:N}=await m.from("leagues").select("id").eq("code",c).maybeSingle();if(N)throw N;if(!v){S("League code not found.");return}const{data:f,error:z}=await m.from("league_members").select("user_id").eq("league_id",v.id);if(z)throw z;if(f&&f.length>=8){S("League is full (max 8 members).");return}await m.from("league_members").upsert({league_id:v.id,user_id:a.id},{onConflict:"league_id,user_id"}),ge(""),await he()}catch(v){S(v?.message??"Failed to join league.")}}}return e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 pb-16",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-semibold tracking-tight text-slate-900",children:"Mini Leagues"}),d.length>4&&e.jsxs("button",{onClick:()=>{const c=document.getElementById("create-join-section");c&&c.scrollIntoView({behavior:"smooth",block:"start"})},className:"text-[#1C8376] font-semibold text-sm hover:text-[#1C8376] no-underline flex items-center gap-1",children:["Create League",e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),e.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600 w-full",children:"Create or join a private league and battle it out with your friends."}),I&&e.jsx("div",{className:"mt-4 rounded border border-rose-200 bg-rose-50 text-rose-700 px-3 py-2 text-sm",children:I}),e.jsx("div",{className:"mt-6",children:te||ne?e.jsx(Be,{}):d.length===0?e.jsx("div",{className:"px-4 py-4 text-sm",children:"No leagues yet."}):e.jsx("div",{className:"space-y-3",children:d.map(c=>e.jsx(qe,{row:c,data:y[c.id],unread:we?.[c.id]??0,submissions:ae[c.id],leagueDataLoading:ne,currentGw:H},c.id))})}),e.jsx("div",{id:"create-join-section",className:"mt-10 mb-3 text-xl font-extrabold text-slate-900",children:"Create or Join"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-2xl p-4 bg-white",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Create a league"}),e.jsx("input",{className:"border rounded px-3 py-2 w-full bg-white",placeholder:"League name",value:U,onChange:c=>F(c.target.value)}),e.jsx("button",{className:"mt-3 px-3 py-2 rounded bg-slate-900 text-white disabled:opacity-50",onClick:Ie,disabled:me||!U.trim(),children:me?"Creating…":"Create"})]}),e.jsxs("div",{className:"border rounded-2xl p-4 bg-white",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Join with code"}),e.jsx("input",{className:"border rounded px-3 py-2 w-full uppercase tracking-widest bg-white",placeholder:"ABCDE",value:ie,onChange:c=>ge(c.target.value)}),e.jsx("button",{className:"mt-3 px-3 py-2 rounded border",onClick:Ne,children:"Join"})]})]})]})})}const qe=_.memo(function({row:d,data:l,unread:te,submissions:k,leagueDataLoading:ne,currentGw:B}){const me=l?.members??[],se=l?.userPosition,ie=te>0?Math.min(te,99):0,ge=_.useMemo(()=>{if(ne||!l)return[];const F=l.members??[];if(!F.length)return[];const I=l.sortedMemberIds&&l.sortedMemberIds.length>0?l.sortedMemberIds.map(y=>F.find(V=>V.id===y)).filter(y=>y!==void 0):[...F].sort((y,V)=>y.name.localeCompare(V.name)),S=ke(l.submittedMembers),ae=ke(l.latestGwWinners),$=d.name==="API Test";return I.slice(0,8).map((y,V)=>{const we=S.has(y.id),fe=ae.has(y.id);let H="chip-container rounded-full flex items-center justify-center text-[10px] font-medium flex-shrink-0 w-6 h-6";return fe&&l.latestRelevantGw!==null&&B!==null&&l.latestRelevantGw===B?H+=" bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 font-semibold relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s]":we?(H+=" chip-green",$&&(H+=" border-2 border-blue-600")):H+=" chip-grey",V>0&&(H+=" chip-overlap"),e.jsx("div",{className:H,title:y.name,children:Re(y.name)},y.id)})},[l,ne,d.name,B]),U=_.useMemo(()=>{if(!l)return 0;const I=((l.sortedMemberIds&&l.sortedMemberIds.length>0?l.sortedMemberIds:l.members?.map(S=>S.id))??[]).length;return I>8?I-8:0},[l]);return e.jsx("div",{className:"rounded-xl border bg-white overflow-hidden shadow-sm w-full",style:{borderRadius:"12px"},children:e.jsxs(De,{to:`/league/${d.code}`,className:"block p-6 !bg-white no-underline hover:text-inherit relative z-20",children:[e.jsxs("div",{className:"flex items-start gap-3 relative",children:[e.jsx("div",{className:"flex-shrink-0 w-14 h-14 rounded-full flex items-center justify-center overflow-hidden bg-slate-100",children:e.jsx("img",{src:Te(d),alt:`${d.name} avatar`,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:F=>{const I=F.target,ae=`/assets/league-avatars/${Ge(d.id)}`;if(I.src!==ae)I.src=ae;else{I.style.display="none";const $=I.parentElement;$&&!$.querySelector("svg")&&($.innerHTML=`
                      <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                      </svg>
                    `)}}})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 truncate",children:d.name}),k?.allSubmitted&&e.jsx("span",{className:"text-xs font-normal text-[#1C8376] whitespace-nowrap",children:"All Submitted"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-4 h-4 text-slate-500",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_4045_135263)",children:[e.jsx("path",{d:"M14.0001 14V13.7C14.0001 13.0489 14.0001 12.7234 13.925 12.4571C13.7361 11.7874 13.2127 11.264 12.543 11.0751C12.2767 11 11.9512 11 11.3001 11H8.36675C7.71566 11 7.39011 11 7.12387 11.0751C6.45414 11.264 5.93072 11.7874 5.74184 12.4571C5.66675 12.7234 5.66675 13.0489 5.66675 13.7V14",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2 11.6667V10.6C2 10.0422 2 9.76328 2.05526 9.53311C2.23083 8.80181 2.80181 8.23083 3.53311 8.05526C3.76328 8 4.04219 8 4.6 8H4.66667",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12.3334 6.33333C12.3334 7.622 11.2887 8.66667 10.0001 8.66667C8.71142 8.66667 7.66675 7.622 7.66675 6.33333C7.66675 5.04467 8.71142 4 10.0001 4C11.2887 4 12.3334 5.04467 12.3334 6.33333Z",stroke:"currentColor",strokeWidth:"1.33333"}),e.jsx("path",{d:"M7.33325 2.92025C6.94237 2.36557 6.27397 2 5.51507 2C4.31009 2 3.33325 2.92165 3.33325 4.05857C3.33325 4.95488 3.94038 5.7174 4.7878 6",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_4045_135263",children:e.jsx("rect",{width:"16",height:"16",fill:"white"})})})]}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:me.length})]}),se!=null?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-[#1C8376]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:Fe(se)}),l?.positionChange==="up"&&e.jsx("span",{className:"text-green-600 text-xs",children:"▲"}),l?.positionChange==="down"&&e.jsx("span",{className:"text-red-600 text-xs",children:"▼"}),l?.positionChange==="same"&&e.jsx("span",{className:"text-slate-400 text-xs",children:"—"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-[#1C8376]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),e.jsx("span",{className:"text-sm font-semibold text-slate-400",children:"—"})]})]}),e.jsxs("div",{className:"flex items-center mt-1 py-0.5",children:[ge,U>0&&e.jsxs("div",{className:`chip-container chip-grey rounded-full flex items-center justify-center text-[10px] font-medium flex-shrink-0 ${U>0?"chip-overlap":""}`,style:{width:"24px",height:"24px"},children:["+",U]})]})]})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-1.5 z-30",children:[ie>0&&e.jsx("span",{className:"inline-flex items-center justify-center h-6 w-6 rounded-full bg-[#1C8376] text-white text-xs font-bold",children:ie}),e.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})}),Be=()=>e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(a=>e.jsx("div",{className:"rounded-xl border bg-white overflow-hidden shadow-sm w-full animate-pulse",style:{borderRadius:"12px"},children:e.jsx("div",{className:"p-6 bg-white relative",children:e.jsxs("div",{className:"flex items-start gap-3 relative",children:[e.jsx("div",{className:"flex-shrink-0 w-14 h-14 rounded-full bg-slate-200"}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[e.jsx("div",{className:"h-5 w-32 bg-slate-200 rounded"}),e.jsx("div",{className:"h-3 w-20 bg-slate-200 rounded"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-4 w-4 bg-slate-200 rounded"}),e.jsx("div",{className:"h-4 w-6 bg-slate-200 rounded"}),e.jsx("div",{className:"h-4 w-4 bg-slate-200 rounded"}),e.jsx("div",{className:"h-4 w-8 bg-slate-200 rounded"})]})]}),e.jsx("div",{className:"absolute top-4 right-4 flex flex-col items-end gap-1",children:e.jsx("div",{className:"h-6 w-6 rounded-full bg-slate-200"})})]})})},a))});async function Ue(){const a="ABCDEFGHJKLMPQRSTVWXYZ23456789";for(let d=0;d<6;d++){let l="";for(let k=0;k<5;k++)l+=a[Math.floor(Math.random()*a.length)];const{data:te}=await m.from("leagues").select("id").eq("code",l).maybeSingle();if(!te)return l}return Math.random().toString(36).slice(2,7).toUpperCase()}export{He as default};
