import{r as p,j as e,L}from"./index-CpwqYQVG.js";import{a as y,b as S}from"./leagueStart-C2xdkNVI.js";function _(n){const s=["th","st","nd","rd"],t=n%100;return n+(s[(t-20)%10]||s[t]||s[0])}function I(n){const s=(n||"?").trim().split(/\s+/);return s.length?s.length===1?s[0].slice(0,1).toUpperCase():(s[0][0]+s[s.length-1][0]).toUpperCase():"?"}function C(n){return n?n instanceof Set?n:new Set(n):new Set}const V=p.memo(function({row:s,data:t,unread:g,submissions:w,leagueDataLoading:b,currentGw:x,showRanking:f=!0}){const j=t?.members??[],d=t?.userPosition,v=g>0?Math.min(g,99):0;console.log("[MiniLeagueCard] Rendering:",{leagueName:s.name,showRanking:f,hasData:!!t,membersCount:j.length,userPosition:d});const k=p.useMemo(()=>{if(b||!t)return[];const l=t.members??[];if(!l.length)return[];const i=t.sortedMemberIds&&t.sortedMemberIds.length>0?t.sortedMemberIds.map(r=>l.find(c=>c.id===r)).filter(r=>r!==void 0):[...l].sort((r,c)=>r.name.localeCompare(c.name)),m=C(t.submittedMembers),h=C(t.latestGwWinners),a=s.name==="API Test";return i.slice(0,8).map((r,c)=>{const M=m.has(r.id),N=h.has(r.id);let o="chip-container rounded-full flex items-center justify-center text-[10px] font-medium flex-shrink-0 w-6 h-6";return N&&t.latestRelevantGw!==null&&x!==null&&t.latestRelevantGw===x?o+=" bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 font-semibold relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s]":M?(o+=" chip-green",a&&(o+=" border-2 border-blue-600")):o+=" chip-grey",c>0&&(o+=" chip-overlap"),e.jsx("div",{className:o,title:r.name,children:I(r.name)},r.id)})},[t,b,s.name,x]),u=p.useMemo(()=>{if(!t)return 0;const i=((t.sortedMemberIds&&t.sortedMemberIds.length>0?t.sortedMemberIds:t.members?.map(m=>m.id))??[]).length;return i>8?i-8:0},[t]);return e.jsx("div",{className:"rounded-xl border bg-white overflow-hidden shadow-sm w-full",children:e.jsxs(L,{to:`/league/${s.code}`,className:"block p-6 !bg-white no-underline hover:text-inherit relative z-20",children:[e.jsxs("div",{className:"flex items-start gap-3 relative",children:[e.jsx("div",{className:"flex-shrink-0 w-14 h-14 rounded-full flex items-center justify-center overflow-hidden bg-slate-100",children:e.jsx("img",{src:y(s),alt:`${s.name} avatar`,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:l=>{const i=l.target,h=`/assets/league-avatars/${S(s.id)}`;if(i.src!==h)i.src=h;else{i.style.display="none";const a=i.parentElement;a&&!a.querySelector("svg")&&(a.innerHTML=`
                      <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                      </svg>
                    `)}}})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[e.jsx("div",{className:"text-base font-semibold text-slate-900 truncate",children:s.name}),f&&w?.allSubmitted&&e.jsx("span",{className:"text-xs font-normal text-[#1C8376] whitespace-nowrap",children:"All Submitted"}),f&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-4 h-4 text-slate-500",width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsxs("g",{clipPath:"url(#clip0_4045_135263)",children:[e.jsx("path",{d:"M14.0001 14V13.7C14.0001 13.0489 14.0001 12.7234 13.925 12.4571C13.7361 11.7874 13.2127 11.264 12.543 11.0751C12.2767 11 11.9512 11 11.3001 11H8.36675C7.71566 11 7.39011 11 7.12387 11.0751C6.45414 11.264 5.93072 11.7874 5.74184 12.4571C5.66675 12.7234 5.66675 13.0489 5.66675 13.7V14",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M2 11.6667V10.6C2 10.0422 2 9.76328 2.05526 9.53311C2.23083 8.80181 2.80181 8.23083 3.53311 8.05526C3.76328 8 4.04219 8 4.6 8H4.66667",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M12.3334 6.33333C12.3334 7.622 11.2887 8.66667 10.0001 8.66667C8.71142 8.66667 7.66675 7.622 7.66675 6.33333C7.66675 5.04467 8.71142 4 10.0001 4C11.2887 4 12.3334 5.04467 12.3334 6.33333Z",stroke:"currentColor",strokeWidth:"1.33333"}),e.jsx("path",{d:"M7.33325 2.92025C6.94237 2.36557 6.27397 2 5.51507 2C4.31009 2 3.33325 2.92165 3.33325 4.05857C3.33325 4.95488 3.94038 5.7174 4.7878 6",stroke:"currentColor",strokeWidth:"1.33333",strokeLinecap:"round"})]}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_4045_135263",children:e.jsx("rect",{width:"16",height:"16",fill:"white"})})})]}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:j.length})]}),d!=null?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-[#1C8376]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:_(d)}),t?.positionChange==="up"&&e.jsx("span",{className:"text-green-600 text-xs",children:"▲"}),t?.positionChange==="down"&&e.jsx("span",{className:"text-red-600 text-xs",children:"▼"}),t?.positionChange==="same"&&e.jsx("span",{className:"text-slate-400 text-xs",children:"—"})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-[#1C8376]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),e.jsx("span",{className:"text-sm font-semibold text-slate-400",children:"—"})]})]}),e.jsxs("div",{className:"flex items-center mt-1 py-0.5",children:[k,u>0&&e.jsxs("div",{className:`chip-container chip-grey rounded-full flex items-center justify-center text-[10px] font-medium flex-shrink-0 ${u>0?"chip-overlap":""}`,style:{width:"24px",height:"24px"},children:["+",u]})]})]})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-1.5 z-30",children:[v>0&&e.jsx("span",{className:"inline-flex items-center justify-center h-6 w-6 rounded-full bg-[#1C8376] text-white text-xs font-bold",children:v}),e.jsx("svg",{className:"w-5 h-5 text-slate-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})})});export{V as M};
