import{R as D,j as e,T as ee,r as L,I as J,a as M,Q as te,W as z,X as se,Y,m as ae,n as re,e as q,Z as ne,u as oe,p as V,L as le,P as ie,$ as ce}from"./index-C0WCEC5K.js";const I=D.memo(function({label:s,value:x,subcopy:d,loading:p=!1,className:w=""}){if(p)return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${w}`,children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 mb-2",children:s}),e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"})]});const $=typeof x=="object"&&x!==null;return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${w}`,children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-2",children:s}),e.jsx("div",{className:`mb-1 flex items-baseline ${$?"":"text-2xl font-bold text-slate-800 dark:text-slate-100"}`,children:x}),d&&e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-2",children:d})]})}),de=D.memo(function({label:s,streakCount:x,gwRange:d,subcopy:p,extraLine:w,loading:$=!1,className:N=""}){return $?e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${N}`,children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 mb-2",children:s}),e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"})]}):e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${N}`,children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-2",children:s}),e.jsxs("div",{className:"text-4xl font-bold text-slate-800 dark:text-slate-100 mb-2 flex items-baseline gap-2",children:[e.jsx("span",{children:x}),e.jsxs("span",{className:"text-base font-normal text-slate-600 dark:text-slate-400",children:["Top 25% from ",d]})]}),w&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 italic mb-2",children:['"',w,'"']}),p&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-2 italic",children:['"',p,'"']})]})}),K=D.memo(function({label:s,teamCode:x,teamName:d,percentage:p,isCorrect:w,subcopy:$,loading:N=!1,className:C=""}){if(N)return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${C}`,children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 mb-2",children:s}),e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"})]});const G=p%1===0?p.toFixed(0):p.toFixed(2);return e.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 ${C}`,children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-3",children:s}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{code:x,size:32}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-lg font-bold text-slate-800 dark:text-slate-100 truncate",children:d}),e.jsxs("div",{className:`text-base font-semibold ${w?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"}`,children:[G,"% ",w?"correct":"incorrect"]})]})]}),$&&e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400 mt-3 italic",children:['"',$,'"']})]})}),me=D.memo(function({weeklyData:s,latestGw:x,showInfo:d=!1}){const p=s.flatMap(c=>[c.userPoints,c.averagePoints]),w=p.length>0?Math.max(...p,10):10,$=0,N=w-$||1,C=120,G=48,R=8,T=12,g=4,m=d?48:16,u=Math.max(340,s.length*G+(s.length-1)*R+T*2+g*2+m);return e.jsx("div",{className:"flex-shrink-0 h-[168px] bg-white dark:bg-slate-800 relative",style:{width:`${u}px`,minWidth:`${u}px`},children:e.jsxs("div",{className:"pt-3 pb-2 h-full flex flex-col",style:{paddingLeft:"0",paddingRight:"12px"},children:[e.jsx("div",{className:"flex-1"}),e.jsx("div",{className:"mb-1 relative",style:{height:"120px"},children:e.jsx("div",{className:"relative h-full",children:e.jsx("div",{className:"flex items-end gap-2 h-full",style:{paddingLeft:"0",paddingRight:"4px"},children:s.map(c=>{const{gw:y,userPoints:f,averagePoints:k}=c,S=y===x,P=f-k,E=P>0,t=P<0,r=(f-$)/N*C,l=(k-$)/N*C,n=Math.max(r,l);return e.jsxs("div",{className:"flex flex-col items-center justify-end relative",style:{minWidth:"48px",width:"48px",height:"100%"},children:[e.jsxs("div",{className:"w-full relative",style:{height:`${n}px`},children:[d&&e.jsx("div",{className:"absolute flex items-center justify-center",style:{bottom:`${n+4}px`,left:"0",right:"0",width:"100%",zIndex:10},children:e.jsx("div",{className:`text-xs font-bold leading-none ${S?"text-[#1C8376] dark:text-emerald-400":E?"text-emerald-600 dark:text-emerald-400":t?"text-red-600 dark:text-red-400":"text-slate-700 dark:text-slate-300"}`,children:f})}),E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 w-full bg-slate-300 dark:bg-slate-600 opacity-60",style:{height:`${l}px`,minHeight:l>0?"2px":"0",borderTopLeftRadius:"2px",borderTopRightRadius:l===n?"2px":"0"},title:`Par: ${k.toFixed(1)}`}),e.jsx("div",{className:"absolute w-full transition-all bg-emerald-500 dark:bg-emerald-600",style:{bottom:`${l}px`,height:`${r-l}px`,minHeight:r-l>0?"2px":"0",borderTopLeftRadius:"2px",borderTopRightRadius:"2px"},title:`Your score: ${f}`})]}):t?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 w-full transition-all bg-red-500 dark:bg-red-600",style:{height:`${r}px`,minHeight:r>0?"2px":"0",borderTopLeftRadius:r===n?"2px":"0",borderTopRightRadius:r===n?"2px":"0"},title:`Your score: ${f}`}),e.jsx("div",{className:"absolute w-full bg-slate-300 dark:bg-slate-600 opacity-60",style:{bottom:`${r}px`,height:`${l-r}px`,minHeight:l-r>0?"2px":"0",borderTopLeftRadius:"2px",borderTopRightRadius:"2px"},title:`Par: ${k.toFixed(1)}`})]}):e.jsx("div",{className:"absolute bottom-0 w-full rounded-t bg-slate-400 dark:bg-slate-500 transition-all",style:{height:`${r}px`,minHeight:r>0?"4px":"0",borderRadius:"2px 2px 0 0"},title:`Your score: ${f} (Par: ${k.toFixed(1)})`}),n>15&&e.jsx("div",{className:"absolute bottom-1 left-0 right-0 flex items-center justify-center",style:{height:"16px"},children:e.jsx("div",{className:`text-sm leading-none ${E?"text-emerald-600 dark:text-emerald-400":"text-white"}`,style:{fontWeight:900},children:E?`+${P.toFixed(1)}`:t?`${P.toFixed(1)}`:"Par"})})]}),e.jsxs("div",{className:"flex flex-col items-center justify-start",style:{height:"28px",marginTop:"4px"},children:[e.jsxs("div",{className:`text-[10px] font-medium leading-tight ${S?"text-[#1C8376] dark:text-emerald-400 font-bold":"text-slate-700 dark:text-slate-300"}`,children:["GW",y]}),e.jsxs("div",{className:"text-[9px] font-medium text-slate-400 dark:text-slate-500 leading-none",style:{visibility:d?"visible":"hidden",height:"12px"},children:["av. ",k.toFixed(1)]})]})]},y)})})})})]})})}),ue=D.memo(function({lastGw:s,form5:x,form10:d,overall:p,loading:w=!1}){const[$,N]=L.useState(!1),C=[{label:"Gameweek",count:s},{label:"5-Week Form",count:x},{label:"10-Week Form",count:d},{label:"Overall",count:p}],G=s+x+d+p;return w?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6",children:[e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:"Leaderboard Trophy Cabinet"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[1,2,3,4].map(R=>e.jsx("div",{className:"h-24 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"},R))})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Leaderboard Trophy Cabinet"}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-400 dark:border-slate-500 flex items-center justify-center cursor-pointer",onClick:()=>N(!0),role:"button","aria-label":"Information about Trophy Cabinet",children:e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold",children:"i"})})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:C.map((R,T)=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 bg-slate-50 dark:bg-slate-700 rounded-lg border border-slate-200 dark:border-slate-600",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:`w-10 h-10 text-yellow-500 ${R.count>0?"sparkle-trophy":"opacity-40"}`,children:e.jsx("g",{children:e.jsx("path",{fill:"currentColor",d:"M16 3c1.1046 0 2 0.89543 2 2h2c1.1046 0 2 0.89543 2 2v1c0 2.695 -2.1323 4.89 -4.8018 4.9941 -0.8777 1.5207 -2.4019 2.6195 -4.1982 2.9209V19h3c0.5523 0 1 0.4477 1 1s-0.4477 1 -1 1H8c-0.55228 0 -1 -0.4477 -1 -1s0.44772 -1 1 -1h3v-3.085c-1.7965 -0.3015 -3.32148 -1.4 -4.19922 -2.9209C4.13175 12.8895 2 10.6947 2 8V7c0 -1.10457 0.89543 -2 2 -2h2c0 -1.10457 0.89543 -2 2 -2zm-8 7c0 2.2091 1.79086 4 4 4 2.2091 0 4 -1.7909 4 -4V5H8zM4 8c0 1.32848 0.86419 2.4532 2.06055 2.8477C6.02137 10.5707 6 10.2878 6 10V7H4zm14 2c0 0.2878 -0.0223 0.5706 -0.0615 0.8477C19.1353 10.4535 20 9.32881 20 8V7h-2z",strokeWidth:"1"})})}),R.count>0&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-yellow-400 text-yellow-900 text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center border-2 border-white",children:R.count})]}),e.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-300 text-center",children:R.label})]},T))}),G>0&&e.jsxs("div",{className:"mt-4 text-sm font-semibold text-slate-600 dark:text-slate-300 text-center",children:["You have ",G," ",G===1?"trophy":"trophies"]}),e.jsx(J,{isOpen:$,onClose:()=>N(!1),title:"Leaderboard Trophy Cabinet",description:`Earn trophies by finishing top (or joint top) of any leaderboard after a gameweek completes.

GAMEWEEK
Finish #1 in the weekly leaderboard for any completed gameweek.

5-WEEK FORM
Finish #1 in the 5-week form leaderboard after any gameweek. Requires 5+ completed gameweeks.

10-WEEK FORM
Finish #1 in the 10-week form leaderboard after any gameweek. Requires 10+ completed gameweeks.

OVERALL
Finish #1 in the overall season leaderboard after any gameweek.`})]})});function O(a,s){if(s.length===0)return 50;const d=s.filter(p=>p<=a).length/s.length*100;return Math.round(d*100)/100}async function ge(a){const s={lastCompletedGw:null,lastCompletedGwPercentile:null,overallPercentile:null,correctPredictionRate:null,bestStreak:0,bestStreakGwRange:null,avgPointsPerWeek:null,bestSingleGw:null,lowestSingleGw:null,chaosIndex:null,chaosCorrectCount:null,chaosTotalCount:null,mostCorrectTeam:null,mostIncorrectTeam:null,weeklyParData:null,trophyCabinet:null};try{const{data:x}=await M.from("app_gw_results").select("gw").order("gw",{ascending:!1}).limit(1).maybeSingle(),d=x?.gw||null;if(s.lastCompletedGw=d,!d)return s;if(d){const{data:g}=await M.from("app_v_gw_points").select("user_id, points").eq("gw",d);if(g&&g.length>0){const m=g.map(c=>c.points||0),u=g.find(c=>c.user_id===a)?.points||0;s.lastCompletedGwPercentile=O(u,m)}}const{data:p}=await M.from("v_ocp_overall").select("user_id, ocp").order("ocp",{ascending:!1});if(p&&p.length>0){const g=p.map(u=>u.ocp||0),m=p.find(u=>u.user_id===a)?.ocp||0;s.overallPercentile=O(m,g)}const[w,$]=await Promise.all([M.from("app_picks").select("gw, fixture_index, pick").eq("user_id",a),M.from("picks").select("gw, fixture_index, pick").eq("user_id",a)]),N=new Map;$.data&&$.data.forEach(g=>{const m=`${g.gw}:${g.fixture_index}`;N.set(m,g)}),w.data&&w.data.forEach(g=>{const m=`${g.gw}:${g.fixture_index}`;N.set(m,g)});const C=Array.from(N.values());console.log("[userStats] Picks from app_picks:",w.data?.length||0),console.log("[userStats] Picks from picks table:",$.data?.length||0),console.log("[userStats] Total unique picks (combined):",C.length),w.error&&console.error("[userStats] Error fetching app_picks:",w.error),$.error&&$.error.code!=="PGRST116"&&console.error("[userStats] Error fetching picks:",$.error);const{data:G,error:R}=await M.from("app_gw_results").select("gw, fixture_index, result");if(console.log("[userStats] Total results fetched:",G?.length||0),R&&console.error("[userStats] Error fetching results:",R),C&&G){const g=new Map;G.forEach(c=>{c.result&&g.set(`${c.gw}:${c.fixture_index}`,c.result)});let m=0,u=0;C.forEach(c=>{const y=g.get(`${c.gw}:${c.fixture_index}`);y&&(u++,c.pick===y&&m++)}),u>0&&(s.correctPredictionRate=m/u*100)}const{data:T}=await M.from("app_v_gw_points").select("gw, points").eq("user_id",a).order("gw",{ascending:!0});if(T&&T.length>0){const g=T.reduce((i,o)=>i+(o.points||0),0);s.avgPointsPerWeek=g/T.length;const m=new Set,{data:u}=await M.from("app_gw_results").select("gw").order("gw",{ascending:!0});u?.forEach(i=>{m.add(i.gw)});const{data:c}=await M.from("app_v_gw_points").select("gw, user_id, points").in("gw",Array.from(m)),y=new Map,f=new Map;c&&c.forEach(i=>{const o=i.gw;f.has(o)||f.set(o,[]),f.get(o).push({user_id:i.user_id,points:i.points||0})});for(const i of Array.from(m).sort((o,_)=>o-_)){const o=f.get(i);if(o&&o.length>0){const _=o.map(W=>W.points),j=o.find(W=>W.user_id===a)?.points||0,A=O(j,_);y.set(i,A)}}let k=0,S=0,P=0,E=0,t=0;const r=Array.from(m).sort((i,o)=>i-o);console.log("[userStats] Calculating best streak. Completed GWs:",r),console.log("[userStats] User percentiles per GW:",Array.from(y.entries()).map(([i,o])=>({gw:i,percentile:o.toFixed(2),inTop25:o>=75})));for(const i of r){const o=y.get(i);o!==void 0&&o>=75?(k===0&&(t=i),k++,k>S&&(S=k,P=t,E=i)):(k>0&&console.log(`[userStats] Streak broken at GW${i} (percentile: ${o?.toFixed(2)||"N/A"}). Previous streak was ${k} games`),k=0)}s.bestStreak=S,S>0?(s.bestStreakGwRange=`GW${P}–GW${E}`,console.log(`[userStats] Best streak: ${S} games from ${s.bestStreakGwRange}`)):console.log("[userStats] No streak found (user never in top 25%)");let l={points:-1,gw:0},n={points:999,gw:0};T.forEach(i=>{const o=i.points||0;o>l.points&&(l={points:o,gw:i.gw}),o<n.points&&(n={points:o,gw:i.gw})}),l.points>=0&&(s.bestSingleGw=l),n.points<999&&(s.lowestSingleGw=n);const v=[],b=new Map;f.forEach((i,o)=>{const _=i.reduce((j,A)=>j+A.points,0)/i.length;b.set(o,_)}),T.forEach(i=>{const o=i.gw,_=i.points||0,j=b.get(o);j!==void 0&&v.push({gw:o,userPoints:_,averagePoints:j})}),v.sort((i,o)=>i.gw-o.gw),s.weeklyParData=v.length>0?v:null;let h={lastGw:0,form5:0,form10:0,overall:0};if(u&&c){console.log("[userStats] Calculating trophy cabinet...");const i=[...new Set(u.map(j=>j.gw))].sort((j,A)=>j-A),{data:o}=await M.from("app_v_gw_points").select("user_id, gw, points").order("gw",{ascending:!0}),{data:_}=await M.from("app_v_ocp_overall").select("user_id, name, ocp");i.forEach(j=>{const A=te(a,j,o||[]);if(A&&A.rank===1&&h.lastGw++,j>=5){const F=z(a,j-4,j,o||[],_||[]);F&&F.rank===1&&h.form5++}if(j>=10){const F=z(a,j-9,j,o||[],_||[]);F&&F.rank===1&&h.form10++}const W=new Set;(o||[]).forEach(F=>{F.gw<=j&&W.add(F.user_id)});const U=Array.from(W).map(F=>{const X=(o||[]).filter(B=>B.user_id===F&&B.gw<=j).reduce((B,Z)=>B+(Z.points||0),0),Q=(_||[]).find(B=>B.user_id===F);return{user_id:F,name:Q?.name||null,ocp:X}}),H=se(a,U);H&&H.rank===1&&h.overall++}),console.log("[userStats] Trophy cabinet calculated:",h)}else console.log("[userStats] Skipping trophy calculation - missing data:",{hasCompletedGwResults:!!u,hasAllGwPoints:!!c});s.trophyCabinet=h}else s.trophyCabinet={lastGw:0,form5:0,form10:0,overall:0};if(C&&C.length>0){const g=new Set;if(C.forEach(m=>{g.add(`${m.gw}:${m.fixture_index}`)}),g.size>0){const m=Array.from(g).map(n=>parseInt(n.split(":")[0])),u=new Set(m),[c,y]=await Promise.all([M.from("app_picks").select("gw, fixture_index, pick").in("gw",Array.from(u)),M.from("picks").select("gw, fixture_index, pick").in("gw",Array.from(u))]),f=new Map;y.data&&y.data.forEach(n=>{const v=`${n.gw}:${n.fixture_index}`;if(g.has(v)){f.has(v)||f.set(v,new Map);const b=f.get(v);b.set(n.pick,(b.get(n.pick)||0)+1)}}),c.data&&c.data.forEach(n=>{const v=`${n.gw}:${n.fixture_index}`;if(g.has(v)){f.has(v)||f.set(v,new Map);const b=f.get(v);b.set(n.pick,(b.get(n.pick)||0)+1)}});let k=0;f.forEach(n=>{k+=Array.from(n.values()).reduce((v,b)=>v+b,0)}),console.log(`[userStats] Chaos Index: Checking ${C.length} user picks across ${g.size} fixtures`),console.log(`[userStats] Chaos Index: Found ${k} total picks from all users across all fixtures`);let S=0,P=0,E=0;const t=new Map;G&&G.forEach(n=>{n.result&&t.set(`${n.gw}:${n.fixture_index}`,n.result)});let r=!1;const l=[];C.forEach(n=>{const v=`${n.gw}:${n.fixture_index}`,b=f.get(v);if(b){const h=Array.from(b.values()).reduce((_,j)=>_+j,0),i=b.get(n.pick)||0,o=h>0?i/h*100:0;if(!r&&h>0){const _=b.get("H")||0,j=b.get("D")||0,A=b.get("A")||0;console.log(`[userStats] Chaos Index sample: GW${n.gw} fixture ${n.fixture_index}, user picked ${n.pick}, totals: H=${_}, D=${j}, A=${A}, total=${h}, userPickPercentage=${o.toFixed(2)}%`),r=!0}if(E++,o<=25){S++;const _=t.get(v);_&&n.pick===_&&P++}}else l.push(v)}),l.length>0&&console.log(`[userStats] Chaos Index: ${l.length} fixtures with no pick counts (skipped from calculation): ${l.slice(0,10).join(", ")}${l.length>10?` ... and ${l.length-10} more`:""}`),E>0&&(s.chaosIndex=S/E*100,s.chaosCorrectCount=P,s.chaosTotalCount=S,console.log(`[userStats] Chaos Index: ${s.chaosIndex.toFixed(2)}% (${S} of ${E} picks, ${P} correct)`),console.log(`[userStats] Chaos Index breakdown: ${E} total picks, ${S} chaos picks`))}}if(C&&G){const g=new Map;G.forEach(u=>{u.result&&g.set(`${u.gw}:${u.fixture_index}`,u.result)});const{data:m}=await M.from("app_fixtures").select("gw, fixture_index, home_code, away_code, home_team, away_team, home_name, away_name");if(m){const u=new Map;m.forEach(t=>{u.set(`${t.gw}:${t.fixture_index}`,t)});const c=new Map,y=new Map;C.forEach(t=>{y.set(`${t.gw}:${t.fixture_index}`,t.pick)});const f=[];if(m.forEach(t=>{const r=g.get(`${t.gw}:${t.fixture_index}`),l=y.get(`${t.gw}:${t.fixture_index}`);if(!r||!l)return;const n=t.home_name||t.home_team||"",v=t.away_name||t.away_team||"",b={code:t.home_code,name:t.home_code?Y(t.home_code):n},h={code:t.away_code,name:t.away_code?Y(t.away_code):v},i=l===r;if(b.code){const o=b.code.toUpperCase(),_=c.get(o)||{correct:0,total:0,code:b.code,name:b.name};_.total++,i&&_.correct++,c.set(o,_),(o==="BUR"||b.code.toUpperCase()==="BUR")&&f.push({gw:t.gw,fixture_index:t.fixture_index,home:b.name,away:h.name,pick:l,result:r,isCorrect:i})}if(h.code){const o=h.code.toUpperCase(),_=c.get(o)||{correct:0,total:0,code:h.code,name:h.name};_.total++,i&&_.correct++,c.set(o,_),(o==="BUR"||h.code.toUpperCase()==="BUR")&&f.push({gw:t.gw,fixture_index:t.fixture_index,home:b.name,away:h.name,pick:l,result:r,isCorrect:i})}}),f.length>0){console.log("[userStats] Burnley picks breakdown:",JSON.stringify(f,null,2));const t=c.get("BUR");t&&console.log("[userStats] Burnley final stats:",{correct:t.correct,total:t.total,percentage:(t.correct/t.total*100).toFixed(2)+"%"})}const k=Array.from(c.entries()).map(([t,r])=>({code:t,name:r.name,correct:r.correct,total:r.total,percentage:(r.correct/r.total*100).toFixed(2)}));console.log("[userStats] All team prediction stats:",JSON.stringify(k,null,2)),console.log("[userStats] Teams with >= 3 picks:",JSON.stringify(k.filter(t=>t.total>=3),null,2));let S=0;c.forEach(t=>{S+=t.total}),console.log("[userStats] Total picks processed for team stats:",S),console.log("[userStats] Total picks with fixtures and results:",C.filter(t=>{const r=u.get(`${t.gw}:${t.fixture_index}`),l=g.get(`${t.gw}:${t.fixture_index}`);return r&&l}).length);let P=null,E=null;c.forEach((t,r)=>{if(t.total>=3){const l=t.correct/t.total*100,n=(t.total-t.correct)/t.total*100;(!P||l>P.percentage)&&(P={code:t.code,name:t.name,percentage:l}),(!E||n>E.percentage)&&(E={code:t.code,name:t.name,percentage:n})}}),s.mostCorrectTeam=P,s.mostIncorrectTeam=E}}}catch(x){console.error("Error fetching user stats:",x)}return s}function xe({value:a,onChange:s,labels:x}){const d=x?.off||"ALL",p=x?.on||"LIVE";return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-[10px] font-medium transition-colors ${a?"text-slate-400":"text-slate-700"}`,children:d}),e.jsx("button",{onClick:()=>s(!a),className:"relative inline-flex items-center rounded-full transition-colors focus:outline-none",style:{backgroundColor:a?"#dc2626":"#cbd5e1",width:"48px",height:"24px",border:"none"},"aria-label":a?`Show ${d}`:`Show ${p}`,children:e.jsx("span",{className:`absolute top-0.5 w-5 h-5 bg-white rounded-full shadow-sm transform transition-transform duration-200 ease-in-out ${a?"translate-x-6":"translate-x-0.5"}`})}),e.jsx("span",{className:`text-[10px] font-medium transition-colors ${a?"text-slate-700":"text-slate-400"}`,children:p})]})}async function fe(a){if(!a)return[];try{const s=await ae(a);if(s.length===0)return[];const x=s.map(t=>t.id),{data:d,error:p}=await M.from("league_members").select("league_id, user_id").in("league_id",x);if(p)throw p;const w=new Map;d?.forEach(t=>{const r=w.get(t.league_id)||[];r.push(t.user_id),w.set(t.league_id,r)});const{data:$,error:N}=await M.from("app_gw_results").select("gw, fixture_index, result").order("gw",{ascending:!1});if(N)throw N;const C=new Map;$?.forEach(t=>{t.result&&C.set(`${t.gw}:${t.fixture_index}`,t.result)});const G=Array.from(new Set(d?.map(t=>t.user_id)||[]));if(G.length===0)return[];const{data:R,error:T}=await M.from("app_picks").select("user_id, gw, fixture_index, pick").in("user_id",G);if(T)throw T;const g=Array.from(new Set($?.map(t=>t.gw)||[]));if(g.length===0)return[];const{data:m}=await M.from("app_meta").select("current_gw").eq("id",1).maybeSingle(),u=m?.current_gw??Math.max(...g,0),{data:c,error:y}=await M.from("app_fixtures").select("gw, fixture_index, home_team, away_team, home_code, away_code, home_name, away_name, kickoff_time, api_match_id").in("gw",g).order("gw",{ascending:!1}).order("fixture_index",{ascending:!0});if(y)throw y;const f=new Map;c?.forEach(t=>{t.api_match_id||f.set(`${t.gw}:${t.fixture_index}`,t)});const k=[];console.log("[Unicorns] Starting calculation for user:",a),console.log("[Unicorns] User leagues:",s.map(t=>({name:t.name,id:t.id,members:w.get(t.id)?.length||0}))),console.log("[Unicorns] Total results available:",C.size),console.log("[Unicorns] Total picks available:",R?.length||0),console.log("[Unicorns] User picks count:",R?.filter(t=>t.user_id===a).length||0),console.log("[Unicorns] Total fixtures available:",f.size),console.log("[Unicorns] Current GW:",u);for(const t of s){if(t.name==="API Test"){console.log(`[Unicorns] Skipping "${t.name}" - test league`);continue}const r=w.get(t.id)||[];if(r.length<3){console.log(`[Unicorns] Skipping "${t.name}" - only ${r.length} members`);continue}const l=await re(t,u);console.log(`[Unicorns] Processing "${t.name}" with ${r.length} members, start GW: ${l}`);const n=R?.filter(h=>r.includes(h.user_id)&&h.gw>=l)||[];console.log(`[Unicorns] "${t.name}" has ${n.length} picks total (filtered from start GW ${l})`);const v=new Map;n.forEach(h=>{const i=`${h.gw}:${h.fixture_index}`,o=v.get(i)||[];o.push({user_id:h.user_id,pick:h.pick}),v.set(i,o)});let b=0;v.forEach((h,i)=>{const[o,_]=i.split(":").map(Number);if(o<l)return;const j=C.get(i);if(!j)return;const A=h.find(U=>U.user_id===a);if(!A)return;const W=h.filter(U=>U.pick===j).map(U=>U.user_id);if(W.length===1&&W[0]===a&&r.length>=3){const U=f.get(i);U&&(b++,k.push({fixture_index:_,gw:o,home_team:U.home_team,away_team:U.away_team,home_code:U.home_code,away_code:U.away_code,home_name:U.home_name,away_name:U.away_name,kickoff_time:U.kickoff_time,pick:A.pick,league_id:t.id,league_name:t.name}))}}),b>0&&console.log(`[Unicorns] "${t.name}" found ${b} unicorns`)}console.log(`[Unicorns] Found ${k.length} total unicorns before grouping`);const S=new Map;k.forEach(t=>{const r=`${t.gw}:${t.fixture_index}`,l=S.get(r);l?l.league_names.includes(t.league_name)||l.league_names.push(t.league_name):S.set(r,{fixture_index:t.fixture_index,gw:t.gw,home_team:t.home_team,away_team:t.away_team,home_code:t.home_code,away_code:t.away_code,home_name:t.home_name,away_name:t.away_name,kickoff_time:t.kickoff_time,pick:t.pick,league_names:[t.league_name]})});const P=Array.from(S.values()),E=P.filter(t=>t.league_names.includes("Prem Predictions"));return console.log("[Unicorns] Prem Predictions unicorns:",E.map(t=>`GW${t.gw} fixture ${t.fixture_index} (leagues: ${t.league_names.join(", ")})`)),console.log(`[Unicorns] Found ${P.length} unique fixtures after grouping`),P.sort((t,r)=>t.gw!==r.gw?t.gw-r.gw:t.fixture_index-r.fixture_index),P}catch(s){return console.error("[Unicorns] Error fetching unicorns:",s),[]}}function he({fixture:a,leagueNames:s,isActive:x=!1}){const d=a.home_code||a.home_name||a.home_team||"",p=a.away_code||a.away_name||a.away_team||"",w=q(d)||a.home_name||a.home_team||"Home",$=q(p)||a.away_name||a.away_name||"Away",N=a.pick==="H"?"Home Win":a.pick==="A"?"Away Win":"Draw",C={id:`${a.gw}-${a.fixture_index}`,fixture_index:a.fixture_index,home_team:w,away_team:$,home_code:a.home_code,away_code:a.away_code,home_name:w,away_name:$,kickoff_time:a.kickoff_time},G=x?1:.92,R=x?1:.75;return e.jsxs("div",{className:"flex-shrink-0 relative",style:{scrollSnapAlign:"center",transform:`scale(${G})`,opacity:R,width:"280px",willChange:"transform, opacity",transition:"transform 500ms cubic-bezier(0.4, 0, 0.2, 1), opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[e.jsx("style",{children:`
        .unicorn-card-wrapper {
          position: relative;
        }
        .unicorn-card-wrapper > div:first-child {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
          position: relative;
        }
        .unicorn-card-wrapper > div:first-child > div:first-child {
          padding-top: 1.5rem !important;
        }
        .unicorn-card-wrapper .flex.items-center.gap-1\\.5.mt-3 {
          display: none !important;
        }
        .unicorn-card-wrapper > div.absolute {
          box-shadow: none !important;
        }
        .unicorn-card-wrapper::before {
          content: '';
          position: absolute;
          inset: 0;
          border-radius: 1.5rem;
          padding: 10px;
          background: linear-gradient(135deg, #fbbf24, #f97316, #ec4899, #9333ea, #fbbf24);
          background-size: 300% 300%;
          -webkit-mask: 
            linear-gradient(#fff 0 0) content-box, 
            linear-gradient(#fff 0 0);
          -webkit-mask-composite: xor;
          mask-composite: exclude;
          animation: gradient-shift 3s ease infinite;
          pointer-events: none;
          z-index: 100;
        }
        @keyframes gradient-shift {
          0%, 100% {
            background-position: 0% 50%;
          }
          50% {
            background-position: 100% 50%;
          }
        }
        .shiny-pick-badge {
          background: linear-gradient(135deg, #fbbf24, #f97316, #ec4899, #9333ea, #fbbf24);
          background-size: 300% 300%;
          animation: gradient-shift 3s ease infinite;
          color: white;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
      `}),e.jsxs("div",{className:"relative unicorn-card-wrapper",children:[e.jsx(ne,{fixture:C,showSwipeHint:!1}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 pt-6 px-4 pb-8 rounded-b-3xl",style:{background:"linear-gradient(to top, rgba(0, 0, 0, 0.85) 0%, rgba(0, 0, 0, 0.65) 25%, rgba(0, 0, 0, 0.45) 45%, rgba(0, 0, 0, 0.25) 65%, rgba(0, 0, 0, 0.1) 80%, transparent 100%)"},children:[e.jsx("div",{className:"text-white text-sm font-semibold text-center mb-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full shiny-pick-badge",children:N})}),e.jsx("div",{className:"text-white text-sm font-semibold text-center",children:s.length===1?s[0]:e.jsx("div",{className:"space-y-1",children:e.jsx("div",{children:s.join(", ")})})}),e.jsxs("div",{className:"text-white/80 text-xs text-center mt-1",children:["GW",a.gw]})]})]})]})}function pe({userId:a,loading:s}){const[x,d]=L.useState([]),[p,w]=L.useState(!0),[$,N]=L.useState(0),[C,G]=L.useState(!1),R=L.useRef(null),T=L.useRef([]);L.useEffect(()=>{if(!a){w(!1);return}let m=!0;async function u(){w(!0);try{const c=await fe(a);m&&(T.current=[],d(c),N(0))}catch(c){console.error("[UnicornCollection] Error loading unicorns:",c),m&&(d([]),N(0))}finally{m&&w(!1)}}return u(),()=>{m=!1}},[a]),L.useEffect(()=>{if(x.length===0||!R.current)return;const m=R.current;let u=null,c=!1;const y=()=>{if(!R.current)return;const r=R.current.getBoundingClientRect();if(r.width===0){setTimeout(y,50);return}if(!T.current.every((h,i)=>i>=x.length?!0:h!==null)){setTimeout(y,50);return}if(T.current[0]&&T.current[0].getBoundingClientRect().width===0){setTimeout(y,50);return}const n=r.left+r.width/2;let v=0,b=1/0;T.current.forEach((h,i)=>{if(h&&i<x.length){const o=h.getBoundingClientRect(),_=o.left+o.width/2,j=Math.abs(_-n);j<b&&(b=j,v=i)}}),N(v)},f=()=>{c||(u=requestAnimationFrame(()=>{y(),c=!1}),c=!0)};m.addEventListener("scroll",f,{passive:!0});const k=()=>{m.scrollLeft===0&&T.current[0],y()},S=setTimeout(()=>{k()},0),P=setTimeout(()=>{k()},100),E=setTimeout(()=>{k()},300),t=()=>{y()};return window.addEventListener("resize",t,{passive:!0}),()=>{clearTimeout(S),clearTimeout(P),clearTimeout(E),u!==null&&cancelAnimationFrame(u),m.removeEventListener("scroll",f),window.removeEventListener("resize",t)}},[x.length,x]);const g=s||p;return s?null:g?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 desktop-constrained-unicorn",style:{marginRight:"-100vw",paddingRight:"100vw"},children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-4 flex items-center gap-2",children:e.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Your Unicorns"})}),e.jsx("div",{className:"h-8 bg-slate-200 dark:bg-slate-700 rounded animate-pulse"})]}):x.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6",children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-2",children:"Your Unicorns"}),e.jsxs("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:["You have ",e.jsx("span",{className:"font-semibold",children:"0 unicorns"})," overall. Keep predicting to earn your first unicorn!"]})]}):e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 desktop-constrained-unicorn",style:{marginRight:"-100vw",paddingRight:"100vw"},children:[e.jsxs("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300 mb-4 flex items-center gap-2",style:{paddingLeft:"1.5rem",marginLeft:"-1.5rem"},children:[e.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:"Your Unicorns"}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-400 dark:border-slate-500 flex items-center justify-center cursor-pointer",onClick:()=>G(!0),role:"button","aria-label":"Information about Unicorns",children:e.jsx("span",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold",children:"i"})})]}),e.jsxs("div",{ref:R,className:"flex gap-0 overflow-x-auto pb-2 scrollbar-hide unicorn-scroll-container",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollBehavior:"smooth",scrollSnapType:"x mandatory",marginLeft:"-1.5rem",marginRight:"-1.5rem",paddingLeft:"calc(50vw - 140px + 1.5rem)",paddingRight:"calc(50vw - 140px)",width:"calc(100% + 3rem)"},children:[e.jsx("style",{children:".scrollbar-hide::-webkit-scrollbar { display: none; }"}),x.map((m,u)=>e.jsx("div",{ref:c=>{T.current[u]=c},children:e.jsx(he,{fixture:m,leagueNames:m.league_names,isActive:u===$})},`${m.gw}-${m.fixture_index}-${u}`))]}),e.jsxs("div",{className:"text-sm font-bold text-slate-800 dark:text-slate-100 mt-4 text-center",children:[x.length," ",x.length===1?"unicorn":"unicorns"," overall"]}),e.jsx(J,{isOpen:C,onClose:()=>G(!1),title:"Unicorns",description:`A unicorn is a unique correct prediction in a mini-league.

Only applies to mini-leagues with 3+ players.

Each card shows the fixture you correctly predicted, what you picked, and which mini-leagues you earned the unicorn in.`})]})}function be(){const{user:a}=oe(),[s,x]=L.useState(null),[d,p]=L.useState(!0),[w,$]=L.useState(!1),[N,C]=L.useState(null),G=L.useRef(null),[R,T]=L.useState(!1),[g,m]=L.useState(null),[u,c]=L.useState(null),[y,f]=L.useState(!1);async function k(){if(a){p(!0);try{const t=await ge(a.id);x(t)}catch{}finally{p(!1)}}}L.useEffect(()=>{let t=!0;const r=async()=>{const{data:n}=await M.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(t&&n){const v=n?.current_gw??null;C(v)}};r();const l=M.channel("stats-app-meta").on("postgres_changes",{event:"*",schema:"public",table:"app_meta"},()=>{r()}).subscribe();return()=>{t=!1,M.removeChannel(l)}},[]);const{state:S}=V(N,a?.id),{state:P}=V(s?.lastCompletedGw??null,a?.id);if(L.useEffect(()=>{let t=!0;return(async()=>{const{data:l}=await M.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(t&&l){const n=l?.current_gw??null;c(n)}})(),()=>{t=!1}},[]),L.useEffect(()=>{a?k():p(!1)},[a]),L.useEffect(()=>{if(!a||!N||S===null)return;let t=!0;return(async()=>{if(S!=="LIVE"&&S==="RESULTS_PRE_GW"){const{data:l}=await M.from("app_gw_results").select("gw").order("gw",{ascending:!1}).limit(1).maybeSingle(),n=l?.gw||null;n&&n!==G.current&&(G.current=n,t&&k());return}})(),()=>{t=!1}},[a,N,S]),!a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",children:e.jsx("div",{className:"max-w-4xl lg:max-w-[1024px] mx-auto px-4 lg:px-6",children:e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-6 text-center",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-300",children:"Please sign in to view your stats."})})})});const E=s&&(s.lastCompletedGw!==null||s.overallPercentile!==null);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 overflow-x-hidden",children:[e.jsx("style",{children:`
 @keyframes sparkle {
 0%, 100% {
 opacity: 1;
 transform: scale(1) rotate(0deg);
 }
 25% {
 opacity: 0.9;
 transform: scale(1.05) rotate(-3deg);
 }
 50% {
 opacity: 1;
 transform: scale(1.1) rotate(3deg);
 }
 75% {
 opacity: 0.9;
 transform: scale(1.05) rotate(-3deg);
 }
 }
 .sparkle-trophy {
 animation: sparkle 2s ease-in-out infinite;
 filter: drop-shadow(0 0 4px rgba(251, 191, 36, 0.6));
 }
 @media (min-width: 1024px) {
 .desktop-constrained-section {
 margin-right: 0 !important;
 padding-right: 1.5rem !important;
 }
 .desktop-constrained-unicorn {
 margin-right: 0 !important;
 padding-right: 1.5rem !important;
 }
 .unicorn-scroll-container {
 margin-left: 0 !important;
 margin-right: 0 !important;
 padding-left: 0 !important;
 padding-right: 0 !important;
 width: 100% !important;
 }
 }
 `}),e.jsxs("div",{className:"max-w-4xl lg:max-w-[1024px] mx-auto px-4 lg:px-6 py-6",children:[e.jsxs(le,{to:"/profile",className:"inline-flex items-center gap-2 text-slate-600 dark:text-slate-400 mb-4",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{children:"Back to Profile"})]}),e.jsx(ie,{title:"Stats",as:"h1",className:"mb-6"}),s&&s.lastCompletedGw!==null&&(P!=="LIVE"&&P!=="GW_OPEN"&&P!=="GW_PREDICTED"?e.jsx("button",{onClick:()=>{m(s.lastCompletedGw),T(!0),f(!0)},className:"w-full mb-6 bg-gradient-to-r from-emerald-500 to-teal-600 dark:from-emerald-600 dark:to-teal-700 text-white font-semibold py-3 px-4 rounded-xl shadow-md duration-200 transform active:scale-[0.98] disabled:opacity-75 disabled:cursor-not-allowed",disabled:y,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg whitespace-nowrap",children:["Your Gameweek ",s.lastCompletedGw," Results"]}),y?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white flex-shrink-0 ml-2"}):e.jsx("svg",{className:"w-5 h-5 flex-shrink-0 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})}):null),!E&&!d?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-md p-8 text-center",children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-lg",children:"Not enough games yet — check back after a few Gameweeks."}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm mt-2",children:"The numbers will start to tell a story soon."})]}):e.jsxs("div",{className:"space-y-6 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0",children:[s&&s.lastCompletedGw!==null&&s.lastCompletedGwPercentile!==null&&(()=>{const t=s.lastCompletedGwPercentile,r=Math.round(100-t),l=Math.round(t),n=t>=75;return e.jsx(I,{label:`Gameweek ${s.lastCompletedGw}`,value:n?`You were in the top ${r}% of players.`:`You were in the bottom ${l}% of players.`,loading:d})})(),s&&s.overallPercentile!==null&&(()=>{const t=s.overallPercentile,r=Math.round(100-t),l=Math.round(t),n=t>=75;return e.jsx(I,{label:"Overall",value:n?`You're in the top ${r}% of players.`:`You're in the bottom ${l}% of players.`,loading:d})})(),s&&s.mostCorrectTeam&&e.jsx(K,{label:"Most correctly predicted team",teamCode:s.mostCorrectTeam.code,teamName:s.mostCorrectTeam.name,percentage:s.mostCorrectTeam.percentage,isCorrect:!0,loading:d}),s&&s.mostIncorrectTeam&&e.jsx(K,{label:"Most incorrectly picked team",teamCode:s.mostIncorrectTeam.code,teamName:s.mostIncorrectTeam.name,percentage:s.mostIncorrectTeam.percentage,isCorrect:!1,loading:d}),s&&s.correctPredictionRate!==null&&e.jsx(I,{label:"Correct prediction rate",value:`${s.correctPredictionRate.toFixed(2)}%`,loading:d}),s&&s.trophyCabinet!==null&&e.jsx("div",{className:"lg:col-span-2",children:e.jsx(ue,{lastGw:s.trophyCabinet.lastGw,form5:s.trophyCabinet.form5,form10:s.trophyCabinet.form10,overall:s.trophyCabinet.overall,loading:d})}),a&&e.jsx("div",{className:"lg:col-span-2 lg:overflow-hidden lg:rounded-xl",children:e.jsx(pe,{userId:a.id,loading:d})}),s&&s.chaosIndex!==null&&e.jsx(I,{label:"Chaos Index",value:`${s.chaosIndex.toFixed(2)}%`,subcopy:"How often you pick an outcome that 25% or fewer players picked",loading:d}),s&&s.chaosTotalCount!==null&&s.chaosTotalCount>0&&s.chaosCorrectCount!==null&&e.jsx(I,{label:"Chaos Index Success Rate",value:`${(s.chaosCorrectCount/s.chaosTotalCount*100).toFixed(2)}%`,subcopy:"How often you're right when you pick an outcome that 25% or fewer players picked",loading:d}),s&&s.weeklyParData&&s.weeklyParData.length>0&&s.lastCompletedGw&&(()=>{const r=(s.weeklyParData.filter(l=>l.userPoints>l.averagePoints).length/s.weeklyParData.length*100).toFixed(0);return e.jsxs("div",{className:"lg:col-span-2 desktop-constrained-section bg-white dark:bg-slate-800 rounded-l-xl lg:rounded-xl shadow-md lg:overflow-hidden",style:{marginRight:"-100vw",paddingRight:"100vw",paddingTop:"1.5rem",paddingBottom:"1.5rem",paddingLeft:"1.5rem"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:"Weekly Performance vs Average"}),e.jsx("div",{className:"pr-2",children:e.jsx(xe,{value:w,onChange:$,labels:{on:"Complex",off:"Simple"}})})]}),e.jsxs("div",{className:"overflow-x-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",overscrollBehaviorY:"auto",touchAction:"pan-x",marginLeft:"-1.5rem",marginRight:"-1.5rem",paddingLeft:"1.5rem",paddingRight:"1.5rem",width:"calc(100% + 3rem)"},children:[e.jsx("style",{children:".scrollbar-hide::-webkit-scrollbar { display: none; }"}),e.jsx(me,{weeklyData:s.weeklyParData,latestGw:s.lastCompletedGw,showInfo:w})]}),e.jsxs("div",{className:"text-sm font-bold text-slate-700 dark:text-slate-200 mt-2",children:["You perform above average ",r,"% of the time."]})]})})(),s&&s.weeklyParData&&s.weeklyParData.length>0&&(()=>{const t=s.weeklyParData.reduce((l,n)=>l+(n.userPoints-n.averagePoints),0),r=t>=0?`+${t.toFixed(1)}`:t.toFixed(1);return r==="0.0"?null:e.jsx(I,{label:"Total Swing",value:r,subcopy:"Your total points difference from the average across all gameweeks",loading:d})})(),s&&s.bestStreak>0&&s.bestStreakGwRange&&e.jsx(de,{label:"Most consecutive weeks in the top 25%",streakCount:s.bestStreak,gwRange:s.bestStreakGwRange,loading:d}),s&&s.avgPointsPerWeek!==null&&e.jsx(I,{label:"Avg points / week",value:s.avgPointsPerWeek.toFixed(2),loading:d}),s&&s.bestSingleGw&&e.jsx(I,{label:"Best single Gameweek",value:e.jsxs("span",{children:[e.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:s.bestSingleGw.points}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400 ml-2",children:["on GW",s.bestSingleGw.gw]})]}),loading:d}),s&&s.lowestSingleGw&&e.jsx(I,{label:"Lowest single Gameweek",value:e.jsxs("span",{children:[e.jsx("span",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100",children:s.lowestSingleGw.points}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400 ml-2",children:["on GW",s.lowestSingleGw.gw]})]}),loading:d})]}),R&&g&&e.jsx(ce,{isOpen:R,onClose:()=>{T(!1),m(null),f(!1)},gw:g,nextGw:u&&u>g?u:null,onLoadingChange:t=>{f(t)}})]})]})}export{be as default};
