import{j as e,u as ct,m as dt,a as x,c as mt,s as k,k as _e,l as ut,C as xt,D as ft,F as ht,n as pt,o as gt}from"./index-CLXiuwq_.js";import{T as de}from"./TeamBadge-CdHmbf43.js";function He({fixture:n,homeColor:h="#EF0107",awayColor:c="#034694",showSwipeHint:q=!0}){const b=n.kickoff_time?new Date(n.kickoff_time).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}):null,g=n.kickoff_time?new Date(n.kickoff_time).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):null;return e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl overflow-hidden select-none flex flex-col",style:{pointerEvents:"none",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none",width:"100%",height:"100%"},children:[e.jsxs("div",{className:"pt-2 px-8 pb-8 relative flex-shrink-0 pointer-events-none",style:{pointerEvents:"none"},children:[q&&e.jsx("div",{className:"absolute top-2 right-4 flex items-center gap-2 text-slate-400 text-xs font-semibold pointer-events-none",style:{pointerEvents:"none"},children:e.jsx("img",{src:"https://cdn-icons-png.flaticon.com/512/4603/4603384.png",alt:"Swipe gesture icon",className:"w-6 h-6 opacity-80 pointer-events-none",style:{pointerEvents:"none"}})}),(b||g)&&e.jsx("div",{className:"text-center mb-6 pointer-events-none",style:{pointerEvents:"none"},children:e.jsxs("div",{className:"text-sm text-slate-500 font-medium pointer-events-none",style:{pointerEvents:"none"},children:[b,b&&g&&e.jsx("span",{className:"mx-2 pointer-events-none",style:{pointerEvents:"none"},children:"‚Ä¢"}),g&&e.jsx("span",{className:"text-slate-700 pointer-events-none",style:{pointerEvents:"none"},children:g})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-10 mb-4 relative pointer-events-none mt-6",style:{pointerEvents:"none"},children:[e.jsxs("div",{className:"flex flex-col items-center pointer-events-none",style:{pointerEvents:"none"},children:[e.jsx("div",{className:"pointer-events-none",style:{pointerEvents:"none"},children:e.jsx(de,{code:n.home_code,crest:n.home_crest,size:120})}),e.jsx("div",{className:"text-sm font-bold text-slate-700 mt-4 text-center max-w-[120px] pointer-events-none",style:{pointerEvents:"none"},children:n.home_team||n.home_name})]}),e.jsxs("div",{className:"flex flex-col items-center pointer-events-none",style:{pointerEvents:"none"},children:[e.jsx("div",{className:"pointer-events-none",style:{pointerEvents:"none"},children:e.jsx(de,{code:n.away_code,crest:n.away_crest,size:120})}),e.jsx("div",{className:"text-sm font-bold text-slate-700 mt-4 text-center max-w-[120px] pointer-events-none",style:{pointerEvents:"none"},children:n.away_team||n.away_name})]})]})]}),e.jsxs("div",{className:"flex-1 relative overflow-hidden pointer-events-none min-h-[192px]",style:{pointerEvents:"none"},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:h,clipPath:"polygon(0 0, 0 100%, 100% 100%)",pointerEvents:"none"}}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{background:c,clipPath:"polygon(0 0, 100% 0, 100% 100%)",pointerEvents:"none"}})]})]})}function bt({score:n,total:h,topPercent:c}){const q=h>0?n/h*100:0;return e.jsx("div",{className:"mb-4 rounded-xl border bg-gradient-to-br from-[#1C8376]/5 to-blue-50/50 shadow-sm px-6 py-5",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-[#1C8376]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{className:"text-4xl font-extrabold text-[#1C8376]",children:[n,"/",h]}),c!=null&&e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-yellow-100 to-orange-100 border border-yellow-300",children:e.jsxs("span",{className:"text-sm font-bold text-orange-700",children:["Top ",c,"%"]})})]}),e.jsx("div",{className:"mb-3 bg-slate-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#1C8376] to-blue-500 transition-all duration-500",style:{width:`${q}%`}})})]})})}function yt({success:n,message:h,onClose:c}){return e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-white px-10 py-8 text-center shadow-2xl max-w-sm mx-4",children:[e.jsx("div",{className:"absolute -top-16 -left-10 h-32 w-32 rounded-full bg-emerald-200/40 blur-2xl"}),e.jsx("div",{className:"absolute -bottom-14 -right-12 h-32 w-32 rounded-full bg-cyan-200/40 blur-2xl"}),e.jsxs("div",{className:"relative z-10 space-y-4",children:[n?e.jsx("svg",{className:"w-16 h-16 mx-auto text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"w-16 h-16 mx-auto text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("div",{className:`text-2xl font-extrabold ${n?"text-emerald-700":"text-amber-600"}`,children:n?"Good Luck!":"Not Quite Yet!"}),e.jsx("p",{className:"text-sm text-slate-600",children:h}),c&&e.jsx("button",{onClick:c,className:"mt-4 px-6 py-2 bg-[#1C8376] text-white rounded-lg font-semibold hover:bg-[#1C8376]/90 transition-colors",children:"Close"})]})]})})}function vt(n){let h=0;for(let g=0;g<n.length;g++)h=n.charCodeAt(g)+((h<<5)-h);const c=Math.abs(h%360),q=60+Math.abs(h)%20,b=45+Math.abs(h)%15;return`hsl(${c}, ${q}%, ${b}%)`}function ce(n,h){return n&&qe[n]?qe[n].primary:vt(n||h||"default")}const qe={ARS:{primary:"#EF0107",secondary:"#023474"},AVL:{primary:"#95BFE5",secondary:"#670E36"},BOU:{primary:"#DA291C",secondary:"#000000"},BRE:{primary:"#E30613",secondary:"#FBB800"},BHA:{primary:"#0057B8",secondary:"#FFCD00"},CHE:{primary:"#034694",secondary:"#034694"},CRY:{primary:"#1B458F",secondary:"#C4122E"},EVE:{primary:"#003399",secondary:"#003399"},FUL:{primary:"#FFFFFF",secondary:"#000000"},LIV:{primary:"#C8102E",secondary:"#00B2A9"},MCI:{primary:"#6CABDD",secondary:"#1C2C5B"},MUN:{primary:"#DA291C",secondary:"#FBE122"},NEW:{primary:"#241F20",secondary:"#FFFFFF"},NFO:{primary:"#DD0000",secondary:"#FFFFFF"},TOT:{primary:"#132257",secondary:"#FFFFFF"},WHU:{primary:"#7A263A",secondary:"#1BB1E7"},WOL:{primary:"#FDB913",secondary:"#231F20"},SUN:{primary:"#EB172B",secondary:"#211E1F"},LEE:{primary:"#FFCD00",secondary:"#1D428A"}};function Et(){const{user:n}=ct(),h=dt(),[c,q]=x.useState(null),[b,g]=x.useState(0),$=(()=>{if(typeof window>"u"||!n?.id)return{fixtures:[],picks:new Map,submitted:!1,results:new Map,loading:!0,picksChecked:!1,submissionChecked:!1};try{const s=_e("app_meta")?.current_gw||14,r=`predictions:${n.id}:${s}`,i=_e(r);if(i&&i.fixtures&&Array.isArray(i.fixtures)&&i.fixtures.length>0){const d=new Map;i.picks&&Array.isArray(i.picks)&&i.picks.forEach(p=>{d.set(p.fixture_index,p)});const l=new Map;return i.results&&Array.isArray(i.results)&&i.results.forEach(p=>{l.set(p.fixture_index,p.result)}),{fixtures:i.fixtures,picks:d,submitted:i.submitted||!1,results:l,loading:!1,picksChecked:!0,submissionChecked:!0}}}catch{}return{fixtures:[],picks:new Map,submitted:!1,results:new Map,loading:!0,picksChecked:!1,submissionChecked:!1}})(),[m,se]=x.useState($.fixtures),[y,T]=x.useState($.picks),[F,me]=x.useState($.results),Ge=()=>{if(typeof window>"u")return"cards";try{for(let t=0;t<sessionStorage.length;t++){const s=sessionStorage.key(t);if(s&&s.startsWith("test_api_submitted_")&&sessionStorage.getItem(s)==="true"){if(n?.id&&s.endsWith(`_${n.id}`))return console.log('[TestApiPredictions] üö´ Initial viewMode set to "list" - found submission in sessionStorage for user'),"list";if(!n?.id)return console.log('[TestApiPredictions] üö´ Initial viewMode set to "list" - found submission in sessionStorage (user ID not available yet)'),"list"}}}catch{}return"cards"},[D,I]=x.useState(()=>{const t=Ge();return $.submitted?"list":t}),[_,ie]=x.useState({x:0,y:0,rotation:0,opacity:1,scale:1}),[Q,Ne]=x.useState(!1),[R,Se]=x.useState(!1),[ue,X]=x.useState(null),[ze,Oe]=x.useState(!1),[xe,G]=x.useState(null),[Z,z]=x.useState($.loading),[fe,re]=x.useState($.picksChecked),[O,K]=x.useState($.submissionChecked),Y=()=>{if(typeof window>"u"||!c||!n?.id)return!1;const t=`test_api_submitted_${c}_${n.id}`;return sessionStorage.getItem(t)==="true"},U=t=>{if(typeof window>"u"||!c||!n?.id)return;const s=`test_api_submitted_${c}_${n?.id}`;t?sessionStorage.setItem(s,"true"):sessionStorage.removeItem(s)},N=x.useRef(Y()),[u,P]=x.useState(()=>{if($.submitted)return N.current=!0,!0;if(typeof window>"u"||!n?.id)return!1;try{for(let t=0;t<sessionStorage.length;t++){const s=sessionStorage.key(t);if(s&&s.startsWith("test_api_submitted_")&&s.endsWith(`_${n.id}`)&&sessionStorage.getItem(s)==="true")return N.current=!0,!0}}catch{}return!1});x.useEffect(()=>{if(c&&n?.id&&typeof window<"u")try{const t=`test_api_submitted_${c}_${n.id}`;sessionStorage.getItem(t)==="true"&&(console.log('[TestApiPredictions] üö´ Setting viewMode to "list" immediately - user has submitted (from sessionStorage)'),I("list"),P(!0),N.current=!0)}catch{}},[c,n?.id]),x.useEffect(()=>{u&&D==="cards"&&(console.log('[TestApiPredictions] ‚úÖ FORCING viewMode to "list" - user has submitted'),I("list"))},[u,D]),x.useEffect(()=>{!Z&&!u&&m.length>0&&b===0&&I("cards")},[Z,u,m.length,b]);const[Ye,ne]=x.useState(null),[Ue,Ve]=x.useState(!1),[oe,Xe]=x.useState([]),[Ce,Ke]=x.useState(new Set),[Ee,Je]=x.useState(null),[Pe,Qe]=x.useState([]),{liveScores:he}=mt(c||void 0,Pe.length>0?Pe:void 0),J=x.useMemo(()=>{const t={};return m.forEach(s=>{if(s.api_match_id&&he.has(s.api_match_id)){const r=he.get(s.api_match_id);t[s.fixture_index]={homeScore:r.home_score??0,awayScore:r.away_score??0,status:r.status||"SCHEDULED",minute:r.minute,goals:r.goals||null,red_cards:r.red_cards||null,home_team:r.home_team||null,away_team:r.away_team||null}}}),t},[he,m]),Ze=()=>{if(typeof window>"u")return!0;try{for(let t=0;t<sessionStorage.length;t++){const s=sessionStorage.key(t);if(s&&s.startsWith("test_api_submitted_")&&sessionStorage.getItem(s)==="true")return!1}}catch{}return!0},pe=x.useRef(Ze());x.useEffect(()=>{const t=Y();(u||t&&N.current)&&(pe.current=!1)},[u]),x.useEffect(()=>{const t=document.documentElement,s=document.body,r=document.getElementById("root");t.style.setProperty("overflow","","important"),s.style.setProperty("overflow","","important"),s.style.setProperty("position","","important"),s.style.removeProperty("width"),s.style.removeProperty("height"),s.style.removeProperty("top"),r&&r.style.setProperty("overflow","","important");const i=setTimeout(()=>{t.style.removeProperty("overflow"),s.style.removeProperty("overflow"),s.style.removeProperty("position"),s.style.removeProperty("width"),s.style.removeProperty("height"),s.style.removeProperty("top"),r&&r.style.removeProperty("overflow")},100);return()=>{clearTimeout(i),t.style.setProperty("overflow","","important"),s.style.setProperty("overflow","","important"),s.style.setProperty("position","","important"),s.style.removeProperty("width"),s.style.removeProperty("height"),s.style.removeProperty("top"),r&&r.style.setProperty("overflow","","important"),setTimeout(()=>{t.style.removeProperty("overflow"),s.style.removeProperty("overflow"),s.style.removeProperty("position"),s.style.removeProperty("width"),s.style.removeProperty("height"),s.style.removeProperty("top"),r&&r.style.removeProperty("overflow")},50)}},[]),x.useEffect(()=>{const t=b>=m.length,s=D==="cards"&&!t&&m.length>0&&!u,r=document.documentElement,i=document.body,d=document.getElementById("root"),l=()=>{r.style.setProperty("overflow","","important"),i.style.setProperty("overflow","","important"),i.style.setProperty("position","","important"),d&&d.style.setProperty("overflow","","important"),r.style.removeProperty("overflow"),i.style.removeProperty("overflow"),i.style.removeProperty("position"),i.style.removeProperty("width"),i.style.removeProperty("height"),i.style.removeProperty("top"),d&&d.style.removeProperty("overflow")};if(!s){l();return}window.scrollTo({top:0,behavior:"auto"}),r.style.setProperty("overflow","hidden","important"),i.style.setProperty("overflow","hidden","important"),i.style.setProperty("position","fixed","important"),i.style.setProperty("width","100%","important"),i.style.setProperty("height","100%","important"),i.style.setProperty("top","0","important"),d&&d.style.setProperty("overflow","hidden","important");const p=f=>{f.preventDefault()},a=f=>{f.target.closest('[style*="aspectRatio"]')||f.preventDefault()};return window.addEventListener("wheel",p,{passive:!1}),document.addEventListener("touchmove",a,{passive:!1}),()=>{l(),window.removeEventListener("wheel",p),document.removeEventListener("touchmove",a)}},[D,b,m.length,u]);const ee=x.useMemo(()=>m.length===0?!1:m.every(t=>y.has(t.fixture_index)),[m,y]),et=x.useRef(null),ge=x.useRef({x:0,y:0}),be=x.useRef(!1);x.useEffect(()=>{let t=!0;return(async()=>{try{let s=null;const{data:r}=await k.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(s=r?.current_gw??14,!s){t&&(se([]),z(!1));return}q(s);const i=`predictions:${n?.id}:${s}`;let d=!1;try{const o=_e(i);if(o&&o.fixtures&&Array.isArray(o.fixtures)&&o.fixtures.length>0){if(se(o.fixtures),z(!1),o.picks&&Array.isArray(o.picks)){const v=new Map;o.picks.forEach(w=>{v.set(w.fixture_index,w)}),T(v)}if(o.submitted!==void 0&&(P(o.submitted),N.current=o.submitted,U(o.submitted),K(!0)),o.results&&Array.isArray(o.results)){const v=new Map;o.results.forEach(w=>{v.set(w.fixture_index,w.result)}),me(v)}re(!0),d=!0}}catch{}d||(m.length===0&&z(!0),re(!1),K(!1));const{data:l,error:p}=await k.from("app_fixtures").select("*").eq("gw",s).order("fixture_index",{ascending:!0});if(p)throw new Error(`Failed to load test fixtures: ${p.message}`);if(!l||l.length===0){t&&(se([]),z(!1));return}const a=l.map(o=>({id:o.id||String(o.api_match_id||o.fixture_index),gw:s,fixture_index:o.fixture_index,home_team:o.home_team,away_team:o.away_team,home_code:o.home_code,away_code:o.away_code,home_name:o.home_name,away_name:o.away_name,home_crest:null,away_crest:null,kickoff_time:o.kickoff_time,api_match_id:o.api_match_id||null}));t&&(se(a),z(!1),me(new Map));const f=a.map(o=>o.api_match_id).filter(o=>o!=null);t&&f.length>0&&Qe(f);let S=!1;if(n?.id&&a.length>0){const{data:o}=await k.from("app_gw_submissions").select("submitted_at").eq("gw",s).eq("user_id",n.id).maybeSingle();if(t&&o?.submitted_at)S=!0,P(!0),I("list"),N.current=!0,U(!0),K(!0);else{P(!1);const v=Y();v&&o?.submitted_at?(P(!0),I("list"),S=!0,N.current=!0):(v&&!o?.submitted_at&&U(!1),N.current=!1),K(!0)}}else t&&(P(!1),K(!0));let B=!1;if(n?.id&&a.length>0&&!S){const{data:o,error:v}=await k.from("app_picks").select("gw,fixture_index,pick").eq("gw",s).eq("user_id",n.id);if(!v&&o&&o.length>0){const w=new Set(a.map(E=>E.fixture_index)),j=o.filter(E=>w.has(E.fixture_index)),A=a.every(E=>j.some(H=>H.fixture_index===E.fixture_index)),W=j.length===a.length;if(A&&W&&j.length>0){const E=new Map;j.forEach(H=>{E.set(H.fixture_index,{fixture_index:H.fixture_index,pick:H.pick,matchday:H.gw||s})}),t&&(T(E),B=!0)}else t&&o.length>0&&(console.log("[TestApiPredictions] Picks found but don't match current fixtures - clearing old picks"),await k.from("app_picks").delete().eq("gw",s).eq("user_id",n.id),T(new Map),B=!1)}}else if(S&&n?.id&&a.length>0){const{data:o,error:v}=await k.from("app_picks").select("gw,fixture_index,pick").eq("gw",s).eq("user_id",n.id);if(!v&&o&&o.length>0){const w=new Set(a.map(A=>A.fixture_index)),j=o.filter(A=>w.has(A.fixture_index));if(j.length===a.length){const A=new Map;j.forEach(W=>{A.set(W.fixture_index,{fixture_index:W.fixture_index,pick:W.pick,matchday:W.gw||s})}),t&&(T(A),B=!0)}}t&&!B&&(P(!1),await k.from("app_gw_submissions").delete().eq("gw",s).eq("user_id",n.id))}if(t&&a.length>0&&n?.id){const{data:o}=await k.from("leagues").select("id").eq("name","API Test").maybeSingle();if(o){t&&Je(o.id);const{data:v}=await k.from("league_members").select("user_id, profiles!inner(id, name)").eq("league_id",o.id);if(v){const w=v.map(M=>({id:M.user_id,name:M.profiles?.name||"Unknown"}));t&&Xe(w);const j=w.map(M=>M.id),{data:A}=await k.from("app_gw_submissions").select("user_id, submitted_at").eq("gw",s).in("user_id",j).not("submitted_at","is",null),{data:W}=await k.from("app_picks").select("user_id, fixture_index").eq("gw",s).in("user_id",j),ke=new Set(a.map(M=>M.fixture_index)),E=ke.size,H=new Date("2025-11-18T00:00:00Z"),je=new Set;A&&W&&E>0&&A.forEach(M=>{const $e=(W??[]).filter(te=>te.user_id===M.user_id).filter(te=>ke.has(te.fixture_index)),ot=$e.length===E,at=new Set($e.map(te=>te.fixture_index)).size===E,Re=M.submitted_at?new Date(M.submitted_at):null,lt=Re&&Re>=H;ot&&at&&lt&&je.add(M.user_id)});const nt=j.length>0&&je.size===j.length;t&&(Ve(nt),Ke(je))}}}if(t&&(re(!0),O||K(!0)),t&&a.length>0&&(B&&!S?g(a.length):S&&B||(g(0),I("cards"))),t&&a.length>0&&n?.id&&s)try{const o=[];y.forEach((w,j)=>{o.push({fixture_index:j,pick:w.pick,matchday:w.matchday})});const v=[];F.forEach((w,j)=>{v.push({fixture_index:j,result:w})}),ut(i,{fixtures:a,picks:o,submitted:S,results:v},xt.PREDICTIONS)}catch(o){console.warn("[TestApiPredictions] Failed to cache data:",o)}}catch(s){console.error("Error loading test API data:",s),t&&re(!0)}finally{t&&z(!1)}})(),()=>{t=!1}},[n?.id]),x.useEffect(()=>{const t=new Map;m.forEach(r=>{const i=J[r.fixture_index];i&&(i.status==="IN_PLAY"||i.status==="PAUSED"||i.status==="FINISHED")&&(i.homeScore>i.awayScore?t.set(r.fixture_index,"H"):i.awayScore>i.homeScore?t.set(r.fixture_index,"A"):t.set(r.fixture_index,"D"))}),me(t)},[J,m]),x.useEffect(()=>{if(!c||!n?.id||F.size===0||m.length===0){ne(null);return}let t=0;if(m.forEach(s=>{const r=F.get(s.fixture_index),i=y.get(s.fixture_index);r&&i&&r===i.pick&&t++}),t===0){ne(null);return}(async()=>{try{const{data:s}=await k.from("app_picks").select("user_id, fixture_index, pick").eq("gw",c);if(s){const r=new Map;s.forEach(a=>{const f=F.get(a.fixture_index),S=r.get(a.user_id)||0;f&&f===a.pick?r.set(a.user_id,S+1):r.set(a.user_id,S)});const i=Array.from(r.values()).sort((a,f)=>f-a),d=i.filter(a=>a>=t).length,l=i.length,p=l>0?Math.round(d/l*100):null;ne(p)}}catch(s){console.error("[TestApiPredictions] Error calculating top percent:",s),ne(null)}})()},[F,y,m,c,n?.id]);const L=m[b],ae=x.useMemo(()=>{let t=0;return m.forEach(s=>{const r=F.get(s.fixture_index),i=y.get(s.fixture_index);r&&i&&i.pick===r&&(t+=1)}),t},[m,F,y]),Ae=(t,s)=>{R||u||(Ne(!0),ge.current={x:t,y:s},X(null))},Me=(t,s)=>{if(!Q||R||u)return;const r=t-ge.current.x,i=s-ge.current.y,d=r*.1;ie({x:r,y:i,rotation:d,opacity:1,scale:1}),Math.abs(r)>50&&Math.abs(r)>Math.abs(i)?X(r>0?"away":"home"):i>50&&i>Math.abs(r)?X("draw"):X(null)},ye=()=>{if(!Q||R||u)return;Ne(!1);const{x:t,y:s}=_,r=100;let i=null;Math.abs(t)>r&&Math.abs(t)>Math.abs(s)?i=t>0?"A":"H":s>r&&s>Math.abs(t)&&(i="D"),i?Fe(i):(ie({x:0,y:0,rotation:0,opacity:1,scale:1}),X(null))},tt=t=>{t.touches.length===1&&Ae(t.touches[0].clientX,t.touches[0].clientY)},st=t=>{t.touches.length===1&&Q&&(t.preventDefault(),Me(t.touches[0].clientX,t.touches[0].clientY))},Te=t=>{t.touches.length>0||(t.preventDefault(),ye())},Fe=async t=>{Se(!0),X(null);const s=t==="H"?-1:t==="A"?1:0,r=s*window.innerWidth,i=t==="D"?window.innerHeight:0;ie({x:r,y:i,rotation:s*30,opacity:0,scale:.8}),await le(t),setTimeout(()=>{be.current=!0,ze?(g(m.length),Oe(!1)):g(b+1),ie({x:0,y:0,rotation:0,opacity:1,scale:1}),requestAnimationFrame(()=>{be.current=!1,Se(!1)})},300)},ve=t=>{!R&&!u&&Fe(t)},le=t=>{if(!L||!c)return;const s=new Map(y);s.set(L.fixture_index,{fixture_index:L.fixture_index,pick:t,matchday:c}),T(s)},it=async()=>{if(!(!n?.id||!c))try{const{error:t}=await k.from("app_gw_submissions").delete().eq("user_id",n.id).eq("gw",c);t?console.error("[TestApiPredictions] Error deleting test_api_submission:",t):console.log("[TestApiPredictions] ‚úÖ Successfully deleted submission on Start Over");const{error:s}=await k.from("app_picks").delete().eq("user_id",n.id).eq("gw",c);s?console.error("[TestApiPredictions] ‚ùå Error deleting test_api_picks:",s):console.log("[TestApiPredictions] ‚úÖ Successfully deleted picks on Start Over"),T(new Map),g(0),P(!1),I("cards"),N.current=!1,U(!1),z(!1),n?.id&&c&&pt(`predictions:${n.id}:${c}`),console.log("[TestApiPredictions] ‚úÖ All picks and submissions cleared - reset to swipe mode")}catch(t){console.error("[TestApiPredictions] ‚ùå Error resetting picks:",t),T(new Map),g(0),P(!1),I("cards"),N.current=!1,U(!1)}},we=async()=>{if(!ee){G({success:!1,message:"You still have fixtures to call!"}),setTimeout(()=>G(null),2200);return}if(!(!n?.id||!c))try{const{data:t}=await k.from("app_gw_submissions").select("submitted_at").eq("user_id",n.id).eq("gw",c).maybeSingle();if(t?.submitted_at){console.warn("[TestApiPredictions] Already submitted - this should not happen if Start Over worked"),P(!0);return}const s=Array.from(y.values()).filter(d=>d.matchday===c).map(d=>({user_id:n.id,gw:c,fixture_index:d.fixture_index,pick:d.pick}));if(s.length!==m.length)throw new Error(`Expected ${m.length} picks but got ${s.length}`);const{error:r}=await k.from("app_picks").upsert(s,{onConflict:"user_id,gw,fixture_index",ignoreDuplicates:!1});if(r)throw console.error("[TestApiPredictions] Error saving picks:",r),r;const{error:i}=await k.from("app_gw_submissions").upsert({user_id:n.id,gw:c,submitted_at:new Date().toISOString()},{onConflict:"user_id,gw"});if(i)throw console.error("[TestApiPredictions] Error saving submission:",i),i;console.log("[TestApiPredictions] Successfully confirmed test picks and submission"),P(!0),N.current=!0,U(!0),n?.id&&gt(n.id),G({success:!0,message:"Your test predictions are locked in. Good luck!"}),setTimeout(()=>{G(null)},2500),Ee&&c&&fetch("/.netlify/functions/notifyFinalSubmission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:Ee,matchday:c,isTestApi:!0})}).catch(d=>{console.error("[TestApiPredictions] Failed to check final submission:",d)})}catch(t){console.error("Error confirming test picks:",t),G({success:!1,message:"Failed to confirm predictions. Please try again."}),setTimeout(()=>G(null),2200)}},rt={loading:Z,currentTestGw:!!c,picksChecked:fe,submissionChecked:O,submitted:u,sessionStorageSubmitted:Y()};if(console.log("[TestApiPredictions] Render check - loading state:",rt),Z||m.length===0||!O||!fe)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1C8376]"})});if(Z&&m.length===0)return e.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"sticky top-0 z-40 px-4 pt-4 pb-2 bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"relative flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>h("/"),className:"text-slate-600 hover:text-slate-800 text-3xl font-bold w-10 h-10 flex items-center justify-center",children:"‚úï"}),e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 text-lg font-extrabold text-slate-700",children:c?`Game Week ${c}`:"Loading..."})]})})}),e.jsx("div",{className:"flex items-center justify-center flex-1",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#1C8376]"})})]});if((!fe||!O)&&m.length>0)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1C8376]"})});if(m.length===0)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4 max-w-md",children:[e.jsx("div",{className:"text-red-600 font-semibold mb-2",children:"No Test Fixtures Found"}),e.jsx("div",{className:"text-sm text-slate-600 mb-4",children:"Please create a test gameweek in the Test API Admin page first."}),e.jsx("button",{onClick:()=>h("/test-admin-api"),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Go to Test API Admin"})]})});const De=Y(),Ie=u||!O&&De;if(console.log("[TestApiPredictions] Checking if submitted - state:",u,"sessionStorage:",De,"submissionChecked:",O,"isUserSubmitted:",Ie),Ie){if(console.log("[TestApiPredictions] ‚úÖ Showing submitted view"),!Ue&&oe.length>0){const t=oe.filter(s=>!Ce.has(s.id)).length;return e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>h("/"),className:"inline-flex items-center gap-2 text-sm font-medium text-slate-600 hover:text-slate-800",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Back"]}),e.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 text-lg font-extrabold text-slate-700",children:["Game Week ",c]})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"rounded-2xl border bg-white p-4 mb-4",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-3",children:["Waiting for ",e.jsx("span",{className:"font-bold",children:t})," of ",oe.length," to submit..."]}),e.jsx("div",{className:"text-xs text-slate-500 mb-4",children:"Your predictions have been confirmed. Once all members have submitted, you'll be able to see everyone's picks."}),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),e.jsx("tbody",{children:oe.slice().sort((s,r)=>s.name.localeCompare(r.name)).map(s=>{const r=Ce.has(s.id);return e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:s.name}),e.jsx("td",{className:"px-4 py-3",children:r?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:"Submitted"}):e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:"Not yet"})})]},s.id)})})]})})]})})})]})}return m.forEach(t=>{const s=J[t.fixture_index],r=s&&(s.status==="IN_PLAY"||s.status==="PAUSED"),i=s&&s.status==="FINISHED";if(s&&(r||i)){const d=y.get(t.fixture_index);d&&(d.pick==="H"&&s.homeScore>s.awayScore||d.pick==="A"&&s.awayScore>s.homeScore||d.pick==="D"&&(s.homeScore,s.awayScore))}}),e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>h("/"),className:"inline-flex items-center gap-2 text-sm font-medium text-slate-600 hover:text-slate-800",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Back"]}),e.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 text-lg font-extrabold text-slate-700",children:["Game Week ",c]})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[(()=>{const t=m.length>0&&m.some(r=>{const i=J[r.fixture_index];return i&&(i.status==="IN_PLAY"||i.status==="PAUSED"||i.status==="FINISHED")});let s=0;if(t?m.forEach(r=>{const i=J[r.fixture_index],d=y.get(r.fixture_index);if(i&&d){let l=!1;(d.pick==="H"&&i.homeScore>i.awayScore||d.pick==="A"&&i.awayScore>i.homeScore||d.pick==="D"&&i.homeScore===i.awayScore)&&(l=!0),l&&s++}}):u&&m.forEach(r=>{const i=F.get(r.fixture_index),d=y.get(r.fixture_index);i&&d&&i===d.pick&&s++}),t||u&&m.length>0){const r=t?s:u?ae:0;return e.jsx(bt,{score:r,total:m.length,topPercent:Ye})}return null})(),e.jsx("div",{className:"space-y-6 [&>div:first-child]:mt-0",children:(()=>{const t=[];let s="",r=[];return m.forEach(i=>{const d=i.kickoff_time?new Date(i.kickoff_time).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}):"No date";d!==s?(r.length>0&&t.push({label:s,items:r}),s=d,r=[i]):r.push(i)}),r.length>0&&t.push({label:s,items:r}),t.map((i,d)=>e.jsxs("div",{className:d>0?"mt-6":"",children:[e.jsx(ft,{date:i.label}),e.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:e.jsx("ul",{children:i.items.map((l,p)=>{const a=y.get(l.fixture_index),f=J[l.fixture_index],S={id:l.id,gw:l.gw,fixture_index:l.fixture_index,home_code:l.home_code,away_code:l.away_code,home_team:l.home_team,away_team:l.away_team,home_name:l.home_name,away_name:l.away_name,kickoff_time:l.kickoff_time,api_match_id:l.api_match_id},B=f?{status:f.status,minute:f.minute??null,homeScore:f.homeScore,awayScore:f.awayScore,home_team:f.home_team,away_team:f.away_team,goals:f.goals??void 0,red_cards:f.red_cards??void 0}:null;return e.jsx("li",{className:p>0?"border-t":"",children:e.jsx(ht,{fixture:S,pick:a?.pick,liveScore:B,isTestApi:!0,showPickButtons:!0})},l.id)})})})]},d))})()})]})})]})}const Le=Y();if(!u&&Le&&O&&(console.log("[TestApiPredictions] WARNING: sessionStorage says submitted but state says no - clearing sessionStorage"),U(!1),N.current=!1),console.log("[TestApiPredictions] Review mode check - submitted:",u,"ref:",N.current,"sessionStorage:",Le),console.log("[TestApiPredictions] Review mode check - currentIndex:",b,"fixtures.length:",m.length,"submitted:",u),b>=m.length)return console.log("[TestApiPredictions] ‚úÖ Showing review mode"),e.jsxs("div",{className:"min-h-screen bg-slate-50 flex flex-col",children:[xe&&e.jsx(yt,{success:xe.success,message:xe.message,onClose:()=>G(null)}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"relative flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>g(0),className:"inline-flex items-center gap-2 text-sm font-medium text-slate-600 hover:text-slate-800",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Back"]}),e.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 text-lg font-extrabold text-slate-700",children:"Review Mode"}),ee&&!u?e.jsx("button",{onClick:we,className:"inline-flex items-center gap-2 rounded-full bg-emerald-500 px-3 py-1.5 text-sm font-semibold text-white shadow hover:bg-emerald-600",children:"Confirm"}):u?e.jsx("span",{className:"text-sm text-green-600 font-semibold",children:"‚úì Submitted"}):y.size>0?e.jsx("button",{onClick:we,className:"inline-flex items-center gap-2 rounded-full bg-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-500 shadow-inner",children:"Confirm"}):e.jsx("button",{onClick:()=>g(0),className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-emerald-500 via-emerald-600 to-emerald-700 px-3 py-1.5 text-xs font-semibold text-white shadow-md transition hover:shadow-lg hover:from-emerald-600 hover:via-emerald-700 hover:to-emerald-800",children:"Swipe View"})]}),e.jsx("div",{className:"mt-4 flex items-center justify-center",children:e.jsxs("div",{className:"relative rounded-3xl border border-emerald-100 bg-white px-5 py-3 shadow-sm max-w-md w-full flex items-center gap-3 text-left",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center text-emerald-700",children:e.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v4m0 4h.01"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),e.jsx("div",{className:"text-sm text-slate-600",children:u?"Your predictions are locked in. This is a TEST game and does not affect the main game.":"Need to tweak something? Tap a prediction to adjust it. Everything locks in once you hit confirm."})]})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-4",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-6",children:(()=>{const t=[];let s="",r=[];return m.forEach(i=>{const d=i.kickoff_time?new Date(i.kickoff_time).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"}):"No date";d!==s?(r.length>0&&t.push({label:s,items:r}),s=d,r=[i]):r.push(i)}),r.length>0&&t.push({label:s,items:r}),t.map((i,d)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-800 mb-4",children:i.label}),e.jsx("div",{className:"space-y-4",children:i.items.map(l=>{const p=y.get(l.fixture_index),a=F.get(l.fixture_index);return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[e.jsx("div",{className:"flex-1 min-w-0 text-right",children:e.jsx("span",{className:"text-sm font-semibold text-slate-800 truncate inline-block",children:l.home_team||l.home_name})}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(de,{code:l.home_code,crest:l.home_crest,size:28}),e.jsx("div",{className:"text-slate-400 font-medium text-sm",children:l.kickoff_time?new Date(l.kickoff_time).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):""}),e.jsx(de,{code:l.away_code,crest:l.away_crest,size:28})]}),e.jsx("div",{className:"flex-1 min-w-0 text-left",children:e.jsx("span",{className:"text-sm font-semibold text-slate-800 truncate inline-block",children:l.away_team||l.away_name})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mt-4",children:[e.jsx("button",{onClick:()=>{if(u)return;const f=new Map(y);f.set(l.fixture_index,{fixture_index:l.fixture_index,pick:"H",matchday:c}),T(f),le("H")},disabled:u,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${p?.pick==="H"?a&&a==="H"&&p.pick===a?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl":a&&(a==="D"||a==="A")?"bg-red-500 text-white border-red-400":"bg-purple-600 text-white border-purple-600":a==="H"?"bg-gray-300 text-slate-700 border-gray-400":u?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Home Win"}),e.jsx("button",{onClick:()=>{if(u)return;const f=new Map(y);f.set(l.fixture_index,{fixture_index:l.fixture_index,pick:"D",matchday:c}),T(f),le("D")},disabled:u,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${p?.pick==="D"?a&&a==="D"&&p.pick===a?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl":a&&(a==="H"||a==="A")?"bg-red-500 text-white border-red-400":"bg-purple-600 text-white border-purple-600":a==="D"?"bg-gray-300 text-slate-700 border-gray-400":u?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Draw"}),e.jsx("button",{onClick:()=>{if(u)return;const f=new Map(y);f.set(l.fixture_index,{fixture_index:l.fixture_index,pick:"A",matchday:c}),T(f),le("A")},disabled:u,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${p?.pick==="A"?a&&a==="A"&&p.pick===a?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl":a&&(a==="H"||a==="D")?"bg-red-500 text-white border-red-400":"bg-purple-600 text-white border-purple-600":a==="A"?"bg-gray-300 text-slate-700 border-gray-400":u?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Away Win"})]})]},l.id)})})]},d))})()})}),e.jsx("div",{className:"p-6 bg-white shadow-lg",children:e.jsx("div",{className:"max-w-2xl mx-auto space-y-4",children:u?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-lg font-bold text-slate-800 mb-2",children:"Predictions Submitted (TEST)"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Your test predictions for Test GW ",c," have been confirmed."]}),ae>0&&e.jsxs("div",{className:"mt-4 text-2xl font-bold text-purple-700",children:[ae,"/",m.length]})]}):e.jsxs(e.Fragment,{children:[!ee&&e.jsx("div",{className:"text-center text-sm text-amber-600 mb-2",children:"You haven't made all your predictions yet"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("button",{onClick:it,disabled:u,className:"w-full py-3 bg-slate-200 text-slate-700 rounded-2xl font-semibold hover:bg-slate-300 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Start Over"}),e.jsx("button",{onClick:we,disabled:!ee,className:"w-full py-4 bg-green-600 text-white rounded-2xl font-bold hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:ee?"Confirm Predictions (TEST)":"Complete All Predictions First"}),e.jsx("button",{onClick:()=>h("/"),className:"w-full py-3 text-slate-600 hover:text-slate-800 font-medium",children:"Cancel"})]})]})})})]});const Be=Y(),We=(()=>{if(typeof window>"u"||!n?.id)return!1;try{for(let t=0;t<sessionStorage.length;t++){const s=sessionStorage.key(t);if(s&&s.startsWith("test_api_submitted_")&&s.endsWith(`_${n.id}`)&&sessionStorage.getItem(s)==="true")return!0}}catch{}return!1})(),C=u||Be&&N.current||We,V=C?"list":D;return C&&D==="cards"?(console.log("[TestApiPredictions] üö´ BLOCKING cards - submission detected, viewMode still cards, showing loading"),e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1C8376]"})})):(console.log("[TestApiPredictions] üî¥ SWIPE VIEW CHECK - submitted:",u,"ref:",N.current,"sessionStorage:",Be,"anySessionStorage:",We,"checkSubmittedBeforeSwipe:",C,"viewMode:",D,"effectiveViewMode:",V),console.log("[TestApiPredictions] ‚úÖ Showing view - mode:",V),!L&&m.length>0?(console.log("[TestApiPredictions] ‚ö†Ô∏è currentFixture is undefined, resetting to index 0"),g(0),e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1C8376]"})})):m.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4 max-w-md",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No fixtures available"}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Check back later for Test GW ",c," fixtures."]})]})}):e.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col overflow-hidden",children:[pe.current&&!C&&!u&&V==="cards"&&D==="cards"&&e.jsx("div",{className:"sticky top-0 z-40 px-4 pt-4 pb-2 bg-gradient-to-br from-slate-50 to-slate-100",style:{display:C?"none":"block"},children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsxs("div",{className:"relative flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>h("/"),className:"text-slate-600 hover:text-slate-800 text-3xl font-bold w-10 h-10 flex items-center justify-center",children:"‚úï"}),e.jsxs("span",{className:"absolute left-1/2 -translate-x-1/2 text-lg font-extrabold text-slate-700",children:["Gameweek ",c]}),!C&&V==="cards"&&e.jsxs("button",{onClick:()=>g(m.length),className:"inline-flex items-center gap-1.5 rounded-full bg-gradient-to-r from-emerald-500 via-emerald-600 to-emerald-700 px-3 py-1.5 text-xs font-semibold text-white shadow-md transition hover:shadow-lg hover:from-emerald-600 hover:via-emerald-700 hover:to-emerald-800",children:[e.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})}),"List View"]})]}),!C&&V==="cards"&&e.jsx("div",{className:"mt-4 flex justify-center mb-0",children:e.jsx("div",{className:"inline-flex items-center gap-2 rounded-full bg-[#e6f3f0] px-3 py-2",children:m.map((t,s)=>{const r=s<b,i=s===b;return e.jsx("div",{className:`flex items-center justify-center transition-all ${i?"h-2 w-6 rounded-full bg-[#178f72]":"h-3 w-3 rounded-full"} ${r&&!i?"bg-[#116f59]":i?"":"bg-white"}`},s)})})})]})}),(C||V==="list")&&e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx("button",{onClick:()=>h("/"),className:"absolute left-0 top-0 w-10 h-10 rounded-full bg-slate-100 hover:bg-slate-200 flex items-center justify-center text-slate-600 hover:text-slate-800 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-extrabold tracking-tight text-slate-900 mt-0 mb-2",children:"Test API Predictions"}),e.jsxs("div",{className:"mt-0 mb-4 text-base text-slate-500",children:["Call every game, lock in your results.",e.jsx("br",{}),"This is a TEST game."]})]})]}),e.jsx("div",{className:"mt-2 mb-4",children:e.jsx("div",{className:"rounded-xl border bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-purple-900 font-semibold text-lg",children:["Test GW ",c," Complete"]}),e.jsx("div",{className:"text-purple-900 text-sm font-bold mt-1",children:"Your Score"})]}),e.jsx("div",{className:"text-purple-900 text-5xl font-extrabold",children:ae})]})})}),!C&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{onClick:()=>{I("cards"),g(0)},className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-emerald-500 via-emerald-600 to-emerald-700 px-4 py-2 text-sm font-semibold text-white shadow-md transition hover:shadow-lg",children:[e.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6h16M4 12h16M4 18h16"})}),"Back to Swipe View"]})})]})}),pe.current&&!C&&!u&&V==="cards"&&D==="cards"&&e.jsxs("div",{className:"flex flex-col min-h-0 overflow-hidden flex-1",style:{height:"100%",paddingBottom:"120px"},children:[e.jsxs("div",{className:"flex items-center justify-center px-4 relative overflow-hidden flex-1",style:{minHeight:0,width:"100%",paddingTop:"0.125rem"},children:[e.jsxs("div",{className:`absolute left-8 top-1/2 -translate-y-1/2 flex flex-col items-center gap-2 transition-opacity z-50 ${ue==="home"?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"text-6xl font-bold text-slate-700",children:"‚Üê"}),e.jsx("div",{className:"text-lg font-bold text-slate-700 bg-white px-4 py-2 rounded-full shadow-lg whitespace-nowrap",children:"Home Win"})]}),e.jsxs("div",{className:`absolute right-8 top-1/2 -translate-y-1/2 flex flex-col items-center gap-2 transition-opacity z-50 ${ue==="away"?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"text-6xl font-bold text-slate-700",children:"‚Üí"}),e.jsx("div",{className:"text-lg font-bold text-slate-700 bg-white px-4 py-2 rounded-full shadow-lg whitespace-nowrap",children:"Away Win"})]}),e.jsxs("div",{className:`absolute bottom-32 left-1/2 -translate-x-1/2 flex flex-col items-center gap-2 transition-opacity z-50 ${ue==="draw"?"opacity-100":"opacity-0"}`,children:[e.jsx("div",{className:"text-6xl font-bold text-slate-700",children:"‚Üì"}),e.jsx("div",{className:"text-lg font-bold text-slate-700 bg-white px-4 py-2 rounded-full shadow-lg",children:"Draw"})]}),e.jsxs("div",{className:"max-w-md w-full relative",style:{aspectRatio:"0.75",display:C?"none":"block"},children:[b<m.length-1&&(()=>{const t=m[b+1];return e.jsx("div",{className:"absolute inset-0 pointer-events-none",style:{transform:"scale(1)",opacity:Q||R?.5:0,zIndex:1,transition:"opacity 0.15s ease-out"},children:e.jsx(He,{fixture:t,homeColor:ce(t.home_code,t.home_name),awayColor:ce(t.away_code,t.away_name),showSwipeHint:!1})},b+1)})(),e.jsx("div",{className:"absolute inset-0 z-10",style:{transform:`translate(${_.x}px, ${_.y}px) rotate(${_.rotation}deg) scale(${_.scale})`,opacity:_.opacity,transition:Q||be.current?"none":"all 0.3s ease-out",pointerEvents:"none",display:C?"none":"block"},children:e.jsx(He,{fixture:L,homeColor:ce(L.home_code,L.home_name),awayColor:ce(L.away_code,L.away_name),showSwipeHint:!0})}),e.jsx("div",{ref:et,className:"absolute inset-0 z-50 cursor-grab active:cursor-grabbing",style:{touchAction:"none",WebkitTouchCallout:"none",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"auto",backgroundColor:"transparent",top:0,left:0,right:0,bottom:0,width:"100%",height:"100%",margin:0,padding:0},onMouseDown:t=>{t.preventDefault(),!u&&Ae(t.clientX,t.clientY)},onMouseMove:t=>{t.preventDefault(),!u&&Me(t.clientX,t.clientY)},onMouseUp:t=>{t.preventDefault(),ye()},onMouseLeave:t=>{t.preventDefault(),ye()},onTouchStart:tt,onTouchMove:st,onTouchEnd:Te,onTouchCancel:Te})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 pt-3 px-4 bg-[#eef4f3] z-[10000] safe-area-inset-bottom",style:{paddingBottom:"calc(1rem + env(safe-area-inset-bottom, 0px))"},children:e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs("div",{className:"flex items-stretch justify-center gap-3",children:[e.jsx("button",{onClick:()=>ve("H"),disabled:R||u,className:"flex-1 py-4 rounded-2xl font-semibold transition-all flex items-center justify-center bg-[#d7e6e3] text-slate-700 disabled:opacity-70",style:{backgroundColor:_.x<-30?`rgba(34, 197, 94, ${Math.min(.8,Math.abs(_.x)/150)})`:void 0,color:_.x<-30?"#fff":void 0},children:"Home Win"}),e.jsx("button",{onClick:()=>ve("D"),disabled:R||u,className:"flex-1 py-4 rounded-2xl font-semibold transition-all flex items-center justify-center bg-[#d7e6e3] text-slate-700 disabled:opacity-70",style:{backgroundColor:_.y>30?`rgba(59, 130, 246, ${Math.min(.8,_.y/150)})`:void 0,color:_.y>30?"#fff":void 0},children:"Draw"}),e.jsx("button",{onClick:()=>ve("A"),disabled:R||u,className:"flex-1 py-4 rounded-2xl font-semibold transition-all flex items-center justify-center bg-[#d7e6e3] text-slate-700 disabled:opacity-70",style:{backgroundColor:_.x>30?`rgba(34, 197, 94, ${Math.min(.8,_.x/150)})`:void 0,color:_.x>30?"#fff":void 0},children:"Away Win"})]})})})]})]}))}export{Et as default};
