import{u as re,r as c,s as w,j as e}from"./index-D_YpmWng.js";import{g as ie}from"./teamNames-sXa9mUip.js";import{u as ae}from"./useLiveScores-CGdAExRV.js";function Y(u,d){const M=u?.[`${d}_name`],_=u?.[`${d}_team`],v=u?.[`${d}_code`]||M||_||"";return ie(v)||(d==="home"?"Home":"Away")}function ce(){const{user:u}=re(),[d,M]=c.useState(null),[_,G]=c.useState([]),[v,C]=c.useState(new Map),[P,z]=c.useState(new Map),[R,D]=c.useState(!0),[U,E]=c.useState(""),[T,q]=c.useState(!1),[K,$]=c.useState(!1),[B,I]=c.useState(!1),[J,A]=c.useState(!1),[V,H]=c.useState("saved"),[h,Q]=c.useState(!1),[F,X]=c.useState(null),[W,Z]=c.useState(null),[y,ee]=c.useState(!1),[k,te]=c.useState(null),O=c.useMemo(()=>_.map(s=>s.api_match_id).filter(s=>s!=null),[_]),{liveScores:se}=ae(d||void 0,O.length>0?O:void 0);return c.useEffect(()=>{console.log("isPastDeadline state changed to:",h)},[h]),c.useEffect(()=>{if(P.size>0&&v.size>0){let s=0;v.forEach(t=>{const r=P.get(t.fixture_index);r&&r===t.pick&&s++}),X(s),console.log("Calculated score:",s),(async()=>{if(d){const{data:t}=await w.from("picks").select("user_id, fixture_index, pick").eq("gw",d);if(t){const r=new Map;t.forEach(g=>{const b=P.get(g.fixture_index),f=r.get(g.user_id)||0;b&&b===g.pick?r.set(g.user_id,f+1):r.set(g.user_id,f)});const o=Array.from(r.values()).sort((g,b)=>b-g),i=o.filter(g=>g>=s).length,x=o.length,m=Math.round(i/x*100);Z(m),console.log("Top percent:",m)}}})()}},[P,v,d]),c.useEffect(()=>{let s=!0;return(async()=>{try{let t=!1;if(u?.id)try{const{data:a,error:l}=await w.from("league_members").select("leagues(id,name)").eq("user_id",u.id);l?(console.warn("[NewPredictionsCentre] Error checking leagues (non-fatal):",l),t=!1):a&&(t=a.some(p=>p.leagues?.name==="API Test"))}catch(a){console.error("[NewPredictionsCentre] Error checking API Test membership:",a),t=!1}s&&ee(t);const{data:r,error:o}=await w.from("meta").select("current_gw").eq("id",1).maybeSingle();if(o){console.error("[NewPredictionsCentre] Error fetching current GW:",o),s&&(E(`Failed to load gameweek: ${o.message||"Unknown error"}`),D(!1));return}const i=r?.current_gw??1;let x,m=i;if(t)try{const a=await w.from("test_api_fixtures").select("id,test_gw as gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",1).order("fixture_index",{ascending:!0});if(a.error){const l=a.error?.code,p=a.error.message||"";if(l==="PGRST116"||p.includes("404")||p.includes("does not exist"))console.log("[NewPredictionsCentre] Test fixtures table not found, using regular fixtures"),x=await w.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0});else throw console.error("[NewPredictionsCentre] Error fetching test fixtures:",a.error),a.error}else a.data&&a.data.length>0?(x={data:a.data,error:null},m=1,console.log("[NewPredictionsCentre] Using test fixtures for GW 1:",a.data.length,"fixtures")):(console.log("[NewPredictionsCentre] No test fixtures found, using regular fixtures"),x=await w.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0}))}catch(a){console.error("[NewPredictionsCentre] Error fetching test fixtures, falling back to regular:",a),x=await w.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0})}else x=await w.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0});const{data:g,error:b}=x;if(b){console.error("Error fetching fixtures:",b),s&&(D(!1),E(`Failed to load fixtures: ${b.message||"Unknown error"}`));return}const f=g??[];if(s&&(G(f),M(m),s&&te(m),console.log("Loaded",f.length,"fixtures for GW",m,t&&m===1?"(Test GW 1)":""),f.length>0&&f[0].kickoff_time)){const a=f.reduce((l,p)=>{if(!p.kickoff_time)return l;const N=new Date(p.kickoff_time);return!l||N<l?N:l},null);if(a){const l=new Date(a.getTime()-45e5),p=new Date,N=p.getTime()>l.getTime();console.log("Earliest kickoff:",a.toISOString()),console.log("Deadline time:",l.toISOString()),console.log("Current time:",p.toISOString()),console.log("Is past deadline?",N),Q(N)}}const S=t&&m===1?1:i;if(u?.id){const{data:a,error:l}=await w.from("picks").select("gw,fixture_index,pick").eq("gw",S).eq("user_id",u.id);l&&console.error("Error fetching picks:",l);const p=new Map;a?.forEach(N=>{p.set(N.fixture_index,{fixture_index:N.fixture_index,pick:N.pick,gw:N.gw})}),s&&(C(p),console.log("Loaded",p.size,"user picks for GW",i))}if(u?.id){const{data:a}=await w.from("gw_submissions").select("submitted_at").eq("gw",S).eq("user_id",u.id).maybeSingle();s&&(q(!!a?.submitted_at),console.log("Submission status:",a?.submitted_at?"confirmed":"not confirmed"))}const n=t&&m===1?1:i,{data:j,error:L}=await w.from("gw_results").select("gw,fixture_index,result").eq("gw",n);if(!L&&j){const a=new Map;j.forEach(l=>{(l.result==="H"||l.result==="D"||l.result==="A")&&a.set(l.fixture_index,l.result)}),s&&(z(a),console.log("Loaded",a.size,"results for GW",i))}}catch(t){if(console.error("Error loading GW data:",t),s){D(!1);let r="Unknown error";t?.message?r=t.message:typeof t=="string"?r=t:t?.toString&&(r=t.toString()),(r.includes("Unexpected token")||r.includes("is not valid JSON"))&&(r="Server returned invalid response. Please check your connection and try again."),E(`Failed to load matches: ${r}`)}}finally{s&&D(!1)}})(),()=>{s=!1}},[u?.id]),U?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-red-600 font-semibold text-lg mb-2",children:"Failed to Load Matches"}),e.jsx("div",{className:"text-slate-600 text-sm mb-4",children:U}),e.jsx("button",{onClick:()=>{E(""),D(!0),window.location.reload()},className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Retry"})]})}):R||!d||_.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsx("div",{className:"text-slate-600",children:"Loading fixtures..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-semibold tracking-tight text-slate-900",children:"Predictions Centre"}),e.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600 w-full",children:"Call every game, lock in your results, and climb the table."})]}),d&&e.jsx("div",{className:"mt-2 mb-3",children:T?e.jsx("div",{className:"rounded-xl border bg-gradient-to-br from-[#1C8376]/5 to-blue-50/50 shadow-sm px-6 py-5",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-bold text-slate-900 text-xl mb-3",children:["Game Week ",d]}),F!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsxs("div",{className:"text-4xl font-extrabold text-[#1C8376]",children:[F,"/",_.length]}),W!==null&&e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-yellow-100 to-orange-100 border border-yellow-300",children:e.jsxs("span",{className:"text-sm font-bold text-orange-700",children:["Top ",W,"%"]})})]}),e.jsx("div",{className:"mb-3 bg-slate-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#1C8376] to-blue-500 transition-all duration-500",style:{width:`${F/_.length*100}%`}})})]})]})}):e.jsx("div",{className:"rounded-xl border bg-gradient-to-r from-[#1C8376]/10 to-blue-50 border-[#1C8376]/20 px-6 py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-[#1C8376] text-lg",children:["Gameweek ",d]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Make your predictions below"})]})})}),e.jsx("div",{className:"space-y-4",children:_.map(s=>{const t=v.get(s.fixture_index),r=P.get(s.fixture_index),o=s.api_match_id,i=o?se.get(o):null,x=s.kickoff_time?(()=>{const n=new Date(s.kickoff_time),j=String(n.getUTCHours()).padStart(2,"0"),L=String(n.getUTCMinutes()).padStart(2,"0");return`${j}:${L}`})():"—",m=i&&(i.status==="IN_PLAY"||i.status==="PAUSED"||i.status==="FINISHED"),g=m?`${i.home_score??0}-${i.away_score??0}`:x,b=i?.status==="IN_PLAY"?i.minute?`${i.minute}'`:"LIVE":i?.status==="PAUSED"?"HT":i?.status==="FINISHED"?"FT":null,f=Y(s,"home"),S=Y(s,"away");return e.jsxs("div",{className:"rounded-2xl border bg-white p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center px-2 pt-1 pb-3",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-end",children:[e.jsx("div",{className:"truncate font-medium",children:f}),e.jsx("img",{src:`/assets/badges/${s.home_code?.toUpperCase()||"UNK"}.png`,alt:f,className:"w-5 h-5",onError:n=>{n.currentTarget.style.display="none"}})]}),e.jsx("div",{className:"text-slate-500 text-sm px-4 text-center",children:m?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"font-bold text-slate-900 text-base",children:g}),b&&e.jsx("div",{className:"text-xs text-slate-500",children:b})]}):x}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-start",children:[e.jsx("img",{src:`/assets/badges/${s.away_code?.toUpperCase()||"UNK"}.png`,alt:S,className:"w-5 h-5",onError:n=>{n.currentTarget.style.display="none"}}),e.jsx("div",{className:"truncate font-medium",children:S})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:T?e.jsxs(e.Fragment,{children:[(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="H"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="H"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="H"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Home Win"})})(),(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="D"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="D"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="D"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Draw"})})(),(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="A"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="A"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="A"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Away Win"})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{if(h)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"H",gw:d}),C(n)},disabled:h,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="H"?"bg-[#1C8376] text-white border-[#1C8376]":h?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Home Win"}),e.jsx("button",{onClick:()=>{if(h)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"D",gw:d}),C(n)},disabled:h,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="D"?"bg-[#1C8376] text-white border-[#1C8376]":h?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Draw"}),e.jsx("button",{onClick:()=>{if(h)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"A",gw:d}),C(n)},disabled:h,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="A"?"bg-[#1C8376] text-white border-[#1C8376]":h?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Away Win"})]})})]},s.id)})})]})}),e.jsx("div",{className:"p-6 bg-white shadow-lg",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-3",children:[_.length>0&&(()=>{const s=_.reduce((t,r)=>{if(!r.kickoff_time)return t;const o=new Date(r.kickoff_time);return!t||o<t?o:t},null);return s&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Deadline"}),e.jsx("div",{className:"text-sm font-bold text-slate-700",children:(()=>{const t=new Date(s.getTime()-45e5),r=t.toLocaleDateString(void 0,{weekday:"short"}),o=t.toLocaleDateString(void 0,{month:"short"}),i=t.toLocaleDateString(void 0,{day:"numeric"}),x=t.getUTCHours().toString().padStart(2,"0"),m=t.getUTCMinutes().toString().padStart(2,"0");return`${r}, ${o} ${i}, ${x}:${m}`})()}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"(75 minutes before first kickoff)"})]})})(),!T&&!h&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{if(h){alert("⚠️ Too late! Predictions are now closed. The deadline was 75 minutes before the first kickoff.");return}$(!0)},className:"w-full py-4 bg-slate-600 text-white rounded-2xl font-bold hover:bg-slate-700 transition-colors",children:"Save Predictions"}),e.jsx("button",{onClick:()=>{if(h){alert("⚠️ Too late! Predictions are now closed. The deadline was 75 minutes before the first kickoff.");return}_.every(t=>v.has(t.fixture_index))?I(!0):alert("Please make all predictions before confirming")},className:"w-full py-4 bg-green-600 text-white rounded-2xl font-bold hover:bg-green-700 transition-colors",children:"Confirm Predictions"})]}),h&&!T&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-lg font-bold text-red-600 mb-2",children:"⚠️ Deadline Passed"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Predictions are now closed. The deadline was 75 minutes before the first kickoff."})]}),T&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-2",children:"✅ Predictions Submitted!"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Your predictions for Gameweek ",d," have been confirmed and locked."]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Save Predictions?"}),e.jsxs("div",{className:"text-slate-600 mb-6",children:["Your predictions will be saved but you can still change them before confirming.",_.length>0&&(()=>{const s=_.reduce((t,r)=>{if(!r.kickoff_time)return t;const o=new Date(r.kickoff_time);return!t||o<t?o:t},null);return s&&e.jsxs("div",{className:"mt-3 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[e.jsx("div",{className:"text-sm font-medium text-amber-800 mb-1",children:"Deadline Reminder"}),e.jsx("div",{className:"text-xs text-amber-700",children:(()=>{const t=new Date(s.getTime()-45e5),r=t.toLocaleDateString(void 0,{weekday:"short"}),o=t.toLocaleDateString(void 0,{month:"short"}),i=t.toLocaleDateString(void 0,{day:"numeric"}),x=t.getUTCHours().toString().padStart(2,"0"),m=t.getUTCMinutes().toString().padStart(2,"0");return`${r}, ${o} ${i}, ${x}:${m}`})()}),e.jsx("div",{className:"text-xs text-amber-600 mt-1",children:"(75 minutes before first kickoff)"})]})})()]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>$(!1),className:"flex-1 py-3 bg-slate-200 text-slate-800 rounded-xl font-bold hover:bg-slate-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{const s=Array.from(v.values()).map(i=>y&&k===1?{user_id:u?.id,matchday:1,fixture_index:i.fixture_index,pick:i.pick}:{user_id:u?.id,gw:i.gw,fixture_index:i.fixture_index,pick:i.pick}),t=y&&k===1?"test_api_picks":"picks",r=y&&k===1?"user_id,matchday,fixture_index":"user_id,gw,fixture_index",{error:o}=await w.from(t).upsert(s,{onConflict:r,ignoreDuplicates:!1});if(o){console.error("Error saving picks:",o),alert("Failed to save predictions. Please try again.");return}console.log("Successfully saved picks:",s),$(!1),H("saved"),A(!0)}catch(s){console.error("Error saving picks:",s),alert("Failed to save predictions. Please try again.")}},className:"flex-1 py-3 bg-slate-600 text-white rounded-xl font-bold hover:bg-slate-700 transition-colors",children:"Save"})]})]})})}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Are You Sure?"}),e.jsx("div",{className:"text-slate-600 mb-6",children:"Once confirmed, you cannot change your predictions. Make sure you're happy with all your picks!"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"flex-1 py-3 bg-slate-200 text-slate-800 rounded-xl font-bold hover:bg-slate-300 transition-colors",children:"Go Back"}),e.jsx("button",{onClick:async()=>{try{const s=Array.from(v.values()).map(f=>y&&k===1?{user_id:u?.id,matchday:1,fixture_index:f.fixture_index,pick:f.pick}:{user_id:u?.id,gw:f.gw,fixture_index:f.fixture_index,pick:f.pick}),t=y&&k===1?"test_api_picks":"picks",r=y&&k===1?"user_id,matchday,fixture_index":"user_id,gw,fixture_index",{error:o}=await w.from(t).upsert(s,{onConflict:r,ignoreDuplicates:!1});if(o){console.error("Error confirming picks:",o),alert("Failed to confirm predictions. Please try again.");return}const i=y&&k===1?"test_api_submissions":"gw_submissions",x=y&&k===1?{user_id:u?.id,matchday:1,submitted_at:new Date().toISOString()}:{user_id:u?.id,gw:d??1,submitted_at:new Date().toISOString()},m=y&&k===1?"user_id,matchday":"user_id,gw",{error:g}=await w.from(i).upsert(x,{onConflict:m});if(g){console.error("Error recording submission:",g),alert("Failed to record submission. Please try again.");return}const{data:b}=await w.from("league_members").select("league_id").eq("user_id",u?.id);if(b&&b.length>0){const f=y&&k===1?1:d??1;b.forEach(({league_id:S})=>{fetch("/.netlify/functions/notifyFinalSubmission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:S,matchday:f,isTestApi:y&&k===1})}).catch(n=>{console.error("[NewPredictionsCentre] Failed to check final submission:",n)})})}console.log("Successfully confirmed picks:",s),q(!0),I(!1),H("confirmed"),A(!0),window.dispatchEvent(new CustomEvent("predictionsSubmitted"))}catch(s){console.error("Error confirming picks:",s),alert("Failed to confirm predictions. Please try again.")}},className:"flex-1 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors",children:"Confirm"})]})]})})}),J&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[V==="saved"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"Predictions Saved!"}),e.jsx("div",{className:"text-slate-600 mb-4",children:"Your predictions have been saved as a draft. You can still edit them until you confirm."}),e.jsxs("div",{className:"text-sm text-amber-700 bg-amber-50 rounded-lg p-3 mb-6 border border-amber-200",children:["⚠️ ",e.jsx("strong",{children:"Important:"})," Don't forget to come back and publish your predictions before the deadline to make them final!"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"Predictions Confirmed!"}),e.jsx("div",{className:"text-slate-600 mb-6",children:"Your predictions have been published and locked. Good luck!"})]}),e.jsx("button",{onClick:()=>A(!1),className:"w-full py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors",children:"Done"})]})})})]})}export{ce as default};
