import{u as re,r as u,s as x,j as e}from"./index-CpwqYQVG.js";import{a as ie}from"./teamNames-lueGeFt9.js";import{u as ae}from"./useLiveScores-BX2FS638.js";function Y(h,m){const $=h?.[`${m}_name`],p=h?.[`${m}_team`],v=h?.[`${m}_code`]||$||p||"";return ie(v)||(m==="home"?"Home":"Away")}function ce(){const{user:h}=re(),[m,$]=u.useState(null),[p,G]=u.useState([]),[v,S]=u.useState(new Map),[C,z]=u.useState(new Map),[R,P]=u.useState(!0),[U,E]=u.useState(""),[T,q]=u.useState(!1),[K,A]=u.useState(!1),[B,I]=u.useState(!1),[J,F]=u.useState(!1),[V,H]=u.useState("saved"),[w,Q]=u.useState(!1),[L,X]=u.useState(null),[W,Z]=u.useState(null),[D,ee]=u.useState(!1),O=u.useMemo(()=>p.map(s=>s.api_match_id).filter(s=>s!=null),[p]),{liveScores:te}=ae(m||void 0,O.length>0?O:void 0);return u.useEffect(()=>{console.log("isPastDeadline state changed to:",w)},[w]),u.useEffect(()=>{if(C.size>0&&v.size>0){let s=0;v.forEach(t=>{const r=C.get(t.fixture_index);r&&r===t.pick&&s++}),X(s),console.log("Calculated score:",s),(async()=>{if(m){const t=D?"app_picks":"picks",{data:r}=await x.from(t).select("user_id, fixture_index, pick").eq("gw",m);if(r){const a=new Map;r.forEach(l=>{const f=C.get(l.fixture_index),k=a.get(l.user_id)||0;f&&f===l.pick?a.set(l.user_id,k+1):a.set(l.user_id,k)});const i=Array.from(a.values()).sort((l,f)=>f-l),g=i.filter(l=>l>=s).length,b=i.length,y=Math.round(g/b*100);Z(y),console.log("Top percent:",y)}}})()}},[C,v,m]),u.useEffect(()=>{let s=!0;return(async()=>{try{let t=!1;if(h?.id)try{const{data:c,error:o}=await x.from("league_members").select("leagues(id,name)").eq("user_id",h.id);o?(console.warn("[NewPredictionsCentre] Error checking leagues (non-fatal):",o),t=!1):c&&(t=c.some(d=>d.leagues?.name==="API Test"))}catch(c){console.error("[NewPredictionsCentre] Error checking API Test membership:",c),t=!1}s&&ee(t);const{data:r,error:a}=await x.from("meta").select("current_gw").eq("id",1).maybeSingle();if(a){console.error("[NewPredictionsCentre] Error fetching current GW:",a),s&&(E(`Failed to load gameweek: ${a.message||"Unknown error"}`),P(!1));return}const i=r?.current_gw??1;let g,b=i;if(t)try{const{data:c}=await x.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();let o=c?.current_test_gw??1;if(o&&o!==1){const{data:_}=await x.from("test_api_fixtures").select("test_gw").eq("test_gw",o).limit(1).maybeSingle();if(!_){const{data:N}=await x.from("test_api_fixtures").select("test_gw").eq("test_gw",1).limit(1).maybeSingle();N&&(o=1)}}const d=await x.from("test_api_fixtures").select("id,test_gw as gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",o).order("fixture_index",{ascending:!0});if(d.error){const _=d.error?.code,N=d.error.message||"";if(_==="PGRST116"||N.includes("404")||N.includes("does not exist"))console.log("[NewPredictionsCentre] Test fixtures table not found, using regular fixtures"),g=await x.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0});else throw console.error("[NewPredictionsCentre] Error fetching test fixtures:",d.error),d.error}else d.data&&d.data.length>0?(g={data:d.data,error:null},b=1,console.log("[NewPredictionsCentre] Using test fixtures for GW 1:",d.data.length,"fixtures")):(console.log("[NewPredictionsCentre] No test fixtures found, using regular fixtures"),g=await x.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0}))}catch(c){console.error("[NewPredictionsCentre] Error fetching test fixtures, falling back to regular:",c),g=await x.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0})}else g=await x.from("fixtures").select("id,gw,fixture_index,home_name,away_name,home_team,away_team,home_code,away_code,kickoff_time").eq("gw",i).order("fixture_index",{ascending:!0});const{data:y,error:l}=g;if(l){console.error("Error fetching fixtures:",l),s&&(P(!1),E(`Failed to load fixtures: ${l.message||"Unknown error"}`));return}const f=y??[];if(s&&(G(f),$(b),console.log("Loaded",f.length,"fixtures for GW",b,t&&b===1?"(Test GW 1)":""),f.length>0&&f[0].kickoff_time)){const c=f.reduce((o,d)=>{if(!d.kickoff_time)return o;const _=new Date(d.kickoff_time);return!o||_<o?_:o},null);if(c){const o=new Date(c.getTime()-45e5),d=new Date,_=d.getTime()>o.getTime();console.log("Earliest kickoff:",c.toISOString()),console.log("Deadline time:",o.toISOString()),console.log("Current time:",d.toISOString()),console.log("Is past deadline?",_),Q(_)}}const k=t&&b===1?1:i;if(h?.id){const c=t?"app_picks":"picks",{data:o,error:d}=await x.from(c).select("gw,fixture_index,pick").eq("gw",k).eq("user_id",h.id);d&&console.error("Error fetching picks:",d);const _=new Map;o?.forEach(N=>{_.set(N.fixture_index,{fixture_index:N.fixture_index,pick:N.pick,gw:N.gw})}),s&&(S(_),console.log("Loaded",_.size,"user picks for GW",i))}if(h?.id){const c=t?"app_gw_submissions":"gw_submissions",{data:o}=await x.from(c).select("submitted_at").eq("gw",k).eq("user_id",h.id).maybeSingle();s&&(q(!!o?.submitted_at),console.log("Submission status:",o?.submitted_at?"confirmed":"not confirmed"))}const n=t&&b===1?1:i,j=t?"app_gw_results":"gw_results",{data:M,error:se}=await x.from(j).select("gw,fixture_index,result").eq("gw",n);if(!se&&M){const c=new Map;M.forEach(o=>{(o.result==="H"||o.result==="D"||o.result==="A")&&c.set(o.fixture_index,o.result)}),s&&(z(c),console.log("Loaded",c.size,"results for GW",i))}}catch(t){if(console.error("Error loading GW data:",t),s){P(!1);let r="Unknown error";t?.message?r=t.message:typeof t=="string"?r=t:t?.toString&&(r=t.toString()),(r.includes("Unexpected token")||r.includes("is not valid JSON"))&&(r="Server returned invalid response. Please check your connection and try again."),E(`Failed to load matches: ${r}`)}}finally{s&&P(!1)}})(),()=>{s=!1}},[h?.id]),U?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center max-w-md mx-auto px-4",children:[e.jsx("div",{className:"text-red-600 font-semibold text-lg mb-2",children:"Failed to Load Matches"}),e.jsx("div",{className:"text-slate-600 text-sm mb-4",children:U}),e.jsx("button",{onClick:()=>{E(""),P(!0),window.location.reload()},className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Retry"})]})}):R||!m||p.length===0?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center",children:e.jsx("div",{className:"text-slate-600",children:"Loading fixtures..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-semibold tracking-tight text-slate-900",children:"Predictions Centre"}),e.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600 w-full",children:"Call every game, lock in your results, and climb the table."})]}),m&&e.jsx("div",{className:"mt-2 mb-3",children:T?e.jsx("div",{className:"rounded-xl border bg-gradient-to-br from-[#1C8376]/5 to-blue-50/50 shadow-sm px-6 py-5",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-bold text-slate-900 text-xl mb-3",children:["Game Week ",m]}),L!==null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsxs("div",{className:"text-4xl font-extrabold text-[#1C8376]",children:[L,"/",p.length]}),W!==null&&e.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-yellow-100 to-orange-100 border border-yellow-300",children:e.jsxs("span",{className:"text-sm font-bold text-orange-700",children:["Top ",W,"%"]})})]}),e.jsx("div",{className:"mb-3 bg-slate-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#1C8376] to-blue-500 transition-all duration-500",style:{width:`${L/p.length*100}%`}})})]})]})}):e.jsx("div",{className:"rounded-xl border bg-gradient-to-r from-[#1C8376]/10 to-blue-50 border-[#1C8376]/20 px-6 py-4",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"font-semibold text-[#1C8376] text-lg",children:["Gameweek ",m]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Make your predictions below"})]})})}),e.jsx("div",{className:"space-y-4",children:p.map(s=>{const t=v.get(s.fixture_index),r=C.get(s.fixture_index),a=s.api_match_id,i=a?te.get(a):null,g=s.kickoff_time?(()=>{const n=new Date(s.kickoff_time),j=String(n.getUTCHours()).padStart(2,"0"),M=String(n.getUTCMinutes()).padStart(2,"0");return`${j}:${M}`})():"—",b=i&&(i.status==="IN_PLAY"||i.status==="PAUSED"||i.status==="FINISHED"),y=b?`${i.home_score??0}-${i.away_score??0}`:g,l=i?.status==="IN_PLAY"?i.minute?`${i.minute}'`:"LIVE":i?.status==="PAUSED"?"HT":i?.status==="FINISHED"?"FT":null,f=Y(s,"home"),k=Y(s,"away");return e.jsxs("div",{className:"rounded-2xl border bg-white p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center px-2 pt-1 pb-3",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-end",children:[e.jsx("div",{className:"truncate font-medium",children:f}),e.jsx("img",{src:`/assets/badges/${s.home_code?.toUpperCase()||"UNK"}.png`,alt:f,className:"w-5 h-5",onError:n=>{n.currentTarget.style.display="none"}})]}),e.jsx("div",{className:"text-slate-500 text-sm px-4 text-center",children:b?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"font-bold text-slate-900 text-base",children:y}),l&&e.jsx("div",{className:"text-xs text-slate-500",children:l})]}):g}),e.jsxs("div",{className:"flex items-center gap-1 flex-1 justify-start",children:[e.jsx("img",{src:`/assets/badges/${s.away_code?.toUpperCase()||"UNK"}.png`,alt:k,className:"w-5 h-5",onError:n=>{n.currentTarget.style.display="none"}}),e.jsx("div",{className:"truncate font-medium",children:k})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:T?e.jsxs(e.Fragment,{children:[(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="H"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="H"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="H"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Home Win"})})(),(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="D"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="D"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="D"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Draw"})})(),(()=>{const n=r&&t?.pick===r,j=r&&t?.pick!==r;return e.jsx("div",{className:`h-16 rounded-xl border text-sm font-medium flex items-center justify-center relative overflow-hidden ${t?.pick==="A"?n?"bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white border-yellow-300 shadow-xl shadow-gray-400/40 before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s] ring-2 ring-yellow-300/60":j&&r==="A"?"bg-red-500 text-white border-red-400":"bg-[#1C8376] text-white border-[#1C8376]":r==="A"?"bg-gray-300 text-slate-700 border-gray-400":"bg-slate-50 text-slate-400 border-slate-200"}`,children:"Away Win"})})()]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{if(w)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"H",gw:m}),S(n)},disabled:w,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="H"?"bg-[#1C8376] text-white border-[#1C8376]":w?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Home Win"}),e.jsx("button",{onClick:()=>{if(w)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"D",gw:m}),S(n)},disabled:w,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="D"?"bg-[#1C8376] text-white border-[#1C8376]":w?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Draw"}),e.jsx("button",{onClick:()=>{if(w)return;const n=new Map(v);n.set(s.fixture_index,{fixture_index:s.fixture_index,pick:"A",gw:m}),S(n)},disabled:w,className:`h-16 rounded-xl border text-sm font-medium transition-colors flex items-center justify-center ${t?.pick==="A"?"bg-[#1C8376] text-white border-[#1C8376]":w?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-slate-50 text-slate-600 border-slate-200 hover:bg-slate-100"}`,children:"Away Win"})]})})]},s.id)})})]})}),e.jsx("div",{className:"p-6 bg-white shadow-lg",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-3",children:[p.length>0&&(()=>{const s=p.reduce((t,r)=>{if(!r.kickoff_time)return t;const a=new Date(r.kickoff_time);return!t||a<t?a:t},null);return s&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 mb-1",children:"Deadline"}),e.jsx("div",{className:"text-sm font-bold text-slate-700",children:(()=>{const t=new Date(s.getTime()-45e5),r=t.toLocaleDateString(void 0,{weekday:"short"}),a=t.toLocaleDateString(void 0,{month:"short"}),i=t.toLocaleDateString(void 0,{day:"numeric"}),g=t.getUTCHours().toString().padStart(2,"0"),b=t.getUTCMinutes().toString().padStart(2,"0");return`${r}, ${a} ${i}, ${g}:${b}`})()}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"(75 minutes before first kickoff)"})]})})(),!T&&!w&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{if(w){alert("⚠️ Too late! Predictions are now closed. The deadline was 75 minutes before the first kickoff.");return}A(!0)},className:"w-full py-4 bg-slate-600 text-white rounded-2xl font-bold hover:bg-slate-700 transition-colors",children:"Save Predictions"}),e.jsx("button",{onClick:()=>{if(w){alert("⚠️ Too late! Predictions are now closed. The deadline was 75 minutes before the first kickoff.");return}p.every(t=>v.has(t.fixture_index))?I(!0):alert("Please make all predictions before confirming")},className:"w-full py-4 bg-green-600 text-white rounded-2xl font-bold hover:bg-green-700 transition-colors",children:"Confirm Predictions"})]}),w&&!T&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-lg font-bold text-red-600 mb-2",children:"⚠️ Deadline Passed"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Predictions are now closed. The deadline was 75 minutes before the first kickoff."})]}),T&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-lg font-bold text-green-600 mb-2",children:"✅ Predictions Submitted!"}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Your predictions for Gameweek ",m," have been confirmed and locked."]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Save Predictions?"}),e.jsxs("div",{className:"text-slate-600 mb-6",children:["Your predictions will be saved but you can still change them before confirming.",p.length>0&&(()=>{const s=p.reduce((t,r)=>{if(!r.kickoff_time)return t;const a=new Date(r.kickoff_time);return!t||a<t?a:t},null);return s&&e.jsxs("div",{className:"mt-3 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[e.jsx("div",{className:"text-sm font-medium text-amber-800 mb-1",children:"Deadline Reminder"}),e.jsx("div",{className:"text-xs text-amber-700",children:(()=>{const t=new Date(s.getTime()-45e5),r=t.toLocaleDateString(void 0,{weekday:"short"}),a=t.toLocaleDateString(void 0,{month:"short"}),i=t.toLocaleDateString(void 0,{day:"numeric"}),g=t.getUTCHours().toString().padStart(2,"0"),b=t.getUTCMinutes().toString().padStart(2,"0");return`${r}, ${a} ${i}, ${g}:${b}`})()}),e.jsx("div",{className:"text-xs text-amber-600 mt-1",children:"(75 minutes before first kickoff)"})]})})()]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>A(!1),className:"flex-1 py-3 bg-slate-200 text-slate-800 rounded-xl font-bold hover:bg-slate-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{const s=Array.from(v.values()).map(i=>({user_id:h?.id,gw:i.gw,fixture_index:i.fixture_index,pick:i.pick})),t=D?"app_picks":"picks",r="user_id,gw,fixture_index",{error:a}=await x.from(t).upsert(s,{onConflict:r,ignoreDuplicates:!1});if(a){console.error("Error saving picks:",a),alert("Failed to save predictions. Please try again.");return}console.log("Successfully saved picks:",s),A(!1),H("saved"),F(!0)}catch(s){console.error("Error saving picks:",s),alert("Failed to save predictions. Please try again.")}},className:"flex-1 py-3 bg-slate-600 text-white rounded-xl font-bold hover:bg-slate-700 transition-colors",children:"Save"})]})]})})}),B&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Are You Sure?"}),e.jsx("div",{className:"text-slate-600 mb-6",children:"Once confirmed, you cannot change your predictions. Make sure you're happy with all your picks!"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"flex-1 py-3 bg-slate-200 text-slate-800 rounded-xl font-bold hover:bg-slate-300 transition-colors",children:"Go Back"}),e.jsx("button",{onClick:async()=>{try{const s=Array.from(v.values()).map(f=>({user_id:h?.id,gw:f.gw,fixture_index:f.fixture_index,pick:f.pick})),t=D?"app_picks":"picks",r="user_id,gw,fixture_index",{error:a}=await x.from(t).upsert(s,{onConflict:r,ignoreDuplicates:!1});if(a){console.error("Error confirming picks:",a),alert("Failed to confirm predictions. Please try again.");return}const i=D?"app_gw_submissions":"gw_submissions",g={user_id:h?.id,gw:m??1,submitted_at:new Date().toISOString()},b="user_id,gw",{error:y}=await x.from(i).upsert(g,{onConflict:b});if(y){console.error("Error recording submission:",y),alert("Failed to record submission. Please try again.");return}const{data:l}=await x.from("league_members").select("league_id").eq("user_id",h?.id);if(l&&l.length>0){const f=m??1;l.forEach(({league_id:k})=>{fetch("/.netlify/functions/notifyFinalSubmission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:k,gw:f,isAppUser:D})}).catch(n=>{console.error("[NewPredictionsCentre] Failed to check final submission:",n)})})}console.log("Successfully confirmed picks:",s),q(!0),I(!1),H("confirmed"),F(!0),window.dispatchEvent(new CustomEvent("predictionsSubmitted"))}catch(s){console.error("Error confirming picks:",s),alert("Failed to confirm predictions. Please try again.")}},className:"flex-1 py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors",children:"Confirm"})]})]})})}),J&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full",children:e.jsxs("div",{className:"text-center",children:[V==="saved"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"Predictions Saved!"}),e.jsx("div",{className:"text-slate-600 mb-4",children:"Your predictions have been saved as a draft. You can still edit them until you confirm."}),e.jsxs("div",{className:"text-sm text-amber-700 bg-amber-50 rounded-lg p-3 mb-6 border border-amber-200",children:["⚠️ ",e.jsx("strong",{children:"Important:"})," Don't forget to come back and publish your predictions before the deadline to make them final!"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"Predictions Confirmed!"}),e.jsx("div",{className:"text-slate-600 mb-6",children:"Your predictions have been published and locked. Good luck!"})]}),e.jsx("button",{onClick:()=>F(!1),className:"w-full py-3 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors",children:"Done"})]})})})]})}export{ce as default};
