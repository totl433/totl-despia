import{s as c}from"./index-CKJVCyNd.js";const u=["soccer-ball-motion.jpg","trophy.jpg","embrace.jpg","baseball-throw.jpg","smiling-faces.jpg","infinity.jpg","abstract-leaf.jpg","soccer-ball.jpg"],f=["ML-avatar-1.png","ML-avatar-2.png","ML-avatar-3.png","ML-avatar-4.png","ML-avatar-5.png"];function g(t){let a=0;for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);a=(a<<5)-a+r,a=a&a}return Math.abs(a)}function S(t){const e=g(t)%u.length;return u[e]}function w(t){const e=g(t)%f.length;return f[e]}function v(t){return t?t.includes("supabase.co/storage/v1/object/public"):!1}function p(t){return t?f.includes(t):!1}function y(t){return t.avatar&&v(t.avatar)?t.avatar:t.avatar&&p(t.avatar)?`/assets/league-avatars/${t.avatar}`:`/assets/league-avatars/${w(t.id)}`}const h=75,A={"Prem Predictions":0,"FC Football":0,"Easy League":0,"API Test":999,"The Bird league":7,gregVjofVcarl:8,"Let Down":8};function _(t){if(t)return A[t]}async function b(t){const a=typeof t.name!="string",e=typeof t.created_at!="string",r=typeof t.start_gw>"u";if(!a&&!e&&!r)return t;const{data:n,error:s}=await c.from("leagues").select("name, start_gw, created_at").eq("id",t.id).maybeSingle();if(s&&s?.code==="42703"){const{data:i,error:o}=await c.from("leagues").select("name, created_at").eq("id",t.id).maybeSingle();if(!o&&i)return{...t,name:a?i.name:t.name,start_gw:t.start_gw,created_at:e?i.created_at:t.created_at}}return s||!n?t:{...t,name:a?n.name:t.name,start_gw:r?n.start_gw:t.start_gw,created_at:e?n.created_at:t.created_at}}async function D(t,a){if(!t?.id)return a;const e=await b(t),r=_(e.name??void 0);if(typeof r=="number")return r;if(e.start_gw!==null&&e.start_gw!==void 0)return e.start_gw;if(e.created_at&&a){const n=new Date(e.created_at),{data:s}=await c.from("gw_results").select("gw").order("gw",{ascending:!0}),i=s?[...new Set(s.map(o=>o.gw))]:[];for(const o of i){const{data:d}=await c.from("fixtures").select("kickoff_time").eq("gw",o).order("kickoff_time",{ascending:!0}).limit(1).maybeSingle();if(d?.kickoff_time){const m=new Date(d.kickoff_time),l=new Date(m.getTime()-h*60*1e3);if(n<=l)return o}}return i.length>0?Math.max(...i)+1:a}return a}function E(t,a,e){if(t?.name==="API Test")return!0;const r=_(t?.name);if(typeof r=="number")return r===999?!0:a>=r;if(t?.start_gw!==null&&t?.start_gw!==void 0)return a>=t.start_gw;if(t?.created_at&&e.has(a)){const n=new Date(t.created_at),s=e.get(a);return n<=s}return!0}export{A as L,y as a,w as b,S as g,D as r,E as s};
