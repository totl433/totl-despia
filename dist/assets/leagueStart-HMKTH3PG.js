import{s as c}from"./index-CM5W4S7F.js";const w=75,u={"Prem Predictions":0,"FC Football":0,"Easy League":0,"API Test":999,"The Bird league":7,gregVjofVcarl:8,"Let Down":8};function d(t){if(t)return u[t]}async function g(t){const e=typeof t.name!="string",r=typeof t.created_at!="string",a=typeof t.start_gw>"u";if(!e&&!r&&!a)return t;const{data:n,error:s}=await c.from("leagues").select("name, start_gw, created_at").eq("id",t.id).maybeSingle();if(s&&s?.code==="42703"){const{data:i,error:o}=await c.from("leagues").select("name, created_at").eq("id",t.id).maybeSingle();if(!o&&i)return{...t,name:e?i.name:t.name,start_gw:t.start_gw,created_at:r?i.created_at:t.created_at}}return s||!n?t:{...t,name:e?n.name:t.name,start_gw:a?n.start_gw:t.start_gw,created_at:r?n.created_at:t.created_at}}async function l(t,e){if(!t?.id)return e;const r=await g(t),a=d(r.name??void 0);if(typeof a=="number")return a;if(r.start_gw!==null&&r.start_gw!==void 0)return r.start_gw;if(r.created_at&&e){const n=new Date(r.created_at),{data:s}=await c.from("gw_results").select("gw").order("gw",{ascending:!0}),i=s?[...new Set(s.map(o=>o.gw))]:[];for(const o of i){const{data:f}=await c.from("fixtures").select("kickoff_time").eq("gw",o).order("kickoff_time",{ascending:!0}).limit(1).maybeSingle();if(f?.kickoff_time){const _=new Date(f.kickoff_time),m=new Date(_.getTime()-w*60*1e3);if(n<=m)return o}}return i.length>0?Math.max(...i)+1:e}return e}function y(t,e,r){if(t?.name==="API Test")return!0;const a=d(t?.name);if(typeof a=="number")return a===999?!0:e>=a;if(t?.start_gw!==null&&t?.start_gw!==void 0)return e>=t.start_gw;if(t?.created_at&&r.has(e)){const n=new Date(t.created_at),s=r.get(e);return n<=s}return!0}export{u as L,l as r,y as s};
