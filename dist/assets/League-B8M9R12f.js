import{r as ar,a as F,s as ce,j as e,u as Rs,b as ir,c as or,d as lr,L as Ls,g as cr,e as Ts,f as Es,h as Ms}from"./index-CGd-6n85.js";import{T as Gt}from"./TeamBadge-85O2sBwV.js";var dr=ar();function ur(p,w){return w.forEach((function(I){I&&typeof I!="string"&&!Array.isArray(I)&&Object.keys(I).forEach((function(r){if(r!=="default"&&!(r in p)){var s=Object.getOwnPropertyDescriptor(I,r);Object.defineProperty(p,r,s.get?s:{enumerable:!0,get:function(){return I[r]}})}}))})),Object.freeze(p)}function Ps(p,w){return new Promise((function(I,r){let s;return fr(p).then((function(t){try{return s=t,I(new Blob([w.slice(0,2),s,w.slice(2)],{type:"image/jpeg"}))}catch(f){return r(f)}}),r)}))}const fr=p=>new Promise(((w,I)=>{const r=new FileReader;r.addEventListener("load",(({target:{result:s}})=>{const t=new DataView(s);let f=0;if(t.getUint16(f)!==65496)return I("not a valid JPEG");for(f+=2;;){const d=t.getUint16(f);if(d===65498)break;const N=t.getUint16(f+2);if(d===65505&&t.getUint32(f+4)===1165519206){const v=f+10;let a;switch(t.getUint16(v)){case 18761:a=!0;break;case 19789:a=!1;break;default:return I("TIFF header contains invalid endian")}if(t.getUint16(v+2,a)!==42)return I("TIFF header contains invalid version");const i=t.getUint32(v+4,a),n=v+i+2+12*t.getUint16(v+i,a);for(let o=v+i+2;o<n;o+=12)if(t.getUint16(o,a)==274){if(t.getUint16(o+2,a)!==3)return I("Orientation data type is invalid");if(t.getUint32(o+4,a)!==1)return I("Orientation data count is invalid");t.setUint16(o+8,1,a);break}return w(s.slice(f,f+2+N))}f+=2+N}return w(new Blob)})),r.readAsArrayBuffer(p)}));var Jt={},mr={get exports(){return Jt},set exports(p){Jt=p}};(function(p){var w,I,r={};mr.exports=r,r.parse=function(s,t){for(var f=r.bin.readUshort,d=r.bin.readUint,N=0,v={},a=new Uint8Array(s),i=a.length-4;d(a,i)!=101010256;)i--;N=i,N+=4;var n=f(a,N+=4);f(a,N+=2);var o=d(a,N+=2),g=d(a,N+=4);N+=4,N=g;for(var C=0;C<n;C++){d(a,N),N+=4,N+=4,N+=4,d(a,N+=4),o=d(a,N+=4);var E=d(a,N+=4),j=f(a,N+=4),$=f(a,N+2),U=f(a,N+4);N+=6;var M=d(a,N+=8);N+=4,N+=j+$+U,r._readLocal(a,M,v,o,E,t)}return v},r._readLocal=function(s,t,f,d,N,v){var a=r.bin.readUshort,i=r.bin.readUint;i(s,t),a(s,t+=4),a(s,t+=2);var n=a(s,t+=2);i(s,t+=2),i(s,t+=4),t+=4;var o=a(s,t+=8),g=a(s,t+=2);t+=2;var C=r.bin.readUTF8(s,t,o);if(t+=o,t+=g,v)f[C]={size:N,csize:d};else{var E=new Uint8Array(s.buffer,t);if(n==0)f[C]=new Uint8Array(E.buffer.slice(t,t+d));else{if(n!=8)throw"unknown compression method: "+n;var j=new Uint8Array(N);r.inflateRaw(E,j),f[C]=j}}},r.inflateRaw=function(s,t){return r.F.inflate(s,t)},r.inflate=function(s,t){return s[0],s[1],r.inflateRaw(new Uint8Array(s.buffer,s.byteOffset+2,s.length-6),t)},r.deflate=function(s,t){t==null&&(t={level:6});var f=0,d=new Uint8Array(50+Math.floor(1.1*s.length));d[f]=120,d[f+1]=156,f+=2,f=r.F.deflateRaw(s,d,f,t.level);var N=r.adler(s,0,s.length);return d[f+0]=N>>>24&255,d[f+1]=N>>>16&255,d[f+2]=N>>>8&255,d[f+3]=N>>>0&255,new Uint8Array(d.buffer,0,f+4)},r.deflateRaw=function(s,t){t==null&&(t={level:6});var f=new Uint8Array(50+Math.floor(1.1*s.length)),d=r.F.deflateRaw(s,f,d,t.level);return new Uint8Array(f.buffer,0,d)},r.encode=function(s,t){t==null&&(t=!1);var f=0,d=r.bin.writeUint,N=r.bin.writeUshort,v={};for(var a in s){var i=!r._noNeed(a)&&!t,n=s[a],o=r.crc.crc(n,0,n.length);v[a]={cpr:i,usize:n.length,crc:o,file:i?r.deflateRaw(n):n}}for(var a in v)f+=v[a].file.length+30+46+2*r.bin.sizeUTF8(a);f+=22;var g=new Uint8Array(f),C=0,E=[];for(var a in v){var j=v[a];E.push(C),C=r._writeHeader(g,C,a,j,0)}var $=0,U=C;for(var a in v)j=v[a],E.push(C),C=r._writeHeader(g,C,a,j,1,E[$++]);var M=C-U;return d(g,C,101010256),C+=4,N(g,C+=4,$),N(g,C+=2,$),d(g,C+=2,M),d(g,C+=4,U),C+=4,C+=2,g.buffer},r._noNeed=function(s){var t=s.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},r._writeHeader=function(s,t,f,d,N,v){var a=r.bin.writeUint,i=r.bin.writeUshort,n=d.file;return a(s,t,N==0?67324752:33639248),t+=4,N==1&&(t+=2),i(s,t,20),i(s,t+=2,0),i(s,t+=2,d.cpr?8:0),a(s,t+=2,0),a(s,t+=4,d.crc),a(s,t+=4,n.length),a(s,t+=4,d.usize),i(s,t+=4,r.bin.sizeUTF8(f)),i(s,t+=2,0),t+=2,N==1&&(t+=2,t+=2,a(s,t+=6,v),t+=4),t+=r.bin.writeUTF8(s,t,f),N==0&&(s.set(n,t),t+=n.length),t},r.crc={table:(function(){for(var s=new Uint32Array(256),t=0;t<256;t++){for(var f=t,d=0;d<8;d++)1&f?f=3988292384^f>>>1:f>>>=1;s[t]=f}return s})(),update:function(s,t,f,d){for(var N=0;N<d;N++)s=r.crc.table[255&(s^t[f+N])]^s>>>8;return s},crc:function(s,t,f){return 4294967295^r.crc.update(4294967295,s,t,f)}},r.adler=function(s,t,f){for(var d=1,N=0,v=t,a=t+f;v<a;){for(var i=Math.min(v+5552,a);v<i;)N+=d+=s[v++];d%=65521,N%=65521}return N<<16|d},r.bin={readUshort:function(s,t){return s[t]|s[t+1]<<8},writeUshort:function(s,t,f){s[t]=255&f,s[t+1]=f>>8&255},readUint:function(s,t){return 16777216*s[t+3]+(s[t+2]<<16|s[t+1]<<8|s[t])},writeUint:function(s,t,f){s[t]=255&f,s[t+1]=f>>8&255,s[t+2]=f>>16&255,s[t+3]=f>>24&255},readASCII:function(s,t,f){for(var d="",N=0;N<f;N++)d+=String.fromCharCode(s[t+N]);return d},writeASCII:function(s,t,f){for(var d=0;d<f.length;d++)s[t+d]=f.charCodeAt(d)},pad:function(s){return s.length<2?"0"+s:s},readUTF8:function(s,t,f){for(var d,N="",v=0;v<f;v++)N+="%"+r.bin.pad(s[t+v].toString(16));try{d=decodeURIComponent(N)}catch{return r.bin.readASCII(s,t,f)}return d},writeUTF8:function(s,t,f){for(var d=f.length,N=0,v=0;v<d;v++){var a=f.charCodeAt(v);if((4294967168&a)==0)s[t+N]=a,N++;else if((4294965248&a)==0)s[t+N]=192|a>>6,s[t+N+1]=128|a>>0&63,N+=2;else if((4294901760&a)==0)s[t+N]=224|a>>12,s[t+N+1]=128|a>>6&63,s[t+N+2]=128|a>>0&63,N+=3;else{if((4292870144&a)!=0)throw"e";s[t+N]=240|a>>18,s[t+N+1]=128|a>>12&63,s[t+N+2]=128|a>>6&63,s[t+N+3]=128|a>>0&63,N+=4}}return N},sizeUTF8:function(s){for(var t=s.length,f=0,d=0;d<t;d++){var N=s.charCodeAt(d);if((4294967168&N)==0)f++;else if((4294965248&N)==0)f+=2;else if((4294901760&N)==0)f+=3;else{if((4292870144&N)!=0)throw"e";f+=4}}return f}},r.F={},r.F.deflateRaw=function(s,t,f,d){var N=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][d],v=r.F.U,a=r.F._goodIndex;r.F._hash;var i=r.F._putsE,n=0,o=f<<3,g=0,C=s.length;if(d==0){for(;n<C;)i(t,o,n+(S=Math.min(65535,C-n))==C?1:0),o=r.F._copyExact(s,n,S,t,o+8),n+=S;return o>>>3}var E=v.lits,j=v.strt,$=v.prev,U=0,M=0,P=0,h=0,L=0,l=0;for(C>2&&(j[l=r.F._hash(s,0)]=0),n=0;n<C;n++){if(L=l,n+1<C-2){l=r.F._hash(s,n+1);var c=n+1&32767;$[c]=j[l],j[l]=c}if(g<=n){(U>14e3||M>26697)&&C-n>100&&(g<n&&(E[U]=n-g,U+=2,g=n),o=r.F._writeBlock(n==C-1||g==C?1:0,E,U,h,s,P,n-P,t,o),U=M=h=0,P=n);var y=0;n<C-2&&(y=r.F._bestMatch(s,n,$,L,Math.min(N[2],C-n),N[3]));var S=y>>>16,x=65535&y;if(y!=0){x=65535&y;var _=a(S=y>>>16,v.of0);v.lhst[257+_]++;var b=a(x,v.df0);v.dhst[b]++,h+=v.exb[_]+v.dxb[b],E[U]=S<<23|n-g,E[U+1]=x<<16|_<<8|b,U+=2,g=n+S}else v.lhst[s[n]]++;M++}}for(P==n&&s.length!=0||(g<n&&(E[U]=n-g,U+=2,g=n),o=r.F._writeBlock(1,E,U,h,s,P,n-P,t,o),U=0,M=0,U=M=h=0,P=n);(7&o)!=0;)o++;return o>>>3},r.F._bestMatch=function(s,t,f,d,N,v){var a=32767&t,i=f[a],n=a-i+32768&32767;if(i==a||d!=r.F._hash(s,t-n))return 0;for(var o=0,g=0,C=Math.min(32767,t);n<=C&&--v!=0&&i!=a;){if(o==0||s[t+o]==s[t+o-n]){var E=r.F._howLong(s,t,n);if(E>o){if(g=n,(o=E)>=N)break;n+2<E&&(E=n+2);for(var j=0,$=0;$<E-2;$++){var U=t-n+$+32768&32767,M=U-f[U]+32768&32767;M>j&&(j=M,i=U)}}}n+=(a=i)-(i=f[a])+32768&32767}return o<<16|g},r.F._howLong=function(s,t,f){if(s[t]!=s[t-f]||s[t+1]!=s[t+1-f]||s[t+2]!=s[t+2-f])return 0;var d=t,N=Math.min(s.length,t+258);for(t+=3;t<N&&s[t]==s[t-f];)t++;return t-d},r.F._hash=function(s,t){return(s[t]<<8|s[t+1])+(s[t+2]<<4)&65535},r.saved=0,r.F._writeBlock=function(s,t,f,d,N,v,a,i,n){var o,g,C,E,j,$,U,M,P,h=r.F.U,L=r.F._putsF,l=r.F._putsE;h.lhst[256]++,g=(o=r.F.getTrees())[0],C=o[1],E=o[2],j=o[3],$=o[4],U=o[5],M=o[6],P=o[7];var c=32+((n+3&7)==0?0:8-(n+3&7))+(a<<3),y=d+r.F.contSize(h.fltree,h.lhst)+r.F.contSize(h.fdtree,h.dhst),S=d+r.F.contSize(h.ltree,h.lhst)+r.F.contSize(h.dtree,h.dhst);S+=14+3*U+r.F.contSize(h.itree,h.ihst)+(2*h.ihst[16]+3*h.ihst[17]+7*h.ihst[18]);for(var x=0;x<286;x++)h.lhst[x]=0;for(x=0;x<30;x++)h.dhst[x]=0;for(x=0;x<19;x++)h.ihst[x]=0;var _=c<y&&c<S?0:y<S?1:2;if(L(i,n,s),L(i,n+1,_),n+=3,_==0){for(;(7&n)!=0;)n++;n=r.F._copyExact(N,v,a,i,n)}else{var b,A;if(_==1&&(b=h.fltree,A=h.fdtree),_==2){r.F.makeCodes(h.ltree,g),r.F.revCodes(h.ltree,g),r.F.makeCodes(h.dtree,C),r.F.revCodes(h.dtree,C),r.F.makeCodes(h.itree,E),r.F.revCodes(h.itree,E),b=h.ltree,A=h.dtree,l(i,n,j-257),l(i,n+=5,$-1),l(i,n+=5,U-4),n+=4;for(var m=0;m<U;m++)l(i,n+3*m,h.itree[1+(h.ordr[m]<<1)]);n+=3*U,n=r.F._codeTiny(M,h.itree,i,n),n=r.F._codeTiny(P,h.itree,i,n)}for(var u=v,D=0;D<f;D+=2){for(var T=t[D],H=T>>>23,re=u+(8388607&T);u<re;)n=r.F._writeLit(N[u++],b,i,n);if(H!=0){var K=t[D+1],X=K>>16,W=K>>8&255,R=255&K;l(i,n=r.F._writeLit(257+W,b,i,n),H-h.of0[W]),n+=h.exb[W],L(i,n=r.F._writeLit(R,A,i,n),X-h.df0[R]),n+=h.dxb[R],u+=H}}n=r.F._writeLit(256,b,i,n)}return n},r.F._copyExact=function(s,t,f,d,N){var v=N>>>3;return d[v]=f,d[v+1]=f>>>8,d[v+2]=255-d[v],d[v+3]=255-d[v+1],v+=4,d.set(new Uint8Array(s.buffer,t,f),v),N+(f+4<<3)},r.F.getTrees=function(){for(var s=r.F.U,t=r.F._hufTree(s.lhst,s.ltree,15),f=r.F._hufTree(s.dhst,s.dtree,15),d=[],N=r.F._lenCodes(s.ltree,d),v=[],a=r.F._lenCodes(s.dtree,v),i=0;i<d.length;i+=2)s.ihst[d[i]]++;for(i=0;i<v.length;i+=2)s.ihst[v[i]]++;for(var n=r.F._hufTree(s.ihst,s.itree,7),o=19;o>4&&s.itree[1+(s.ordr[o-1]<<1)]==0;)o--;return[t,f,n,N,a,o,d,v]},r.F.getSecond=function(s){for(var t=[],f=0;f<s.length;f+=2)t.push(s[f+1]);return t},r.F.nonZero=function(s){for(var t="",f=0;f<s.length;f+=2)s[f+1]!=0&&(t+=(f>>1)+",");return t},r.F.contSize=function(s,t){for(var f=0,d=0;d<t.length;d++)f+=t[d]*s[1+(d<<1)];return f},r.F._codeTiny=function(s,t,f,d){for(var N=0;N<s.length;N+=2){var v=s[N],a=s[N+1];d=r.F._writeLit(v,t,f,d);var i=v==16?2:v==17?3:7;v>15&&(r.F._putsE(f,d,a,i),d+=i)}return d},r.F._lenCodes=function(s,t){for(var f=s.length;f!=2&&s[f-1]==0;)f-=2;for(var d=0;d<f;d+=2){var N=s[d+1],v=d+3<f?s[d+3]:-1,a=d+5<f?s[d+5]:-1,i=d==0?-1:s[d-1];if(N==0&&v==N&&a==N){for(var n=d+5;n+2<f&&s[n+2]==N;)n+=2;(o=Math.min(n+1-d>>>1,138))<11?t.push(17,o-3):t.push(18,o-11),d+=2*o-2}else if(N==i&&v==N&&a==N){for(n=d+5;n+2<f&&s[n+2]==N;)n+=2;var o=Math.min(n+1-d>>>1,6);t.push(16,o-3),d+=2*o-2}else t.push(N,0)}return f>>>1},r.F._hufTree=function(s,t,f){var d=[],N=s.length,v=t.length,a=0;for(a=0;a<v;a+=2)t[a]=0,t[a+1]=0;for(a=0;a<N;a++)s[a]!=0&&d.push({lit:a,f:s[a]});var i=d.length,n=d.slice(0);if(i==0)return 0;if(i==1){var o=d[0].lit;return n=o==0?1:0,t[1+(o<<1)]=1,t[1+(n<<1)]=1,1}d.sort((function(M,P){return M.f-P.f}));var g=d[0],C=d[1],E=0,j=1,$=2;for(d[0]={lit:-1,f:g.f+C.f,l:g,r:C,d:0};j!=i-1;)g=E!=j&&($==i||d[E].f<d[$].f)?d[E++]:d[$++],C=E!=j&&($==i||d[E].f<d[$].f)?d[E++]:d[$++],d[j++]={lit:-1,f:g.f+C.f,l:g,r:C};var U=r.F.setDepth(d[j-1],0);for(U>f&&(r.F.restrictDepth(n,f,U),U=f),a=0;a<i;a++)t[1+(n[a].lit<<1)]=n[a].d;return U},r.F.setDepth=function(s,t){return s.lit!=-1?(s.d=t,t):Math.max(r.F.setDepth(s.l,t+1),r.F.setDepth(s.r,t+1))},r.F.restrictDepth=function(s,t,f){var d=0,N=1<<f-t,v=0;for(s.sort((function(i,n){return n.d==i.d?i.f-n.f:n.d-i.d})),d=0;d<s.length&&s[d].d>t;d++){var a=s[d].d;s[d].d=t,v+=N-(1<<f-a)}for(v>>>=f-t;v>0;)(a=s[d].d)<t?(s[d].d++,v-=1<<t-a-1):d++;for(;d>=0;d--)s[d].d==t&&v<0&&(s[d].d--,v++);v!=0&&console.log("debt left")},r.F._goodIndex=function(s,t){var f=0;return t[16|f]<=s&&(f|=16),t[8|f]<=s&&(f|=8),t[4|f]<=s&&(f|=4),t[2|f]<=s&&(f|=2),t[1|f]<=s&&(f|=1),f},r.F._writeLit=function(s,t,f,d){return r.F._putsF(f,d,t[s<<1]),d+t[1+(s<<1)]},r.F.inflate=function(s,t){var f=Uint8Array;if(s[0]==3&&s[1]==0)return t||new f(0);var d=r.F,N=d._bitsF,v=d._bitsE,a=d._decodeTiny,i=d.makeCodes,n=d.codes2map,o=d._get17,g=d.U,C=t==null;C&&(t=new f(s.length>>>2<<3));for(var E,j,$=0,U=0,M=0,P=0,h=0,L=0,l=0,c=0,y=0;$==0;)if($=N(s,y,1),U=N(s,y+1,2),y+=3,U!=0){if(C&&(t=r.F._check(t,c+(1<<17))),U==1&&(E=g.flmap,j=g.fdmap,L=511,l=31),U==2){M=v(s,y,5)+257,P=v(s,y+5,5)+1,h=v(s,y+10,4)+4,y+=14;for(var S=0;S<38;S+=2)g.itree[S]=0,g.itree[S+1]=0;var x=1;for(S=0;S<h;S++){var _=v(s,y+3*S,3);g.itree[1+(g.ordr[S]<<1)]=_,_>x&&(x=_)}y+=3*h,i(g.itree,x),n(g.itree,x,g.imap),E=g.lmap,j=g.dmap,y=a(g.imap,(1<<x)-1,M+P,s,y,g.ttree);var b=d._copyOut(g.ttree,0,M,g.ltree);L=(1<<b)-1;var A=d._copyOut(g.ttree,M,P,g.dtree);l=(1<<A)-1,i(g.ltree,b),n(g.ltree,b,E),i(g.dtree,A),n(g.dtree,A,j)}for(;;){var m=E[o(s,y)&L];y+=15&m;var u=m>>>4;if(!(u>>>8))t[c++]=u;else{if(u==256)break;var D=c+u-254;if(u>264){var T=g.ldef[u-257];D=c+(T>>>3)+v(s,y,7&T),y+=7&T}var H=j[o(s,y)&l];y+=15&H;var re=H>>>4,K=g.ddef[re],X=(K>>>4)+N(s,y,15&K);for(y+=15&K,C&&(t=r.F._check(t,c+(1<<17)));c<D;)t[c]=t[c++-X],t[c]=t[c++-X],t[c]=t[c++-X],t[c]=t[c++-X];c=D}}}else{(7&y)!=0&&(y+=8-(7&y));var W=4+(y>>>3),R=s[W-4]|s[W-3]<<8;C&&(t=r.F._check(t,c+R)),t.set(new f(s.buffer,s.byteOffset+W,R),c),y=W+R<<3,c+=R}return t.length==c?t:t.slice(0,c)},r.F._check=function(s,t){var f=s.length;if(t<=f)return s;var d=new Uint8Array(Math.max(f<<1,t));return d.set(s,0),d},r.F._decodeTiny=function(s,t,f,d,N,v){for(var a=r.F._bitsE,i=r.F._get17,n=0;n<f;){var o=s[i(d,N)&t];N+=15&o;var g=o>>>4;if(g<=15)v[n]=g,n++;else{var C=0,E=0;g==16?(E=3+a(d,N,2),N+=2,C=v[n-1]):g==17?(E=3+a(d,N,3),N+=3):g==18&&(E=11+a(d,N,7),N+=7);for(var j=n+E;n<j;)v[n]=C,n++}}return N},r.F._copyOut=function(s,t,f,d){for(var N=0,v=0,a=d.length>>>1;v<f;){var i=s[v+t];d[v<<1]=0,d[1+(v<<1)]=i,i>N&&(N=i),v++}for(;v<a;)d[v<<1]=0,d[1+(v<<1)]=0,v++;return N},r.F.makeCodes=function(s,t){for(var f,d,N,v,a=r.F.U,i=s.length,n=a.bl_count,o=0;o<=t;o++)n[o]=0;for(o=1;o<i;o+=2)n[s[o]]++;var g=a.next_code;for(f=0,n[0]=0,d=1;d<=t;d++)f=f+n[d-1]<<1,g[d]=f;for(N=0;N<i;N+=2)(v=s[N+1])!=0&&(s[N]=g[v],g[v]++)},r.F.codes2map=function(s,t,f){for(var d=s.length,N=r.F.U.rev15,v=0;v<d;v+=2)if(s[v+1]!=0)for(var a=v>>1,i=s[v+1],n=a<<4|i,o=t-i,g=s[v]<<o,C=g+(1<<o);g!=C;)f[N[g]>>>15-t]=n,g++},r.F.revCodes=function(s,t){for(var f=r.F.U.rev15,d=15-t,N=0;N<s.length;N+=2){var v=s[N]<<t-s[N+1];s[N]=f[v]>>>d}},r.F._putsE=function(s,t,f){f<<=7&t;var d=t>>>3;s[d]|=f,s[d+1]|=f>>>8},r.F._putsF=function(s,t,f){f<<=7&t;var d=t>>>3;s[d]|=f,s[d+1]|=f>>>8,s[d+2]|=f>>>16},r.F._bitsE=function(s,t,f){return(s[t>>>3]|s[1+(t>>>3)]<<8)>>>(7&t)&(1<<f)-1},r.F._bitsF=function(s,t,f){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16)>>>(7&t)&(1<<f)-1},r.F._get17=function(s,t){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16)>>>(7&t)},r.F._get25=function(s,t){return(s[t>>>3]|s[1+(t>>>3)]<<8|s[2+(t>>>3)]<<16|s[3+(t>>>3)]<<24)>>>(7&t)},r.F.U=(w=Uint16Array,I=Uint32Array,{next_code:new w(16),bl_count:new w(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new w(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new I(32),flmap:new w(512),fltree:[],fdmap:new w(32),fdtree:[],lmap:new w(32768),ltree:[],ttree:[],dmap:new w(32768),dtree:[],imap:new w(512),itree:[],rev15:new w(32768),lhst:new I(286),dhst:new I(30),ihst:new I(19),lits:new I(15e3),strt:new w(65536),prev:new w(32768)}),(function(){for(var s=r.F.U,t=0;t<32768;t++){var f=t;f=(4278255360&(f=(4042322160&(f=(3435973836&(f=(2863311530&f)>>>1|(1431655765&f)<<1))>>>2|(858993459&f)<<2))>>>4|(252645135&f)<<4))>>>8|(16711935&f)<<8,s.rev15[t]=(f>>>16|f<<16)>>>17}function d(N,v,a){for(;v--!=0;)N.push(0,a)}for(t=0;t<32;t++)s.ldef[t]=s.of0[t]<<3|s.exb[t],s.ddef[t]=s.df0[t]<<4|s.dxb[t];d(s.fltree,144,8),d(s.fltree,112,9),d(s.fltree,24,7),d(s.fltree,8,8),r.F.makeCodes(s.fltree,9),r.F.codes2map(s.fltree,9,s.flmap),r.F.revCodes(s.fltree,9),d(s.fdtree,32,5),r.F.makeCodes(s.fdtree,5),r.F.codes2map(s.fdtree,5,s.fdmap),r.F.revCodes(s.fdtree,5),d(s.itree,19,0),d(s.ltree,286,0),d(s.dtree,30,0),d(s.ttree,320,0)})()})();var hr=ur({__proto__:null,default:Jt},[Jt]);const lt=(function(){var p={nextZero(a,i){for(;a[i]!=0;)i++;return i},readUshort:(a,i)=>a[i]<<8|a[i+1],writeUshort(a,i,n){a[i]=n>>8&255,a[i+1]=255&n},readUint:(a,i)=>16777216*a[i]+(a[i+1]<<16|a[i+2]<<8|a[i+3]),writeUint(a,i,n){a[i]=n>>24&255,a[i+1]=n>>16&255,a[i+2]=n>>8&255,a[i+3]=255&n},readASCII(a,i,n){let o="";for(let g=0;g<n;g++)o+=String.fromCharCode(a[i+g]);return o},writeASCII(a,i,n){for(let o=0;o<n.length;o++)a[i+o]=n.charCodeAt(o)},readBytes(a,i,n){const o=[];for(let g=0;g<n;g++)o.push(a[i+g]);return o},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,i,n){let o,g="";for(let C=0;C<n;C++)g+=`%${p.pad(a[i+C].toString(16))}`;try{o=decodeURIComponent(g)}catch{return p.readASCII(a,i,n)}return o}};function w(a,i,n,o){const g=i*n,C=t(o),E=Math.ceil(i*C/8),j=new Uint8Array(4*g),$=new Uint32Array(j.buffer),{ctype:U}=o,{depth:M}=o,P=p.readUshort;if(U==6){const T=g<<2;if(M==8)for(var h=0;h<T;h+=4)j[h]=a[h],j[h+1]=a[h+1],j[h+2]=a[h+2],j[h+3]=a[h+3];if(M==16)for(h=0;h<T;h++)j[h]=a[h<<1]}else if(U==2){const T=o.tabs.tRNS;if(T==null){if(M==8)for(h=0;h<g;h++){var L=3*h;$[h]=255<<24|a[L+2]<<16|a[L+1]<<8|a[L]}if(M==16)for(h=0;h<g;h++)L=6*h,$[h]=255<<24|a[L+4]<<16|a[L+2]<<8|a[L]}else{var l=T[0];const H=T[1],re=T[2];if(M==8)for(h=0;h<g;h++){var c=h<<2;L=3*h,$[h]=255<<24|a[L+2]<<16|a[L+1]<<8|a[L],a[L]==l&&a[L+1]==H&&a[L+2]==re&&(j[c+3]=0)}if(M==16)for(h=0;h<g;h++)c=h<<2,L=6*h,$[h]=255<<24|a[L+4]<<16|a[L+2]<<8|a[L],P(a,L)==l&&P(a,L+2)==H&&P(a,L+4)==re&&(j[c+3]=0)}}else if(U==3){const T=o.tabs.PLTE,H=o.tabs.tRNS,re=H?H.length:0;if(M==1)for(var y=0;y<n;y++){var S=y*E,x=y*i;for(h=0;h<i;h++){c=x+h<<2;var _=3*(b=a[S+(h>>3)]>>7-((7&h)<<0)&1);j[c]=T[_],j[c+1]=T[_+1],j[c+2]=T[_+2],j[c+3]=b<re?H[b]:255}}if(M==2)for(y=0;y<n;y++)for(S=y*E,x=y*i,h=0;h<i;h++)c=x+h<<2,_=3*(b=a[S+(h>>2)]>>6-((3&h)<<1)&3),j[c]=T[_],j[c+1]=T[_+1],j[c+2]=T[_+2],j[c+3]=b<re?H[b]:255;if(M==4)for(y=0;y<n;y++)for(S=y*E,x=y*i,h=0;h<i;h++)c=x+h<<2,_=3*(b=a[S+(h>>1)]>>4-((1&h)<<2)&15),j[c]=T[_],j[c+1]=T[_+1],j[c+2]=T[_+2],j[c+3]=b<re?H[b]:255;if(M==8)for(h=0;h<g;h++){var b;c=h<<2,_=3*(b=a[h]),j[c]=T[_],j[c+1]=T[_+1],j[c+2]=T[_+2],j[c+3]=b<re?H[b]:255}}else if(U==4){if(M==8)for(h=0;h<g;h++){c=h<<2;var A=a[m=h<<1];j[c]=A,j[c+1]=A,j[c+2]=A,j[c+3]=a[m+1]}if(M==16)for(h=0;h<g;h++){var m;c=h<<2,A=a[m=h<<2],j[c]=A,j[c+1]=A,j[c+2]=A,j[c+3]=a[m+2]}}else if(U==0)for(l=o.tabs.tRNS?o.tabs.tRNS:-1,y=0;y<n;y++){const T=y*E,H=y*i;if(M==1)for(var u=0;u<i;u++){var D=(A=255*(a[T+(u>>>3)]>>>7-(7&u)&1))==255*l?0:255;$[H+u]=D<<24|A<<16|A<<8|A}else if(M==2)for(u=0;u<i;u++)D=(A=85*(a[T+(u>>>2)]>>>6-((3&u)<<1)&3))==85*l?0:255,$[H+u]=D<<24|A<<16|A<<8|A;else if(M==4)for(u=0;u<i;u++)D=(A=17*(a[T+(u>>>1)]>>>4-((1&u)<<2)&15))==17*l?0:255,$[H+u]=D<<24|A<<16|A<<8|A;else if(M==8)for(u=0;u<i;u++)D=(A=a[T+u])==l?0:255,$[H+u]=D<<24|A<<16|A<<8|A;else if(M==16)for(u=0;u<i;u++)A=a[T+(u<<1)],D=P(a,T+(u<<1))==l?0:255,$[H+u]=D<<24|A<<16|A<<8|A}return j}function I(a,i,n,o){const g=t(a),C=Math.ceil(n*g/8),E=new Uint8Array((C+1+a.interlace)*o);return i=a.tabs.CgBI?s(i,E):r(i,E),a.interlace==0?i=f(i,a,0,n,o):a.interlace==1&&(i=(function($,U){const M=U.width,P=U.height,h=t(U),L=h>>3,l=Math.ceil(M*h/8),c=new Uint8Array(P*l);let y=0;const S=[0,0,4,0,2,0,1],x=[0,4,0,2,0,1,0],_=[8,8,8,4,4,2,2],b=[8,8,4,4,2,2,1];let A=0;for(;A<7;){const u=_[A],D=b[A];let T=0,H=0,re=S[A];for(;re<P;)re+=u,H++;let K=x[A];for(;K<M;)K+=D,T++;const X=Math.ceil(T*h/8);f($,U,y,T,H);let W=0,R=S[A];for(;R<P;){let le=x[A],Ne=y+W*X<<3;for(;le<M;){var m;if(h==1&&(m=(m=$[Ne>>3])>>7-(7&Ne)&1,c[R*l+(le>>3)]|=m<<7-((7&le)<<0)),h==2&&(m=(m=$[Ne>>3])>>6-(7&Ne)&3,c[R*l+(le>>2)]|=m<<6-((3&le)<<1)),h==4&&(m=(m=$[Ne>>3])>>4-(7&Ne)&15,c[R*l+(le>>1)]|=m<<4-((1&le)<<2)),h>=8){const we=R*l+le*L;for(let be=0;be<L;be++)c[we+be]=$[(Ne>>3)+be]}Ne+=h,le+=D}W++,R+=u}T*H!=0&&(y+=H*(1+X)),A+=1}return c})(i,a)),i}function r(a,i){return s(new Uint8Array(a.buffer,2,a.length-6),i)}var s=(function(){const a={H:{}};return a.H.N=function(i,n){const o=Uint8Array;let g,C,E=0,j=0,$=0,U=0,M=0,P=0,h=0,L=0,l=0;if(i[0]==3&&i[1]==0)return n||new o(0);const c=a.H,y=c.b,S=c.e,x=c.R,_=c.n,b=c.A,A=c.Z,m=c.m,u=n==null;for(u&&(n=new o(i.length>>>2<<5));E==0;)if(E=y(i,l,1),j=y(i,l+1,2),l+=3,j!=0){if(u&&(n=a.H.W(n,L+(1<<17))),j==1&&(g=m.J,C=m.h,P=511,h=31),j==2){$=S(i,l,5)+257,U=S(i,l+5,5)+1,M=S(i,l+10,4)+4,l+=14;let T=1;for(var D=0;D<38;D+=2)m.Q[D]=0,m.Q[D+1]=0;for(D=0;D<M;D++){const K=S(i,l+3*D,3);m.Q[1+(m.X[D]<<1)]=K,K>T&&(T=K)}l+=3*M,_(m.Q,T),b(m.Q,T,m.u),g=m.w,C=m.d,l=x(m.u,(1<<T)-1,$+U,i,l,m.v);const H=c.V(m.v,0,$,m.C);P=(1<<H)-1;const re=c.V(m.v,$,U,m.D);h=(1<<re)-1,_(m.C,H),b(m.C,H,g),_(m.D,re),b(m.D,re,C)}for(;;){const T=g[A(i,l)&P];l+=15&T;const H=T>>>4;if(!(H>>>8))n[L++]=H;else{if(H==256)break;{let re=L+H-254;if(H>264){const le=m.q[H-257];re=L+(le>>>3)+S(i,l,7&le),l+=7&le}const K=C[A(i,l)&h];l+=15&K;const X=K>>>4,W=m.c[X],R=(W>>>4)+y(i,l,15&W);for(l+=15&W;L<re;)n[L]=n[L++-R],n[L]=n[L++-R],n[L]=n[L++-R],n[L]=n[L++-R];L=re}}}}else{(7&l)!=0&&(l+=8-(7&l));const T=4+(l>>>3),H=i[T-4]|i[T-3]<<8;u&&(n=a.H.W(n,L+H)),n.set(new o(i.buffer,i.byteOffset+T,H),L),l=T+H<<3,L+=H}return n.length==L?n:n.slice(0,L)},a.H.W=function(i,n){const o=i.length;if(n<=o)return i;const g=new Uint8Array(o<<1);return g.set(i,0),g},a.H.R=function(i,n,o,g,C,E){const j=a.H.e,$=a.H.Z;let U=0;for(;U<o;){const M=i[$(g,C)&n];C+=15&M;const P=M>>>4;if(P<=15)E[U]=P,U++;else{let h=0,L=0;P==16?(L=3+j(g,C,2),C+=2,h=E[U-1]):P==17?(L=3+j(g,C,3),C+=3):P==18&&(L=11+j(g,C,7),C+=7);const l=U+L;for(;U<l;)E[U]=h,U++}}return C},a.H.V=function(i,n,o,g){let C=0,E=0;const j=g.length>>>1;for(;E<o;){const $=i[E+n];g[E<<1]=0,g[1+(E<<1)]=$,$>C&&(C=$),E++}for(;E<j;)g[E<<1]=0,g[1+(E<<1)]=0,E++;return C},a.H.n=function(i,n){const o=a.H.m,g=i.length;let C,E,j,$;const U=o.j;for(var M=0;M<=n;M++)U[M]=0;for(M=1;M<g;M+=2)U[i[M]]++;const P=o.K;for(C=0,U[0]=0,E=1;E<=n;E++)C=C+U[E-1]<<1,P[E]=C;for(j=0;j<g;j+=2)$=i[j+1],$!=0&&(i[j]=P[$],P[$]++)},a.H.A=function(i,n,o){const g=i.length,C=a.H.m.r;for(let E=0;E<g;E+=2)if(i[E+1]!=0){const j=E>>1,$=i[E+1],U=j<<4|$,M=n-$;let P=i[E]<<M;const h=P+(1<<M);for(;P!=h;)o[C[P]>>>15-n]=U,P++}},a.H.l=function(i,n){const o=a.H.m.r,g=15-n;for(let C=0;C<i.length;C+=2){const E=i[C]<<n-i[C+1];i[C]=o[E]>>>g}},a.H.M=function(i,n,o){o<<=7&n;const g=n>>>3;i[g]|=o,i[g+1]|=o>>>8},a.H.I=function(i,n,o){o<<=7&n;const g=n>>>3;i[g]|=o,i[g+1]|=o>>>8,i[g+2]|=o>>>16},a.H.e=function(i,n,o){return(i[n>>>3]|i[1+(n>>>3)]<<8)>>>(7&n)&(1<<o)-1},a.H.b=function(i,n,o){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)&(1<<o)-1},a.H.Z=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16)>>>(7&n)},a.H.i=function(i,n){return(i[n>>>3]|i[1+(n>>>3)]<<8|i[2+(n>>>3)]<<16|i[3+(n>>>3)]<<24)>>>(7&n)},a.H.m=(function(){const i=Uint16Array,n=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new n(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new n(286),Y:new n(30),a:new n(19),t:new n(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=a.H.m;for(var n=0;n<32768;n++){let g=n;g=(2863311530&g)>>>1|(1431655765&g)<<1,g=(3435973836&g)>>>2|(858993459&g)<<2,g=(4042322160&g)>>>4|(252645135&g)<<4,g=(4278255360&g)>>>8|(16711935&g)<<8,i.r[n]=(g>>>16|g<<16)>>>17}function o(g,C,E){for(;C--!=0;)g.push(0,E)}for(n=0;n<32;n++)i.q[n]=i.S[n]<<3|i.T[n],i.c[n]=i.p[n]<<4|i.z[n];o(i._,144,8),o(i._,112,9),o(i._,24,7),o(i._,8,8),a.H.n(i._,9),a.H.A(i._,9,i.J),a.H.l(i._,9),o(i.$,32,5),a.H.n(i.$,5),a.H.A(i.$,5,i.h),a.H.l(i.$,5),o(i.Q,19,0),o(i.C,286,0),o(i.D,30,0),o(i.v,320,0)})(),a.H.N})();function t(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function f(a,i,n,o,g){let C=t(i);const E=Math.ceil(o*C/8);let j,$;C=Math.ceil(C/8);let U=a[n],M=0;if(U>1&&(a[n]=[0,0,1][U-2]),U==3)for(M=C;M<E;M++)a[M+1]=a[M+1]+(a[M+1-C]>>>1)&255;for(let P=0;P<g;P++)if(j=n+P*E,$=j+P+1,U=a[$-1],M=0,U==0)for(;M<E;M++)a[j+M]=a[$+M];else if(U==1){for(;M<C;M++)a[j+M]=a[$+M];for(;M<E;M++)a[j+M]=a[$+M]+a[j+M-C]}else if(U==2)for(;M<E;M++)a[j+M]=a[$+M]+a[j+M-E];else if(U==3){for(;M<C;M++)a[j+M]=a[$+M]+(a[j+M-E]>>>1);for(;M<E;M++)a[j+M]=a[$+M]+(a[j+M-E]+a[j+M-C]>>>1)}else{for(;M<C;M++)a[j+M]=a[$+M]+d(0,a[j+M-E],0);for(;M<E;M++)a[j+M]=a[$+M]+d(a[j+M-C],a[j+M-E],a[j+M-C-E])}return a}function d(a,i,n){const o=a+i-n,g=o-a,C=o-i,E=o-n;return g*g<=C*C&&g*g<=E*E?a:C*C<=E*E?i:n}function N(a,i,n){n.width=p.readUint(a,i),i+=4,n.height=p.readUint(a,i),i+=4,n.depth=a[i],i++,n.ctype=a[i],i++,n.compress=a[i],i++,n.filter=a[i],i++,n.interlace=a[i],i++}function v(a,i,n,o,g,C,E,j,$){const U=Math.min(i,g),M=Math.min(n,C);let P=0,h=0;for(let A=0;A<M;A++)for(let m=0;m<U;m++)if(E>=0&&j>=0?(P=A*i+m<<2,h=(j+A)*g+E+m<<2):(P=(-j+A)*i-E+m<<2,h=A*g+m<<2),$==0)o[h]=a[P],o[h+1]=a[P+1],o[h+2]=a[P+2],o[h+3]=a[P+3];else if($==1){var L=a[P+3]*.00392156862745098,l=a[P]*L,c=a[P+1]*L,y=a[P+2]*L,S=o[h+3]*(1/255),x=o[h]*S,_=o[h+1]*S,b=o[h+2]*S;const u=1-L,D=L+S*u,T=D==0?0:1/D;o[h+3]=255*D,o[h+0]=(l+x*u)*T,o[h+1]=(c+_*u)*T,o[h+2]=(y+b*u)*T}else if($==2)L=a[P+3],l=a[P],c=a[P+1],y=a[P+2],S=o[h+3],x=o[h],_=o[h+1],b=o[h+2],L==S&&l==x&&c==_&&y==b?(o[h]=0,o[h+1]=0,o[h+2]=0,o[h+3]=0):(o[h]=l,o[h+1]=c,o[h+2]=y,o[h+3]=L);else if($==3){if(L=a[P+3],l=a[P],c=a[P+1],y=a[P+2],S=o[h+3],x=o[h],_=o[h+1],b=o[h+2],L==S&&l==x&&c==_&&y==b)continue;if(L<220&&S>20)return!1}return!0}return{decode:function(i){const n=new Uint8Array(i);let o=8;const g=p,C=g.readUshort,E=g.readUint,j={tabs:{},frames:[]},$=new Uint8Array(n.length);let U,M=0,P=0;const h=[137,80,78,71,13,10,26,10];for(var L=0;L<8;L++)if(n[L]!=h[L])throw"The input is not a PNG file!";for(;o<n.length;){const A=g.readUint(n,o);o+=4;const m=g.readASCII(n,o,4);if(o+=4,m=="IHDR")N(n,o,j);else if(m=="iCCP"){for(var l=o;n[l]!=0;)l++;g.readASCII(n,o,l-o),n[l+1];const u=n.slice(l+2,o+A);let D=null;try{D=r(u)}catch{D=s(u)}j.tabs[m]=D}else if(m=="CgBI")j.tabs[m]=n.slice(o,o+4);else if(m=="IDAT"){for(L=0;L<A;L++)$[M+L]=n[o+L];M+=A}else if(m=="acTL")j.tabs[m]={num_frames:E(n,o),num_plays:E(n,o+4)},U=new Uint8Array(n.length);else if(m=="fcTL"){P!=0&&((b=j.frames[j.frames.length-1]).data=I(j,U.slice(0,P),b.rect.width,b.rect.height),P=0);const u={x:E(n,o+12),y:E(n,o+16),width:E(n,o+4),height:E(n,o+8)};let D=C(n,o+22);D=C(n,o+20)/(D==0?100:D);const T={rect:u,delay:Math.round(1e3*D),dispose:n[o+24],blend:n[o+25]};j.frames.push(T)}else if(m=="fdAT"){for(L=0;L<A-4;L++)U[P+L]=n[o+L+4];P+=A-4}else if(m=="pHYs")j.tabs[m]=[g.readUint(n,o),g.readUint(n,o+4),n[o+8]];else if(m=="cHRM")for(j.tabs[m]=[],L=0;L<8;L++)j.tabs[m].push(g.readUint(n,o+4*L));else if(m=="tEXt"||m=="zTXt"){j.tabs[m]==null&&(j.tabs[m]={});var c=g.nextZero(n,o),y=g.readASCII(n,o,c-o),S=o+A-c-1;if(m=="tEXt")_=g.readASCII(n,c+1,S);else{var x=r(n.slice(c+2,c+2+S));_=g.readUTF8(x,0,x.length)}j.tabs[m][y]=_}else if(m=="iTXt"){j.tabs[m]==null&&(j.tabs[m]={}),c=0,l=o,c=g.nextZero(n,l),y=g.readASCII(n,l,c-l);const u=n[l=c+1];var _;n[l+1],l+=2,c=g.nextZero(n,l),g.readASCII(n,l,c-l),l=c+1,c=g.nextZero(n,l),g.readUTF8(n,l,c-l),S=A-((l=c+1)-o),u==0?_=g.readUTF8(n,l,S):(x=r(n.slice(l,l+S)),_=g.readUTF8(x,0,x.length)),j.tabs[m][y]=_}else if(m=="PLTE")j.tabs[m]=g.readBytes(n,o,A);else if(m=="hIST"){const u=j.tabs.PLTE.length/3;for(j.tabs[m]=[],L=0;L<u;L++)j.tabs[m].push(C(n,o+2*L))}else if(m=="tRNS")j.ctype==3?j.tabs[m]=g.readBytes(n,o,A):j.ctype==0?j.tabs[m]=C(n,o):j.ctype==2&&(j.tabs[m]=[C(n,o),C(n,o+2),C(n,o+4)]);else if(m=="gAMA")j.tabs[m]=g.readUint(n,o)/1e5;else if(m=="sRGB")j.tabs[m]=n[o];else if(m=="bKGD")j.ctype==0||j.ctype==4?j.tabs[m]=[C(n,o)]:j.ctype==2||j.ctype==6?j.tabs[m]=[C(n,o),C(n,o+2),C(n,o+4)]:j.ctype==3&&(j.tabs[m]=n[o]);else if(m=="IEND")break;o+=A,g.readUint(n,o),o+=4}var b;return P!=0&&((b=j.frames[j.frames.length-1]).data=I(j,U.slice(0,P),b.rect.width,b.rect.height)),j.data=I(j,$,j.width,j.height),delete j.compress,delete j.interlace,delete j.filter,j},toRGBA8:function(i){const n=i.width,o=i.height;if(i.tabs.acTL==null)return[w(i.data,n,o,i).buffer];const g=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const C=n*o*4,E=new Uint8Array(C),j=new Uint8Array(C),$=new Uint8Array(C);for(let M=0;M<i.frames.length;M++){const P=i.frames[M],h=P.rect.x,L=P.rect.y,l=P.rect.width,c=P.rect.height,y=w(P.data,l,c,i);if(M!=0)for(var U=0;U<C;U++)$[U]=E[U];if(P.blend==0?v(y,l,c,E,n,o,h,L,0):P.blend==1&&v(y,l,c,E,n,o,h,L,1),g.push(E.buffer.slice(0)),P.dispose!=0){if(P.dispose==1)v(j,l,c,E,n,o,h,L,0);else if(P.dispose==2)for(U=0;U<C;U++)E[U]=$[U]}}return g},_paeth:d,_copyTile:v,_bin:p}})();(function(){const{_copyTile:p}=lt,{_bin:w}=lt,I=lt._paeth;var r={table:(function(){const l=new Uint32Array(256);for(let c=0;c<256;c++){let y=c;for(let S=0;S<8;S++)1&y?y=3988292384^y>>>1:y>>>=1;l[c]=y}return l})(),update(l,c,y,S){for(let x=0;x<S;x++)l=r.table[255&(l^c[y+x])]^l>>>8;return l},crc:(l,c,y)=>4294967295^r.update(4294967295,l,c,y)};function s(l,c,y,S){c[y]+=l[0]*S>>4,c[y+1]+=l[1]*S>>4,c[y+2]+=l[2]*S>>4,c[y+3]+=l[3]*S>>4}function t(l){return Math.max(0,Math.min(255,l))}function f(l,c){const y=l[0]-c[0],S=l[1]-c[1],x=l[2]-c[2],_=l[3]-c[3];return y*y+S*S+x*x+_*_}function d(l,c,y,S,x,_,b){b==null&&(b=1);const A=S.length,m=[];for(var u=0;u<A;u++){const R=S[u];m.push([R>>>0&255,R>>>8&255,R>>>16&255,R>>>24&255])}for(u=0;u<A;u++){let R=4294967295;for(var D=0,T=0;T<A;T++){var H=f(m[u],m[T]);T!=u&&H<R&&(R=H,D=T)}}const re=new Uint32Array(x.buffer),K=new Int16Array(c*y*4),X=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(u=0;u<X.length;u++)X[u]=255*((X[u]+.5)/16-.5);for(let R=0;R<y;R++)for(let le=0;le<c;le++){var W;u=4*(R*c+le),b!=2?W=[t(l[u]+K[u]),t(l[u+1]+K[u+1]),t(l[u+2]+K[u+2]),t(l[u+3]+K[u+3])]:(H=X[4*(3&R)+(3&le)],W=[t(l[u]+H),t(l[u+1]+H),t(l[u+2]+H),t(l[u+3]+H)]),D=0;let Ne=16777215;for(T=0;T<A;T++){const xe=f(W,m[T]);xe<Ne&&(Ne=xe,D=T)}const we=m[D],be=[W[0]-we[0],W[1]-we[1],W[2]-we[2],W[3]-we[3]];b==1&&(le!=c-1&&s(be,K,u+4,7),R!=y-1&&(le!=0&&s(be,K,u+4*c-4,3),s(be,K,u+4*c,5),le!=c-1&&s(be,K,u+4*c+4,1))),_[u>>2]=D,re[u>>2]=S[D]}}function N(l,c,y,S,x){x==null&&(x={});const{crc:_}=r,b=w.writeUint,A=w.writeUshort,m=w.writeASCII;let u=8;const D=l.frames.length>1;let T,H=!1,re=33+(D?20:0);if(x.sRGB!=null&&(re+=13),x.pHYs!=null&&(re+=21),x.iCCP!=null&&(T=pako.deflate(x.iCCP),re+=21+T.length+4),l.ctype==3){for(var K=l.plte.length,X=0;X<K;X++)l.plte[X]>>>24!=255&&(H=!0);re+=8+3*K+4+(H?8+1*K+4:0)}for(var W=0;W<l.frames.length;W++)D&&(re+=38),re+=(we=l.frames[W]).cimg.length+12,W!=0&&(re+=4);re+=12;const R=new Uint8Array(re),le=[137,80,78,71,13,10,26,10];for(X=0;X<8;X++)R[X]=le[X];if(b(R,u,13),u+=4,m(R,u,"IHDR"),u+=4,b(R,u,c),u+=4,b(R,u,y),u+=4,R[u]=l.depth,u++,R[u]=l.ctype,u++,R[u]=0,u++,R[u]=0,u++,R[u]=0,u++,b(R,u,_(R,u-17,17)),u+=4,x.sRGB!=null&&(b(R,u,1),u+=4,m(R,u,"sRGB"),u+=4,R[u]=x.sRGB,u++,b(R,u,_(R,u-5,5)),u+=4),x.iCCP!=null){const be=13+T.length;b(R,u,be),u+=4,m(R,u,"iCCP"),u+=4,m(R,u,"ICC profile"),u+=11,u+=2,R.set(T,u),u+=T.length,b(R,u,_(R,u-(be+4),be+4)),u+=4}if(x.pHYs!=null&&(b(R,u,9),u+=4,m(R,u,"pHYs"),u+=4,b(R,u,x.pHYs[0]),u+=4,b(R,u,x.pHYs[1]),u+=4,R[u]=x.pHYs[2],u++,b(R,u,_(R,u-13,13)),u+=4),D&&(b(R,u,8),u+=4,m(R,u,"acTL"),u+=4,b(R,u,l.frames.length),u+=4,b(R,u,x.loop!=null?x.loop:0),u+=4,b(R,u,_(R,u-12,12)),u+=4),l.ctype==3){for(b(R,u,3*(K=l.plte.length)),u+=4,m(R,u,"PLTE"),u+=4,X=0;X<K;X++){const be=3*X,xe=l.plte[X],Ee=255&xe,Ae=xe>>>8&255,ut=xe>>>16&255;R[u+be+0]=Ee,R[u+be+1]=Ae,R[u+be+2]=ut}if(u+=3*K,b(R,u,_(R,u-3*K-4,3*K+4)),u+=4,H){for(b(R,u,K),u+=4,m(R,u,"tRNS"),u+=4,X=0;X<K;X++)R[u+X]=l.plte[X]>>>24&255;u+=K,b(R,u,_(R,u-K-4,K+4)),u+=4}}let Ne=0;for(W=0;W<l.frames.length;W++){var we=l.frames[W];D&&(b(R,u,26),u+=4,m(R,u,"fcTL"),u+=4,b(R,u,Ne++),u+=4,b(R,u,we.rect.width),u+=4,b(R,u,we.rect.height),u+=4,b(R,u,we.rect.x),u+=4,b(R,u,we.rect.y),u+=4,A(R,u,S[W]),u+=2,A(R,u,1e3),u+=2,R[u]=we.dispose,u++,R[u]=we.blend,u++,b(R,u,_(R,u-30,30)),u+=4);const be=we.cimg;b(R,u,(K=be.length)+(W==0?0:4)),u+=4;const xe=u;m(R,u,W==0?"IDAT":"fdAT"),u+=4,W!=0&&(b(R,u,Ne++),u+=4),R.set(be,u),u+=K,b(R,u,_(R,xe,u-xe)),u+=4}return b(R,u,0),u+=4,m(R,u,"IEND"),u+=4,b(R,u,_(R,u-4,4)),u+=4,R.buffer}function v(l,c,y){for(let S=0;S<l.frames.length;S++){const x=l.frames[S];x.rect.width;const _=x.rect.height,b=new Uint8Array(_*x.bpl+_);x.cimg=o(x.img,_,x.bpp,x.bpl,b,c,y)}}function a(l,c,y,S,x){const _=x[0],b=x[1],A=x[2],m=x[3],u=x[4],D=x[5];let T=6,H=8,re=255;for(var K=0;K<l.length;K++){const Fe=new Uint8Array(l[K]);for(var X=Fe.length,W=0;W<X;W+=4)re&=Fe[W+3]}const R=re!=255,le=(function(_e,ke,De,Me,Ue,He){const Ie=[];for(var je=0;je<_e.length;je++){const $e=new Uint8Array(_e[je]),ze=new Uint32Array($e.buffer);var Pe;let Ve=0,st=0,Ge=ke,rt=De,jt=Me?1:0;if(je!=0){const ts=He||Me||je==1||Ie[je-2].dispose!=0?1:2;let qe=0,$t=1e9;for(let Qe=0;Qe<ts;Qe++){var et=new Uint8Array(_e[je-1-Qe]);const ss=new Uint32Array(_e[je-1-Qe]);let nt=ke,at=De,bt=-1,Nt=-1;for(let ft=0;ft<De;ft++)for(let mt=0;mt<ke;mt++)ze[Re=ft*ke+mt]!=ss[Re]&&(mt<nt&&(nt=mt),mt>bt&&(bt=mt),ft<at&&(at=ft),ft>Nt&&(Nt=ft));bt==-1&&(nt=at=bt=Nt=0),Ue&&((1&nt)==1&&nt--,(1&at)==1&&at--);const Ht=(bt-nt+1)*(Nt-at+1);Ht<$t&&($t=Ht,qe=Qe,Ve=nt,st=at,Ge=bt-nt+1,rt=Nt-at+1)}et=new Uint8Array(_e[je-1-qe]),qe==1&&(Ie[je-1].dispose=2),Pe=new Uint8Array(Ge*rt*4),p(et,ke,De,Pe,Ge,rt,-Ve,-st,0),jt=p($e,ke,De,Pe,Ge,rt,-Ve,-st,3)?1:0,jt==1?n($e,ke,De,Pe,{x:Ve,y:st,width:Ge,height:rt}):p($e,ke,De,Pe,Ge,rt,-Ve,-st,0)}else Pe=$e.slice(0);Ie.push({rect:{x:Ve,y:st,width:Ge,height:rt},img:Pe,blend:jt,dispose:0})}if(Me)for(je=0;je<Ie.length;je++){if((tt=Ie[je]).blend==1)continue;const $e=tt.rect,ze=Ie[je-1].rect,Ve=Math.min($e.x,ze.x),st=Math.min($e.y,ze.y),Ge={x:Ve,y:st,width:Math.max($e.x+$e.width,ze.x+ze.width)-Ve,height:Math.max($e.y+$e.height,ze.y+ze.height)-st};Ie[je-1].dispose=1,je-1!=0&&i(_e,ke,De,Ie,je-1,Ge,Ue),i(_e,ke,De,Ie,je,Ge,Ue)}let pt=0;if(_e.length!=1)for(var Re=0;Re<Ie.length;Re++){var tt;pt+=(tt=Ie[Re]).rect.width*tt.rect.height}return Ie})(l,c,y,_,b,A),Ne={},we=[],be=[];if(S!=0){const Fe=[];for(W=0;W<le.length;W++)Fe.push(le[W].img.buffer);const _e=(function(Ue){let He=0;for(var Ie=0;Ie<Ue.length;Ie++)He+=Ue[Ie].byteLength;const je=new Uint8Array(He);let Pe=0;for(Ie=0;Ie<Ue.length;Ie++){const et=new Uint8Array(Ue[Ie]),pt=et.length;for(let Re=0;Re<pt;Re+=4){let tt=et[Re],$e=et[Re+1],ze=et[Re+2];const Ve=et[Re+3];Ve==0&&(tt=$e=ze=0),je[Pe+Re]=tt,je[Pe+Re+1]=$e,je[Pe+Re+2]=ze,je[Pe+Re+3]=Ve}Pe+=pt}return je.buffer})(Fe),ke=C(_e,S);for(W=0;W<ke.plte.length;W++)we.push(ke.plte[W].est.rgba);let De=0;for(W=0;W<le.length;W++){const Me=(Ee=le[W]).img.length;var xe=new Uint8Array(ke.inds.buffer,De>>2,Me>>2);be.push(xe);const Ue=new Uint8Array(ke.abuf,De,Me);D&&d(Ee.img,Ee.rect.width,Ee.rect.height,we,Ue,xe),Ee.img.set(Ue),De+=Me}}else for(K=0;K<le.length;K++){var Ee=le[K];const Fe=new Uint32Array(Ee.img.buffer);var Ae=Ee.rect.width;for(X=Fe.length,xe=new Uint8Array(X),be.push(xe),W=0;W<X;W++){const _e=Fe[W];if(W!=0&&_e==Fe[W-1])xe[W]=xe[W-1];else if(W>Ae&&_e==Fe[W-Ae])xe[W]=xe[W-Ae];else{let ke=Ne[_e];if(ke==null&&(Ne[_e]=ke=we.length,we.push(_e),we.length>=300))break;xe[W]=ke}}}const ut=we.length;for(ut<=256&&u==0&&(H=ut<=2?1:ut<=4?2:ut<=16?4:8,H=Math.max(H,m)),K=0;K<le.length;K++){(Ee=le[K]).rect.x,Ee.rect.y,Ae=Ee.rect.width;const Fe=Ee.rect.height;let _e=Ee.img;new Uint32Array(_e.buffer);let ke=4*Ae,De=4;if(ut<=256&&u==0){ke=Math.ceil(H*Ae/8);var Ye=new Uint8Array(ke*Fe);const Me=be[K];for(let Ue=0;Ue<Fe;Ue++){W=Ue*ke;const He=Ue*Ae;if(H==8)for(var Le=0;Le<Ae;Le++)Ye[W+Le]=Me[He+Le];else if(H==4)for(Le=0;Le<Ae;Le++)Ye[W+(Le>>1)]|=Me[He+Le]<<4-4*(1&Le);else if(H==2)for(Le=0;Le<Ae;Le++)Ye[W+(Le>>2)]|=Me[He+Le]<<6-2*(3&Le);else if(H==1)for(Le=0;Le<Ae;Le++)Ye[W+(Le>>3)]|=Me[He+Le]<<7-1*(7&Le)}_e=Ye,T=3,De=1}else if(R==0&&le.length==1){Ye=new Uint8Array(Ae*Fe*3);const Me=Ae*Fe;for(W=0;W<Me;W++){const Ue=3*W,He=4*W;Ye[Ue]=_e[He],Ye[Ue+1]=_e[He+1],Ye[Ue+2]=_e[He+2]}_e=Ye,T=2,De=3,ke=3*Ae}Ee.img=_e,Ee.bpl=ke,Ee.bpp=De}return{ctype:T,depth:H,plte:we,frames:le}}function i(l,c,y,S,x,_,b){const A=Uint8Array,m=Uint32Array,u=new A(l[x-1]),D=new m(l[x-1]),T=x+1<l.length?new A(l[x+1]):null,H=new A(l[x]),re=new m(H.buffer);let K=c,X=y,W=-1,R=-1;for(let Ne=0;Ne<_.height;Ne++)for(let we=0;we<_.width;we++){const be=_.x+we,xe=_.y+Ne,Ee=xe*c+be,Ae=re[Ee];Ae==0||S[x-1].dispose==0&&D[Ee]==Ae&&(T==null||T[4*Ee+3]!=0)||(be<K&&(K=be),be>W&&(W=be),xe<X&&(X=xe),xe>R&&(R=xe))}W==-1&&(K=X=W=R=0),b&&((1&K)==1&&K--,(1&X)==1&&X--),_={x:K,y:X,width:W-K+1,height:R-X+1};const le=S[x];le.rect=_,le.blend=1,le.img=new Uint8Array(_.width*_.height*4),S[x-1].dispose==0?(p(u,c,y,le.img,_.width,_.height,-_.x,-_.y,0),n(H,c,y,le.img,_)):p(H,c,y,le.img,_.width,_.height,-_.x,-_.y,0)}function n(l,c,y,S,x){p(l,c,y,S,x.width,x.height,-x.x,-x.y,2)}function o(l,c,y,S,x,_,b){const A=[];let m,u=[0,1,2,3,4];_!=-1?u=[_]:(c*S>5e5||y==1)&&(u=[0]),b&&(m={level:0});const D=hr;for(var T=0;T<u.length;T++){for(let K=0;K<c;K++)g(x,l,K,S,y,u[T]);A.push(D.deflate(x,m))}let H,re=1e9;for(T=0;T<A.length;T++)A[T].length<re&&(H=T,re=A[T].length);return A[H]}function g(l,c,y,S,x,_){const b=y*S;let A=b+y;if(l[A]=_,A++,_==0)if(S<500)for(var m=0;m<S;m++)l[A+m]=c[b+m];else l.set(new Uint8Array(c.buffer,b,S),A);else if(_==1){for(m=0;m<x;m++)l[A+m]=c[b+m];for(m=x;m<S;m++)l[A+m]=c[b+m]-c[b+m-x]+256&255}else if(y==0){for(m=0;m<x;m++)l[A+m]=c[b+m];if(_==2)for(m=x;m<S;m++)l[A+m]=c[b+m];if(_==3)for(m=x;m<S;m++)l[A+m]=c[b+m]-(c[b+m-x]>>1)+256&255;if(_==4)for(m=x;m<S;m++)l[A+m]=c[b+m]-I(c[b+m-x],0,0)+256&255}else{if(_==2)for(m=0;m<S;m++)l[A+m]=c[b+m]+256-c[b+m-S]&255;if(_==3){for(m=0;m<x;m++)l[A+m]=c[b+m]+256-(c[b+m-S]>>1)&255;for(m=x;m<S;m++)l[A+m]=c[b+m]+256-(c[b+m-S]+c[b+m-x]>>1)&255}if(_==4){for(m=0;m<x;m++)l[A+m]=c[b+m]+256-I(0,c[b+m-S],0)&255;for(m=x;m<S;m++)l[A+m]=c[b+m]+256-I(c[b+m-x],c[b+m-S],c[b+m-x-S])&255}}}function C(l,c){const y=new Uint8Array(l),S=y.slice(0),x=new Uint32Array(S.buffer),_=E(S,c),b=_[0],A=_[1],m=y.length,u=new Uint8Array(m>>2);let D;if(y.length<2e7)for(var T=0;T<m;T+=4)D=j(b,H=y[T]*(1/255),re=y[T+1]*(1/255),K=y[T+2]*(1/255),X=y[T+3]*(1/255)),u[T>>2]=D.ind,x[T>>2]=D.est.rgba;else for(T=0;T<m;T+=4){var H=y[T]*.00392156862745098,re=y[T+1]*(1/255),K=y[T+2]*(1/255),X=y[T+3]*(1/255);for(D=b;D.left;)D=$(D.est,H,re,K,X)<=0?D.left:D.right;u[T>>2]=D.ind,x[T>>2]=D.est.rgba}return{abuf:S.buffer,inds:u,plte:A}}function E(l,c,y){y==null&&(y=1e-4);const S=new Uint32Array(l.buffer),x={i0:0,i1:l.length,bst:null,est:null,tdst:0,left:null,right:null};x.bst=P(l,x.i0,x.i1),x.est=h(x.bst);const _=[x];for(;_.length<c;){let A=0,m=0;for(var b=0;b<_.length;b++)_[b].est.L>A&&(A=_[b].est.L,m=b);if(A<y)break;const u=_[m],D=U(l,S,u.i0,u.i1,u.est.e,u.est.eMq255);if(u.i0>=D||u.i1<=D){u.est.L=0;continue}const T={i0:u.i0,i1:D,bst:null,est:null,tdst:0,left:null,right:null};T.bst=P(l,T.i0,T.i1),T.est=h(T.bst);const H={i0:D,i1:u.i1,bst:null,est:null,tdst:0,left:null,right:null};for(H.bst={R:[],m:[],N:u.bst.N-T.bst.N},b=0;b<16;b++)H.bst.R[b]=u.bst.R[b]-T.bst.R[b];for(b=0;b<4;b++)H.bst.m[b]=u.bst.m[b]-T.bst.m[b];H.est=h(H.bst),u.left=T,u.right=H,_[m]=T,_.push(H)}for(_.sort(((A,m)=>m.bst.N-A.bst.N)),b=0;b<_.length;b++)_[b].ind=b;return[x,_]}function j(l,c,y,S,x){if(l.left==null)return l.tdst=(function(T,H,re,K,X){const W=H-T[0],R=re-T[1],le=K-T[2],Ne=X-T[3];return W*W+R*R+le*le+Ne*Ne})(l.est.q,c,y,S,x),l;const _=$(l.est,c,y,S,x);let b=l.left,A=l.right;_>0&&(b=l.right,A=l.left);const m=j(b,c,y,S,x);if(m.tdst<=_*_)return m;const u=j(A,c,y,S,x);return u.tdst<m.tdst?u:m}function $(l,c,y,S,x){const{e:_}=l;return _[0]*c+_[1]*y+_[2]*S+_[3]*x-l.eMq}function U(l,c,y,S,x,_){for(S-=4;y<S;){for(;M(l,y,x)<=_;)y+=4;for(;M(l,S,x)>_;)S-=4;if(y>=S)break;const b=c[y>>2];c[y>>2]=c[S>>2],c[S>>2]=b,y+=4,S-=4}for(;M(l,y,x)>_;)y-=4;return y+4}function M(l,c,y){return l[c]*y[0]+l[c+1]*y[1]+l[c+2]*y[2]+l[c+3]*y[3]}function P(l,c,y){const S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=[0,0,0,0],_=y-c>>2;for(let b=c;b<y;b+=4){const A=l[b]*.00392156862745098,m=l[b+1]*(1/255),u=l[b+2]*(1/255),D=l[b+3]*(1/255);x[0]+=A,x[1]+=m,x[2]+=u,x[3]+=D,S[0]+=A*A,S[1]+=A*m,S[2]+=A*u,S[3]+=A*D,S[5]+=m*m,S[6]+=m*u,S[7]+=m*D,S[10]+=u*u,S[11]+=u*D,S[15]+=D*D}return S[4]=S[1],S[8]=S[2],S[9]=S[6],S[12]=S[3],S[13]=S[7],S[14]=S[11],{R:S,m:x,N:_}}function h(l){const{R:c}=l,{m:y}=l,{N:S}=l,x=y[0],_=y[1],b=y[2],A=y[3],m=S==0?0:1/S,u=[c[0]-x*x*m,c[1]-x*_*m,c[2]-x*b*m,c[3]-x*A*m,c[4]-_*x*m,c[5]-_*_*m,c[6]-_*b*m,c[7]-_*A*m,c[8]-b*x*m,c[9]-b*_*m,c[10]-b*b*m,c[11]-b*A*m,c[12]-A*x*m,c[13]-A*_*m,c[14]-A*b*m,c[15]-A*A*m],D=u,T=L;let H=[Math.random(),Math.random(),Math.random(),Math.random()],re=0,K=0;if(S!=0)for(let W=0;W<16&&(H=T.multVec(D,H),K=Math.sqrt(T.dot(H,H)),H=T.sml(1/K,H),!(W!=0&&Math.abs(K-re)<1e-9));W++)re=K;const X=[x*m,_*m,b*m,A*m];return{Cov:u,q:X,e:H,L:re,eMq255:T.dot(T.sml(255,X),H),eMq:T.dot(H,X),rgba:(Math.round(255*X[3])<<24|Math.round(255*X[2])<<16|Math.round(255*X[1])<<8|Math.round(255*X[0])<<0)>>>0}}var L={multVec:(l,c)=>[l[0]*c[0]+l[1]*c[1]+l[2]*c[2]+l[3]*c[3],l[4]*c[0]+l[5]*c[1]+l[6]*c[2]+l[7]*c[3],l[8]*c[0]+l[9]*c[1]+l[10]*c[2]+l[11]*c[3],l[12]*c[0]+l[13]*c[1]+l[14]*c[2]+l[15]*c[3]],dot:(l,c)=>l[0]*c[0]+l[1]*c[1]+l[2]*c[2]+l[3]*c[3],sml:(l,c)=>[l*c[0],l*c[1],l*c[2],l*c[3]]};lt.encode=function(c,y,S,x,_,b,A){x==null&&(x=0),A==null&&(A=!1);const m=a(c,y,S,x,[!1,!1,!1,0,A,!1]);return v(m,-1),N(m,y,S,_,b)},lt.encodeLL=function(c,y,S,x,_,b,A,m){const u={ctype:0+(x==1?0:2)+(_==0?0:4),depth:b,frames:[]},D=(x+_)*b,T=D*y;for(let H=0;H<c.length;H++)u.frames.push({rect:{x:0,y:0,width:y,height:S},img:new Uint8Array(c[H]),blend:0,dispose:1,bpp:Math.ceil(D/8),bpl:Math.ceil(T/8)});return v(u,0,!0),N(u,y,S,A,m)},lt.encode.compress=a,lt.encode.dither=d,lt.quantize=C,lt.quantize.getKDtree=E,lt.quantize.getNearest=j})();const $s={toArrayBuffer(p,w){const I=p.width,r=p.height,s=I<<2,t=p.getContext("2d").getImageData(0,0,I,r),f=new Uint32Array(t.data.buffer),d=(32*I+31)/32<<2,N=d*r,v=122+N,a=new ArrayBuffer(v),i=new DataView(a),n=1<<20;let o,g,C,E,j=n,$=0,U=0,M=0;function P(l){i.setUint16(U,l,!0),U+=2}function h(l){i.setUint32(U,l,!0),U+=4}function L(l){U+=l}P(19778),h(v),L(4),h(122),h(108),h(I),h(-r>>>0),P(1),P(32),h(3),h(N),h(2835),h(2835),L(8),h(16711680),h(65280),h(255),h(4278190080),h(1466527264),(function l(){for(;$<r&&j>0;){for(E=122+$*d,o=0;o<s;)j--,g=f[M++],C=g>>>24,i.setUint32(E+o,g<<8|C),o+=4;$++}M<f.length?(j=n,setTimeout(l,$s._dly)):w(a)})()},toBlob(p,w){this.toArrayBuffer(p,(I=>{w(new Blob([I],{type:"image/bmp"}))}))},_dly:9};var Je={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},gr={[Je.CHROME]:16384,[Je.FIREFOX]:11180,[Je.DESKTOP_SAFARI]:16384,[Je.IE]:8192,[Je.IOS]:4096,[Je.ETC]:8192};const gs=typeof window<"u",Hs=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Qt=gs&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),xr=(gs||Hs)&&(Qt&&Qt.getOriginalSymbol(window,"File")||typeof File<"u"&&File),zs=(gs||Hs)&&(Qt&&Qt.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function xs(p,w,I=Date.now()){return new Promise((r=>{const s=p.split(","),t=s[0].match(/:(.*?);/)[1],f=globalThis.atob(s[1]);let d=f.length;const N=new Uint8Array(d);for(;d--;)N[d]=f.charCodeAt(d);const v=new Blob([N],{type:t});v.name=w,v.lastModified=I,r(v)}))}function Bs(p){return new Promise(((w,I)=>{const r=new zs;r.onload=()=>w(r.result),r.onerror=s=>I(s),r.readAsDataURL(p)}))}function Ws(p){return new Promise(((w,I)=>{const r=new Image;r.onload=()=>w(r),r.onerror=s=>I(s),r.src=p}))}function Ct(){if(Ct.cachedResult!==void 0)return Ct.cachedResult;let p=Je.ETC;const{userAgent:w}=navigator;return/Chrom(e|ium)/i.test(w)?p=Je.CHROME:/iP(ad|od|hone)/i.test(w)&&/WebKit/i.test(w)?p=Je.IOS:/Safari/i.test(w)?p=Je.DESKTOP_SAFARI:/Firefox/i.test(w)?p=Je.FIREFOX:(/MSIE/i.test(w)||document.documentMode)&&(p=Je.IE),Ct.cachedResult=p,Ct.cachedResult}function Os(p,w){const I=Ct(),r=gr[I];let s=p,t=w,f=s*t;const d=s>t?t/s:s/t;for(;f>r*r;){const N=(r+s)/2,v=(r+t)/2;N<v?(t=v,s=v*d):(t=N*d,s=N),f=s*t}return{width:s,height:t}}function es(p,w){let I,r;try{if(I=new OffscreenCanvas(p,w),r=I.getContext("2d"),r===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{I=document.createElement("canvas"),r=I.getContext("2d")}return I.width=p,I.height=w,[I,r]}function Gs(p,w){const{width:I,height:r}=Os(p.width,p.height),[s,t]=es(I,r);return w&&/jpe?g/.test(w)&&(t.fillStyle="white",t.fillRect(0,0,s.width,s.height)),t.drawImage(p,0,0,s.width,s.height),s}function Vt(){return Vt.cachedResult!==void 0||(Vt.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Vt.cachedResult}function Zt(p,w={}){return new Promise((function(I,r){let s,t;var f=function(){try{return t=Gs(s,w.fileType||p.type),I([s,t])}catch(N){return r(N)}},d=function(N){try{var v=function(a){try{throw a}catch(i){return r(i)}};try{let a;return Bs(p).then((function(i){try{return a=i,Ws(a).then((function(n){try{return s=n,(function(){try{return f()}catch(o){return r(o)}})()}catch(o){return v(o)}}),v)}catch(n){return v(n)}}),v)}catch(a){v(a)}}catch(a){return r(a)}};try{if(Vt()||[Je.DESKTOP_SAFARI,Je.MOBILE_SAFARI].includes(Ct()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(p).then((function(N){try{return s=N,f()}catch{return d()}}),d)}catch{d()}}))}function Xt(p,w,I,r,s=1){return new Promise((function(t,f){let d;if(w==="image/png"){let v,a,i;return v=p.getContext("2d"),{data:a}=v.getImageData(0,0,p.width,p.height),i=lt.encode([a.buffer],p.width,p.height,4096*s),d=new Blob([i],{type:w}),d.name=I,d.lastModified=r,N.call(this)}{let v=function(){return N.call(this)};if(w==="image/bmp")return new Promise((a=>$s.toBlob(p,a))).then((function(a){try{return d=a,d.name=I,d.lastModified=r,v.call(this)}catch(i){return f(i)}}).bind(this),f);{let a=function(){return v.call(this)};if(typeof OffscreenCanvas=="function"&&p instanceof OffscreenCanvas)return p.convertToBlob({type:w,quality:s}).then((function(i){try{return d=i,d.name=I,d.lastModified=r,a.call(this)}catch(n){return f(n)}}).bind(this),f);{let i;return i=p.toDataURL(w,s),xs(i,I,r).then((function(n){try{return d=n,a.call(this)}catch(o){return f(o)}}).bind(this),f)}}}function N(){return t(d)}}))}function dt(p){p.width=0,p.height=0}function Et(){return new Promise((function(p,w){let I,r,s,t;return Et.cachedResult!==void 0?p(Et.cachedResult):xs("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(f){try{return I=f,Zt(I).then((function(d){try{return r=d[1],Xt(r,I.type,I.name,I.lastModified).then((function(N){try{return s=N,dt(r),Zt(s).then((function(v){try{return t=v[0],Et.cachedResult=t.width===1&&t.height===2,p(Et.cachedResult)}catch(a){return w(a)}}),w)}catch(v){return w(v)}}),w)}catch(N){return w(N)}}),w)}catch(d){return w(d)}}),w)}))}function qs(p){return new Promise(((w,I)=>{const r=new zs;r.onload=s=>{const t=new DataView(s.target.result);if(t.getUint16(0,!1)!=65496)return w(-2);const f=t.byteLength;let d=2;for(;d<f;){if(t.getUint16(d+2,!1)<=8)return w(-1);const N=t.getUint16(d,!1);if(d+=2,N==65505){if(t.getUint32(d+=2,!1)!=1165519206)return w(-1);const v=t.getUint16(d+=6,!1)==18761;d+=t.getUint32(d+4,v);const a=t.getUint16(d,v);d+=2;for(let i=0;i<a;i++)if(t.getUint16(d+12*i,v)==274)return w(t.getUint16(d+12*i+8,v))}else{if((65280&N)!=65280)break;d+=t.getUint16(d,!1)}}return w(-1)},r.onerror=s=>I(s),r.readAsArrayBuffer(p)}))}function Ks(p,w){const{width:I}=p,{height:r}=p,{maxWidthOrHeight:s}=w;let t,f=p;return isFinite(s)&&(I>s||r>s)&&([f,t]=es(I,r),I>r?(f.width=s,f.height=r/I*s):(f.width=I/r*s,f.height=s),t.drawImage(p,0,0,f.width,f.height),dt(p)),f}function Ys(p,w){const{width:I}=p,{height:r}=p,[s,t]=es(I,r);switch(w>4&&w<9?(s.width=r,s.height=I):(s.width=I,s.height=r),w){case 2:t.transform(-1,0,0,1,I,0);break;case 3:t.transform(-1,0,0,-1,I,r);break;case 4:t.transform(1,0,0,-1,0,r);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,r,0);break;case 7:t.transform(0,-1,-1,0,r,I);break;case 8:t.transform(0,-1,1,0,0,I)}return t.drawImage(p,0,0,I,r),dt(p),s}function Us(p,w,I=0){return new Promise((function(r,s){let t,f,d,N,v,a,i,n,o,g,C,E,j,$,U,M,P,h,L,l;function c(S=5){if(w.signal&&w.signal.aborted)throw w.signal.reason;t+=S,w.onProgress(Math.min(t,100))}function y(S){if(w.signal&&w.signal.aborted)throw w.signal.reason;t=Math.min(Math.max(S,t),100),w.onProgress(t)}return t=I,f=w.maxIteration||10,d=1024*w.maxSizeMB*1024,c(),Zt(p,w).then((function(S){try{return[,N]=S,c(),v=Ks(N,w),c(),new Promise((function(x,_){var b;if(!(b=w.exifOrientation))return qs(p).then((function(m){try{return b=m,A.call(this)}catch(u){return _(u)}}).bind(this),_);function A(){return x(b)}return A.call(this)})).then((function(x){try{return a=x,c(),Et().then((function(_){try{return i=_?v:Ys(v,a),c(),n=w.initialQuality||1,o=w.fileType||p.type,Xt(i,o,p.name,p.lastModified,n).then((function(b){try{{let m=function(){if(f--&&(U>d||U>j)){let D,T;return D=l?.95*L.width:L.width,T=l?.95*L.height:L.height,[P,h]=es(D,T),h.drawImage(L,0,0,D,T),n*=o==="image/png"?.85:.95,Xt(P,o,p.name,p.lastModified,n).then((function(H){try{return M=H,dt(L),L=P,U=M.size,y(Math.min(99,Math.floor(($-U)/($-d)*100))),m}catch(re){return s(re)}}),s)}return[1]},u=function(){return dt(L),dt(P),dt(v),dt(i),dt(N),y(100),r(M)};if(g=b,c(),C=g.size>d,E=g.size>p.size,!C&&!E)return y(100),r(g);var A;return j=p.size,$=g.size,U=$,L=i,l=!w.alwaysKeepResolution&&C,(A=(function(D){for(;D;){if(D.then)return void D.then(A,s);try{if(D.pop){if(D.length)return D.pop()?u.call(this):D;D=m}else D=D.call(this)}catch(T){return s(T)}}}).bind(this))(m)}}catch(m){return s(m)}}).bind(this),s)}catch(b){return s(b)}}).bind(this),s)}catch(_){return s(_)}}).bind(this),s)}catch(x){return s(x)}}).bind(this),s)}))}const pr=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let us;function br(p,w){return new Promise(((I,r)=>{us||(us=(function(f){const d=[];return d.push(f),URL.createObjectURL(new Blob(d))})(pr));const s=new Worker(us);s.addEventListener("message",(function(f){if(w.signal&&w.signal.aborted)s.terminate();else if(f.data.progress===void 0){if(f.data.error)return r(new Error(f.data.error)),void s.terminate();I(f.data.file),s.terminate()}else w.onProgress(f.data.progress)})),s.addEventListener("error",r),w.signal&&w.signal.addEventListener("abort",(()=>{r(w.signal.reason),s.terminate()})),s.postMessage({file:p,imageCompressionLibUrl:w.libURL,options:{...w,onProgress:void 0,signal:void 0}})}))}function Oe(p,w){return new Promise((function(I,r){let s,t,f,d,N,v;if(s={...w},f=0,{onProgress:d}=s,s.maxSizeMB=s.maxSizeMB||Number.POSITIVE_INFINITY,N=typeof s.useWebWorker!="boolean"||s.useWebWorker,delete s.useWebWorker,s.onProgress=o=>{f=o,typeof d=="function"&&d(f)},!(p instanceof Blob||p instanceof xr))return r(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(p.type))return r(new Error("The file given is not an image"));if(v=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!N||typeof Worker!="function"||v)return Us(p,s).then((function(o){try{return t=o,n.call(this)}catch(g){return r(g)}}).bind(this),r);var a=(function(){try{return n.call(this)}catch(o){return r(o)}}).bind(this),i=function(o){try{return Us(p,s).then((function(g){try{return t=g,a()}catch(C){return r(C)}}),r)}catch(g){return r(g)}};try{return s.libURL=s.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",br(p,s).then((function(o){try{return t=o,a()}catch{return i()}}),i)}catch{i()}function n(){try{t.name=p.name,t.lastModified=p.lastModified}catch{}try{s.preserveExif&&p.type==="image/jpeg"&&(!s.fileType||s.fileType&&s.fileType===p.type)&&(t=Ps(p,t))}catch{}return I(t)}}))}Oe.getDataUrlFromFile=Bs,Oe.getFilefromDataUrl=xs,Oe.loadImage=Ws,Oe.drawImageInCanvas=Gs,Oe.drawFileInCanvas=Zt,Oe.canvasToFile=Xt,Oe.getExifOrientation=qs,Oe.handleMaxWidthOrHeight=Ks,Oe.followExifOrientation=Ys,Oe.cleanupCanvasMemory=dt,Oe.isAutoOrientationInBrowser=Et,Oe.approximateBelowMaximumCanvasSizeOfBrowser=Os,Oe.copyExifWithoutOrientation=Ps,Oe.getBrowserName=Ct,Oe.version="2.0.2";const Be=[];for(let p=0;p<256;++p)Be.push((p+256).toString(16).slice(1));function wr(p,w=0){return(Be[p[w+0]]+Be[p[w+1]]+Be[p[w+2]]+Be[p[w+3]]+"-"+Be[p[w+4]]+Be[p[w+5]]+"-"+Be[p[w+6]]+Be[p[w+7]]+"-"+Be[p[w+8]]+Be[p[w+9]]+"-"+Be[p[w+10]]+Be[p[w+11]]+Be[p[w+12]]+Be[p[w+13]]+Be[p[w+14]]+Be[p[w+15]]).toLowerCase()}let fs;const vr=new Uint8Array(16);function yr(){if(!fs){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");fs=crypto.getRandomValues.bind(crypto)}return fs(vr)}const jr=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Is={randomUUID:jr};function Nr(p,w,I){p=p||{};const r=p.random??p.rng?.()??yr();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,wr(r)}function _r(p,w,I){return Is.randomUUID&&!p?Is.randomUUID():Nr(p)}const Fs=50,ms=p=>({id:p.id,league_id:p.league_id,user_id:p.user_id,content:p.content,created_at:p.created_at??new Date().toISOString(),status:"sent"}),qt=p=>{const w=new Map;for(const I of p)w.set(I.id,I);return Array.from(w.values()).sort((I,r)=>new Date(I.created_at).getTime()-new Date(r.created_at).getTime())};function kr(p,w={}){const{userId:I,enabled:r=!0,autoSubscribe:s=!0}=w,[t,f]=F.useState([]),[d,N]=F.useState(!1),[v,a]=F.useState(!1),[i,n]=F.useState(!0),[o,g]=F.useState(null),C=F.useRef(null),E=F.useCallback(h=>{f(L=>{const l=h(L);return C.current=l.length?l[0].created_at:null,l})},[]),j=F.useCallback(async({before:h,append:L})=>{if(!p||!r)return;const l=ce.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",p).order("created_at",{ascending:!1}).limit(Fs);h&&l.lt("created_at",h);const{data:c,error:y}=await l;if(y)throw y;const S=(c??[]).map(ms).reverse();E(x=>qt(L?[...S,...x]:S)),(c??[]).length<Fs?n(!1):L||n(!0)},[p,r,E]),$=F.useCallback(async()=>{if(!p||!r){f([]),n(!0);return}N(!0),g(null),C.current=null;try{await j({append:!1})}catch(h){g(h?.message??"Failed to load chat")}finally{N(!1)}},[p,r,j]);F.useEffect(()=>{if(!p||!r){f([]),n(!0);return}let h=!0;if($(),!s)return()=>{h=!1};const L=ce.channel(`league-messages:${p}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${p}`},l=>{if(!h)return;const c=ms(l.new);E(y=>y.some(S=>S.id===c.id)?y:qt([...y,c]))}).subscribe();return()=>{h=!1,ce.removeChannel(L)}},[p,r,s,$,E]);const U=F.useCallback(async()=>{if(!p||!r||!i||v)return;const h=C.current??t[0]?.created_at;if(h){a(!0);try{await j({before:h,append:!0})}catch(L){g(L?.message??"Failed to load more messages")}finally{a(!1)}}},[p,r,i,v,j,t]),M=F.useCallback(async h=>{if(!p||!I)throw new Error("Missing league or user");const L=h.trim();if(!L)return;const l=_r(),c=`optimistic-${l}`,y={id:c,client_msg_id:l,league_id:p,user_id:I,content:L,created_at:new Date().toISOString(),status:"sending"};E(_=>qt([..._,y]));const{data:S,error:x}=await ce.from("league_messages").insert({league_id:p,user_id:I,content:L}).select("id, league_id, user_id, content, created_at").single();if(x)throw E(_=>_.map(b=>b.id===c?{...b,status:"error"}:b)),x;if(S){const _=ms(S);_.client_msg_id=l,E(b=>b.map(A=>A.id===c?{..._,status:"sent",client_msg_id:l}:A))}},[p,I,E]),P=F.useMemo(()=>t.slice(-5),[t]);return{messages:t,previewMessages:P,loading:d,loadingMore:v,hasMore:i,error:o,refresh:$,loadMore:U,sendMessage:M}}const Sr={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",middle:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",bottom:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]"},Cr={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[4px] rounded-bl-[12px]",middle:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[4px] rounded-bl-[12px]",bottom:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[12px] rounded-bl-[12px]"};function Vs({author:p,text:w,time:I,isOwnMessage:r,shape:s="single"}){const t=r?"text-right":"text-left",f=r?"bg-[#1C8376] text-white":"bg-white text-slate-900",d=r?Cr:Sr;return e.jsxs("div",{className:`inline-block w-fit px-3 py-2 text-sm leading-snug shadow-sm max-w-[70%] whitespace-normal break-words ${t} ${f} ${d[s]}`,children:[p&&!r&&e.jsx("div",{className:"text-[11px] font-semibold text-slate-600 mb-1",children:p}),e.jsx("div",{children:w}),e.jsx("div",{className:"text-[11px] text-[#DCDCDD] mt-1",children:I})]})}function Ar({author:p,messages:w,isOwnMessage:I,avatarInitials:r}){const s=I?"justify-end":"justify-start";return e.jsxs("div",{className:`flex items-end gap-3 w-full ${s}`,children:[I?e.jsx("div",{className:"w-8 flex-shrink-0"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-[13px] font-semibold text-slate-500 flex-shrink-0",children:(r||p.charAt(0)).toUpperCase()}),e.jsx("div",{className:"flex flex-col gap-1 flex-1",children:w.map((t,f)=>{const d=w.length===1?"single":f===0?"top":f===w.length-1?"bottom":"middle";return e.jsxs("div",{className:`flex w-full ${I?"justify-end":"justify-start"}`,children:[e.jsx(Vs,{author:!I&&f===0?p:void 0,text:t.text,time:t.time,isOwnMessage:I,shape:d}),t.status&&e.jsx("div",{className:`text-[11px] ml-2 ${t.status==="error"?"text-red-500":"text-slate-400"}`,children:t.status==="error"?"Failed":"Sending"})]},t.id)})})]})}function Lr({groups:p}){return e.jsx("div",{className:"flex flex-col gap-5",children:p.map(w=>e.jsxs("div",{className:"flex flex-col gap-3",children:[w.dayLabel&&e.jsx("div",{className:"text-center text-xs uppercase tracking-wide text-slate-400",children:w.dayLabel}),e.jsx(Ar,{author:w.author,avatarInitials:w.avatarInitials,isOwnMessage:w.isOwnMessage,messages:w.messages})]},w.id))})}const Tr=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Er=p=>new Date(p).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),Mr=p=>{const w=p.trim().split(/\s+/);return w.length===1?w[0][0]?.toUpperCase()??"?":`${w[0][0]?.toUpperCase()??""}${w[w.length-1][0]?.toUpperCase()??""}`},Ur=(p,w)=>w?w instanceof Map?w.get(p)??"":w[p]??"":"";function Ir({miniLeagueId:p,memberNames:w}){const{user:I}=Rs(),{messages:r,loading:s,loadingMore:t,hasMore:f,error:d,loadMore:N,sendMessage:v}=kr(p,{userId:I?.id,enabled:!!p}),[a,i]=F.useState(""),[n,o]=F.useState(!1),g=F.useRef(null),C=F.useRef(null),E=F.useRef(null),[j,$]=F.useState(0),U=F.useCallback(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[]),M=F.useCallback((x=[0,100,300,500,700])=>{requestAnimationFrame(()=>{x.forEach(_=>{setTimeout(()=>U(),_)})})},[U]);F.useEffect(()=>{r.length>0&&M([0,150,300])},[r.length,M]),F.useEffect(()=>{!a&&C.current&&(C.current.style.height="auto",C.current.style.height="42px")},[a]);const P=F.useCallback((x,_=[0,100,300,500,700])=>{if(x>0){if($(x),g.current){const b=Math.max(x+(C.current?.offsetHeight||0)+16,80);g.current.style.paddingBottom=`${b}px`}}else $(0),g.current&&(g.current.style.paddingBottom="");M(_)},[M]);F.useEffect(()=>{const x=window.visualViewport;if(!x)return;let _=null,b=0;const A=()=>{_&&(clearTimeout(_),_=null),_=setTimeout(()=>{const D=window.innerHeight,T=x.height,H=x.offsetTop+T,re=D-H;Math.abs(re-b)<10&&re>0||(b=re,P(re))},50)};x.addEventListener("resize",A),x.addEventListener("scroll",A);const m=()=>{setTimeout(A,100),setTimeout(A,300)},u=setTimeout(()=>{C.current&&C.current.addEventListener("focus",m)},100);return A(),()=>{_&&clearTimeout(_),clearTimeout(u),x.removeEventListener("resize",A),x.removeEventListener("scroll",A),C.current&&C.current.removeEventListener("focus",m)}},[P]),F.useEffect(()=>{if(typeof window>"u")return;const x=window.innerHeight,_=()=>{const b=x-window.innerHeight;P(b>0?b:0)};return window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[P]),F.useEffect(()=>{if(!g.current||!E.current)return;const x=E.current.offsetHeight??72;g.current.style.paddingBottom=`${x+24}px`},[]);const h=()=>{const x=window.visualViewport;x&&setTimeout(()=>{const _=window.innerHeight,b=x.height,A=x.offsetTop+b,m=_-A;P(m,[0,200,400,600,800])},100),M([200,400,600])},L=x=>{const _=x.target;!(_.tagName==="A"||_.tagName==="BUTTON"||_.closest("a, button"))&&C.current&&document.activeElement===C.current&&C.current.blur()},l=F.useMemo(()=>{if(!I)return"";const x=I.user_metadata??{};return x.display_name||x.full_name||I.email||""},[I]),c=F.useMemo(()=>{if(!r.length)return[];const x=[];let _=null;return r.forEach(b=>{const A=b.user_id===I?.id,D=Ur(b.user_id,w)||(A?l:"")||(A?"You":"Unknown"),T=A?void 0:Mr(D),re=new Date(b.created_at).toDateString(),K=re!==_;K&&(_=re);const X={id:b.id,text:b.content,time:Tr(b.created_at),status:b.status&&b.status!=="sent"?b.status:void 0},W=x[x.length-1];W&&!K&&W.isOwnMessage===A&&W.author===D?W.messages.push(X):x.push({id:b.id,author:D,avatarInitials:T,isOwnMessage:A,dayLabel:K?Er(b.created_at):void 0,messages:[X]})}),x},[l,w,r,I?.id]),y=F.useCallback(async x=>{if(!p||!I?.id||typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"))return;const b=I.user_metadata?.display_name||I.user_metadata?.full_name||I.email||"User";try{await fetch("/.netlify/functions/notifyLeagueMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:p,senderId:I.id,senderName:b,content:x})})}catch(A){console.error("[MiniLeagueChatBeta] notifyLeagueMessage failed:",A)}},[p,I?.id]),S=F.useCallback(async()=>{const x=a.trim();if(!(!p||!x||n))try{o(!0),await v(x),await y(x),i(""),M([0,150,300])}catch(_){console.error("[MiniLeagueChatBeta] Failed to send message",_)}finally{o(!1)}},[a,p,y,M,v,n]);return e.jsxs("div",{className:"flex flex-col h-full bg-[#f5f6fb] w-full",children:[e.jsxs("div",{ref:g,className:"flex-1 overflow-y-auto px-4 py-5",onClick:L,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:j>0?"0":"auto",cursor:"pointer"},children:[f&&p&&e.jsx("button",{className:"mx-auto mb-2 text-xs font-semibold text-[#1C8376] bg-white px-3 py-1 rounded-full shadow disabled:opacity-40",onClick:N,disabled:t,children:t?"Loading earlier":"Load earlier messages"}),c.length===0&&!s?e.jsx("div",{className:"text-center text-sm text-slate-500 mt-8",children:"Say hi to kick off this chat!"}):e.jsx(Lr,{groups:c})]}),e.jsxs("div",{ref:E,className:"flex-shrink-0 border-t border-slate-200 bg-white px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:j>0?"fixed":"relative",bottom:j>0?`${j}px`:"auto",left:j>0?0:"auto",right:j>0?0:"auto",width:j>0?"100%":"auto",maxWidth:j>0?"440px":"none",marginLeft:j>0?"auto":void 0,marginRight:j>0?"auto":void 0,zIndex:j>0?1e3:"auto"},children:[e.jsxs("div",{className:"flex items-end gap-3 bg-slate-100 rounded-2xl px-3 py-2",children:[e.jsx("textarea",{ref:C,className:"flex-1 bg-transparent resize-none focus:outline-none text-sm text-slate-800 placeholder:text-slate-400",rows:1,value:a,disabled:!p||n,placeholder:p?"Start typing a message":"Join this league to chat",onChange:x=>{i(x.target.value),C.current&&(C.current.style.height="auto",C.current.style.height=`${Math.min(C.current.scrollHeight,120)}px`)},onFocus:h,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),S())},style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),e.jsx("button",{type:"button",onClick:S,disabled:!p||n||!a.trim(),className:"w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-40",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14M12 5l7 7-7 7"})})})]}),d&&e.jsxs("div",{className:"text-xs text-red-500 mt-2 text-center",children:[d,"  try again or switch to the classic chat tab."]})]})]})}const Kt=8;function Fr(p,w){if(p==="FINISHED")return"FT";if(p==="PAUSED")return"HT";if(p==="IN_PLAY"){if(w==null)return"LIVE";if(w>=1&&w<=45)return"First Half";if(w>45&&w<=50)return"45+";if(w>50)return"Second Half"}return"LIVE"}function Ds(p){const w=(p||"?").trim().split(/\s+/);return w.length?w.length===1?w[0].slice(0,1).toUpperCase():(w[0][0]+w[w.length-1][0]).toUpperCase():"?"}function hs(p){return p.result==="H"||p.result==="D"||p.result==="A"?p.result:typeof p.home_goals=="number"&&typeof p.away_goals=="number"?p.home_goals>p.away_goals?"H":p.home_goals<p.away_goals?"A":"D":null}function Yt({letter:p,correct:w,unicorn:I,hasSubmitted:r,isLive:s,isOngoing:t,isFinished:f}){let d;return w===!0?s||t?d="bg-emerald-600 text-white border-emerald-600 animate-pulse shadow-lg shadow-emerald-500/50":f?d="bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 relative overflow-hidden animate-pulse before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s]":d="bg-emerald-600 text-white border-emerald-600":r?d="bg-emerald-600 text-white border-emerald-600":d="bg-slate-100 text-slate-600 border-slate-200",e.jsx("span",{className:["inline-flex items-center justify-center h-5 min-w-[18px] px-1.5","rounded-full border text-[11px] font-semibold mb-0.5","align-middle",d].join(" "),title:I?"Correct!":void 0,children:p})}function Dr({chat:p,userId:w,nameById:I,isMember:r,newMsg:s,setNewMsg:t,onSend:f,leagueCode:d,memberCount:N,maxMembers:v,notificationStatus:a}){const i=F.useRef(null),n=F.useRef(null),o=F.useRef(null),g=F.useRef(null),[C,E]=F.useState(0),j=()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},$=F.useCallback((h=[0,100,300,500,700])=>{requestAnimationFrame(()=>{h.forEach(L=>{setTimeout(()=>j(),L)})})},[]),U=F.useCallback((h,L=[0,100,300,500,700])=>{if(h>0){if(E(h),i.current){const l=Math.max(h+(o.current?.offsetHeight||0)+16,80);i.current.style.paddingBottom=`${l}px`}}else E(0),i.current&&(i.current.style.paddingBottom="");$(L)},[$]);F.useEffect(()=>{p.length>0&&setTimeout(()=>j(),100)},[p.length]),F.useEffect(()=>{!s&&o.current&&(o.current.style.height="auto",o.current.style.height="42px")},[s]),F.useEffect(()=>{const h=window.visualViewport;if(!h)return;let L=null,l=0;const c=()=>{L&&(clearTimeout(L),L=null),L=setTimeout(()=>{const x=window.innerHeight,_=h.height,b=h.offsetTop+_,A=x-b;Math.abs(A-l)<10&&A>0||(l=A,U(A))},50)};h.addEventListener("resize",c),h.addEventListener("scroll",c);const y=()=>{setTimeout(c,100),setTimeout(c,300)},S=setTimeout(()=>{o.current&&o.current.addEventListener("focus",y)},100);return c(),()=>{L&&clearTimeout(L),clearTimeout(S),h.removeEventListener("resize",c),h.removeEventListener("scroll",c),o.current&&o.current.removeEventListener("focus",y)}},[U]);const M=()=>{const h=window.visualViewport;h&&setTimeout(()=>{const L=window.innerHeight,l=h.height,c=h.offsetTop+l,y=L-c;U(y,[0,200,400,600,800])},100),$([200,400,600])};F.useEffect(()=>{if(typeof window>"u")return;const h=window.innerHeight,L=()=>{const l=h-window.innerHeight;U(l>0?l:0)};return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[U]);const P=h=>{const L=h.target;!(L.tagName==="A"||L.tagName==="BUTTON"||L.closest("a, button"))&&o.current&&document.activeElement===o.current&&o.current.blur()};return e.jsxs("div",{className:"flex flex-col chat-container",style:{height:"100%"},children:[e.jsxs("div",{ref:i,className:"flex-1 overflow-y-auto px-3 pt-3 pb-4 min-h-0 messages-container",onClick:P,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:C>0?"0":"auto",cursor:"pointer"},children:[p.map((h,L)=>{const l=h.user_id===w,c=I.get(h.user_id)??"Unknown",y=new Date(h.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),S=p[L-1],x=p[L+1],_=S?.user_id===h.user_id,b=x?.user_id===h.user_id,A=!_,m=!b,u=!_&&!b,D=A&&b,T=_&&m,H=!l&&(u||T),re=c.split(/\s+/).map(W=>W[0]).join("").toUpperCase(),K=l?"flex justify-end":"flex items-end gap-2",X=u?"single":D?"top":T?"bottom":"middle";return e.jsxs("div",{className:K,style:{marginTop:A?24:4},children:[!l&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex justify-center self-end",children:H?e.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs font-semibold text-slate-500",children:re}):e.jsx("div",{className:"w-8 h-8"})}),e.jsx("div",{className:`flex flex-col gap-1 ${l?"items-end":"items-start"}`,children:e.jsx(Vs,{author:!l&&A?c:void 0,text:h.content,time:y,isOwnMessage:l,shape:X})})]},h.id)}),e.jsx("div",{ref:n,style:{height:"1px",width:"100%"}})]}),e.jsxs("div",{ref:g,className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:C>0?"fixed":"relative",bottom:C>0?`${C}px`:"auto",left:C>0?"0":"auto",right:C>0?"0":"auto",width:C>0?"100%":"auto",zIndex:C>0?1e3:"auto"},children:[r?e.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},className:"flex items-center gap-2",children:[e.jsx("textarea",{ref:o,value:s,onChange:h=>{t(h.target.value),o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},onFocus:M,onKeyDown:h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),s.trim()&&f())},placeholder:"Start typing...",maxLength:2e3,rows:1,className:"flex-1 rounded-xl border border-slate-300 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-transparent resize-none overflow-hidden",style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),e.jsx("button",{type:"submit",className:"flex-shrink-0 w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:!s.trim(),style:{backgroundColor:s.trim()?"#1C8376":"#94a3b8"},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})})]}):e.jsx("div",{className:"rounded-md border border-amber-200 bg-amber-50 text-amber-800 p-3 text-sm",children:"Join this league to chat with other members."}),a&&e.jsx("div",{className:`w-full rounded px-2 py-1 text-xs mt-2 ${a.type==="success"?"bg-green-50 text-green-700 border border-green-200":a.type==="warning"?"bg-amber-50 text-amber-700 border border-amber-200":"bg-red-50 text-red-700 border border-red-200"}`,children:a.message})]})]})}function $r(){const{code:p=""}=ir(),{user:w}=Rs(),[I]=F.useState(()=>{const k=localStorage.getItem("oldSchoolMode");return k?JSON.parse(k):!1});F.useEffect(()=>{localStorage.setItem("oldSchoolMode",JSON.stringify(I))},[I]),F.useEffect(()=>{const k=Y=>{const ee=Y.target;(ee.tagName==="INPUT"||ee.tagName==="TEXTAREA")&&setTimeout(()=>{window.scrollTo(0,0);const q=document.querySelector(".league-header-fixed");q&&(q.style.top="0")},100)},z=()=>{const Y=document.querySelector(".league-header-fixed");Y&&(Y.style.top="0")};return document.addEventListener("focusin",k),window.addEventListener("resize",z),window.addEventListener("orientationchange",z),()=>{document.removeEventListener("focusin",k),window.removeEventListener("resize",z),window.removeEventListener("orientationchange",z)}},[]),F.useEffect(()=>{if(typeof window>"u")return;const k=window.visualViewport;if(!k)return;let z=null;const Y=()=>{const q=n.current;if(!q)return;const ne=k.offsetTop??0;q.style.setProperty("transform",`translate3d(0, ${ne}px, 0)`,"important")},ee=()=>{z&&cancelAnimationFrame(z),z=window.requestAnimationFrame(Y)};return ee(),k.addEventListener("resize",ee),k.addEventListener("scroll",ee),()=>{z&&cancelAnimationFrame(z),k.removeEventListener("resize",ee),k.removeEventListener("scroll",ee),n.current&&n.current.style.removeProperty("transform")}},[]);const[r,s]=F.useState(null),[t,f]=F.useState([]),[d,N]=F.useState(!0),[v,a]=F.useState("chat-beta"),i=F.useRef(!1),n=F.useRef(null),[o,g]=F.useState(!1),[C,E]=F.useState(!1),[j,$]=F.useState(!1),[U,M]=F.useState(null),[P,h]=F.useState(null),[L,l]=F.useState(null),[c,y]=F.useState([]),S=F.useRef({}),x=F.useRef(new Map),[_,b]=F.useState(new Set),[A,m]=F.useState(!1),[u,D]=F.useState(!1),[T,H]=F.useState(0),[re,K]=F.useState(!1),[X,W]=F.useState(!1),[R,le]=F.useState(!1),[Ne,we]=F.useState(!1),[be,xe]=F.useState(null),[Ee,Ae]=F.useState(!1),[ut,Ye]=F.useState(!1),[Le,Fe]=F.useState(!1),[_e,ke]=F.useState(!1),[De,Me]=F.useState(!1),[Ue,He]=F.useState(!1),[Ie,je]=F.useState(!1),[Pe,et]=F.useState(null),[pt,Re]=F.useState(!1),[tt,$e]=F.useState(!1),[ze,Ve]=F.useState(null),[st,Ge]=F.useState([]),[rt,jt]=F.useState(""),[ts,qe]=F.useState(null),$t=F.useMemo(()=>!!w?.id&&t.some(k=>k.id===w.id),[w?.id,t]),Qe=F.useMemo(()=>!!w?.id&&!!ze&&ze.id===w.id,[w?.id,ze]),ss=F.useMemo(()=>ze?.name??"League admin",[ze]),nt=F.useMemo(()=>{const k=new Map;return t.forEach(z=>k.set(z.id,z.name)),k},[t]),at=F.useCallback(()=>{if(!r?.code||typeof window>"u"||typeof navigator>"u")return;const k=`Join my mini league "${r.name}" on TotL!`,z=`${window.location.origin}/league/${r.code}`,Y=navigator;if(typeof Y.share=="function"){Y.share({title:`Join ${r.name}`,text:k,url:z}).catch(q=>{console.warn("[League] Share cancelled",q)});return}const ee=`${k}
${z}`;navigator.clipboard?.writeText?navigator.clipboard.writeText(ee).then(()=>window.alert?.("League link copied to clipboard!")).catch(()=>{window.prompt?.("Share this league code:",r.code)}):window.prompt?.("Share this league code:",r.code)},[r]),bt=F.useCallback(async()=>{if(!(!r?.id||!w?.id)){$(!0);try{const{error:k}=await ce.from("league_members").delete().eq("league_id",r.id).eq("user_id",w.id);if(k)throw k;typeof window<"u"&&(window.location.href="/leagues")}catch(k){console.error("[League] Error leaving league:",k),typeof window<"u"&&window.alert?.(k?.message??"Failed to leave league. Please try again.")}finally{$(!1),E(!1)}}},[r?.id,w?.id]),Nt=F.useCallback(async()=>{if(!(!r?.id||!w?.id)){ke(!0);try{if(t.length>=Kt){typeof window<"u"&&window.alert?.("League is full (max 8 members)."),Fe(!1);return}const{error:k}=await ce.from("league_members").insert({league_id:r.id,user_id:w.id});if(k)throw k;typeof window<"u"&&window.location.reload()}catch(k){console.error("[League] Error joining league:",k),typeof window<"u"&&window.alert?.(k?.message??"Failed to join league.")}finally{ke(!1)}}},[r?.id,w?.id,t.length]),Ht=F.useCallback(async()=>{if(!(!Pe||!r?.id||!w?.id)){Re(!0);try{const{error:k}=await ce.from("league_members").delete().eq("league_id",r.id).eq("user_id",Pe.id);if(k)throw k;typeof window<"u"&&window.location.reload()}catch(k){console.error("[League] Error removing member:",k),typeof window<"u"&&window.alert?.(k?.message??"Failed to remove member.")}finally{Re(!1),He(!1),et(null)}}},[r?.id,Pe,w?.id]),ft=F.useCallback(async()=>{if(!(!r?.id||!w?.id)){$e(!0);try{const{error:k}=await ce.from("league_members").delete().eq("league_id",r.id);if(k)throw k;const{error:z}=await ce.from("leagues").delete().eq("id",r.id);if(z)throw z;typeof window<"u"&&(window.location.href="/leagues")}catch(k){console.error("[League] Error ending league:",k),typeof window<"u"&&window.alert?.(k?.message??"Failed to end league.")}finally{$e(!1),je(!1)}}},[r?.id,w?.id]),mt=F.useCallback(async k=>{if(!r?.id||!Qe){xe("Only league admins can upload avatars.");return}if(!new Set(["image/png","image/jpeg","image/jpg","image/webp"]).has(k.type)){xe("Please upload a PNG, JPG, or WebP image.");return}if(k.size>2*1024*1024){xe("Please choose an image smaller than 2MB.");return}xe(null),Ae(!1),we(!0);try{const Y=await Oe(k,{maxSizeMB:.02,maxWidthOrHeight:256,useWebWorker:!0,initialQuality:.8});if(Y.size>20*1024)throw new Error("Compressed image is still larger than 20KB. Try a smaller image.");const q={"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp"}[Y.type]??"jpg",ne=`${r.id}-${Date.now()}.${q}`,{error:V}=await ce.storage.from("league-avatars").upload(ne,Y,{cacheControl:"3600",upsert:!0,contentType:Y.type});if(V)throw V;const{data:de}=ce.storage.from("league-avatars").getPublicUrl(ne),ve=de?.publicUrl;if(!ve)throw new Error("Unable to get public URL for avatar.");const{error:fe}=await ce.from("leagues").update({avatar:ve}).eq("id",r.id);if(fe)throw fe;s(G=>G&&{...G,avatar:ve}),Ae(!0)}catch(Y){console.error("[League] Error uploading avatar:",Y),xe(Y?.message??"Failed to upload avatar. Please try again.")}finally{we(!1)}},[Qe,r?.id]),Js=F.useCallback(async()=>{if(!(!r?.id||!Qe)){xe(null),Ae(!1),we(!0);try{const{error:k}=await ce.from("leagues").update({avatar:null}).eq("id",r.id);if(k)throw k;s(z=>z&&{...z,avatar:null}),Ae(!0)}catch(k){console.error("[League] Error removing avatar:",k),xe(k?.message??"Failed to remove avatar. Please try again.")}finally{we(!1)}}},[Qe,r?.id]),[rs,Qs]=F.useState(new Map);F.useEffect(()=>{(async()=>{const k=new Map,{data:z}=await ce.from("app_fixtures").select("gw, kickoff_time").order("gw",{ascending:!0}),{data:Y}=await ce.from("app_fixtures").select("gw, kickoff_time").eq("gw",1).order("fixture_index",{ascending:!0}),ee=new Map;if(z&&z.forEach(q=>{(!ee.has(q.gw)||q.kickoff_time&&new Date(q.kickoff_time)<new Date(ee.get(q.gw)))&&q.kickoff_time&&ee.set(q.gw,q.kickoff_time)}),Y&&Y.length>0){const q=Y.find(ne=>ne.kickoff_time)?.kickoff_time;if(q){const ne=ee.get(1);(!ne||new Date(q)<new Date(ne))&&ee.set(1,q)}}ee.forEach((q,ne)=>{const V=new Date(q),de=new Date(V.getTime()-4500*1e3);k.set(ne,de)}),Qs(k)})()},[]),F.useEffect(()=>{const k=z=>{const Y=z.target;A&&!Y.closest(".gw-dropdown-container")&&m(!1)};return A&&document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[A]),F.useEffect(()=>{let k=!0;return(async()=>{const{data:z}=await ce.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(!k)return;M(z?.current_gw??null);const{data:Y}=await ce.from("app_gw_results").select("gw").order("gw",{ascending:!1}).limit(1);if(!k)return;h(Y&&Y.length?Y[0].gw:null);const{data:ee}=await ce.from("app_gw_results").select("gw").order("gw",{ascending:!1});if(!k)return;const q=ee?[...new Set(ee.map(V=>V.gw))].sort((V,de)=>de-V):[],ne=z?.current_gw;ne&&!q.includes(ne)&&q.unshift(ne),y(q),q.length>0&&l(q[0])})(),()=>{k=!1}},[]);const ht=F.useMemo(()=>t.map(k=>k.id),[t]),[Se,ps]=F.useState([]),[Mt,ns]=F.useState([]),[as,is]=F.useState([]),[bs,os]=F.useState([]),ws=F.useMemo(()=>!Se||Se.length===0?[]:Se.map(k=>k.api_match_id).filter(k=>k!=null),[Se]),zt=F.useMemo(()=>r?.name==="API Test",[r?.name]),[Ze,vs]=F.useState(null);F.useEffect(()=>{if(!zt){vs(null);return}let k=!0;return(async()=>{const{data:z}=await ce.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();let Y=z?.current_test_gw??1;if(Y&&Y!==1){const{data:ee}=await ce.from("app_fixtures").select("gw").eq("gw",Y).limit(1).maybeSingle();if(!ee){const{data:q}=await ce.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();q&&(Y=1)}}k&&vs(Y)})(),()=>{k=!1}},[zt]);const Zs=F.useMemo(()=>zt&&Ze!==null?Ze:U||L||void 0,[zt,Ze,U,L]),{liveScores:ys}=or(Zs,ws.length>0?ws:void 0),Ke=F.useMemo(()=>{const k={};return!Se||Se.length===0||Se.forEach(z=>{const Y=z.api_match_id;if(Y){const ee=ys.get(Y);ee&&(k[z.fixture_index]={homeScore:ee.home_score??0,awayScore:ee.away_score??0,status:ee.status||"SCHEDULED",minute:ee.minute??null})}}),k},[ys,Se]),[ls,Ut]=F.useState([]),[js,It]=F.useState(!1);F.useEffect(()=>{let k=!0;return(async()=>{N(!0);const{data:z}=await ce.from("leagues").select("id,name,code,created_at").eq("code",p).maybeSingle();if(!k)return;if(!z){s(null),f([]),N(!1);return}s(z);const{data:Y}=await ce.from("league_members").select("users(id,name),created_at").eq("league_id",z.id).order("created_at",{ascending:!0}),ee=Y?.map(V=>({id:V.users.id,name:V.users.name??"(no name)"}))??[],q=[...ee].sort((V,de)=>V.name.localeCompare(de.name));f(q);const ne=ee[0];Ve(ne),w?.id&&!ee.some(V=>V.id===w.id)&&Fe(!0),N(!1)})(),()=>{k=!1}},[p]),F.useEffect(()=>{},[r,v]),F.useEffect(()=>{if(v!=="chat"&&v!=="chat-beta"||!r?.id||!w?.id)return;(async()=>{await ce.from("league_message_reads").upsert({league_id:r.id,user_id:w.id,last_read_at:new Date().toISOString()},{onConflict:"league_id,user_id"})})()},[v,r?.id,w?.id]);const Xs=F.useCallback(async(k,z=!1)=>{const{data:Y,error:ee}=await ce.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",k).order("created_at",{ascending:!1}).limit(500);if(!ee&&Y){const ne=(Y??[]).reverse();z&&console.log("[Chat] Loaded messages:",ne.length,"from database (most recent)"),Ge(V=>{const de=new Set(V.map(ie=>ie.id)),ve=ne.filter(ie=>!de.has(ie.id));if(V.length===0)return z&&console.log("[Chat] Initial load, setting",ne.length,"messages"),ne;const G=[...V,...ve].sort((ie,me)=>new Date(ie.created_at).getTime()-new Date(me.created_at).getTime()),J=G.length>500?G.slice(-500):G;return z&&console.log("[Chat] Merged messages. Previous:",V.length,"New from DB:",ve.length,"Total:",G.length,"After limit:",J.length),J})}else ee&&console.error("[Chat] Error loading messages:",ee)},[]);F.useEffect(()=>{if(!r?.id)return;let k=!0;const z=async()=>{k&&await Xs(r.id,!0)};z();const Y=ce.channel(`league-messages:${r.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${r.id}`},ne=>{const V=ne.new;console.log("[Chat] Realtime message received:",V.id,V.content.substring(0,50)),Ge(de=>{if(de.some(fe=>fe.id===V.id))return console.log("[Chat] Message already exists, skipping"),de;const ve=[...de,V];return console.log("[Chat] Added realtime message. Total messages:",ve.length),ve})}).subscribe(),ee=()=>{!document.hidden&&r?.id&&k&&(console.log("[Chat] App became visible, refetching messages..."),z())},q=()=>{r?.id&&k&&(console.log("[Chat] Window gained focus, refetching messages..."),z())};return document.addEventListener("visibilitychange",ee),window.addEventListener("focus",q),()=>{k=!1,ce.removeChannel(Y),document.removeEventListener("visibilitychange",ee),window.removeEventListener("focus",q)}},[r?.id]);const er=F.useCallback(async()=>{if(!r||!w?.id)return;const k=rt.trim();if(!k)return;jt("");const{data:z,error:Y}=await ce.from("league_messages").insert({league_id:r.id,user_id:w.id,content:k}).select("id, league_id, user_id, content, created_at").single();Y?(console.error(Y),alert("Failed to send message.")):z&&Ge(q=>[...q,z]),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||setTimeout(async()=>{try{const q=w.user_metadata?.display_name||w.email||"User",ne=await fetch("/.netlify/functions/notifyLeagueMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:r.id,senderId:w.id,senderName:q,content:k})}),V=await ne.json().catch(()=>({}));V.ok===!0?V.sent&&V.sent>0?qe({message:` Message sent to ${V.sent} device${V.sent===1?"":"s"}`,type:"success"}):V.message==="No subscribed devices"?qe({message:` No subscribed devices (${V.eligibleRecipients||0} eligible recipient${V.eligibleRecipients===1?"":"s"})`,type:"warning"}):V.message==="No devices"?qe({message:` No devices registered (${V.eligibleRecipients||0} eligible recipient${V.eligibleRecipients===1?"":"s"})`,type:"warning"}):V.message==="No eligible recipients"?qe({message:" All members are currently active",type:"success"}):qe({message:` ${V.message||"Notification sent"}`,type:"success"}):V.ok===!1||V.error?qe({message:` Failed to send notification: ${V.error||"Unknown error"}`,type:"error"}):ne.ok||qe({message:` Notification error (HTTP ${ne.status})`,type:"error"}),setTimeout(()=>qe(null),5e3)}catch(q){console.error("[Chat] Notification exception:",q),qe({message:" Failed to send notification",type:"error"}),setTimeout(()=>qe(null),5e3)}},100)},[r,w,rt,jt,Ge,qe]);F.useEffect(()=>{let k=!0;return(async()=>{const z=r?.name==="API Test";let Y=Ze??1;if(z){const{data:fe}=await ce.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();if(Y=fe?.current_test_gw??1,Y&&Y!==1){const{data:G}=await ce.from("app_fixtures").select("gw").eq("gw",Y).limit(1).maybeSingle();if(G)console.log("[League] Using current_test_gw from meta:",Y);else{const{data:J}=await ce.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();J&&(Y=1,console.log("[League] No fixtures for current_test_gw, falling back to GW T1"))}}else console.log("[League] Using GW T1 or current_test_gw:",Y)}const ee=z&&(v==="gw"||v==="gwr");console.log("[League] Data fetch:",{isApiTestLeague:z,tab:v,useTestFixtures:ee,leagueName:r?.name,testGwForData:Y,willUseTestTables:ee,willUseMainTables:!ee});let q=v==="gwr"?U||L:U;if(z&&(v==="gw"||v==="gwr")&&(q=Y),v==="gw"&&!z&&ht.length>0){const{data:fe}=await ce.from("app_gw_submissions").select("gw").in("user_id",ht).not("submitted_at","is",null).order("gw",{ascending:!1}).limit(10);if(fe&&fe.length>0){const G=[...new Set(fe.map(J=>J.gw))].sort((J,ie)=>(ie||0)-(J||0));for(const J of G)if(J){const{data:ie}=await ce.from("app_fixtures").select("gw").eq("gw",J).limit(1);if(ie&&ie.length>0){console.log("[League] Found fixtures for GW",J,"from submissions - using this GW (currentGw was",q,")"),q=J;break}}}!q&&U&&(q=U,console.log("[League] Using currentGw as fallback:",U))}if(console.log("[League] gwForData:",q,"memberIds:",ht),!q&&!ee){ps([]),ns([]),is([]),os([]);return}let ne;if(ee){const{data:fe}=await ce.from("app_fixtures").select("id,test_gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,home_crest,away_crest,kickoff_time,api_match_id").eq("test_gw",Y).order("fixture_index",{ascending:!0});ne=fe?.map(G=>({...G,gw:G.test_gw}))||null}else{console.log("[League] Fetching from MAIN database table (app_fixtures) for regular league, GW:",q);const{data:fe}=await ce.from("app_fixtures").select("id,gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,kickoff_time,api_match_id").eq("gw",q).order("fixture_index",{ascending:!0});ne=fe||null,console.log("[League] Fetched fixtures from main database:",fe?.length||0,"fixtures")}if(!k)return;if(ps(ne??[]),!ht.length){ns([]),is([]),os([]);return}let V=null,de;if(ee){const{data:fe}=await ce.from("app_picks").select("user_id,matchday,fixture_index,pick").eq("matchday",Y).in("user_id",ht);V=fe?.map(O=>({...O,gw:O.matchday}))||null;const{data:G,error:J}=await ce.from("app_gw_submissions").select("user_id,matchday,submitted_at").eq("matchday",Y).not("submitted_at","is",null).in("user_id",ht);J&&console.error("Error fetching test_api_submissions:",J);const{data:ie}=await ce.from("app_fixtures").select("fixture_index,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",Y).order("fixture_index",{ascending:!0}),me=new Set((ie||[]).map(O=>O.fixture_index));console.log("[League] Current fixture indices from test_api_fixtures:",Array.from(me)),console.log("[League] Current fixtures:",ie?.map(O=>({index:O.fixture_index,home:O.home_team,away:O.away_team})));const B=[];if(G&&V&&ie){const O=me.size;console.log("[League] Required fixture count for valid submission:",O);const Z=(ie||[]).map(Q=>Q.kickoff_time?new Date(Q.kickoff_time):null).filter(Q=>Q!==null&&!isNaN(Q.getTime())),se=Z.length>0?new Date(Math.min(...Z.map(Q=>Q.getTime()))):null,he=new Date("2025-11-18T00:00:00Z");console.log("[League] Submission cutoff date (submissions before this are old):",he.toISOString()),console.log("[League] Earliest kickoff:",se?.toISOString()),G.forEach(Q=>{const ge=(V||[]).filter(Ce=>Ce.user_id===Q.user_id&&Ce.matchday===Y),pe=ge.filter(Ce=>me.has(Ce.fixture_index)),ue=pe.length===O&&O>0,te=new Set(pe.map(Ce=>Ce.fixture_index)),ae=te.size===O,Te=Q.submitted_at?new Date(Q.submitted_at):null,oe=Te&&Te>=he;if(ue&&ae&&oe)B.push(Q),console.log("[League]  VALID submission (has picks for ALL current fixtures AND recent submission):",{user_id:Q.user_id,submitted_at:Q.submitted_at,submissionDate:Te?.toISOString(),cutoffDate:he.toISOString(),picksCount:ge.length,picksForCurrentFixtures:pe.length,uniqueIndices:te.size,requiredCount:O});else{const Ce=[];ue||Ce.push("missing picks"),ae||Ce.push("duplicate/extra picks"),oe||Ce.push(`old submission (${Te?.toISOString()} < ${he.toISOString()})`),console.log("[League]  INVALID submission:",{user_id:Q.user_id,submitted_at:Q.submitted_at,submissionDate:Te?.toISOString(),cutoffDate:he.toISOString(),picksCount:ge.length,picksForCurrentFixtures:pe.length,uniqueIndices:te.size,requiredCount:O,hasAllRequired:ue,hasExactMatch:ae,isRecent:oe,reason:Ce.join(", ")})}})}de=B.map(O=>({...O,gw:O.matchday}))||null,console.log("[League] Test API submissions fetched (filtered to only current fixtures):",de),console.log("[League] Valid submissions count:",B.length,"out of",G?.length||0,"total")}else{console.log("[League] Fetching from MAIN database tables (picks, gw_submissions) for regular league");const{data:fe}=await ce.from("app_picks").select("user_id,gw,fixture_index,pick").eq("gw",q).in("user_id",ht);V=fe,console.log("[League] Fetched picks from main database:",fe?.length||0,"picks");const{data:G}=await ce.from("app_gw_submissions").select("user_id,gw,submitted_at").eq("gw",q).in("user_id",ht);de=G,console.log("[League] Fetched submissions from main database:",G?.length||0,"submissions")}if(!k)return;ns(V??[]),is(de??[]);const{data:ve}=await ce.from("app_gw_results").select("gw,fixture_index,result").eq("gw",ee?1:q||0);k&&os(ve??[])})(),()=>{k=!1}},[v,U,P,L,ht]),F.useEffect(()=>{S.current=Ke},[Ke]);const We=F.useMemo(()=>{const k=new Map;return console.log("[League] Building submittedMap from subs:",as),as.forEach(z=>{if(z.submitted_at){const Y=`${z.user_id}:${z.gw}`;console.log(`[League] Adding submission key: ${Y}`,z),k.set(Y,!0)}else console.log("[League] Skipping submission with null submitted_at:",z)}),console.log("[League] Final submittedMap:",Array.from(k.entries())),k},[as]),Bt=F.useCallback(k=>k.map(z=>({user_id:z.id,name:z.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]})),[]);F.useEffect(()=>{const k=ce.channel("gw-results-changes").on("postgres_changes",{event:"*",schema:"public",table:"gw_results"},()=>{H(z=>z+1)}).subscribe();return()=>{ce.removeChannel(k)}},[]),F.useEffect(()=>{let k=!0;return(async()=>{if(!t.length){Ut([]);return}if(r?.name==="API Test"){Ut(Bt(t)),It(!1);return}if(U===null)return;It(!0);const{data:z}=await ce.from("gw_results").select("gw,fixture_index,result"),Y=z??[],ee=new Map;if(Y.forEach(Q=>{const ge=hs(Q);ge&&ee.set(`${Q.gw}:${Q.fixture_index}`,ge)}),ee.size===0){Ut(Bt(t)),It(!1);return}const q=[...new Set(Array.from(ee.keys()).map(Q=>parseInt(Q.split(":")[0],10)))].sort((Q,ge)=>Q-ge),ne=["Prem Predictions","FC Football","Easy League"],V=["The Bird league"],de=await lr(r,U),ve=q.filter(Q=>Q>=de);if(!ne.includes(r?.name||"")&&!V.includes(r?.name||"")&&ve.length===0){Ut(Bt(t)),It(!1);return}const{data:fe}=await ce.from("picks").select("user_id,gw,fixture_index,pick").in("user_id",t.map(Q=>Q.id)).in("gw",ve),G=fe??[],J=new Map;ve.forEach(Q=>{const ge=new Map;t.forEach(pe=>ge.set(pe.id,{user_id:pe.id,score:0,unicorns:0})),J.set(Q,ge)}),ve.forEach(Q=>{Array.from(ee.entries()).filter(([pe])=>parseInt(pe.split(":")[0],10)===Q).map(([pe,ue])=>({idx:parseInt(pe.split(":")[1],10),out:ue})).forEach(({idx:pe,out:ue})=>{const te=G.filter(oe=>oe.gw===Q&&oe.fixture_index===pe),ae=te.filter(oe=>oe.pick===ue).map(oe=>oe.user_id),Te=J.get(Q);if(te.forEach(oe=>{if(oe.pick===ue){const Ce=Te.get(oe.user_id);Ce.score+=1}}),ae.length===1&&t.length>=3){const oe=ae[0],Ce=Te.get(oe);Ce.unicorns+=1}})});const ie=new Map,me=new Map,B=new Map,O=new Map,Z=new Map,se=new Map;t.forEach(Q=>{ie.set(Q.id,0),me.set(Q.id,0),B.set(Q.id,0),O.set(Q.id,0),Z.set(Q.id,0),se.set(Q.id,[])}),ve.forEach(Q=>{const ge=Array.from(J.get(Q).values());if(ge.forEach(te=>{me.set(te.user_id,(me.get(te.user_id)??0)+te.score),B.set(te.user_id,(B.get(te.user_id)??0)+te.unicorns)}),ge.sort((te,ae)=>ae.score-te.score||ae.unicorns-te.unicorns),!ge.length)return;const pe=ge[0],ue=ge.filter(te=>te.score===pe.score&&te.unicorns===pe.unicorns);ue.length===1?(ie.set(pe.user_id,(ie.get(pe.user_id)??0)+3),O.set(pe.user_id,(O.get(pe.user_id)??0)+1),se.get(pe.user_id).push("W"),ge.slice(1).forEach(te=>se.get(te.user_id).push("L"))):(ue.forEach(te=>{ie.set(te.user_id,(ie.get(te.user_id)??0)+1),Z.set(te.user_id,(Z.get(te.user_id)??0)+1),se.get(te.user_id).push("D")}),ge.filter(te=>!ue.find(ae=>ae.user_id===te.user_id)).forEach(te=>se.get(te.user_id).push("L")))});const he=t.map(Q=>({user_id:Q.id,name:Q.name,mltPts:ie.get(Q.id)??0,ocp:me.get(Q.id)??0,unicorns:B.get(Q.id)??0,wins:O.get(Q.id)??0,draws:Z.get(Q.id)??0,form:se.get(Q.id)??[]}));he.sort((Q,ge)=>ge.mltPts-Q.mltPts||ge.unicorns-Q.unicorns||ge.ocp-Q.ocp||Q.name.localeCompare(ge.name)),k&&(Ut(he),It(!1))})(),()=>{k=!1}},[t,r,U,Bt,T]);function tr(){const k=V=>{const de=V.slice(-5),ve=5-de.length;return e.jsxs("div",{className:"flex items-center justify-between w-full",children:[Array.from({length:ve}).map((fe,G)=>e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-200"},`dot-${G}`)),de.map((fe,G)=>e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold ${fe==="W"?"bg-green-100 text-green-700":fe==="D"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:fe},G))]})},z=["Prem Predictions","FC Football","Easy League"],Y=["The Bird league"],ee=["gregVjofVcarl","Let Down"],q=r&&!z.includes(r.name)&&!Y.includes(r.name)&&!ee.includes(r.name),ne=ls.length?ls:t.map(V=>({user_id:V.id,name:V.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]}));return t.length===1?e.jsxs("div",{className:"text-center p-8 bg-white rounded-xl border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-6xl mb-4",children:""}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Invite at least one more user to make the ML start"}),e.jsx("p",{className:"text-slate-600 mb-4",children:"Share your league code with friends to get the competition going!"}),e.jsx("button",{onClick:()=>Ye(!0),className:"px-4 py-2 bg-[#1C8376] text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors",children:"Share League Code"})]}):e.jsxs("div",{className:"pt-4",children:[e.jsx("style",{children:`
          .mlt-table tbody tr:last-child {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table tbody tr:last-child td {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table tbody tr:last-child th {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table {
            border-bottom: none !important;
          }
          .mlt-table tbody {
            border-bottom: none !important;
          }
          .mlt-table-container {
            border-bottom: none !important;
          }
          .mlt-table-container table {
            border-bottom: none !important;
          }
          .mlt-table-container tbody {
            border-bottom: none !important;
          }
          .mlt-table-container tbody tr:last-child {
            border-bottom: none !important;
            border: none !important;
          }
          .mlt-table-container tbody tr:last-child td {
            border-bottom: none !important;
            border: none !important;
          }
        `}),e.jsx("div",{className:"mlt-table-container overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x bg-slate-50",style:{backgroundColor:"#f8fafc",borderBottom:"none",boxShadow:"none"},children:e.jsxs("table",{className:"mlt-table w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc",border:"none",borderBottom:"none"},children:[e.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[e.jsx("th",{className:"py-3 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),e.jsx("th",{className:"py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:"Player"}),o?e.jsx("th",{className:"px-4 py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8"},children:"Form"}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"W"}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"D"}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:q?"CP":"OCP"}),t.length>=3&&e.jsx("th",{className:"py-3 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""}),e.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"PTS"})]})]})}),e.jsxs("tbody",{children:[ne.map((V,de)=>{const ve=V.user_id===w?.id,fe=de===ne.length-1;return e.jsxs("tr",{className:ve?"flash-user-row":"",style:{position:"relative",backgroundColor:"#f8fafc",...fe?{}:{borderBottom:"1px solid #e2e8f0"}},children:[e.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:de+1}),e.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:V.name}),o?e.jsx("td",{className:"px-4 py-4",style:{backgroundColor:"#f8fafc"},children:k(V.form)}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:V.wins}),e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:V.draws}),e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:V.ocp}),t.length>=3&&e.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:V.unicorns}),e.jsx("td",{className:"py-4 text-center tabular-nums font-bold",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:V.mltPts})]})]},V.user_id)}),js&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:o?3:t.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"Calculating"})}),!js&&!ls.length&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:o?3:t.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"No gameweeks completed yet  this will populate after the first results are saved."})})]})]})}),e.jsx("div",{className:"mt-6 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-0.5 shadow-sm border border-slate-200",children:[e.jsx("button",{onClick:()=>g(!1),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${o?"text-slate-600 hover:text-slate-900 hover:bg-white/50":"bg-[#1C8376] text-white shadow-sm"}`,children:"Points"}),e.jsx("button",{onClick:()=>g(!0),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${o?"bg-[#1C8376] text-white shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:"Form"})]}),e.jsxs("button",{onClick:()=>{console.log("Button clicked, setting modal to true"),K(!0)},className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[e.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),e.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),r?.name==="API Test"&&e.jsx("div",{className:"mt-4",style:{marginLeft:"-1rem",marginRight:"-1rem",width:"calc(100% + 2rem)",paddingLeft:0,paddingRight:0},children:e.jsx("video",{src:"/assets/Animation/Unicorn_Small.mov",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"auto",display:"block",padding:0,margin:0}})})]})}function sr(){const k=r?.name==="API Test"?Ze??1:U;if(!k)return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No current game week available."});if(!Ts(r,k,rs))return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Predictions Available"}),e.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),e.jsxs("div",{className:"text-sm",children:["GW",k," predictions are not included in this league."]})]})});const z=new Map;bs.forEach(B=>{if(B.gw!==k)return;const O=hs(B);O&&z.set(B.fixture_index,O)}),Se.forEach(B=>{if(B.gw!==k)return;const O=Ke[B.fixture_index];O&&(O.status==="IN_PLAY"||O.status==="PAUSED"||O.status==="FINISHED")&&(O.homeScore>O.awayScore?z.set(B.fixture_index,"H"):O.awayScore>O.homeScore?z.set(B.fixture_index,"A"):z.set(B.fixture_index,"D"))});const Y=F.useMemo(()=>{const B=se=>{if(!se)return"Fixtures";const he=new Date(se);return isNaN(he.getTime())?"Fixtures":he.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})},O=new Map;Se.filter(se=>se.gw===k).forEach(se=>{const he=B(se.kickoff_time),Q=se.kickoff_time?new Date(se.kickoff_time).getTime():Number.MAX_SAFE_INTEGER;O.has(he)||O.set(he,{label:he,key:Q,items:[]}),O.get(he).items.push(se)});const Z=Array.from(O.values());return Z.forEach(se=>se.items.sort((he,Q)=>he.fixture_index-Q.fixture_index)),Z.sort((se,he)=>se.key-he.key),Z},[Se,k]),ee=new Set(Se.filter(B=>B.gw===k).map(B=>B.fixture_index)),q=r?.name==="API Test",ne=t.length>0&&t.every(B=>We.get(`${B.id}:${k}`));if(q&&k===(Ze??1)){console.log("[League] API Test filtering:",{currentFixtureIndices:Array.from(ee),totalPicks:Mt.length,picksForGw:Mt.filter(O=>O.gw===k).length,submittedMapSize:We.size,allSubmitted:ne,members:t.map(O=>({id:O.id,name:O.name,submitted:We.get(`${O.id}:${k}`)})),fixturesCount:Se.filter(O=>O.gw===k).length});const B=Mt.filter(O=>O.gw===k);console.log(`[League] All picks for GW${k}:`,B.map(O=>({user_id:O.user_id,userName:t.find(Z=>Z.id===O.user_id)?.name,fixture_index:O.fixture_index,pick:O.pick,hasSubmitted:!!We.get(`${O.user_id}:${k}`),inCurrentFixtures:ee.has(O.fixture_index)})))}const V=new Map;!q||ne?Mt.forEach(B=>{if(B.gw!==k)return;if(q&&!We.get(`${B.user_id}:${k}`)){k===1&&console.log("[League] API Test: Filtering out unsubmitted pick:",{user_id:B.user_id,fixture_index:B.fixture_index,userName:t.find(se=>se.id===B.user_id)?.name});return}if(!ee.has(B.fixture_index)){q&&k===1&&console.log("[League] Filtering out old pick (not in current fixtures):",{fixture_index:B.fixture_index,currentIndices:Array.from(ee),userName:t.find(Z=>Z.id===B.user_id)?.name});return}const O=V.get(B.fixture_index)??[];O.push(B),V.set(B.fixture_index,O)}):console.log("[League] API Test: Not all submitted - skipping ALL picks processing. allSubmitted=",ne);const de=P!==null&&P>=k,ve=t.filter(B=>!We.get(`${B.id}:${k}`)).length,fe=t.filter(B=>!We.get(`${B.id}:${k}`)).map(B=>B.name),G=rs.get(k),J=G?new Date>=G:!1;if(q&&k===1){const B=t.map(se=>{const he=`${se.id}:${k}`,Q=We.get(he);return{id:se.id,name:se.name,submitted:!!Q,key:he}});console.log(`[League] ===== API Test GW${k} SUBMISSION CHECK =====`),console.log("[League] All submitted:",ne),console.log("[League] Remaining:",ve),console.log("[League] Who didn't submit:",fe),console.log("[League] Member submission status:",B),console.log("[League] Submitted map entries:",Array.from(We.entries())),console.log("[League] ================================================");const O=t.find(se=>se.name.toLowerCase().includes("steve")||se.name.toLowerCase().includes("s")),Z=t.find(se=>se.name.toLowerCase().includes("jof")||se.name.toLowerCase().includes("j"));if(O){const se=`${O.id}:${k}`;console.log(`[League] STEVE (${O.name}):`,{id:O.id,submitted:!!We.get(se),key:se})}if(Z){const se=`${Z.id}:${k}`;console.log(`[League] JOF (${Z.name}):`,{id:Z.id,submitted:!!We.get(se),key:se})}}console.log(`GW${k} deadline check:`,{gwDeadline:G,now:new Date,deadlinePassed:J,allSubmitted:ne,willShowPredictions:ne||J});const ie=q?!ne:!ne&&!J;return(q?!ne:!ne&&!J)?(console.log(`[League] Not all submitted, showing ONLY "Who's submitted" view. Blocking all predictions/fixtures.`,{isApiTestLeague:q,allSubmitted:ne,deadlinePassed:J,remaining:ve}),e.jsxs("div",{className:"mt-2 pt-2",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700",children:e.jsxs(e.Fragment,{children:["Waiting for ",e.jsx("span",{className:"font-semibold",children:ve})," of ",t.length," to submit."]})}),e.jsxs("button",{onClick:()=>{const B=`Game Week ${k} Predictions Reminder!

DEADLINE: THIS ${(()=>{const Z=new Date(Se.find(Te=>Te.gw===k)?.kickoff_time||""),se=new Date(Z.getTime()-4500*1e3),he=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],Q=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],ge=he[se.getUTCDay()],pe=se.getUTCDate(),ue=Q[se.getUTCMonth()],te=se.getUTCHours().toString().padStart(2,"0"),ae=se.getUTCMinutes().toString().padStart(2,"0");return`${ge} ${pe} ${ue}, ${te}:${ae} BST`})()}

Don't forget!
playtotl.com`,O=`https://wa.me/?text=${encodeURIComponent(B)}`;try{window.open(O,"_blank")}catch{navigator.clipboard.writeText(B).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+B)})}},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),(()=>{const B=Se.map(oe=>oe.kickoff_time).filter(oe=>!!oe).map(oe=>new Date(oe)).filter(oe=>!isNaN(oe.getTime()));if(B.length===0)return null;const O=new Date(Math.min(...B.map(oe=>oe.getTime()))),Z=new Date(O.getTime()-4500*1e3),se=new Date>=Z,he=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ge=he[Z.getUTCDay()],pe=Z.getUTCDate(),ue=Q[Z.getUTCMonth()],te=Z.getUTCHours().toString().padStart(2,"0"),ae=Z.getUTCMinutes().toString().padStart(2,"0"),Te=`${ge} ${pe} ${ue}, ${te}:${ae} BST`;return e.jsxs("div",{className:`mb-3 text-xs font-medium ${se?"text-orange-600":"text-slate-600"} flex items-center gap-1.5`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),se?"Deadline Passed: ":"Deadline: ",Te]})})(),e.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white",children:e.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),e.jsx("tbody",{children:t.slice().sort((B,O)=>B.name.localeCompare(O.name)).map(B=>{const O=`${B.id}:${k}`,Z=!!We.get(O);return e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:B.name}),e.jsx("td",{className:"px-4 py-3",children:Z?e.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2.5 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submitted"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2.5 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Not yet"]})})]},B.id)})})]})})]})):e.jsxs("div",{className:"mt-2 pt-2",children:[ie?e.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-700",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsx("div",{children:ne?e.jsxs(e.Fragment,{children:["All ",t.length," members have submitted."]}):e.jsxs(e.Fragment,{children:["Waiting for ",e.jsx("span",{className:"font-semibold",children:ve})," of ",t.length," to submit."]})}),!ne&&e.jsxs("button",{onClick:()=>{const B=`Game Week ${k} Predictions Reminder!

DEADLINE: THIS ${(()=>{const Z=new Date(Se.find(Te=>Te.gw===k)?.kickoff_time||""),se=new Date(Z.getTime()-4500*1e3),he=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],Q=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],ge=he[se.getUTCDay()],pe=se.getUTCDate(),ue=Q[se.getUTCMonth()],te=se.getUTCHours().toString().padStart(2,"0"),ae=se.getUTCMinutes().toString().padStart(2,"0");return`${ge} ${pe} ${ue}, ${te}:${ae} BST`})()}

Don't forget!
playtotl.com`,O=`https://wa.me/?text=${encodeURIComponent(B)}`;try{window.open(O,"_blank")}catch{navigator.clipboard.writeText(B).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+B)})}},className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),(()=>{const B=Se.map(oe=>oe.kickoff_time).filter(oe=>!!oe).map(oe=>new Date(oe)).filter(oe=>!isNaN(oe.getTime()));if(B.length===0)return null;const O=new Date(Math.min(...B.map(oe=>oe.getTime()))),Z=new Date(O.getTime()-4500*1e3),se=new Date>=Z,he=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Q=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ge=he[Z.getUTCDay()],pe=Z.getUTCDate(),ue=Q[Z.getUTCMonth()],te=Z.getUTCHours().toString().padStart(2,"0"),ae=Z.getUTCMinutes().toString().padStart(2,"0"),Te=`${ge} ${pe} ${ue}, ${te}:${ae} BST`;return e.jsxs("div",{className:`mb-3 text-sm ${se?"text-orange-600 font-semibold":"text-slate-600"}`,children:[se?" Deadline Passed: ":" Deadline: ",Te]})})(),e.jsx("div",{className:"overflow-hidden rounded-lg border",children:e.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),e.jsx("tbody",{children:t.slice().sort((B,O)=>B.name.localeCompare(O.name)).map(B=>{const O=`${B.id}:${k}`,Z=!!We.get(O);return B.name==="Jof"&&console.log(`Checking Jof submission: key=${O}, submitted=${Z}, submittedMap has:`,We.has(O),"picksGw=",k),e.jsxs("tr",{className:"border-t border-slate-200",children:[e.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:B.name}),e.jsx("td",{className:"px-4 py-3",children:Z?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:" Submitted"}):e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:" Not yet"})})]},B.id)})})]})})]}):null,r?.name==="API Test"&&ne&&Y.length>0&&!ie&&(()=>{const B=Y.flatMap(ue=>ue.items),O=new Set(B.map(ue=>ue.fixture_index)),Z={};Object.keys(Ke).forEach(ue=>{const te=parseInt(ue,10);O.has(te)&&(Z[te]=Ke[te])});const se=Z,he=B.some(ue=>{const te=se[ue.fixture_index];return te&&(te.status==="IN_PLAY"||te.status==="PAUSED")}),Q=B.length>0&&B.every(ue=>{const te=se[ue.fixture_index];return te&&te.status==="FINISHED"}),ge=he||Q||B.some(ue=>se[ue.fixture_index]);let pe=0;return w?.id&&B.forEach(ue=>{const te=se[ue.fixture_index],ae=te&&(te.status==="IN_PLAY"||te.status==="PAUSED"),Te=te&&te.status==="FINISHED";if(te&&(ae||Te)){const Ce=(V.get(ue.fixture_index)??[]).find(it=>it.user_id===w.id);if(Ce){let it=!1;(Ce.pick==="H"&&te.homeScore>te.awayScore||Ce.pick==="A"&&te.awayScore>te.homeScore||Ce.pick==="D"&&te.homeScore===te.awayScore)&&(it=!0),it&&pe++}}}),e.jsx("div",{className:"mt-3 space-y-6",children:Y.map((ue,te)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-slate-700 font-normal text-lg",children:ue.label}),te===0&&e.jsxs(e.Fragment,{children:[he&&(()=>{const ae=B.length;return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-600 text-white text-sm font-bold border border-red-700 shadow-sm",style:{marginTop:"-2px"},children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"Live"}),e.jsxs("span",{className:"flex items-baseline gap-0.5",children:[e.jsx("span",{className:"text-base sm:text-lg font-extrabold",children:pe}),e.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"/"}),e.jsx("span",{className:"text-sm sm:text-base font-semibold opacity-80",children:ae})]})]})})(),Q&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),!ge&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"})]})]}),e.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:e.jsxs("ul",{children:[ue.items.map((ae,Te)=>{try{const oe=ae.home_code||ae.home_team||ae.home_name||"",Ce=ae.away_code||ae.away_team||ae.away_name||"",it=Es(oe)||"Home",Ft=Es(Ce)||"Away",At=ae.home_code||"",_t=ae.away_code||"",kt=ae.home_crest||(At?`/assets/badges/${At.toUpperCase()}.png`:Ms(ae.home_team||ae.home_name||it||"")),gt=ae.away_crest||(_t?`/assets/badges/${_t.toUpperCase()}.png`:Ms(ae.away_team||ae.away_name||Ft||""));Te===0&&console.log("[League] Badge paths for first fixture:",{homeCode:At,awayCode:_t,homeBadgeSrc:kt,awayBadgeSrc:gt,fixture:ae});const Rt=(vt=>{if(!vt)return"";const Xe=new Date(vt);if(isNaN(Xe.getTime()))return"";const ot=String(Xe.getUTCHours()).padStart(2,"0"),cs=String(Xe.getUTCMinutes()).padStart(2,"0");return`${ot}:${cs}`})(ae.kickoff_time),Lt=ae.fixture_index,Pt=V.get(Lt)??[],ye=se[Lt],ct=ye&&ye.status==="IN_PLAY",xt=ye&&(ye.status==="PAUSED"||ye.status==="HALF_TIME"||ye.status==="HT"),wt=ye&&ye.status==="FINISHED",St=ct||xt,Tt=vt=>{const Xe=Pt.filter(yt=>yt.pick===vt);let ot=null;r?.name==="API Test"?ye&&(ye.homeScore>ye.awayScore?ot="H":ye.awayScore>ye.homeScore?ot="A":ye.homeScore===ye.awayScore&&(ot="D")):ot=z.get(Lt)||null;const cs=Pt.length===t.length&&Xe.length===t.length,Ns=4,_s=[];for(let yt=0;yt<Xe.length;yt+=Ns){const ds=Xe.slice(yt,yt+Ns);_s.push(ds)}return e.jsx("div",{className:"flex flex-col gap-1",children:_s.map((yt,ds)=>e.jsx("div",{className:"flex items-center justify-center",children:yt.map((Wt,ks)=>{const nr=t.find(As=>As.id===Wt.user_id),Ss=Ds(nr?.name??"?"),Cs=We.has(`${Wt.user_id}:${k}`),Ot=ot&&ot===vt?!0:null;return cs?e.jsx("span",{className:"inline-block",style:{marginLeft:ks>0?"-8px":"0",position:"relative",zIndex:ks},children:e.jsx(Yt,{letter:Ss,correct:Ot,unicorn:Ot===!0,hasSubmitted:Cs,isLive:ct,isOngoing:St,isFinished:wt})},Wt.user_id):e.jsx(Yt,{letter:Ss,correct:Ot,unicorn:Ot===!0,hasSubmitted:Cs,isLive:ct,isOngoing:St,isFinished:wt},Wt.user_id)})},ds))})};return e.jsx("li",{className:Te>0?"border-t":"",children:e.jsxs("div",{className:"p-4 bg-white relative",children:[(ct||xt)&&e.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-bold text-red-600",children:"LIVE"})]}),wt&&!ct&&!xt&&e.jsx("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:e.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"FT"})}),e.jsxs("div",{className:`grid grid-cols-3 items-center ${St?"pt-4":""}`,children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:it})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Gt,{code:ae.home_code||void 0,crest:ae.home_crest||void 0,size:24,className:"h-6 w-6"}),e.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:ye&&(ct||xt||wt)?e.jsxs("span",{className:"font-bold text-base text-slate-900",children:[ye.homeScore," - ",ye.awayScore]}):e.jsx("span",{children:Rt})}),e.jsx(Gt,{code:ae.away_code||void 0,crest:ae.away_crest||void 0,size:24,className:"h-6 w-6"})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:Ft})})]}),ye&&(St||wt)&&e.jsx("div",{className:"flex justify-center mt-1",children:e.jsx("span",{className:`text-[10px] font-semibold ${St?"text-red-600":"text-slate-500"}`,children:Fr(ye.status,ye.minute)})}),e.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:Tt("H")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:Tt("D")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:Tt("A")})})]})]})},`${ae.gw}-${ae.fixture_index}`)}catch(oe){return console.error("Error rendering fixture:",oe,ae),e.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",ae.fixture_index]},`${ae.gw}-${ae.fixture_index}`)}}),!ue.items.length&&e.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]},te))})})(),Y.length>0&&r?.name!=="API Test"&&e.jsx("div",{className:"mt-3 space-y-6",children:Y.map((B,O)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"text-slate-700 font-normal text-lg",children:B.label}),O===0&&ne&&de&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),O===0&&ne&&!de&&e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),O===0&&J&&!ne&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-orange-100 text-orange-800 text-sm font-bold border border-orange-300 shadow-sm",style:{marginTop:"-2px"},children:["Deadline Passed ",fe.length>0&&`(${fe.join(", ")} didn't submit)`]})]}),e.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:e.jsxs("ul",{children:[B.items.map((Z,se)=>{try{const he=Z.home_name||Z.home_team||"Home",Q=Z.away_name||Z.away_team||"Away",ge=Z.home_code||"",pe=Z.away_code||"",te=(kt=>{if(!kt)return"";const gt=new Date(kt);if(isNaN(gt.getTime()))return"";const Dt=String(gt.getUTCHours()).padStart(2,"0"),Rt=String(gt.getUTCMinutes()).padStart(2,"0");return`${Dt}:${Rt}`})(Z.kickoff_time),ae=Z.fixture_index,Te=V.get(ae)??[],oe=Ke[ae],Ce=oe&&oe.status==="IN_PLAY",it=oe&&(oe.status==="PAUSED"||oe.status==="HALF_TIME"||oe.status==="HT"),Ft=oe&&oe.status==="FINISHED",At=Ce||it,_t=kt=>{const gt=Te.filter(ye=>ye.pick===kt),Dt=z.get(ae),Rt=Te.length===t.length&&gt.length===t.length,Lt=4,Pt=[];for(let ye=0;ye<gt.length;ye+=Lt){const ct=gt.slice(ye,ye+Lt);Pt.push(ct)}return e.jsx("div",{className:"flex flex-col gap-1",children:Pt.map((ye,ct)=>e.jsx("div",{className:"flex items-center justify-center",children:ye.map((xt,wt)=>{const St=t.find(ot=>ot.id===xt.user_id),Tt=Ds(St?.name??"?"),vt=We.has(`${xt.user_id}:${k}`),Xe=Dt&&Dt===kt?!0:null;return Rt?e.jsx("span",{className:"inline-block",style:{marginLeft:wt>0?"-8px":"0",position:"relative",zIndex:wt},children:e.jsx(Yt,{letter:Tt,correct:Xe,unicorn:Xe===!0,hasSubmitted:vt,isLive:Ce,isOngoing:At,isFinished:Ft})},xt.user_id):e.jsx(Yt,{letter:Tt,correct:Xe,unicorn:Xe===!0,hasSubmitted:vt,isLive:Ce,isOngoing:At,isFinished:Ft},xt.user_id)})},ct))})};return e.jsx("li",{className:se>0?"border-t":"",children:e.jsxs("div",{className:"p-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-3 items-center",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:he})}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Gt,{code:Z.home_code||ge||null,crest:Z.home_crest||null,size:24}),e.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:te}),e.jsx(Gt,{code:Z.away_code||pe||null,crest:Z.away_crest||null,size:24})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:Q})})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:_t("H")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:_t("D")})}),e.jsx("div",{className:"relative min-h-6",children:e.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:_t("A")})})]})]})},`${Z.gw}-${Z.fixture_index}`)}catch(he){return console.error("Error rendering fixture:",he,Z),e.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",Z.fixture_index]},`${Z.gw}-${Z.fixture_index}`)}}),!B.items.length&&e.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]},O))}),!Y.length&&!ie&&e.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-500",children:["No fixtures for GW ",k,"."]})]})}function rr(){const k=r?.name==="API Test"?Ze??1:v==="gwr"&&U||L;if(!k||c.length===0&&r?.name!=="API Test")return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No game week selected."});if(!Ts(r,k,rs))return e.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Results Available"}),e.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),e.jsxs("div",{className:"text-sm",children:["GW",k," results are not included in this league."]})]})});const z=new Map,Y=r?.name==="API Test",ee=Se.some(G=>{const J=Ke[G.fixture_index];return J&&(J.status==="IN_PLAY"||J.status==="PAUSED"||J.status==="FINISHED")});console.log("[League] Live Table calculation:",{resGw:k,currentGw:U,selectedGw:L,hasLiveScores:ee,liveScoresCount:Object.keys(Ke).length,isApiTestLeague:Y,fixturesCount:Se.length}),Y&&k===(Ze??1)?Se.forEach(J=>{const ie=Ke[J.fixture_index];ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED"||ie.status==="FINISHED")&&(ie.homeScore>ie.awayScore?z.set(J.fixture_index,"H"):ie.awayScore>ie.homeScore?z.set(J.fixture_index,"A"):z.set(J.fixture_index,"D"))}):ee&&k===U?(console.log("[League] Using live scores for regular league GW",k),Se.forEach(G=>{const J=Ke[G.fixture_index];J&&(J.status==="IN_PLAY"||J.status==="PAUSED"||J.status==="FINISHED")&&(J.homeScore>J.awayScore?z.set(G.fixture_index,"H"):J.awayScore>J.homeScore?z.set(G.fixture_index,"A"):z.set(G.fixture_index,"D"))}),console.log("[League] Outcomes from live scores:",Array.from(z.entries()))):(console.log("[League] Using results table for GW",k,"(hasLiveScores:",ee,", resGw === currentGw:",k===U,")"),bs.forEach(G=>{if(G.gw!==k)return;const J=hs(G);J&&z.set(G.fixture_index,J)}));const q=t.map(G=>({user_id:G.id,name:G.name,score:0,unicorns:0})),ne=new Map;Mt.forEach(G=>{if(G.gw!==k)return;const J=ne.get(G.fixture_index)??[];J.push(G),ne.set(G.fixture_index,J)}),Array.from(z.entries()).forEach(([G,J])=>{const me=(ne.get(G)??[]).filter(B=>B.pick===J).map(B=>B.user_id);if(me.forEach(B=>{const O=q.find(Z=>Z.user_id===B);O.score+=1}),me.length===1&&t.length>=3){const B=q.find(O=>O.user_id===me[0]);B.unicorns+=1}}),q.sort((G,J)=>J.score-G.score||J.unicorns-G.unicorns||G.name.localeCompare(J.name)),F.useEffect(()=>{if(q.length===0)return;const G=new Map;q.forEach((ie,me)=>{G.set(ie.user_id,me)});const J=new Set;if(G.forEach((ie,me)=>{const B=x.current.get(me);B!==void 0&&B!==ie&&J.add(me)}),x.current=G,J.size>0){b(J);const ie=setTimeout(()=>{b(new Set)},2e3);return()=>clearTimeout(ie)}},[q.map(G=>`${G.user_id}-${G.score}-${G.unicorns}`).join(",")]);let V=!1,de=!1,ve=!1,fe=!1;if(Y&&k===(Ze??1)){const G=Se;if(G.length>0&&(V=G.every(ie=>{const me=Ke[ie.fixture_index];return me&&me.status==="FINISHED"}),de=!!G.find(ie=>{const me=Ke[ie.fixture_index];return me&&(me.status==="IN_PLAY"||me.status==="PAUSED")}),fe=G.some(ie=>{const me=Ke[ie.fixture_index];return me&&(me.status==="IN_PLAY"||me.status==="PAUSED"||me.status==="FINISHED")}),!V)){const ie=new Date;ve=G.some(me=>{if(!me.kickoff_time)return!1;const O=new Date(me.kickoff_time).getTime()-ie.getTime(),Z=Ke[me.fixture_index];return(!Z||Z.status!=="IN_PLAY"&&Z.status!=="PAUSED"&&Z.status!=="FINISHED")&&O>0&&O<=1440*60*1e3})}}else{const G=Se.filter(J=>J.gw===k);G.length>0&&(V=G.every(J=>z.has(J.fixture_index)))}return e.jsxs("div",{children:[e.jsx("style",{children:`
          @keyframes flash {
            0%, 100% {
              background-color: rgb(209, 250, 229);
            }
            25% {
              background-color: rgb(167, 243, 208);
            }
            50% {
              background-color: rgb(209, 250, 229);
            }
            75% {
              background-color: rgb(167, 243, 208);
            }
          }
          @keyframes pulse-score {
            0%, 100% {
              opacity: 1;
            }
            50% {
              opacity: 0.7;
            }
          }
          @keyframes position-change {
            0% {
              background-color: rgb(254, 243, 199);
            }
            50% {
              background-color: rgb(253, 230, 138);
            }
            100% {
              background-color: transparent;
            }
          }
          .flash-user-row {
            animation: flash 1.5s ease-in-out 3;
          }
          .pulse-live-score {
            animation: pulse-score 2s ease-in-out infinite;
          }
          .position-changed {
            animation: position-change 1.5s ease-out;
          }
          .full-width-header-border::after {
            content: '';
            position: absolute;
            left: -1rem;
            right: -1rem;
            bottom: 0;
            height: 1px;
            background-color: #cbd5e1;
            z-index: 1;
          }
        `}),q.length>0&&V&&e.jsx("div",{className:"mt-4 mb-4 py-6 px-6 rounded-xl bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 shadow-2xl shadow-slate-600/50 relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:animate-[shimmer_2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/30 after:to-transparent after:animate-[shimmer_2.5s_ease-in-out_infinite_0.6s]",children:e.jsx("div",{className:"text-center relative z-10",children:q[0].score===q[1]?.score&&q[0].unicorns===q[1]?.unicorns?e.jsx("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:" It's a Draw!"}):e.jsxs("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:[q[0].name," Wins!"]})})}),e.jsx("div",{className:"overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x border-b border-slate-200 bg-slate-50 shadow-sm",style:{backgroundColor:"#f8fafc"},children:e.jsxs("table",{className:"w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc"},children:[e.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[e.jsx("th",{className:"py-4 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),e.jsx("th",{className:"py-4 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:e.jsxs("div",{className:"flex items-center gap-2",children:["Player",Y&&de&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-600 text-white shadow-md shadow-red-500/30",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-medium",children:"LIVE"})]}),Y&&!V&&ve&&!de&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500 text-white shadow-md shadow-amber-500/30",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-[10px] font-medium",children:fe?"Next Game Starting Soon":"Starting soon"})]})]})}),e.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8"},children:"Score"}),t.length>=3&&e.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""})]})}),e.jsxs("tbody",{children:[q.map((G,J)=>{const ie=G.user_id===w?.id,me=J===q.length-1,B=_.has(G.user_id);return e.jsxs("tr",{className:`${ie?"flash-user-row":""} ${B?"position-changed":""}`,style:{position:"relative",backgroundColor:"#f8fafc",...me?{}:{borderBottom:"1px solid #e2e8f0"}},children:[e.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:J+1}),e.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[Y&&de&&e.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full animate-pulse flex-shrink-0",style:{minWidth:"8px",minHeight:"8px"}}),Y&&!de&&ve&&e.jsx("svg",{className:"w-3 h-3 text-amber-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:G.name})]})}),e.jsx("td",{className:`py-4 text-center tabular-nums font-bold ${Y&&de?"pulse-live-score":""}`,style:{width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:G.score}),t.length>=3&&e.jsx("td",{className:`py-4 text-center tabular-nums ${Y&&de?"pulse-live-score":""}`,style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:G.unicorns})]},G.user_id)}),!q.length&&e.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:e.jsxs("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:t.length>=3?4:3,style:{backgroundColor:"#f8fafc"},children:["No results recorded for GW ",k," yet."]})})]})]})}),c.length>1&&e.jsx("div",{className:"mt-6 mb-4 flex flex-col items-center gap-3 px-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 w-full max-w-sm",children:[e.jsx("div",{className:"flex-1",children:e.jsx("select",{value:k||void 0,onChange:G=>{const J=parseInt(G.target.value,10);l(J)},className:"gw-selector w-full bg-white rounded-full border-2 border-slate-300 px-3 py-2 text-xs font-normal text-slate-600 text-center focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-[#1C8376] active:bg-slate-50 transition-colors",style:{fontSize:"12px",minHeight:"40px",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b' stroke-width='2.5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"1em 1em",paddingRight:"2.5rem"},children:c.map(G=>e.jsxs("option",{value:G,style:{fontSize:"12px",padding:"0.5rem",fontWeight:"normal",color:"#64748b",textTransform:"uppercase"},children:["GAME WEEK ",G]},G))})}),e.jsxs("button",{onClick:()=>W(!0),className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[e.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),e.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),X&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>W(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:G=>G.stopPropagation(),children:[e.jsx("button",{onClick:()=>W(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Weekly Winner"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:" How to Win the Week:"}),e.jsxs("p",{className:"text-[#1C8376]/80",children:["The player with the ",e.jsx("strong",{children:"most correct predictions"})," wins that gameweek."]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-purple-800 mb-2",children:" Unicorn Rule"}),e.jsxs("p",{className:"text-purple-700",children:["In Mini-Leagues with ",e.jsx("strong",{children:"3 or more players"}),", if you're the ",e.jsx("strong",{children:"only person"})," to correctly predict a fixture, that's a ",e.jsx("strong",{children:" Unicorn"}),". In ties, the player with most ",e.jsx("strong",{children:" Unicorns"})," wins!"]})]})]})]})]})})]})}return F.useEffect(()=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"auto"})},[v]),d?e.jsx("div",{className:"max-w-5xl mx-auto px-4 py-10",children:e.jsx("div",{className:"text-slate-500",children:"Loading"})}):!r&&!d?e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-10",children:e.jsxs("div",{className:"rounded border bg-white p-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"League not found"}),e.jsx(Ls,{to:"/leagues",className:"text-slate-600 underline",children:"Back to Mini Leagues"})]})}):r?e.jsxs("div",{className:`${I?"oldschool-theme":"bg-slate-50"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",maxHeight:"100vh",overflow:"hidden"},children:[e.jsx("style",{children:`
        .league-header-fixed {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          z-index: 50 !important;
          transform: translate3d(0, 0, 0) !important;
          -webkit-transform: translate3d(0, 0, 0) !important;
          will-change: transform !important;
          contain: layout style paint !important;
        }
        .league-header-fixed .relative {
          position: relative !important;
          z-index: 100 !important;
        }
        @supports (height: 100dvh) {
          .league-header-fixed {
            top: env(safe-area-inset-top, 0px) !important;
          }
        }
        .league-content-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
          left: 0;
          right: 0;
          bottom: 0;
          overflow-y: auto;
          overflow-x: hidden;
          -webkit-overflow-scrolling: touch;
          overscroll-behavior: contain;
          padding-bottom: 2rem;
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .league-content-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
        }
        @media (max-width: 768px) {
          .league-content-wrapper {
            top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
            padding-bottom: 2rem;
            padding-left: 1rem;
            padding-right: 1rem;
          }
          .league-content-wrapper.has-banner {
            top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
          }
        }
        /* Chat tab - full height layout */
        .chat-tab-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px));
          left: 0;
          right: 0;
          bottom: 0;
          height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          z-index: 10;
          overflow: visible;
          pointer-events: none;
        }
        .chat-tab-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px));
          height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
        }
        .chat-tab-wrapper > * {
          pointer-events: auto;
        }
        @supports (height: 100dvh) {
          .chat-tab-wrapper {
            height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          }
          .chat-tab-wrapper.has-banner {
            height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          }
        }
      `}),e.jsx("div",{ref:n,className:"league-header-fixed bg-white border-b border-slate-200 shadow-sm",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[e.jsxs("div",{className:"flex items-center justify-between h-14",children:[e.jsx(Ls,{to:"/leagues",className:"flex items-center text-slate-600 hover:text-slate-900 transition-colors -ml-2 px-2 py-1",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("h1",{className:"text-lg font-normal text-slate-900 truncate flex-1 text-left px-2",children:r.name}),e.jsx("div",{className:"relative",style:{zIndex:100},children:e.jsx("button",{onClick:()=>Me(!De),className:"flex items-center justify-center w-8 h-8 rounded-full hover:bg-slate-100 transition-colors -mr-2","aria-label":"Menu",children:e.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]}),e.jsxs("div",{className:"flex border-b border-slate-200 bg-white",children:[e.jsxs("button",{onClick:()=>{i.current=!0,a("chat-beta")},className:"flex-1 px-3 sm:px-6 py-3 text-[12px] font-semibold transition-colors relative "+(v==="chat-beta"?"text-[#1C8376]":"text-slate-400"),children:["Chat (beta)",v==="chat-beta"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(c.length>0||r?.name==="API Test")&&e.jsxs("button",{onClick:()=>{i.current=!0,a("gwr")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight flex items-center justify-center gap-1.5 "+(v==="gwr"?"text-[#1C8376]":"text-slate-400"),children:[(()=>{const k=r?.name==="API Test"?Ze??1:U||L,z=r?.name==="API Test"?`T${k}`:k,Y=new Date,ee=Se[0],q=ee?.kickoff_time?new Date(ee.kickoff_time):null,ne=q&&q<=Y,de=Se[Se.length-1]?.fixture_index,fe=(de!==void 0?Ke[de]:null)?.status==="FINISHED",G=ne&&!fe,J=G?"Live Table":"Results";return e.jsxs(e.Fragment,{children:[G&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:z?`GW ${z} ${J}`:`GW ${J}`}),e.jsx("span",{className:"sm:hidden whitespace-pre-line text-center",children:z?`GW${z}
${J}`:`GW
${J}`})]})})(),v==="gwr"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(U||r?.name==="API Test")&&e.jsxs("button",{onClick:()=>{i.current=!0,a("gw")},className:"flex-1 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight "+(v==="gw"?"text-[#1C8376]":"text-slate-400"),children:[e.jsx("span",{className:"hidden sm:inline",children:r?.name==="API Test"?`GW T${Ze??1} Predictions`:U?`GW ${U} Predictions`:"GW Predictions"}),e.jsx("span",{className:"sm:hidden whitespace-pre-line",children:r?.name==="API Test"?`GWT${Ze??1}
Predictions`:U?`GW${U}
Predictions`:`GW
Predictions`}),v==="gw"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),e.jsxs("button",{onClick:()=>{i.current=!0,a("mlt")},className:"flex-1 px-3 sm:px-6 py-3 text-sm font-semibold transition-colors relative "+(v==="mlt"?"text-[#1C8376]":"text-slate-400"),children:["Table",v==="mlt"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]})]})]})}),De&&typeof document<"u"&&document.body&&dr.createPortal(e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0",onClick:()=>Me(!1),style:{backgroundColor:"transparent",zIndex:99998}}),e.jsxs("div",{className:"fixed w-56 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",style:{zIndex:99999,top:"calc(3.5rem + 0.5rem + env(safe-area-inset-top, 0px))",right:"1rem"},children:[Qe&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-4 py-3 border-b border-slate-100",children:[e.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Admin:"}),e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:ss})]}),e.jsx("button",{onClick:()=>{D(!0),Me(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Manage"}),e.jsx("button",{onClick:()=>{le(!0),Me(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Upload avatar"})]}),e.jsx("button",{onClick:()=>{Ye(!0),Me(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Invite players"}),e.jsx("button",{onClick:()=>{at(),Me(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:"Share league code"}),e.jsx("button",{onClick:()=>{E(!0),Me(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Leave"})]})]}),document.body),v==="chat"?e.jsx("div",{className:"chat-tab-wrapper",children:e.jsx(Dr,{chat:st,userId:w?.id,nameById:nt,isMember:$t,newMsg:rt,setNewMsg:jt,onSend:er,leagueCode:r?.code,memberCount:t.length,maxMembers:Kt,notificationStatus:ts})}):v==="chat-beta"?e.jsx("div",{className:"chat-tab-wrapper",children:e.jsx(Ir,{miniLeagueId:r?.id??null,memberNames:nt})}):e.jsx("div",{className:"league-content-wrapper",children:e.jsxs("div",{className:"px-1 sm:px-2",children:[v==="mlt"&&e.jsx(tr,{}),v==="gw"&&e.jsx(sr,{}),v==="gwr"&&e.jsx(rr,{})]})}),Qe&&u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>D(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:k=>k.stopPropagation(),children:[e.jsx("button",{onClick:()=>D(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm text-slate-600 mb-3 font-semibold",children:"Remove Members:"}),e.jsxs("div",{className:"space-y-2",children:[t.filter(k=>k.id!==w?.id).map(k=>e.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-slate-800",children:k.name}),e.jsx("button",{onClick:()=>{et(k),He(!0),D(!1)},className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium",children:"Remove"})]},k.id)),t.filter(k=>k.id!==w?.id).length===0&&e.jsx("div",{className:"text-sm text-slate-500 italic py-4 text-center",children:"No other members to remove"})]})]}),e.jsx("div",{className:"pt-4 border-t border-slate-200",children:e.jsx("button",{onClick:()=>{je(!0),D(!1)},className:"w-full px-4 py-3 text-sm bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium flex items-center justify-center gap-2",children:" End League"})})]})]})]})}),Qe&&R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>le(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:k=>k.stopPropagation(),children:[e.jsx("button",{onClick:()=>{le(!1),xe(null),Ae(!1)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Upload League Avatar"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-sm text-slate-600 mb-2 font-medium",children:"Current Avatar:"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-slate-100 flex items-center justify-center",children:e.jsx("img",{src:r?cr(r):"/assets/league-avatars/ML-avatar-1.png",alt:"League avatar",className:"w-full h-full object-cover",onError:k=>{const z=k.target;z.src="/assets/league-avatars/ML-avatar-1.png"}})}),r?.avatar&&e.jsx("button",{onClick:Js,disabled:Ne,className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium disabled:opacity-50",children:"Remove Avatar"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Upload New Avatar"}),e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:k=>{const z=k.target.files?.[0];z&&mt(z)},disabled:Ne,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#1C8376] file:text-white hover:file:bg-emerald-700 file:cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),e.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Images will be automatically compressed to ~60KB and resized to 256x256px. Max file size: 2MB before compression."})]}),Ne&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#1C8376]"}),e.jsx("span",{children:"Processing and uploading..."})]}),Ee&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800",children:" Avatar uploaded successfully!"}),be&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:be})]})]})]})}),re&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>K(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:k=>k.stopPropagation(),children:[e.jsx("button",{onClick:()=>K(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"p-6 pt-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Points"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#1C8376]/10 border border-[#1C8376]/20 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-[#1C8376]/90 mb-3",children:"League Points:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Win the week"}),"  3 points"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Draw"}),"  1 point"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[#1C8376] font-bold",children:""}),e.jsxs("span",{className:"text-[#1C8376]/80",children:[e.jsx("strong",{children:"Lose"}),"  0 points"]})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:" Ties"}),e.jsxs("p",{className:"text-blue-700",children:["If two or more players are tied on Points, the player with the most overall ",e.jsx("strong",{children:" Unicorns"})," in the mini league is ranked higher."]})]})]}),r&&(["The Bird league"].includes(r.name)||["gregVjofVcarl","Let Down"].includes(r.name))&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-blue-700 text-sm",children:[e.jsx("strong",{children:"Note:"}),' This mini league started after GW1, so the "CP" column shows correct predictions since this mini league began.']})})]})]})}),ut&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Invite players"}),e.jsxs("p",{className:"text-slate-600 text-sm",children:["Share this code (up to ",Kt," members):"]}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("code",{className:"font-mono text-lg font-bold",children:r.code}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.code)},className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Copy"}),e.jsx("button",{onClick:at,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Share"})]}),e.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:[t.length,"/",Kt," members"]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>Ye(!1),className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-50",children:"Close"})})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Leave League"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:['Are you sure you want to leave "',r?.name,`"? You'll need the league code to rejoin later.`]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:j,children:"Cancel"}),e.jsx("button",{onClick:bt,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:j,children:j?"Leaving...":"Leave League"})]})]})}),Le&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Join Mini League"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:["You are about to join ",e.jsxs("strong",{children:['"',r?.name,'"']}),". Are you sure?"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Fe(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:_e,children:"Cancel"}),e.jsx("button",{onClick:Nt,className:"flex-1 px-4 py-2 bg-[#1C8376] text-white rounded-md hover:bg-emerald-700 transition-colors disabled:opacity-50",disabled:_e,children:_e?"Joining...":"Join League"})]})]})}),Ue&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Remove Member"}),e.jsxs("p",{className:"text-slate-600 mb-6",children:["Are you sure you want to remove ",e.jsxs("strong",{children:['"',Pe?.name,'"']})," from the league? They will need the league code to rejoin."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>He(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:pt,children:"Cancel"}),e.jsx("button",{onClick:Ht,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:pt,children:pt?"Removing...":"Remove Member"})]})]})}),Ie&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:" End League"}),e.jsxs("p",{className:"text-slate-600 mb-4",children:["Are you absolutely sure you want to ",e.jsx("strong",{children:"permanently end"})," the league ",e.jsxs("strong",{children:['"',r?.name,'"']}),"?"]}),e.jsx("p",{className:"text-sm text-red-600 mb-6",children:"This will remove all members and delete the league forever. This action cannot be undone!"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>je(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:tt,children:"Cancel"}),e.jsx("button",{onClick:ft,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:tt,children:tt?"Ending...":"Yes, End League"})]})]})}),r?.name==="API Test"&&e.jsx("div",{className:"mt-6 mb-4 px-4 py-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:" Test League:"})," This league uses test API data and starts from Test GW 1 with zero points. It does not affect your main game scores."]})})]}):null}export{$r as default};
