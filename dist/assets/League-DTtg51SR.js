import{r as D,s as re,j as n,u as ln,i as Tn,g as Qt,D as Mn,a as In,b as Un,c as Fn,L as Jt,d as Dn,e as Rn,I as Zt,f as Xt}from"./index-Bu25J0QH.js";import{T as en}from"./TeamBadge-Lc-oqosZ.js";function Pn(m,x){return x.forEach((function(E){E&&typeof E!="string"&&!Array.isArray(E)&&Object.keys(E).forEach((function(s){if(s!=="default"&&!(s in m)){var e=Object.getOwnPropertyDescriptor(E,s);Object.defineProperty(m,s,e.get?e:{enumerable:!0,get:function(){return E[s]}})}}))})),Object.freeze(m)}function cn(m,x){return new Promise((function(E,s){let e;return $n(m).then((function(t){try{return e=t,E(new Blob([x.slice(0,2),e,x.slice(2)],{type:"image/jpeg"}))}catch(u){return s(u)}}),s)}))}const $n=m=>new Promise(((x,E)=>{const s=new FileReader;s.addEventListener("load",(({target:{result:e}})=>{const t=new DataView(e);let u=0;if(t.getUint16(u)!==65496)return E("not a valid JPEG");for(u+=2;;){const o=t.getUint16(u);if(o===65498)break;const y=t.getUint16(u+2);if(o===65505&&t.getUint32(u+4)===1165519206){const v=u+10;let a;switch(t.getUint16(v)){case 18761:a=!0;break;case 19789:a=!1;break;default:return E("TIFF header contains invalid endian")}if(t.getUint16(v+2,a)!==42)return E("TIFF header contains invalid version");const i=t.getUint32(v+4,a),r=v+i+2+12*t.getUint16(v+i,a);for(let l=v+i+2;l<r;l+=12)if(t.getUint16(l,a)==274){if(t.getUint16(l+2,a)!==3)return E("Orientation data type is invalid");if(t.getUint32(l+4,a)!==1)return E("Orientation data count is invalid");t.setUint16(l+8,1,a);break}return x(e.slice(u,u+2+y))}u+=2+y}return x(new Blob)})),s.readAsArrayBuffer(m)}));var Lt={},Hn={get exports(){return Lt},set exports(m){Lt=m}};(function(m){var x,E,s={};Hn.exports=s,s.parse=function(e,t){for(var u=s.bin.readUshort,o=s.bin.readUint,y=0,v={},a=new Uint8Array(e),i=a.length-4;o(a,i)!=101010256;)i--;y=i,y+=4;var r=u(a,y+=4);u(a,y+=2);var l=o(a,y+=2),h=o(a,y+=4);y+=4,y=h;for(var N=0;N<r;N++){o(a,y),y+=4,y+=4,y+=4,o(a,y+=4),l=o(a,y+=4);var T=o(a,y+=4),j=u(a,y+=4),F=u(a,y+2),U=u(a,y+4);y+=6;var C=o(a,y+=8);y+=4,y+=j+F+U,s._readLocal(a,C,v,l,T,t)}return v},s._readLocal=function(e,t,u,o,y,v){var a=s.bin.readUshort,i=s.bin.readUint;i(e,t),a(e,t+=4),a(e,t+=2);var r=a(e,t+=2);i(e,t+=2),i(e,t+=4),t+=4;var l=a(e,t+=8),h=a(e,t+=2);t+=2;var N=s.bin.readUTF8(e,t,l);if(t+=l,t+=h,v)u[N]={size:y,csize:o};else{var T=new Uint8Array(e.buffer,t);if(r==0)u[N]=new Uint8Array(T.buffer.slice(t,t+o));else{if(r!=8)throw"unknown compression method: "+r;var j=new Uint8Array(y);s.inflateRaw(T,j),u[N]=j}}},s.inflateRaw=function(e,t){return s.F.inflate(e,t)},s.inflate=function(e,t){return e[0],e[1],s.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},s.deflate=function(e,t){t==null&&(t={level:6});var u=0,o=new Uint8Array(50+Math.floor(1.1*e.length));o[u]=120,o[u+1]=156,u+=2,u=s.F.deflateRaw(e,o,u,t.level);var y=s.adler(e,0,e.length);return o[u+0]=y>>>24&255,o[u+1]=y>>>16&255,o[u+2]=y>>>8&255,o[u+3]=y>>>0&255,new Uint8Array(o.buffer,0,u+4)},s.deflateRaw=function(e,t){t==null&&(t={level:6});var u=new Uint8Array(50+Math.floor(1.1*e.length)),o=s.F.deflateRaw(e,u,o,t.level);return new Uint8Array(u.buffer,0,o)},s.encode=function(e,t){t==null&&(t=!1);var u=0,o=s.bin.writeUint,y=s.bin.writeUshort,v={};for(var a in e){var i=!s._noNeed(a)&&!t,r=e[a],l=s.crc.crc(r,0,r.length);v[a]={cpr:i,usize:r.length,crc:l,file:i?s.deflateRaw(r):r}}for(var a in v)u+=v[a].file.length+30+46+2*s.bin.sizeUTF8(a);u+=22;var h=new Uint8Array(u),N=0,T=[];for(var a in v){var j=v[a];T.push(N),N=s._writeHeader(h,N,a,j,0)}var F=0,U=N;for(var a in v)j=v[a],T.push(N),N=s._writeHeader(h,N,a,j,1,T[F++]);var C=N-U;return o(h,N,101010256),N+=4,y(h,N+=4,F),y(h,N+=2,F),o(h,N+=2,C),o(h,N+=4,U),N+=4,N+=2,h.buffer},s._noNeed=function(e){var t=e.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(t)!=-1},s._writeHeader=function(e,t,u,o,y,v){var a=s.bin.writeUint,i=s.bin.writeUshort,r=o.file;return a(e,t,y==0?67324752:33639248),t+=4,y==1&&(t+=2),i(e,t,20),i(e,t+=2,0),i(e,t+=2,o.cpr?8:0),a(e,t+=2,0),a(e,t+=4,o.crc),a(e,t+=4,r.length),a(e,t+=4,o.usize),i(e,t+=4,s.bin.sizeUTF8(u)),i(e,t+=2,0),t+=2,y==1&&(t+=2,t+=2,a(e,t+=6,v),t+=4),t+=s.bin.writeUTF8(e,t,u),y==0&&(e.set(r,t),t+=r.length),t},s.crc={table:(function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var u=t,o=0;o<8;o++)1&u?u=3988292384^u>>>1:u>>>=1;e[t]=u}return e})(),update:function(e,t,u,o){for(var y=0;y<o;y++)e=s.crc.table[255&(e^t[u+y])]^e>>>8;return e},crc:function(e,t,u){return 4294967295^s.crc.update(4294967295,e,t,u)}},s.adler=function(e,t,u){for(var o=1,y=0,v=t,a=t+u;v<a;){for(var i=Math.min(v+5552,a);v<i;)y+=o+=e[v++];o%=65521,y%=65521}return y<<16|o},s.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,u){e[t]=255&u,e[t+1]=u>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,u){e[t]=255&u,e[t+1]=u>>8&255,e[t+2]=u>>16&255,e[t+3]=u>>24&255},readASCII:function(e,t,u){for(var o="",y=0;y<u;y++)o+=String.fromCharCode(e[t+y]);return o},writeASCII:function(e,t,u){for(var o=0;o<u.length;o++)e[t+o]=u.charCodeAt(o)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,u){for(var o,y="",v=0;v<u;v++)y+="%"+s.bin.pad(e[t+v].toString(16));try{o=decodeURIComponent(y)}catch{return s.bin.readASCII(e,t,u)}return o},writeUTF8:function(e,t,u){for(var o=u.length,y=0,v=0;v<o;v++){var a=u.charCodeAt(v);if((4294967168&a)==0)e[t+y]=a,y++;else if((4294965248&a)==0)e[t+y]=192|a>>6,e[t+y+1]=128|a>>0&63,y+=2;else if((4294901760&a)==0)e[t+y]=224|a>>12,e[t+y+1]=128|a>>6&63,e[t+y+2]=128|a>>0&63,y+=3;else{if((4292870144&a)!=0)throw"e";e[t+y]=240|a>>18,e[t+y+1]=128|a>>12&63,e[t+y+2]=128|a>>6&63,e[t+y+3]=128|a>>0&63,y+=4}}return y},sizeUTF8:function(e){for(var t=e.length,u=0,o=0;o<t;o++){var y=e.charCodeAt(o);if((4294967168&y)==0)u++;else if((4294965248&y)==0)u+=2;else if((4294901760&y)==0)u+=3;else{if((4292870144&y)!=0)throw"e";u+=4}}return u}},s.F={},s.F.deflateRaw=function(e,t,u,o){var y=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][o],v=s.F.U,a=s.F._goodIndex;s.F._hash;var i=s.F._putsE,r=0,l=u<<3,h=0,N=e.length;if(o==0){for(;r<N;)i(t,l,r+(A=Math.min(65535,N-r))==N?1:0),l=s.F._copyExact(e,r,A,t,l+8),r+=A;return l>>>3}var T=v.lits,j=v.strt,F=v.prev,U=0,C=0,R=0,p=0,M=0,c=0;for(N>2&&(j[c=s.F._hash(e,0)]=0),r=0;r<N;r++){if(M=c,r+1<N-2){c=s.F._hash(e,r+1);var d=r+1&32767;F[d]=j[c],j[c]=d}if(h<=r){(U>14e3||C>26697)&&N-r>100&&(h<r&&(T[U]=r-h,U+=2,h=r),l=s.F._writeBlock(r==N-1||h==N?1:0,T,U,p,e,R,r-R,t,l),U=C=p=0,R=r);var _=0;r<N-2&&(_=s.F._bestMatch(e,r,F,M,Math.min(y[2],N-r),y[3]));var A=_>>>16,b=65535&_;if(_!=0){b=65535&_;var k=a(A=_>>>16,v.of0);v.lhst[257+k]++;var w=a(b,v.df0);v.dhst[w]++,p+=v.exb[k]+v.dxb[w],T[U]=A<<23|r-h,T[U+1]=b<<16|k<<8|w,U+=2,h=r+A}else v.lhst[e[r]]++;C++}}for(R==r&&e.length!=0||(h<r&&(T[U]=r-h,U+=2,h=r),l=s.F._writeBlock(1,T,U,p,e,R,r-R,t,l),U=0,C=0,U=C=p=0,R=r);(7&l)!=0;)l++;return l>>>3},s.F._bestMatch=function(e,t,u,o,y,v){var a=32767&t,i=u[a],r=a-i+32768&32767;if(i==a||o!=s.F._hash(e,t-r))return 0;for(var l=0,h=0,N=Math.min(32767,t);r<=N&&--v!=0&&i!=a;){if(l==0||e[t+l]==e[t+l-r]){var T=s.F._howLong(e,t,r);if(T>l){if(h=r,(l=T)>=y)break;r+2<T&&(T=r+2);for(var j=0,F=0;F<T-2;F++){var U=t-r+F+32768&32767,C=U-u[U]+32768&32767;C>j&&(j=C,i=U)}}}r+=(a=i)-(i=u[a])+32768&32767}return l<<16|h},s.F._howLong=function(e,t,u){if(e[t]!=e[t-u]||e[t+1]!=e[t+1-u]||e[t+2]!=e[t+2-u])return 0;var o=t,y=Math.min(e.length,t+258);for(t+=3;t<y&&e[t]==e[t-u];)t++;return t-o},s.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},s.saved=0,s.F._writeBlock=function(e,t,u,o,y,v,a,i,r){var l,h,N,T,j,F,U,C,R,p=s.F.U,M=s.F._putsF,c=s.F._putsE;p.lhst[256]++,h=(l=s.F.getTrees())[0],N=l[1],T=l[2],j=l[3],F=l[4],U=l[5],C=l[6],R=l[7];var d=32+((r+3&7)==0?0:8-(r+3&7))+(a<<3),_=o+s.F.contSize(p.fltree,p.lhst)+s.F.contSize(p.fdtree,p.dhst),A=o+s.F.contSize(p.ltree,p.lhst)+s.F.contSize(p.dtree,p.dhst);A+=14+3*U+s.F.contSize(p.itree,p.ihst)+(2*p.ihst[16]+3*p.ihst[17]+7*p.ihst[18]);for(var b=0;b<286;b++)p.lhst[b]=0;for(b=0;b<30;b++)p.dhst[b]=0;for(b=0;b<19;b++)p.ihst[b]=0;var k=d<_&&d<A?0:_<A?1:2;if(M(i,r,e),M(i,r+1,k),r+=3,k==0){for(;(7&r)!=0;)r++;r=s.F._copyExact(y,v,a,i,r)}else{var w,L;if(k==1&&(w=p.fltree,L=p.fdtree),k==2){s.F.makeCodes(p.ltree,h),s.F.revCodes(p.ltree,h),s.F.makeCodes(p.dtree,N),s.F.revCodes(p.dtree,N),s.F.makeCodes(p.itree,T),s.F.revCodes(p.itree,T),w=p.ltree,L=p.dtree,c(i,r,j-257),c(i,r+=5,F-1),c(i,r+=5,U-4),r+=4;for(var g=0;g<U;g++)c(i,r+3*g,p.itree[1+(p.ordr[g]<<1)]);r+=3*U,r=s.F._codeTiny(C,p.itree,i,r),r=s.F._codeTiny(R,p.itree,i,r)}for(var f=v,$=0;$<u;$+=2){for(var I=t[$],H=I>>>23,X=f+(8388607&I);f<X;)r=s.F._writeLit(y[f++],w,i,r);if(H!=0){var V=t[$+1],Z=V>>16,G=V>>8&255,P=255&V;c(i,r=s.F._writeLit(257+G,w,i,r),H-p.of0[G]),r+=p.exb[G],M(i,r=s.F._writeLit(P,L,i,r),Z-p.df0[P]),r+=p.dxb[P],f+=H}}r=s.F._writeLit(256,w,i,r)}return r},s.F._copyExact=function(e,t,u,o,y){var v=y>>>3;return o[v]=u,o[v+1]=u>>>8,o[v+2]=255-o[v],o[v+3]=255-o[v+1],v+=4,o.set(new Uint8Array(e.buffer,t,u),v),y+(u+4<<3)},s.F.getTrees=function(){for(var e=s.F.U,t=s.F._hufTree(e.lhst,e.ltree,15),u=s.F._hufTree(e.dhst,e.dtree,15),o=[],y=s.F._lenCodes(e.ltree,o),v=[],a=s.F._lenCodes(e.dtree,v),i=0;i<o.length;i+=2)e.ihst[o[i]]++;for(i=0;i<v.length;i+=2)e.ihst[v[i]]++;for(var r=s.F._hufTree(e.ihst,e.itree,7),l=19;l>4&&e.itree[1+(e.ordr[l-1]<<1)]==0;)l--;return[t,u,r,y,a,l,o,v]},s.F.getSecond=function(e){for(var t=[],u=0;u<e.length;u+=2)t.push(e[u+1]);return t},s.F.nonZero=function(e){for(var t="",u=0;u<e.length;u+=2)e[u+1]!=0&&(t+=(u>>1)+",");return t},s.F.contSize=function(e,t){for(var u=0,o=0;o<t.length;o++)u+=t[o]*e[1+(o<<1)];return u},s.F._codeTiny=function(e,t,u,o){for(var y=0;y<e.length;y+=2){var v=e[y],a=e[y+1];o=s.F._writeLit(v,t,u,o);var i=v==16?2:v==17?3:7;v>15&&(s.F._putsE(u,o,a,i),o+=i)}return o},s.F._lenCodes=function(e,t){for(var u=e.length;u!=2&&e[u-1]==0;)u-=2;for(var o=0;o<u;o+=2){var y=e[o+1],v=o+3<u?e[o+3]:-1,a=o+5<u?e[o+5]:-1,i=o==0?-1:e[o-1];if(y==0&&v==y&&a==y){for(var r=o+5;r+2<u&&e[r+2]==y;)r+=2;(l=Math.min(r+1-o>>>1,138))<11?t.push(17,l-3):t.push(18,l-11),o+=2*l-2}else if(y==i&&v==y&&a==y){for(r=o+5;r+2<u&&e[r+2]==y;)r+=2;var l=Math.min(r+1-o>>>1,6);t.push(16,l-3),o+=2*l-2}else t.push(y,0)}return u>>>1},s.F._hufTree=function(e,t,u){var o=[],y=e.length,v=t.length,a=0;for(a=0;a<v;a+=2)t[a]=0,t[a+1]=0;for(a=0;a<y;a++)e[a]!=0&&o.push({lit:a,f:e[a]});var i=o.length,r=o.slice(0);if(i==0)return 0;if(i==1){var l=o[0].lit;return r=l==0?1:0,t[1+(l<<1)]=1,t[1+(r<<1)]=1,1}o.sort((function(C,R){return C.f-R.f}));var h=o[0],N=o[1],T=0,j=1,F=2;for(o[0]={lit:-1,f:h.f+N.f,l:h,r:N,d:0};j!=i-1;)h=T!=j&&(F==i||o[T].f<o[F].f)?o[T++]:o[F++],N=T!=j&&(F==i||o[T].f<o[F].f)?o[T++]:o[F++],o[j++]={lit:-1,f:h.f+N.f,l:h,r:N};var U=s.F.setDepth(o[j-1],0);for(U>u&&(s.F.restrictDepth(r,u,U),U=u),a=0;a<i;a++)t[1+(r[a].lit<<1)]=r[a].d;return U},s.F.setDepth=function(e,t){return e.lit!=-1?(e.d=t,t):Math.max(s.F.setDepth(e.l,t+1),s.F.setDepth(e.r,t+1))},s.F.restrictDepth=function(e,t,u){var o=0,y=1<<u-t,v=0;for(e.sort((function(i,r){return r.d==i.d?i.f-r.f:r.d-i.d})),o=0;o<e.length&&e[o].d>t;o++){var a=e[o].d;e[o].d=t,v+=y-(1<<u-a)}for(v>>>=u-t;v>0;)(a=e[o].d)<t?(e[o].d++,v-=1<<t-a-1):o++;for(;o>=0;o--)e[o].d==t&&v<0&&(e[o].d--,v++);v!=0&&console.log("debt left")},s.F._goodIndex=function(e,t){var u=0;return t[16|u]<=e&&(u|=16),t[8|u]<=e&&(u|=8),t[4|u]<=e&&(u|=4),t[2|u]<=e&&(u|=2),t[1|u]<=e&&(u|=1),u},s.F._writeLit=function(e,t,u,o){return s.F._putsF(u,o,t[e<<1]),o+t[1+(e<<1)]},s.F.inflate=function(e,t){var u=Uint8Array;if(e[0]==3&&e[1]==0)return t||new u(0);var o=s.F,y=o._bitsF,v=o._bitsE,a=o._decodeTiny,i=o.makeCodes,r=o.codes2map,l=o._get17,h=o.U,N=t==null;N&&(t=new u(e.length>>>2<<3));for(var T,j,F=0,U=0,C=0,R=0,p=0,M=0,c=0,d=0,_=0;F==0;)if(F=y(e,_,1),U=y(e,_+1,2),_+=3,U!=0){if(N&&(t=s.F._check(t,d+(1<<17))),U==1&&(T=h.flmap,j=h.fdmap,M=511,c=31),U==2){C=v(e,_,5)+257,R=v(e,_+5,5)+1,p=v(e,_+10,4)+4,_+=14;for(var A=0;A<38;A+=2)h.itree[A]=0,h.itree[A+1]=0;var b=1;for(A=0;A<p;A++){var k=v(e,_+3*A,3);h.itree[1+(h.ordr[A]<<1)]=k,k>b&&(b=k)}_+=3*p,i(h.itree,b),r(h.itree,b,h.imap),T=h.lmap,j=h.dmap,_=a(h.imap,(1<<b)-1,C+R,e,_,h.ttree);var w=o._copyOut(h.ttree,0,C,h.ltree);M=(1<<w)-1;var L=o._copyOut(h.ttree,C,R,h.dtree);c=(1<<L)-1,i(h.ltree,w),r(h.ltree,w,T),i(h.dtree,L),r(h.dtree,L,j)}for(;;){var g=T[l(e,_)&M];_+=15&g;var f=g>>>4;if(!(f>>>8))t[d++]=f;else{if(f==256)break;var $=d+f-254;if(f>264){var I=h.ldef[f-257];$=d+(I>>>3)+v(e,_,7&I),_+=7&I}var H=j[l(e,_)&c];_+=15&H;var X=H>>>4,V=h.ddef[X],Z=(V>>>4)+y(e,_,15&V);for(_+=15&V,N&&(t=s.F._check(t,d+(1<<17)));d<$;)t[d]=t[d++-Z],t[d]=t[d++-Z],t[d]=t[d++-Z],t[d]=t[d++-Z];d=$}}}else{(7&_)!=0&&(_+=8-(7&_));var G=4+(_>>>3),P=e[G-4]|e[G-3]<<8;N&&(t=s.F._check(t,d+P)),t.set(new u(e.buffer,e.byteOffset+G,P),d),_=G+P<<3,d+=P}return t.length==d?t:t.slice(0,d)},s.F._check=function(e,t){var u=e.length;if(t<=u)return e;var o=new Uint8Array(Math.max(u<<1,t));return o.set(e,0),o},s.F._decodeTiny=function(e,t,u,o,y,v){for(var a=s.F._bitsE,i=s.F._get17,r=0;r<u;){var l=e[i(o,y)&t];y+=15&l;var h=l>>>4;if(h<=15)v[r]=h,r++;else{var N=0,T=0;h==16?(T=3+a(o,y,2),y+=2,N=v[r-1]):h==17?(T=3+a(o,y,3),y+=3):h==18&&(T=11+a(o,y,7),y+=7);for(var j=r+T;r<j;)v[r]=N,r++}}return y},s.F._copyOut=function(e,t,u,o){for(var y=0,v=0,a=o.length>>>1;v<u;){var i=e[v+t];o[v<<1]=0,o[1+(v<<1)]=i,i>y&&(y=i),v++}for(;v<a;)o[v<<1]=0,o[1+(v<<1)]=0,v++;return y},s.F.makeCodes=function(e,t){for(var u,o,y,v,a=s.F.U,i=e.length,r=a.bl_count,l=0;l<=t;l++)r[l]=0;for(l=1;l<i;l+=2)r[e[l]]++;var h=a.next_code;for(u=0,r[0]=0,o=1;o<=t;o++)u=u+r[o-1]<<1,h[o]=u;for(y=0;y<i;y+=2)(v=e[y+1])!=0&&(e[y]=h[v],h[v]++)},s.F.codes2map=function(e,t,u){for(var o=e.length,y=s.F.U.rev15,v=0;v<o;v+=2)if(e[v+1]!=0)for(var a=v>>1,i=e[v+1],r=a<<4|i,l=t-i,h=e[v]<<l,N=h+(1<<l);h!=N;)u[y[h]>>>15-t]=r,h++},s.F.revCodes=function(e,t){for(var u=s.F.U.rev15,o=15-t,y=0;y<e.length;y+=2){var v=e[y]<<t-e[y+1];e[y]=u[v]>>>o}},s.F._putsE=function(e,t,u){u<<=7&t;var o=t>>>3;e[o]|=u,e[o+1]|=u>>>8},s.F._putsF=function(e,t,u){u<<=7&t;var o=t>>>3;e[o]|=u,e[o+1]|=u>>>8,e[o+2]|=u>>>16},s.F._bitsE=function(e,t,u){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<u)-1},s.F._bitsF=function(e,t,u){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<u)-1},s.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},s.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},s.F.U=(x=Uint16Array,E=Uint32Array,{next_code:new x(16),bl_count:new x(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new x(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new E(32),flmap:new x(512),fltree:[],fdmap:new x(32),fdtree:[],lmap:new x(32768),ltree:[],ttree:[],dmap:new x(32768),dtree:[],imap:new x(512),itree:[],rev15:new x(32768),lhst:new E(286),dhst:new E(30),ihst:new E(19),lits:new E(15e3),strt:new x(65536),prev:new x(32768)}),(function(){for(var e=s.F.U,t=0;t<32768;t++){var u=t;u=(4278255360&(u=(4042322160&(u=(3435973836&(u=(2863311530&u)>>>1|(1431655765&u)<<1))>>>2|(858993459&u)<<2))>>>4|(252645135&u)<<4))>>>8|(16711935&u)<<8,e.rev15[t]=(u>>>16|u<<16)>>>17}function o(y,v,a){for(;v--!=0;)y.push(0,a)}for(t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];o(e.fltree,144,8),o(e.fltree,112,9),o(e.fltree,24,7),o(e.fltree,8,8),s.F.makeCodes(e.fltree,9),s.F.codes2map(e.fltree,9,e.flmap),s.F.revCodes(e.fltree,9),o(e.fdtree,32,5),s.F.makeCodes(e.fdtree,5),s.F.codes2map(e.fdtree,5,e.fdmap),s.F.revCodes(e.fdtree,5),o(e.itree,19,0),o(e.ltree,286,0),o(e.dtree,30,0),o(e.ttree,320,0)})()})();var zn=Pn({__proto__:null,default:Lt},[Lt]);const tt=(function(){var m={nextZero(a,i){for(;a[i]!=0;)i++;return i},readUshort:(a,i)=>a[i]<<8|a[i+1],writeUshort(a,i,r){a[i]=r>>8&255,a[i+1]=255&r},readUint:(a,i)=>16777216*a[i]+(a[i+1]<<16|a[i+2]<<8|a[i+3]),writeUint(a,i,r){a[i]=r>>24&255,a[i+1]=r>>16&255,a[i+2]=r>>8&255,a[i+3]=255&r},readASCII(a,i,r){let l="";for(let h=0;h<r;h++)l+=String.fromCharCode(a[i+h]);return l},writeASCII(a,i,r){for(let l=0;l<r.length;l++)a[i+l]=r.charCodeAt(l)},readBytes(a,i,r){const l=[];for(let h=0;h<r;h++)l.push(a[i+h]);return l},pad:a=>a.length<2?`0${a}`:a,readUTF8(a,i,r){let l,h="";for(let N=0;N<r;N++)h+=`%${m.pad(a[i+N].toString(16))}`;try{l=decodeURIComponent(h)}catch{return m.readASCII(a,i,r)}return l}};function x(a,i,r,l){const h=i*r,N=t(l),T=Math.ceil(i*N/8),j=new Uint8Array(4*h),F=new Uint32Array(j.buffer),{ctype:U}=l,{depth:C}=l,R=m.readUshort;if(U==6){const I=h<<2;if(C==8)for(var p=0;p<I;p+=4)j[p]=a[p],j[p+1]=a[p+1],j[p+2]=a[p+2],j[p+3]=a[p+3];if(C==16)for(p=0;p<I;p++)j[p]=a[p<<1]}else if(U==2){const I=l.tabs.tRNS;if(I==null){if(C==8)for(p=0;p<h;p++){var M=3*p;F[p]=255<<24|a[M+2]<<16|a[M+1]<<8|a[M]}if(C==16)for(p=0;p<h;p++)M=6*p,F[p]=255<<24|a[M+4]<<16|a[M+2]<<8|a[M]}else{var c=I[0];const H=I[1],X=I[2];if(C==8)for(p=0;p<h;p++){var d=p<<2;M=3*p,F[p]=255<<24|a[M+2]<<16|a[M+1]<<8|a[M],a[M]==c&&a[M+1]==H&&a[M+2]==X&&(j[d+3]=0)}if(C==16)for(p=0;p<h;p++)d=p<<2,M=6*p,F[p]=255<<24|a[M+4]<<16|a[M+2]<<8|a[M],R(a,M)==c&&R(a,M+2)==H&&R(a,M+4)==X&&(j[d+3]=0)}}else if(U==3){const I=l.tabs.PLTE,H=l.tabs.tRNS,X=H?H.length:0;if(C==1)for(var _=0;_<r;_++){var A=_*T,b=_*i;for(p=0;p<i;p++){d=b+p<<2;var k=3*(w=a[A+(p>>3)]>>7-((7&p)<<0)&1);j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255}}if(C==2)for(_=0;_<r;_++)for(A=_*T,b=_*i,p=0;p<i;p++)d=b+p<<2,k=3*(w=a[A+(p>>2)]>>6-((3&p)<<1)&3),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255;if(C==4)for(_=0;_<r;_++)for(A=_*T,b=_*i,p=0;p<i;p++)d=b+p<<2,k=3*(w=a[A+(p>>1)]>>4-((1&p)<<2)&15),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255;if(C==8)for(p=0;p<h;p++){var w;d=p<<2,k=3*(w=a[p]),j[d]=I[k],j[d+1]=I[k+1],j[d+2]=I[k+2],j[d+3]=w<X?H[w]:255}}else if(U==4){if(C==8)for(p=0;p<h;p++){d=p<<2;var L=a[g=p<<1];j[d]=L,j[d+1]=L,j[d+2]=L,j[d+3]=a[g+1]}if(C==16)for(p=0;p<h;p++){var g;d=p<<2,L=a[g=p<<2],j[d]=L,j[d+1]=L,j[d+2]=L,j[d+3]=a[g+2]}}else if(U==0)for(c=l.tabs.tRNS?l.tabs.tRNS:-1,_=0;_<r;_++){const I=_*T,H=_*i;if(C==1)for(var f=0;f<i;f++){var $=(L=255*(a[I+(f>>>3)]>>>7-(7&f)&1))==255*c?0:255;F[H+f]=$<<24|L<<16|L<<8|L}else if(C==2)for(f=0;f<i;f++)$=(L=85*(a[I+(f>>>2)]>>>6-((3&f)<<1)&3))==85*c?0:255,F[H+f]=$<<24|L<<16|L<<8|L;else if(C==4)for(f=0;f<i;f++)$=(L=17*(a[I+(f>>>1)]>>>4-((1&f)<<2)&15))==17*c?0:255,F[H+f]=$<<24|L<<16|L<<8|L;else if(C==8)for(f=0;f<i;f++)$=(L=a[I+f])==c?0:255,F[H+f]=$<<24|L<<16|L<<8|L;else if(C==16)for(f=0;f<i;f++)L=a[I+(f<<1)],$=R(a,I+(f<<1))==c?0:255,F[H+f]=$<<24|L<<16|L<<8|L}return j}function E(a,i,r,l){const h=t(a),N=Math.ceil(r*h/8),T=new Uint8Array((N+1+a.interlace)*l);return i=a.tabs.CgBI?e(i,T):s(i,T),a.interlace==0?i=u(i,a,0,r,l):a.interlace==1&&(i=(function(F,U){const C=U.width,R=U.height,p=t(U),M=p>>3,c=Math.ceil(C*p/8),d=new Uint8Array(R*c);let _=0;const A=[0,0,4,0,2,0,1],b=[0,4,0,2,0,1,0],k=[8,8,8,4,4,2,2],w=[8,8,4,4,2,2,1];let L=0;for(;L<7;){const f=k[L],$=w[L];let I=0,H=0,X=A[L];for(;X<R;)X+=f,H++;let V=b[L];for(;V<C;)V+=$,I++;const Z=Math.ceil(I*p/8);u(F,U,_,I,H);let G=0,P=A[L];for(;P<R;){let se=b[L],xe=_+G*Z<<3;for(;se<C;){var g;if(p==1&&(g=(g=F[xe>>3])>>7-(7&xe)&1,d[P*c+(se>>3)]|=g<<7-((7&se)<<0)),p==2&&(g=(g=F[xe>>3])>>6-(7&xe)&3,d[P*c+(se>>2)]|=g<<6-((3&se)<<1)),p==4&&(g=(g=F[xe>>3])>>4-(7&xe)&15,d[P*c+(se>>1)]|=g<<4-((1&se)<<2)),p>=8){const fe=P*c+se*M;for(let oe=0;oe<M;oe++)d[fe+oe]=F[(xe>>3)+oe]}xe+=p,se+=$}G++,P+=f}I*H!=0&&(_+=H*(1+Z)),L+=1}return d})(i,a)),i}function s(a,i){return e(new Uint8Array(a.buffer,2,a.length-6),i)}var e=(function(){const a={H:{}};return a.H.N=function(i,r){const l=Uint8Array;let h,N,T=0,j=0,F=0,U=0,C=0,R=0,p=0,M=0,c=0;if(i[0]==3&&i[1]==0)return r||new l(0);const d=a.H,_=d.b,A=d.e,b=d.R,k=d.n,w=d.A,L=d.Z,g=d.m,f=r==null;for(f&&(r=new l(i.length>>>2<<5));T==0;)if(T=_(i,c,1),j=_(i,c+1,2),c+=3,j!=0){if(f&&(r=a.H.W(r,M+(1<<17))),j==1&&(h=g.J,N=g.h,R=511,p=31),j==2){F=A(i,c,5)+257,U=A(i,c+5,5)+1,C=A(i,c+10,4)+4,c+=14;let I=1;for(var $=0;$<38;$+=2)g.Q[$]=0,g.Q[$+1]=0;for($=0;$<C;$++){const V=A(i,c+3*$,3);g.Q[1+(g.X[$]<<1)]=V,V>I&&(I=V)}c+=3*C,k(g.Q,I),w(g.Q,I,g.u),h=g.w,N=g.d,c=b(g.u,(1<<I)-1,F+U,i,c,g.v);const H=d.V(g.v,0,F,g.C);R=(1<<H)-1;const X=d.V(g.v,F,U,g.D);p=(1<<X)-1,k(g.C,H),w(g.C,H,h),k(g.D,X),w(g.D,X,N)}for(;;){const I=h[L(i,c)&R];c+=15&I;const H=I>>>4;if(!(H>>>8))r[M++]=H;else{if(H==256)break;{let X=M+H-254;if(H>264){const se=g.q[H-257];X=M+(se>>>3)+A(i,c,7&se),c+=7&se}const V=N[L(i,c)&p];c+=15&V;const Z=V>>>4,G=g.c[Z],P=(G>>>4)+_(i,c,15&G);for(c+=15&G;M<X;)r[M]=r[M++-P],r[M]=r[M++-P],r[M]=r[M++-P],r[M]=r[M++-P];M=X}}}}else{(7&c)!=0&&(c+=8-(7&c));const I=4+(c>>>3),H=i[I-4]|i[I-3]<<8;f&&(r=a.H.W(r,M+H)),r.set(new l(i.buffer,i.byteOffset+I,H),M),c=I+H<<3,M+=H}return r.length==M?r:r.slice(0,M)},a.H.W=function(i,r){const l=i.length;if(r<=l)return i;const h=new Uint8Array(l<<1);return h.set(i,0),h},a.H.R=function(i,r,l,h,N,T){const j=a.H.e,F=a.H.Z;let U=0;for(;U<l;){const C=i[F(h,N)&r];N+=15&C;const R=C>>>4;if(R<=15)T[U]=R,U++;else{let p=0,M=0;R==16?(M=3+j(h,N,2),N+=2,p=T[U-1]):R==17?(M=3+j(h,N,3),N+=3):R==18&&(M=11+j(h,N,7),N+=7);const c=U+M;for(;U<c;)T[U]=p,U++}}return N},a.H.V=function(i,r,l,h){let N=0,T=0;const j=h.length>>>1;for(;T<l;){const F=i[T+r];h[T<<1]=0,h[1+(T<<1)]=F,F>N&&(N=F),T++}for(;T<j;)h[T<<1]=0,h[1+(T<<1)]=0,T++;return N},a.H.n=function(i,r){const l=a.H.m,h=i.length;let N,T,j,F;const U=l.j;for(var C=0;C<=r;C++)U[C]=0;for(C=1;C<h;C+=2)U[i[C]]++;const R=l.K;for(N=0,U[0]=0,T=1;T<=r;T++)N=N+U[T-1]<<1,R[T]=N;for(j=0;j<h;j+=2)F=i[j+1],F!=0&&(i[j]=R[F],R[F]++)},a.H.A=function(i,r,l){const h=i.length,N=a.H.m.r;for(let T=0;T<h;T+=2)if(i[T+1]!=0){const j=T>>1,F=i[T+1],U=j<<4|F,C=r-F;let R=i[T]<<C;const p=R+(1<<C);for(;R!=p;)l[N[R]>>>15-r]=U,R++}},a.H.l=function(i,r){const l=a.H.m.r,h=15-r;for(let N=0;N<i.length;N+=2){const T=i[N]<<r-i[N+1];i[N]=l[T]>>>h}},a.H.M=function(i,r,l){l<<=7&r;const h=r>>>3;i[h]|=l,i[h+1]|=l>>>8},a.H.I=function(i,r,l){l<<=7&r;const h=r>>>3;i[h]|=l,i[h+1]|=l>>>8,i[h+2]|=l>>>16},a.H.e=function(i,r,l){return(i[r>>>3]|i[1+(r>>>3)]<<8)>>>(7&r)&(1<<l)-1},a.H.b=function(i,r,l){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)&(1<<l)-1},a.H.Z=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16)>>>(7&r)},a.H.i=function(i,r){return(i[r>>>3]|i[1+(r>>>3)]<<8|i[2+(r>>>3)]<<16|i[3+(r>>>3)]<<24)>>>(7&r)},a.H.m=(function(){const i=Uint16Array,r=Uint32Array;return{K:new i(16),j:new i(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new i(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new r(32),J:new i(512),_:[],h:new i(32),$:[],w:new i(32768),C:[],v:[],d:new i(32768),D:[],u:new i(512),Q:[],r:new i(32768),s:new r(286),Y:new r(30),a:new r(19),t:new r(15e3),k:new i(65536),g:new i(32768)}})(),(function(){const i=a.H.m;for(var r=0;r<32768;r++){let h=r;h=(2863311530&h)>>>1|(1431655765&h)<<1,h=(3435973836&h)>>>2|(858993459&h)<<2,h=(4042322160&h)>>>4|(252645135&h)<<4,h=(4278255360&h)>>>8|(16711935&h)<<8,i.r[r]=(h>>>16|h<<16)>>>17}function l(h,N,T){for(;N--!=0;)h.push(0,T)}for(r=0;r<32;r++)i.q[r]=i.S[r]<<3|i.T[r],i.c[r]=i.p[r]<<4|i.z[r];l(i._,144,8),l(i._,112,9),l(i._,24,7),l(i._,8,8),a.H.n(i._,9),a.H.A(i._,9,i.J),a.H.l(i._,9),l(i.$,32,5),a.H.n(i.$,5),a.H.A(i.$,5,i.h),a.H.l(i.$,5),l(i.Q,19,0),l(i.C,286,0),l(i.D,30,0),l(i.v,320,0)})(),a.H.N})();function t(a){return[1,null,3,1,2,null,4][a.ctype]*a.depth}function u(a,i,r,l,h){let N=t(i);const T=Math.ceil(l*N/8);let j,F;N=Math.ceil(N/8);let U=a[r],C=0;if(U>1&&(a[r]=[0,0,1][U-2]),U==3)for(C=N;C<T;C++)a[C+1]=a[C+1]+(a[C+1-N]>>>1)&255;for(let R=0;R<h;R++)if(j=r+R*T,F=j+R+1,U=a[F-1],C=0,U==0)for(;C<T;C++)a[j+C]=a[F+C];else if(U==1){for(;C<N;C++)a[j+C]=a[F+C];for(;C<T;C++)a[j+C]=a[F+C]+a[j+C-N]}else if(U==2)for(;C<T;C++)a[j+C]=a[F+C]+a[j+C-T];else if(U==3){for(;C<N;C++)a[j+C]=a[F+C]+(a[j+C-T]>>>1);for(;C<T;C++)a[j+C]=a[F+C]+(a[j+C-T]+a[j+C-N]>>>1)}else{for(;C<N;C++)a[j+C]=a[F+C]+o(0,a[j+C-T],0);for(;C<T;C++)a[j+C]=a[F+C]+o(a[j+C-N],a[j+C-T],a[j+C-N-T])}return a}function o(a,i,r){const l=a+i-r,h=l-a,N=l-i,T=l-r;return h*h<=N*N&&h*h<=T*T?a:N*N<=T*T?i:r}function y(a,i,r){r.width=m.readUint(a,i),i+=4,r.height=m.readUint(a,i),i+=4,r.depth=a[i],i++,r.ctype=a[i],i++,r.compress=a[i],i++,r.filter=a[i],i++,r.interlace=a[i],i++}function v(a,i,r,l,h,N,T,j,F){const U=Math.min(i,h),C=Math.min(r,N);let R=0,p=0;for(let L=0;L<C;L++)for(let g=0;g<U;g++)if(T>=0&&j>=0?(R=L*i+g<<2,p=(j+L)*h+T+g<<2):(R=(-j+L)*i-T+g<<2,p=L*h+g<<2),F==0)l[p]=a[R],l[p+1]=a[R+1],l[p+2]=a[R+2],l[p+3]=a[R+3];else if(F==1){var M=a[R+3]*.00392156862745098,c=a[R]*M,d=a[R+1]*M,_=a[R+2]*M,A=l[p+3]*(1/255),b=l[p]*A,k=l[p+1]*A,w=l[p+2]*A;const f=1-M,$=M+A*f,I=$==0?0:1/$;l[p+3]=255*$,l[p+0]=(c+b*f)*I,l[p+1]=(d+k*f)*I,l[p+2]=(_+w*f)*I}else if(F==2)M=a[R+3],c=a[R],d=a[R+1],_=a[R+2],A=l[p+3],b=l[p],k=l[p+1],w=l[p+2],M==A&&c==b&&d==k&&_==w?(l[p]=0,l[p+1]=0,l[p+2]=0,l[p+3]=0):(l[p]=c,l[p+1]=d,l[p+2]=_,l[p+3]=M);else if(F==3){if(M=a[R+3],c=a[R],d=a[R+1],_=a[R+2],A=l[p+3],b=l[p],k=l[p+1],w=l[p+2],M==A&&c==b&&d==k&&_==w)continue;if(M<220&&A>20)return!1}return!0}return{decode:function(i){const r=new Uint8Array(i);let l=8;const h=m,N=h.readUshort,T=h.readUint,j={tabs:{},frames:[]},F=new Uint8Array(r.length);let U,C=0,R=0;const p=[137,80,78,71,13,10,26,10];for(var M=0;M<8;M++)if(r[M]!=p[M])throw"The input is not a PNG file!";for(;l<r.length;){const L=h.readUint(r,l);l+=4;const g=h.readASCII(r,l,4);if(l+=4,g=="IHDR")y(r,l,j);else if(g=="iCCP"){for(var c=l;r[c]!=0;)c++;h.readASCII(r,l,c-l),r[c+1];const f=r.slice(c+2,l+L);let $=null;try{$=s(f)}catch{$=e(f)}j.tabs[g]=$}else if(g=="CgBI")j.tabs[g]=r.slice(l,l+4);else if(g=="IDAT"){for(M=0;M<L;M++)F[C+M]=r[l+M];C+=L}else if(g=="acTL")j.tabs[g]={num_frames:T(r,l),num_plays:T(r,l+4)},U=new Uint8Array(r.length);else if(g=="fcTL"){R!=0&&((w=j.frames[j.frames.length-1]).data=E(j,U.slice(0,R),w.rect.width,w.rect.height),R=0);const f={x:T(r,l+12),y:T(r,l+16),width:T(r,l+4),height:T(r,l+8)};let $=N(r,l+22);$=N(r,l+20)/($==0?100:$);const I={rect:f,delay:Math.round(1e3*$),dispose:r[l+24],blend:r[l+25]};j.frames.push(I)}else if(g=="fdAT"){for(M=0;M<L-4;M++)U[R+M]=r[l+M+4];R+=L-4}else if(g=="pHYs")j.tabs[g]=[h.readUint(r,l),h.readUint(r,l+4),r[l+8]];else if(g=="cHRM")for(j.tabs[g]=[],M=0;M<8;M++)j.tabs[g].push(h.readUint(r,l+4*M));else if(g=="tEXt"||g=="zTXt"){j.tabs[g]==null&&(j.tabs[g]={});var d=h.nextZero(r,l),_=h.readASCII(r,l,d-l),A=l+L-d-1;if(g=="tEXt")k=h.readASCII(r,d+1,A);else{var b=s(r.slice(d+2,d+2+A));k=h.readUTF8(b,0,b.length)}j.tabs[g][_]=k}else if(g=="iTXt"){j.tabs[g]==null&&(j.tabs[g]={}),d=0,c=l,d=h.nextZero(r,c),_=h.readASCII(r,c,d-c);const f=r[c=d+1];var k;r[c+1],c+=2,d=h.nextZero(r,c),h.readASCII(r,c,d-c),c=d+1,d=h.nextZero(r,c),h.readUTF8(r,c,d-c),A=L-((c=d+1)-l),f==0?k=h.readUTF8(r,c,A):(b=s(r.slice(c,c+A)),k=h.readUTF8(b,0,b.length)),j.tabs[g][_]=k}else if(g=="PLTE")j.tabs[g]=h.readBytes(r,l,L);else if(g=="hIST"){const f=j.tabs.PLTE.length/3;for(j.tabs[g]=[],M=0;M<f;M++)j.tabs[g].push(N(r,l+2*M))}else if(g=="tRNS")j.ctype==3?j.tabs[g]=h.readBytes(r,l,L):j.ctype==0?j.tabs[g]=N(r,l):j.ctype==2&&(j.tabs[g]=[N(r,l),N(r,l+2),N(r,l+4)]);else if(g=="gAMA")j.tabs[g]=h.readUint(r,l)/1e5;else if(g=="sRGB")j.tabs[g]=r[l];else if(g=="bKGD")j.ctype==0||j.ctype==4?j.tabs[g]=[N(r,l)]:j.ctype==2||j.ctype==6?j.tabs[g]=[N(r,l),N(r,l+2),N(r,l+4)]:j.ctype==3&&(j.tabs[g]=r[l]);else if(g=="IEND")break;l+=L,h.readUint(r,l),l+=4}var w;return R!=0&&((w=j.frames[j.frames.length-1]).data=E(j,U.slice(0,R),w.rect.width,w.rect.height)),j.data=E(j,F,j.width,j.height),delete j.compress,delete j.interlace,delete j.filter,j},toRGBA8:function(i){const r=i.width,l=i.height;if(i.tabs.acTL==null)return[x(i.data,r,l,i).buffer];const h=[];i.frames[0].data==null&&(i.frames[0].data=i.data);const N=r*l*4,T=new Uint8Array(N),j=new Uint8Array(N),F=new Uint8Array(N);for(let C=0;C<i.frames.length;C++){const R=i.frames[C],p=R.rect.x,M=R.rect.y,c=R.rect.width,d=R.rect.height,_=x(R.data,c,d,i);if(C!=0)for(var U=0;U<N;U++)F[U]=T[U];if(R.blend==0?v(_,c,d,T,r,l,p,M,0):R.blend==1&&v(_,c,d,T,r,l,p,M,1),h.push(T.buffer.slice(0)),R.dispose!=0){if(R.dispose==1)v(j,c,d,T,r,l,p,M,0);else if(R.dispose==2)for(U=0;U<N;U++)T[U]=F[U]}}return h},_paeth:o,_copyTile:v,_bin:m}})();(function(){const{_copyTile:m}=tt,{_bin:x}=tt,E=tt._paeth;var s={table:(function(){const c=new Uint32Array(256);for(let d=0;d<256;d++){let _=d;for(let A=0;A<8;A++)1&_?_=3988292384^_>>>1:_>>>=1;c[d]=_}return c})(),update(c,d,_,A){for(let b=0;b<A;b++)c=s.table[255&(c^d[_+b])]^c>>>8;return c},crc:(c,d,_)=>4294967295^s.update(4294967295,c,d,_)};function e(c,d,_,A){d[_]+=c[0]*A>>4,d[_+1]+=c[1]*A>>4,d[_+2]+=c[2]*A>>4,d[_+3]+=c[3]*A>>4}function t(c){return Math.max(0,Math.min(255,c))}function u(c,d){const _=c[0]-d[0],A=c[1]-d[1],b=c[2]-d[2],k=c[3]-d[3];return _*_+A*A+b*b+k*k}function o(c,d,_,A,b,k,w){w==null&&(w=1);const L=A.length,g=[];for(var f=0;f<L;f++){const P=A[f];g.push([P>>>0&255,P>>>8&255,P>>>16&255,P>>>24&255])}for(f=0;f<L;f++){let P=4294967295;for(var $=0,I=0;I<L;I++){var H=u(g[f],g[I]);I!=f&&H<P&&(P=H,$=I)}}const X=new Uint32Array(b.buffer),V=new Int16Array(d*_*4),Z=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(f=0;f<Z.length;f++)Z[f]=255*((Z[f]+.5)/16-.5);for(let P=0;P<_;P++)for(let se=0;se<d;se++){var G;f=4*(P*d+se),w!=2?G=[t(c[f]+V[f]),t(c[f+1]+V[f+1]),t(c[f+2]+V[f+2]),t(c[f+3]+V[f+3])]:(H=Z[4*(3&P)+(3&se)],G=[t(c[f]+H),t(c[f+1]+H),t(c[f+2]+H),t(c[f+3]+H)]),$=0;let xe=16777215;for(I=0;I<L;I++){const be=u(G,g[I]);be<xe&&(xe=be,$=I)}const fe=g[$],oe=[G[0]-fe[0],G[1]-fe[1],G[2]-fe[2],G[3]-fe[3]];w==1&&(se!=d-1&&e(oe,V,f+4,7),P!=_-1&&(se!=0&&e(oe,V,f+4*d-4,3),e(oe,V,f+4*d,5),se!=d-1&&e(oe,V,f+4*d+4,1))),k[f>>2]=$,X[f>>2]=A[$]}}function y(c,d,_,A,b){b==null&&(b={});const{crc:k}=s,w=x.writeUint,L=x.writeUshort,g=x.writeASCII;let f=8;const $=c.frames.length>1;let I,H=!1,X=33+($?20:0);if(b.sRGB!=null&&(X+=13),b.pHYs!=null&&(X+=21),b.iCCP!=null&&(I=pako.deflate(b.iCCP),X+=21+I.length+4),c.ctype==3){for(var V=c.plte.length,Z=0;Z<V;Z++)c.plte[Z]>>>24!=255&&(H=!0);X+=8+3*V+4+(H?8+1*V+4:0)}for(var G=0;G<c.frames.length;G++)$&&(X+=38),X+=(fe=c.frames[G]).cimg.length+12,G!=0&&(X+=4);X+=12;const P=new Uint8Array(X),se=[137,80,78,71,13,10,26,10];for(Z=0;Z<8;Z++)P[Z]=se[Z];if(w(P,f,13),f+=4,g(P,f,"IHDR"),f+=4,w(P,f,d),f+=4,w(P,f,_),f+=4,P[f]=c.depth,f++,P[f]=c.ctype,f++,P[f]=0,f++,P[f]=0,f++,P[f]=0,f++,w(P,f,k(P,f-17,17)),f+=4,b.sRGB!=null&&(w(P,f,1),f+=4,g(P,f,"sRGB"),f+=4,P[f]=b.sRGB,f++,w(P,f,k(P,f-5,5)),f+=4),b.iCCP!=null){const oe=13+I.length;w(P,f,oe),f+=4,g(P,f,"iCCP"),f+=4,g(P,f,"ICC profile"),f+=11,f+=2,P.set(I,f),f+=I.length,w(P,f,k(P,f-(oe+4),oe+4)),f+=4}if(b.pHYs!=null&&(w(P,f,9),f+=4,g(P,f,"pHYs"),f+=4,w(P,f,b.pHYs[0]),f+=4,w(P,f,b.pHYs[1]),f+=4,P[f]=b.pHYs[2],f++,w(P,f,k(P,f-13,13)),f+=4),$&&(w(P,f,8),f+=4,g(P,f,"acTL"),f+=4,w(P,f,c.frames.length),f+=4,w(P,f,b.loop!=null?b.loop:0),f+=4,w(P,f,k(P,f-12,12)),f+=4),c.ctype==3){for(w(P,f,3*(V=c.plte.length)),f+=4,g(P,f,"PLTE"),f+=4,Z=0;Z<V;Z++){const oe=3*Z,be=c.plte[Z],he=255&be,Le=be>>>8&255,qe=be>>>16&255;P[f+oe+0]=he,P[f+oe+1]=Le,P[f+oe+2]=qe}if(f+=3*V,w(P,f,k(P,f-3*V-4,3*V+4)),f+=4,H){for(w(P,f,V),f+=4,g(P,f,"tRNS"),f+=4,Z=0;Z<V;Z++)P[f+Z]=c.plte[Z]>>>24&255;f+=V,w(P,f,k(P,f-V-4,V+4)),f+=4}}let xe=0;for(G=0;G<c.frames.length;G++){var fe=c.frames[G];$&&(w(P,f,26),f+=4,g(P,f,"fcTL"),f+=4,w(P,f,xe++),f+=4,w(P,f,fe.rect.width),f+=4,w(P,f,fe.rect.height),f+=4,w(P,f,fe.rect.x),f+=4,w(P,f,fe.rect.y),f+=4,L(P,f,A[G]),f+=2,L(P,f,1e3),f+=2,P[f]=fe.dispose,f++,P[f]=fe.blend,f++,w(P,f,k(P,f-30,30)),f+=4);const oe=fe.cimg;w(P,f,(V=oe.length)+(G==0?0:4)),f+=4;const be=f;g(P,f,G==0?"IDAT":"fdAT"),f+=4,G!=0&&(w(P,f,xe++),f+=4),P.set(oe,f),f+=V,w(P,f,k(P,be,f-be)),f+=4}return w(P,f,0),f+=4,g(P,f,"IEND"),f+=4,w(P,f,k(P,f-4,4)),f+=4,P.buffer}function v(c,d,_){for(let A=0;A<c.frames.length;A++){const b=c.frames[A];b.rect.width;const k=b.rect.height,w=new Uint8Array(k*b.bpl+k);b.cimg=l(b.img,k,b.bpp,b.bpl,w,d,_)}}function a(c,d,_,A,b){const k=b[0],w=b[1],L=b[2],g=b[3],f=b[4],$=b[5];let I=6,H=8,X=255;for(var V=0;V<c.length;V++){const Ue=new Uint8Array(c[V]);for(var Z=Ue.length,G=0;G<Z;G+=4)X&=Ue[G+3]}const P=X!=255,se=(function(we,ge,Ee,Fe,ve,ze){const Se=[];for(var je=0;je<we.length;je++){const Ie=new Uint8Array(we[je]),We=new Uint32Array(Ie.buffer);var Re;let De=0,Xe=0,Qe=ge,Je=Ee,ft=Fe?1:0;if(je!=0){const xt=ze||Fe||je==1||Se[je-2].dispose!=0?1:2;let bt=0,Be=1e9;for(let mt=0;mt<xt;mt++){var Ve=new Uint8Array(we[je-1-mt]);const at=new Uint32Array(we[je-1-mt]);let st=ge,et=Ee,it=-1,ht=-1;for(let ot=0;ot<Ee;ot++)for(let lt=0;lt<ge;lt++)We[Te=ot*ge+lt]!=at[Te]&&(lt<st&&(st=lt),lt>it&&(it=lt),ot<et&&(et=ot),ot>ht&&(ht=ot));it==-1&&(st=et=it=ht=0),ve&&((1&st)==1&&st--,(1&et)==1&&et--);const jt=(it-st+1)*(ht-et+1);jt<Be&&(Be=jt,bt=mt,De=st,Xe=et,Qe=it-st+1,Je=ht-et+1)}Ve=new Uint8Array(we[je-1-bt]),bt==1&&(Se[je-1].dispose=2),Re=new Uint8Array(Qe*Je*4),m(Ve,ge,Ee,Re,Qe,Je,-De,-Xe,0),ft=m(Ie,ge,Ee,Re,Qe,Je,-De,-Xe,3)?1:0,ft==1?r(Ie,ge,Ee,Re,{x:De,y:Xe,width:Qe,height:Je}):m(Ie,ge,Ee,Re,Qe,Je,-De,-Xe,0)}else Re=Ie.slice(0);Se.push({rect:{x:De,y:Xe,width:Qe,height:Je},img:Re,blend:ft,dispose:0})}if(Fe)for(je=0;je<Se.length;je++){if((nt=Se[je]).blend==1)continue;const Ie=nt.rect,We=Se[je-1].rect,De=Math.min(Ie.x,We.x),Xe=Math.min(Ie.y,We.y),Qe={x:De,y:Xe,width:Math.max(Ie.x+Ie.width,We.x+We.width)-De,height:Math.max(Ie.y+Ie.height,We.y+We.height)-Xe};Se[je-1].dispose=1,je-1!=0&&i(we,ge,Ee,Se,je-1,Qe,ve),i(we,ge,Ee,Se,je,Qe,ve)}let ut=0;if(we.length!=1)for(var Te=0;Te<Se.length;Te++){var nt;ut+=(nt=Se[Te]).rect.width*nt.rect.height}return Se})(c,d,_,k,w,L),xe={},fe=[],oe=[];if(A!=0){const Ue=[];for(G=0;G<se.length;G++)Ue.push(se[G].img.buffer);const we=(function(ve){let ze=0;for(var Se=0;Se<ve.length;Se++)ze+=ve[Se].byteLength;const je=new Uint8Array(ze);let Re=0;for(Se=0;Se<ve.length;Se++){const Ve=new Uint8Array(ve[Se]),ut=Ve.length;for(let Te=0;Te<ut;Te+=4){let nt=Ve[Te],Ie=Ve[Te+1],We=Ve[Te+2];const De=Ve[Te+3];De==0&&(nt=Ie=We=0),je[Re+Te]=nt,je[Re+Te+1]=Ie,je[Re+Te+2]=We,je[Re+Te+3]=De}Re+=ut}return je.buffer})(Ue),ge=N(we,A);for(G=0;G<ge.plte.length;G++)fe.push(ge.plte[G].est.rgba);let Ee=0;for(G=0;G<se.length;G++){const Fe=(he=se[G]).img.length;var be=new Uint8Array(ge.inds.buffer,Ee>>2,Fe>>2);oe.push(be);const ve=new Uint8Array(ge.abuf,Ee,Fe);$&&o(he.img,he.rect.width,he.rect.height,fe,ve,be),he.img.set(ve),Ee+=Fe}}else for(V=0;V<se.length;V++){var he=se[V];const Ue=new Uint32Array(he.img.buffer);var Le=he.rect.width;for(Z=Ue.length,be=new Uint8Array(Z),oe.push(be),G=0;G<Z;G++){const we=Ue[G];if(G!=0&&we==Ue[G-1])be[G]=be[G-1];else if(G>Le&&we==Ue[G-Le])be[G]=be[G-Le];else{let ge=xe[we];if(ge==null&&(xe[we]=ge=fe.length,fe.push(we),fe.length>=300))break;be[G]=ge}}}const qe=fe.length;for(qe<=256&&f==0&&(H=qe<=2?1:qe<=4?2:qe<=16?4:8,H=Math.max(H,g)),V=0;V<se.length;V++){(he=se[V]).rect.x,he.rect.y,Le=he.rect.width;const Ue=he.rect.height;let we=he.img;new Uint32Array(we.buffer);let ge=4*Le,Ee=4;if(qe<=256&&f==0){ge=Math.ceil(H*Le/8);var Ye=new Uint8Array(ge*Ue);const Fe=oe[V];for(let ve=0;ve<Ue;ve++){G=ve*ge;const ze=ve*Le;if(H==8)for(var Ne=0;Ne<Le;Ne++)Ye[G+Ne]=Fe[ze+Ne];else if(H==4)for(Ne=0;Ne<Le;Ne++)Ye[G+(Ne>>1)]|=Fe[ze+Ne]<<4-4*(1&Ne);else if(H==2)for(Ne=0;Ne<Le;Ne++)Ye[G+(Ne>>2)]|=Fe[ze+Ne]<<6-2*(3&Ne);else if(H==1)for(Ne=0;Ne<Le;Ne++)Ye[G+(Ne>>3)]|=Fe[ze+Ne]<<7-1*(7&Ne)}we=Ye,I=3,Ee=1}else if(P==0&&se.length==1){Ye=new Uint8Array(Le*Ue*3);const Fe=Le*Ue;for(G=0;G<Fe;G++){const ve=3*G,ze=4*G;Ye[ve]=we[ze],Ye[ve+1]=we[ze+1],Ye[ve+2]=we[ze+2]}we=Ye,I=2,Ee=3,ge=3*Le}he.img=we,he.bpl=ge,he.bpp=Ee}return{ctype:I,depth:H,plte:fe,frames:se}}function i(c,d,_,A,b,k,w){const L=Uint8Array,g=Uint32Array,f=new L(c[b-1]),$=new g(c[b-1]),I=b+1<c.length?new L(c[b+1]):null,H=new L(c[b]),X=new g(H.buffer);let V=d,Z=_,G=-1,P=-1;for(let xe=0;xe<k.height;xe++)for(let fe=0;fe<k.width;fe++){const oe=k.x+fe,be=k.y+xe,he=be*d+oe,Le=X[he];Le==0||A[b-1].dispose==0&&$[he]==Le&&(I==null||I[4*he+3]!=0)||(oe<V&&(V=oe),oe>G&&(G=oe),be<Z&&(Z=be),be>P&&(P=be))}G==-1&&(V=Z=G=P=0),w&&((1&V)==1&&V--,(1&Z)==1&&Z--),k={x:V,y:Z,width:G-V+1,height:P-Z+1};const se=A[b];se.rect=k,se.blend=1,se.img=new Uint8Array(k.width*k.height*4),A[b-1].dispose==0?(m(f,d,_,se.img,k.width,k.height,-k.x,-k.y,0),r(H,d,_,se.img,k)):m(H,d,_,se.img,k.width,k.height,-k.x,-k.y,0)}function r(c,d,_,A,b){m(c,d,_,A,b.width,b.height,-b.x,-b.y,2)}function l(c,d,_,A,b,k,w){const L=[];let g,f=[0,1,2,3,4];k!=-1?f=[k]:(d*A>5e5||_==1)&&(f=[0]),w&&(g={level:0});const $=zn;for(var I=0;I<f.length;I++){for(let V=0;V<d;V++)h(b,c,V,A,_,f[I]);L.push($.deflate(b,g))}let H,X=1e9;for(I=0;I<L.length;I++)L[I].length<X&&(H=I,X=L[I].length);return L[H]}function h(c,d,_,A,b,k){const w=_*A;let L=w+_;if(c[L]=k,L++,k==0)if(A<500)for(var g=0;g<A;g++)c[L+g]=d[w+g];else c.set(new Uint8Array(d.buffer,w,A),L);else if(k==1){for(g=0;g<b;g++)c[L+g]=d[w+g];for(g=b;g<A;g++)c[L+g]=d[w+g]-d[w+g-b]+256&255}else if(_==0){for(g=0;g<b;g++)c[L+g]=d[w+g];if(k==2)for(g=b;g<A;g++)c[L+g]=d[w+g];if(k==3)for(g=b;g<A;g++)c[L+g]=d[w+g]-(d[w+g-b]>>1)+256&255;if(k==4)for(g=b;g<A;g++)c[L+g]=d[w+g]-E(d[w+g-b],0,0)+256&255}else{if(k==2)for(g=0;g<A;g++)c[L+g]=d[w+g]+256-d[w+g-A]&255;if(k==3){for(g=0;g<b;g++)c[L+g]=d[w+g]+256-(d[w+g-A]>>1)&255;for(g=b;g<A;g++)c[L+g]=d[w+g]+256-(d[w+g-A]+d[w+g-b]>>1)&255}if(k==4){for(g=0;g<b;g++)c[L+g]=d[w+g]+256-E(0,d[w+g-A],0)&255;for(g=b;g<A;g++)c[L+g]=d[w+g]+256-E(d[w+g-b],d[w+g-A],d[w+g-b-A])&255}}}function N(c,d){const _=new Uint8Array(c),A=_.slice(0),b=new Uint32Array(A.buffer),k=T(A,d),w=k[0],L=k[1],g=_.length,f=new Uint8Array(g>>2);let $;if(_.length<2e7)for(var I=0;I<g;I+=4)$=j(w,H=_[I]*(1/255),X=_[I+1]*(1/255),V=_[I+2]*(1/255),Z=_[I+3]*(1/255)),f[I>>2]=$.ind,b[I>>2]=$.est.rgba;else for(I=0;I<g;I+=4){var H=_[I]*.00392156862745098,X=_[I+1]*(1/255),V=_[I+2]*(1/255),Z=_[I+3]*(1/255);for($=w;$.left;)$=F($.est,H,X,V,Z)<=0?$.left:$.right;f[I>>2]=$.ind,b[I>>2]=$.est.rgba}return{abuf:A.buffer,inds:f,plte:L}}function T(c,d,_){_==null&&(_=1e-4);const A=new Uint32Array(c.buffer),b={i0:0,i1:c.length,bst:null,est:null,tdst:0,left:null,right:null};b.bst=R(c,b.i0,b.i1),b.est=p(b.bst);const k=[b];for(;k.length<d;){let L=0,g=0;for(var w=0;w<k.length;w++)k[w].est.L>L&&(L=k[w].est.L,g=w);if(L<_)break;const f=k[g],$=U(c,A,f.i0,f.i1,f.est.e,f.est.eMq255);if(f.i0>=$||f.i1<=$){f.est.L=0;continue}const I={i0:f.i0,i1:$,bst:null,est:null,tdst:0,left:null,right:null};I.bst=R(c,I.i0,I.i1),I.est=p(I.bst);const H={i0:$,i1:f.i1,bst:null,est:null,tdst:0,left:null,right:null};for(H.bst={R:[],m:[],N:f.bst.N-I.bst.N},w=0;w<16;w++)H.bst.R[w]=f.bst.R[w]-I.bst.R[w];for(w=0;w<4;w++)H.bst.m[w]=f.bst.m[w]-I.bst.m[w];H.est=p(H.bst),f.left=I,f.right=H,k[g]=I,k.push(H)}for(k.sort(((L,g)=>g.bst.N-L.bst.N)),w=0;w<k.length;w++)k[w].ind=w;return[b,k]}function j(c,d,_,A,b){if(c.left==null)return c.tdst=(function(I,H,X,V,Z){const G=H-I[0],P=X-I[1],se=V-I[2],xe=Z-I[3];return G*G+P*P+se*se+xe*xe})(c.est.q,d,_,A,b),c;const k=F(c.est,d,_,A,b);let w=c.left,L=c.right;k>0&&(w=c.right,L=c.left);const g=j(w,d,_,A,b);if(g.tdst<=k*k)return g;const f=j(L,d,_,A,b);return f.tdst<g.tdst?f:g}function F(c,d,_,A,b){const{e:k}=c;return k[0]*d+k[1]*_+k[2]*A+k[3]*b-c.eMq}function U(c,d,_,A,b,k){for(A-=4;_<A;){for(;C(c,_,b)<=k;)_+=4;for(;C(c,A,b)>k;)A-=4;if(_>=A)break;const w=d[_>>2];d[_>>2]=d[A>>2],d[A>>2]=w,_+=4,A-=4}for(;C(c,_,b)>k;)_-=4;return _+4}function C(c,d,_){return c[d]*_[0]+c[d+1]*_[1]+c[d+2]*_[2]+c[d+3]*_[3]}function R(c,d,_){const A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b=[0,0,0,0],k=_-d>>2;for(let w=d;w<_;w+=4){const L=c[w]*.00392156862745098,g=c[w+1]*(1/255),f=c[w+2]*(1/255),$=c[w+3]*(1/255);b[0]+=L,b[1]+=g,b[2]+=f,b[3]+=$,A[0]+=L*L,A[1]+=L*g,A[2]+=L*f,A[3]+=L*$,A[5]+=g*g,A[6]+=g*f,A[7]+=g*$,A[10]+=f*f,A[11]+=f*$,A[15]+=$*$}return A[4]=A[1],A[8]=A[2],A[9]=A[6],A[12]=A[3],A[13]=A[7],A[14]=A[11],{R:A,m:b,N:k}}function p(c){const{R:d}=c,{m:_}=c,{N:A}=c,b=_[0],k=_[1],w=_[2],L=_[3],g=A==0?0:1/A,f=[d[0]-b*b*g,d[1]-b*k*g,d[2]-b*w*g,d[3]-b*L*g,d[4]-k*b*g,d[5]-k*k*g,d[6]-k*w*g,d[7]-k*L*g,d[8]-w*b*g,d[9]-w*k*g,d[10]-w*w*g,d[11]-w*L*g,d[12]-L*b*g,d[13]-L*k*g,d[14]-L*w*g,d[15]-L*L*g],$=f,I=M;let H=[Math.random(),Math.random(),Math.random(),Math.random()],X=0,V=0;if(A!=0)for(let G=0;G<16&&(H=I.multVec($,H),V=Math.sqrt(I.dot(H,H)),H=I.sml(1/V,H),!(G!=0&&Math.abs(V-X)<1e-9));G++)X=V;const Z=[b*g,k*g,w*g,L*g];return{Cov:f,q:Z,e:H,L:X,eMq255:I.dot(I.sml(255,Z),H),eMq:I.dot(H,Z),rgba:(Math.round(255*Z[3])<<24|Math.round(255*Z[2])<<16|Math.round(255*Z[1])<<8|Math.round(255*Z[0])<<0)>>>0}}var M={multVec:(c,d)=>[c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3],c[4]*d[0]+c[5]*d[1]+c[6]*d[2]+c[7]*d[3],c[8]*d[0]+c[9]*d[1]+c[10]*d[2]+c[11]*d[3],c[12]*d[0]+c[13]*d[1]+c[14]*d[2]+c[15]*d[3]],dot:(c,d)=>c[0]*d[0]+c[1]*d[1]+c[2]*d[2]+c[3]*d[3],sml:(c,d)=>[c*d[0],c*d[1],c*d[2],c*d[3]]};tt.encode=function(d,_,A,b,k,w,L){b==null&&(b=0),L==null&&(L=!1);const g=a(d,_,A,b,[!1,!1,!1,0,L,!1]);return v(g,-1),y(g,_,A,k,w)},tt.encodeLL=function(d,_,A,b,k,w,L,g){const f={ctype:0+(b==1?0:2)+(k==0?0:4),depth:w,frames:[]},$=(b+k)*w,I=$*_;for(let H=0;H<d.length;H++)f.frames.push({rect:{x:0,y:0,width:_,height:A},img:new Uint8Array(d[H]),blend:0,dispose:1,bpp:Math.ceil($/8),bpl:Math.ceil(I/8)});return v(f,0,!0),y(f,_,A,L,g)},tt.encode.compress=a,tt.encode.dither=o,tt.quantize=N,tt.quantize.getKDtree=T,tt.quantize.getNearest=j})();const dn={toArrayBuffer(m,x){const E=m.width,s=m.height,e=E<<2,t=m.getContext("2d").getImageData(0,0,E,s),u=new Uint32Array(t.data.buffer),o=(32*E+31)/32<<2,y=o*s,v=122+y,a=new ArrayBuffer(v),i=new DataView(a),r=1<<20;let l,h,N,T,j=r,F=0,U=0,C=0;function R(c){i.setUint16(U,c,!0),U+=2}function p(c){i.setUint32(U,c,!0),U+=4}function M(c){U+=c}R(19778),p(v),M(4),p(122),p(108),p(E),p(-s>>>0),R(1),R(32),p(3),p(y),p(2835),p(2835),M(8),p(16711680),p(65280),p(255),p(4278190080),p(1466527264),(function c(){for(;F<s&&j>0;){for(T=122+F*o,l=0;l<e;)j--,h=u[C++],N=h>>>24,i.setUint32(T+l,h<<8|N),l+=4;F++}C<u.length?(j=r,setTimeout(c,dn._dly)):x(a)})()},toBlob(m,x){this.toArrayBuffer(m,(E=>{x(new Blob([E],{type:"image/bmp"}))}))},_dly:9};var Oe={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},Gn={[Oe.CHROME]:16384,[Oe.FIREFOX]:11180,[Oe.DESKTOP_SAFARI]:16384,[Oe.IE]:8192,[Oe.IOS]:4096,[Oe.ETC]:8192};const Wt=typeof window<"u",un=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Et=Wt&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),Wn=(Wt||un)&&(Et&&Et.getOriginalSymbol(window,"File")||typeof File<"u"&&File),fn=(Wt||un)&&(Et&&Et.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function Bt(m,x,E=Date.now()){return new Promise((s=>{const e=m.split(","),t=e[0].match(/:(.*?);/)[1],u=globalThis.atob(e[1]);let o=u.length;const y=new Uint8Array(o);for(;o--;)y[o]=u.charCodeAt(o);const v=new Blob([y],{type:t});v.name=x,v.lastModified=E,s(v)}))}function mn(m){return new Promise(((x,E)=>{const s=new fn;s.onload=()=>x(s.result),s.onerror=e=>E(e),s.readAsDataURL(m)}))}function hn(m){return new Promise(((x,E)=>{const s=new Image;s.onload=()=>x(s),s.onerror=e=>E(e),s.src=m}))}function gt(){if(gt.cachedResult!==void 0)return gt.cachedResult;let m=Oe.ETC;const{userAgent:x}=navigator;return/Chrom(e|ium)/i.test(x)?m=Oe.CHROME:/iP(ad|od|hone)/i.test(x)&&/WebKit/i.test(x)?m=Oe.IOS:/Safari/i.test(x)?m=Oe.DESKTOP_SAFARI:/Firefox/i.test(x)?m=Oe.FIREFOX:(/MSIE/i.test(x)||document.documentMode)&&(m=Oe.IE),gt.cachedResult=m,gt.cachedResult}function gn(m,x){const E=gt(),s=Gn[E];let e=m,t=x,u=e*t;const o=e>t?t/e:e/t;for(;u>s*s;){const y=(s+e)/2,v=(s+t)/2;y<v?(t=v,e=v*o):(t=y*o,e=y),u=e*t}return{width:e,height:t}}function It(m,x){let E,s;try{if(E=new OffscreenCanvas(m,x),s=E.getContext("2d"),s===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{E=document.createElement("canvas"),s=E.getContext("2d")}return E.width=m,E.height=x,[E,s]}function pn(m,x){const{width:E,height:s}=gn(m.width,m.height),[e,t]=It(E,s);return x&&/jpe?g/.test(x)&&(t.fillStyle="white",t.fillRect(0,0,e.width,e.height)),t.drawImage(m,0,0,e.width,e.height),e}function Ct(){return Ct.cachedResult!==void 0||(Ct.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),Ct.cachedResult}function Tt(m,x={}){return new Promise((function(E,s){let e,t;var u=function(){try{return t=pn(e,x.fileType||m.type),E([e,t])}catch(y){return s(y)}},o=function(y){try{var v=function(a){try{throw a}catch(i){return s(i)}};try{let a;return mn(m).then((function(i){try{return a=i,hn(a).then((function(r){try{return e=r,(function(){try{return u()}catch(l){return s(l)}})()}catch(l){return v(l)}}),v)}catch(r){return v(r)}}),v)}catch(a){v(a)}}catch(a){return s(a)}};try{if(Ct()||[Oe.DESKTOP_SAFARI,Oe.MOBILE_SAFARI].includes(gt()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(m).then((function(y){try{return e=y,u()}catch{return o()}}),o)}catch{o()}}))}function Mt(m,x,E,s,e=1){return new Promise((function(t,u){let o;if(x==="image/png"){let v,a,i;return v=m.getContext("2d"),{data:a}=v.getImageData(0,0,m.width,m.height),i=tt.encode([a.buffer],m.width,m.height,4096*e),o=new Blob([i],{type:x}),o.name=E,o.lastModified=s,y.call(this)}{let v=function(){return y.call(this)};if(x==="image/bmp")return new Promise((a=>dn.toBlob(m,a))).then((function(a){try{return o=a,o.name=E,o.lastModified=s,v.call(this)}catch(i){return u(i)}}).bind(this),u);{let a=function(){return v.call(this)};if(typeof OffscreenCanvas=="function"&&m instanceof OffscreenCanvas)return m.convertToBlob({type:x,quality:e}).then((function(i){try{return o=i,o.name=E,o.lastModified=s,a.call(this)}catch(r){return u(r)}}).bind(this),u);{let i;return i=m.toDataURL(x,e),Bt(i,E,s).then((function(r){try{return o=r,a.call(this)}catch(l){return u(l)}}).bind(this),u)}}}function y(){return t(o)}}))}function rt(m){m.width=0,m.height=0}function pt(){return new Promise((function(m,x){let E,s,e,t;return pt.cachedResult!==void 0?m(pt.cachedResult):Bt("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then((function(u){try{return E=u,Tt(E).then((function(o){try{return s=o[1],Mt(s,E.type,E.name,E.lastModified).then((function(y){try{return e=y,rt(s),Tt(e).then((function(v){try{return t=v[0],pt.cachedResult=t.width===1&&t.height===2,m(pt.cachedResult)}catch(a){return x(a)}}),x)}catch(v){return x(v)}}),x)}catch(y){return x(y)}}),x)}catch(o){return x(o)}}),x)}))}function xn(m){return new Promise(((x,E)=>{const s=new fn;s.onload=e=>{const t=new DataView(e.target.result);if(t.getUint16(0,!1)!=65496)return x(-2);const u=t.byteLength;let o=2;for(;o<u;){if(t.getUint16(o+2,!1)<=8)return x(-1);const y=t.getUint16(o,!1);if(o+=2,y==65505){if(t.getUint32(o+=2,!1)!=1165519206)return x(-1);const v=t.getUint16(o+=6,!1)==18761;o+=t.getUint32(o+4,v);const a=t.getUint16(o,v);o+=2;for(let i=0;i<a;i++)if(t.getUint16(o+12*i,v)==274)return x(t.getUint16(o+12*i+8,v))}else{if((65280&y)!=65280)break;o+=t.getUint16(o,!1)}}return x(-1)},s.onerror=e=>E(e),s.readAsArrayBuffer(m)}))}function bn(m,x){const{width:E}=m,{height:s}=m,{maxWidthOrHeight:e}=x;let t,u=m;return isFinite(e)&&(E>e||s>e)&&([u,t]=It(E,s),E>s?(u.width=e,u.height=s/E*e):(u.width=E/s*e,u.height=e),t.drawImage(m,0,0,u.width,u.height),rt(m)),u}function wn(m,x){const{width:E}=m,{height:s}=m,[e,t]=It(E,s);switch(x>4&&x<9?(e.width=s,e.height=E):(e.width=E,e.height=s),x){case 2:t.transform(-1,0,0,1,E,0);break;case 3:t.transform(-1,0,0,-1,E,s);break;case 4:t.transform(1,0,0,-1,0,s);break;case 5:t.transform(0,1,1,0,0,0);break;case 6:t.transform(0,1,-1,0,s,0);break;case 7:t.transform(0,-1,-1,0,s,E);break;case 8:t.transform(0,-1,1,0,0,E)}return t.drawImage(m,0,0,E,s),rt(m),e}function tn(m,x,E=0){return new Promise((function(s,e){let t,u,o,y,v,a,i,r,l,h,N,T,j,F,U,C,R,p,M,c;function d(A=5){if(x.signal&&x.signal.aborted)throw x.signal.reason;t+=A,x.onProgress(Math.min(t,100))}function _(A){if(x.signal&&x.signal.aborted)throw x.signal.reason;t=Math.min(Math.max(A,t),100),x.onProgress(t)}return t=E,u=x.maxIteration||10,o=1024*x.maxSizeMB*1024,d(),Tt(m,x).then((function(A){try{return[,y]=A,d(),v=bn(y,x),d(),new Promise((function(b,k){var w;if(!(w=x.exifOrientation))return xn(m).then((function(g){try{return w=g,L.call(this)}catch(f){return k(f)}}).bind(this),k);function L(){return b(w)}return L.call(this)})).then((function(b){try{return a=b,d(),pt().then((function(k){try{return i=k?v:wn(v,a),d(),r=x.initialQuality||1,l=x.fileType||m.type,Mt(i,l,m.name,m.lastModified,r).then((function(w){try{{let g=function(){if(u--&&(U>o||U>j)){let $,I;return $=c?.95*M.width:M.width,I=c?.95*M.height:M.height,[R,p]=It($,I),p.drawImage(M,0,0,$,I),r*=l==="image/png"?.85:.95,Mt(R,l,m.name,m.lastModified,r).then((function(H){try{return C=H,rt(M),M=R,U=C.size,_(Math.min(99,Math.floor((F-U)/(F-o)*100))),g}catch(X){return e(X)}}),e)}return[1]},f=function(){return rt(M),rt(R),rt(v),rt(i),rt(y),_(100),s(C)};if(h=w,d(),N=h.size>o,T=h.size>m.size,!N&&!T)return _(100),s(h);var L;return j=m.size,F=h.size,U=F,M=i,c=!x.alwaysKeepResolution&&N,(L=(function($){for(;$;){if($.then)return void $.then(L,e);try{if($.pop){if($.length)return $.pop()?f.call(this):$;$=g}else $=$.call(this)}catch(I){return e(I)}}}).bind(this))(g)}}catch(g){return e(g)}}).bind(this),e)}catch(w){return e(w)}}).bind(this),e)}catch(k){return e(k)}}).bind(this),e)}catch(b){return e(b)}}).bind(this),e)}))}const Bn=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let $t;function On(m,x){return new Promise(((E,s)=>{$t||($t=(function(u){const o=[];return o.push(u),URL.createObjectURL(new Blob(o))})(Bn));const e=new Worker($t);e.addEventListener("message",(function(u){if(x.signal&&x.signal.aborted)e.terminate();else if(u.data.progress===void 0){if(u.data.error)return s(new Error(u.data.error)),void e.terminate();E(u.data.file),e.terminate()}else x.onProgress(u.data.progress)})),e.addEventListener("error",s),x.signal&&x.signal.addEventListener("abort",(()=>{s(x.signal.reason),e.terminate()})),e.postMessage({file:m,imageCompressionLibUrl:x.libURL,options:{...x,onProgress:void 0,signal:void 0}})}))}function He(m,x){return new Promise((function(E,s){let e,t,u,o,y,v;if(e={...x},u=0,{onProgress:o}=e,e.maxSizeMB=e.maxSizeMB||Number.POSITIVE_INFINITY,y=typeof e.useWebWorker!="boolean"||e.useWebWorker,delete e.useWebWorker,e.onProgress=l=>{u=l,typeof o=="function"&&o(u)},!(m instanceof Blob||m instanceof Wn))return s(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(m.type))return s(new Error("The file given is not an image"));if(v=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!y||typeof Worker!="function"||v)return tn(m,e).then((function(l){try{return t=l,r.call(this)}catch(h){return s(h)}}).bind(this),s);var a=(function(){try{return r.call(this)}catch(l){return s(l)}}).bind(this),i=function(l){try{return tn(m,e).then((function(h){try{return t=h,a()}catch(N){return s(N)}}),s)}catch(h){return s(h)}};try{return e.libURL=e.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",On(m,e).then((function(l){try{return t=l,a()}catch{return i()}}),i)}catch{i()}function r(){try{t.name=m.name,t.lastModified=m.lastModified}catch{}try{e.preserveExif&&m.type==="image/jpeg"&&(!e.fileType||e.fileType&&e.fileType===m.type)&&(t=cn(m,t))}catch{}return E(t)}}))}He.getDataUrlFromFile=mn,He.getFilefromDataUrl=Bt,He.loadImage=hn,He.drawImageInCanvas=pn,He.drawFileInCanvas=Tt,He.canvasToFile=Mt,He.getExifOrientation=xn,He.handleMaxWidthOrHeight=bn,He.followExifOrientation=wn,He.cleanupCanvasMemory=rt,He.isAutoOrientationInBrowser=pt,He.approximateBelowMaximumCanvasSizeOfBrowser=gn,He.copyExifWithoutOrientation=cn,He.getBrowserName=gt,He.version="2.0.2";const Pe=[];for(let m=0;m<256;++m)Pe.push((m+256).toString(16).slice(1));function qn(m,x=0){return(Pe[m[x+0]]+Pe[m[x+1]]+Pe[m[x+2]]+Pe[m[x+3]]+"-"+Pe[m[x+4]]+Pe[m[x+5]]+"-"+Pe[m[x+6]]+Pe[m[x+7]]+"-"+Pe[m[x+8]]+Pe[m[x+9]]+"-"+Pe[m[x+10]]+Pe[m[x+11]]+Pe[m[x+12]]+Pe[m[x+13]]+Pe[m[x+14]]+Pe[m[x+15]]).toLowerCase()}let Ht;const Vn=new Uint8Array(16);function Kn(){if(!Ht){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ht=crypto.getRandomValues.bind(crypto)}return Ht(Vn)}const Yn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),nn={randomUUID:Yn};function Qn(m,x,E){m=m||{};const s=m.random??m.rng?.()??Kn();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,qn(s)}function Jn(m,x,E){return nn.randomUUID&&!m?nn.randomUUID():Qn(m)}const sn=50,zt=m=>({id:m.id,league_id:m.league_id,user_id:m.user_id,content:m.content,created_at:m.created_at??new Date().toISOString(),status:"sent"}),St=m=>{const x=new Map;for(const E of m)x.set(E.id,E);return Array.from(x.values()).sort((E,s)=>new Date(E.created_at).getTime()-new Date(s.created_at).getTime())};function Zn(m,x={}){const{userId:E,enabled:s=!0,autoSubscribe:e=!0}=x,[t,u]=D.useState([]),[o,y]=D.useState(!1),[v,a]=D.useState(!1),[i,r]=D.useState(!0),[l,h]=D.useState(null),N=D.useRef(null),T=D.useCallback(p=>{u(M=>{const c=p(M);return N.current=c.length?c[0].created_at:null,c})},[]),j=D.useCallback(async({before:p,append:M})=>{if(!m||!s)return;const c=re.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",m).order("created_at",{ascending:!1}).limit(sn);p&&c.lt("created_at",p);const{data:d,error:_}=await c;if(_)throw _;const A=(d??[]).map(zt).reverse();T(b=>St(M?[...A,...b]:A)),(d??[]).length<sn?r(!1):M||r(!0)},[m,s,T]),F=D.useCallback(async()=>{if(!m||!s){u([]),r(!0);return}y(!0),h(null),N.current=null;try{await j({append:!1})}catch(p){h(p?.message??"Failed to load chat")}finally{y(!1)}},[m,s,j]);D.useEffect(()=>{if(!m||!s){u([]),r(!0);return}let p=!0;if(F(),!e)return()=>{p=!1};const M=re.channel(`league-messages:${m}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${m}`},c=>{if(!p)return;const d=zt(c.new);T(_=>_.some(A=>A.id===d.id)?_:St([..._,d]))}).subscribe();return()=>{p=!1,re.removeChannel(M)}},[m,s,e,F,T]);const U=D.useCallback(async()=>{if(!m||!s||!i||v)return;const p=N.current??t[0]?.created_at;if(p){a(!0);try{await j({before:p,append:!0})}catch(M){h(M?.message??"Failed to load more messages")}finally{a(!1)}}},[m,s,i,v,j,t]),C=D.useCallback(async p=>{if(!m||!E)throw new Error("Missing league or user");const M=p.trim();if(!M)return;const c=Jn(),d=`optimistic-${c}`,_={id:d,client_msg_id:c,league_id:m,user_id:E,content:M,created_at:new Date().toISOString(),status:"sending"};T(k=>St([...k,_]));const{data:A,error:b}=await re.from("league_messages").insert({league_id:m,user_id:E,content:M}).select("id, league_id, user_id, content, created_at").single();if(b)throw T(k=>k.map(w=>w.id===d?{...w,status:"error"}:w)),b;if(A){const k=zt(A);k.client_msg_id=c,T(w=>w.map(L=>L.id===d?{...k,status:"sent",client_msg_id:c}:L))}},[m,E,T]),R=D.useMemo(()=>t.slice(-5),[t]);return{messages:t,previewMessages:R,loading:o,loadingMore:v,hasMore:i,error:l,refresh:F,loadMore:U,sendMessage:C}}const Xn={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",middle:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[4px]",bottom:"rounded-tl-[4px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]"},es={single:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[12px] rounded-bl-[12px]",top:"rounded-tl-[12px] rounded-tr-[12px] rounded-br-[4px] rounded-bl-[12px]",middle:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[4px] rounded-bl-[12px]",bottom:"rounded-tl-[12px] rounded-tr-[4px] rounded-br-[12px] rounded-bl-[12px]"};function vn({author:m,text:x,time:E,isOwnMessage:s,shape:e="single"}){const t=s?"text-right":"text-left",u=s?"bg-[#1C8376] text-white":"bg-white text-slate-900",o=s?es:Xn;return n.jsxs("div",{className:`inline-block w-fit px-3 py-2 text-sm leading-snug shadow-sm max-w-[70%] whitespace-normal break-words ${t} ${u} ${o[e]}`,children:[m&&!s&&n.jsx("div",{className:"text-[11px] font-semibold text-slate-600 mb-1",children:m}),n.jsx("div",{children:x}),n.jsx("div",{className:"text-[11px] text-[#DCDCDD] mt-1",children:E})]})}function ts({author:m,messages:x,isOwnMessage:E,avatarInitials:s}){const e=E?"justify-end":"justify-start";return n.jsxs("div",{className:`flex items-end gap-3 w-full ${e}`,children:[E?n.jsx("div",{className:"w-8 flex-shrink-0"}):n.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-[13px] font-semibold text-slate-500 flex-shrink-0",children:(s||m.charAt(0)).toUpperCase()}),n.jsx("div",{className:"flex flex-col gap-1 flex-1",children:x.map((t,u)=>{const o=x.length===1?"single":u===0?"top":u===x.length-1?"bottom":"middle";return n.jsxs("div",{className:`flex w-full ${E?"justify-end":"justify-start"}`,children:[n.jsx(vn,{author:!E&&u===0?m:void 0,text:t.text,time:t.time,isOwnMessage:E,shape:o}),t.status&&n.jsx("div",{className:`text-[11px] ml-2 ${t.status==="error"?"text-red-500":"text-slate-400"}`,children:t.status==="error"?"Failed":"Sending"})]},t.id)})})]})}function ns({groups:m}){return n.jsx("div",{className:"flex flex-col gap-5",children:m.map(x=>n.jsxs("div",{className:"flex flex-col gap-3",children:[x.dayLabel&&n.jsx("div",{className:"text-center text-xs uppercase tracking-wide text-slate-400",children:x.dayLabel}),n.jsx(ts,{author:x.author,avatarInitials:x.avatarInitials,isOwnMessage:x.isOwnMessage,messages:x.messages})]},x.id))})}const ss=m=>new Date(m).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),rs=m=>new Date(m).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"}),as=m=>{const x=m.trim().split(/\s+/);return x.length===1?x[0][0]?.toUpperCase()??"?":`${x[0][0]?.toUpperCase()??""}${x[x.length-1][0]?.toUpperCase()??""}`},is=(m,x)=>x?x instanceof Map?x.get(m)??"":x[m]??"":"";function os({miniLeagueId:m,memberNames:x}){const{user:E}=ln(),{messages:s,loading:e,loadingMore:t,hasMore:u,error:o,loadMore:y,sendMessage:v}=Zn(m,{userId:E?.id,enabled:!!m}),[a,i]=D.useState(""),[r,l]=D.useState(!1),h=D.useRef(null),N=D.useRef(null),T=D.useRef(null),[j,F]=D.useState(0),U=D.useCallback(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[]),C=D.useCallback((b=[0,100,300,500,700])=>{requestAnimationFrame(()=>{b.forEach(k=>{setTimeout(()=>U(),k)})})},[U]);D.useEffect(()=>{s.length>0&&C([0,150,300])},[s.length,C]),D.useEffect(()=>{!a&&N.current&&(N.current.style.height="auto",N.current.style.height="42px")},[a]);const R=D.useCallback((b,k=[0,100,300,500,700])=>{if(b>0){if(F(b),h.current){const w=Math.max(b+(N.current?.offsetHeight||0)+16,80);h.current.style.paddingBottom=`${w}px`}}else F(0),h.current&&(h.current.style.paddingBottom="");C(k)},[C]);D.useEffect(()=>{const b=window.visualViewport;if(!b)return;let k=null,w=0;const L=()=>{k&&(clearTimeout(k),k=null),k=setTimeout(()=>{const $=window.innerHeight,I=b.height,H=b.offsetTop+I,X=$-H;Math.abs(X-w)<10&&X>0||(w=X,R(X))},50)};b.addEventListener("resize",L),b.addEventListener("scroll",L);const g=()=>{setTimeout(L,100),setTimeout(L,300)},f=setTimeout(()=>{N.current&&N.current.addEventListener("focus",g)},100);return L(),()=>{k&&clearTimeout(k),clearTimeout(f),b.removeEventListener("resize",L),b.removeEventListener("scroll",L),N.current&&N.current.removeEventListener("focus",g)}},[R]),D.useEffect(()=>{if(typeof window>"u")return;const b=window.innerHeight,k=()=>{const w=b-window.innerHeight;R(w>0?w:0)};return window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[R]),D.useEffect(()=>{if(!h.current||!T.current)return;const b=T.current.offsetHeight??72;h.current.style.paddingBottom=`${b+24}px`},[]);const p=()=>{const b=window.visualViewport;b&&setTimeout(()=>{const k=window.innerHeight,w=b.height,L=b.offsetTop+w,g=k-L;R(g,[0,200,400,600,800])},100),C([200,400,600])},M=b=>{const k=b.target;!(k.tagName==="A"||k.tagName==="BUTTON"||k.closest("a, button"))&&N.current&&document.activeElement===N.current&&N.current.blur()},c=D.useMemo(()=>{if(!E)return"";const b=E.user_metadata??{};return b.display_name||b.full_name||E.email||""},[E]),d=D.useMemo(()=>{if(!s.length)return[];const b=[];let k=null;return s.forEach(w=>{const L=w.user_id===E?.id,$=is(w.user_id,x)||(L?c:"")||(L?"You":"Unknown"),I=L?void 0:as($),X=new Date(w.created_at).toDateString(),V=X!==k;V&&(k=X);const Z={id:w.id,text:w.content,time:ss(w.created_at),status:w.status&&w.status!=="sent"?w.status:void 0},G=b[b.length-1];G&&!V&&G.isOwnMessage===L&&G.author===$?G.messages.push(Z):b.push({id:w.id,author:$,avatarInitials:I,isOwnMessage:L,dayLabel:V?rs(w.created_at):void 0,messages:[Z]})}),b},[c,x,s,E?.id]),_=D.useCallback(async b=>{if(!m||!E?.id||typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"))return;const w=E.user_metadata?.display_name||E.user_metadata?.full_name||E.email||"User";try{await fetch("/.netlify/functions/notifyLeagueMessageV2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:m,senderId:E.id,senderName:w,content:b})})}catch(L){console.error("[MiniLeagueChatBeta] notifyLeagueMessageV2 failed:",L)}},[m,E?.id]),A=D.useCallback(async()=>{const b=a.trim();if(!(!m||!b||r))try{l(!0),await v(b),await _(b),i(""),C([0,150,300])}catch(k){console.error("[MiniLeagueChatBeta] Failed to send message",k)}finally{l(!1)}},[a,m,_,C,v,r]);return n.jsxs("div",{className:"flex flex-col h-full bg-[#f5f6fb] w-full",children:[n.jsxs("div",{ref:h,className:"flex-1 overflow-y-auto px-4 py-5",onClick:M,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:j>0?"0":"auto",cursor:"pointer"},children:[u&&m&&n.jsx("button",{className:"mx-auto mb-2 text-xs font-semibold text-[#1C8376] bg-white px-3 py-1 rounded-full shadow disabled:opacity-40",onClick:y,disabled:t,children:t?"Loading earlier":"Load earlier messages"}),d.length===0&&!e?n.jsx("div",{className:"text-center text-sm text-slate-500 mt-8",children:"Say hi to kick off this chat!"}):n.jsx(ns,{groups:d})]}),n.jsxs("div",{ref:T,className:"flex-shrink-0 border-t border-slate-200 bg-white px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:j>0?"fixed":"relative",bottom:j>0?`${j}px`:"auto",left:j>0?0:"auto",right:j>0?0:"auto",width:j>0?"100%":"auto",maxWidth:j>0?"440px":"none",marginLeft:j>0?"auto":void 0,marginRight:j>0?"auto":void 0,zIndex:j>0?1e3:"auto"},children:[n.jsxs("div",{className:"flex items-end gap-3 bg-slate-100 rounded-2xl px-3 py-2",children:[n.jsx("textarea",{ref:N,className:"flex-1 bg-transparent resize-none focus:outline-none text-sm text-slate-800 placeholder:text-slate-400",rows:1,value:a,disabled:!m||r,placeholder:m?"Start typing a message":"Join this league to chat",onChange:b=>{i(b.target.value),N.current&&(N.current.style.height="auto",N.current.style.height=`${Math.min(N.current.scrollHeight,120)}px`)},onFocus:p,onKeyDown:b=>{b.key==="Enter"&&!b.shiftKey&&(b.preventDefault(),A())},style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),n.jsx("button",{type:"button",onClick:A,disabled:!m||r||!a.trim(),className:"w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-40",children:n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14M12 5l7 7-7 7"})})})]}),o&&n.jsxs("div",{className:"text-xs text-red-500 mt-2 text-center",children:[o,"  try again or switch to the classic chat tab."]})]})]})}function ls({winnerName:m,isDraw:x}){return n.jsx("div",{className:"mt-4 mb-4 py-6 px-6 rounded-xl bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 shadow-2xl shadow-slate-600/50 relative overflow-hidden before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:animate-[shimmer_2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/30 after:to-transparent after:animate-[shimmer_2.5s_ease-in-out_infinite_0.6s]",children:n.jsx("div",{className:"text-center relative z-10",children:x?n.jsx("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:" It's a Draw!"}):n.jsxs("div",{className:"text-lg font-bold text-white break-words whitespace-normal px-2 leading-normal",children:[m," Wins!"]})})})}function cs({availableGws:m,selectedGw:x,onChange:E,className:s=""}){return m.length<=1?null:n.jsx("div",{className:`flex-1 ${s}`,children:n.jsx("select",{value:x||void 0,onChange:e=>{const t=parseInt(e.target.value,10);E(t)},className:"gw-selector w-full bg-white rounded-full border-2 border-slate-300 px-3 py-2 text-xs font-normal text-slate-600 text-center focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-[#1C8376] active:bg-slate-50 transition-colors",style:{fontSize:"12px",minHeight:"40px",WebkitAppearance:"none",MozAppearance:"none",appearance:"none",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%2364748b' stroke-width='2.5'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E")`,backgroundRepeat:"no-repeat",backgroundPosition:"right 0.75rem center",backgroundSize:"1em 1em",paddingRight:"2.5rem"},children:m.map(e=>n.jsxs("option",{value:e,style:{fontSize:"12px",padding:"0.5rem",fontWeight:"normal",color:"#64748b"},children:["Gameweek ",e]},e))})})}function ds({showForm:m,onToggle:x}){return n.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-0.5 shadow-sm border border-slate-200",children:[n.jsx("button",{onClick:()=>x(!1),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${m?"text-slate-600 hover:text-slate-900 hover:bg-white/50":"bg-[#1C8376] text-white shadow-sm"}`,children:"Points"}),n.jsx("button",{onClick:()=>x(!0),className:`px-3 py-1.5 text-xs font-semibold rounded-full transition-colors ${m?"bg-[#1C8376] text-white shadow-sm":"text-slate-600 hover:text-slate-900 hover:bg-white/50"}`,children:"Form"})]})}function us({form:m}){const x=m.slice(-5),E=5-x.length;return n.jsxs("div",{className:"flex items-center justify-between w-full",children:[Array.from({length:E}).map((s,e)=>n.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-200"},`dot-${e}`)),x.map((s,e)=>n.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold ${s==="W"?"bg-green-100 text-green-700":s==="D"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:s},e))]})}function fs({rows:m,members:x,showForm:E,currentUserId:s,loading:e,isLateStartingLeague:t}){return n.jsxs("div",{className:"pt-4",children:[n.jsx("style",{children:`
        .mlt-table tbody tr:last-child {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table tbody tr:last-child td {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table tbody tr:last-child th {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table {
          border-bottom: none !important;
        }
        .mlt-table tbody {
          border-bottom: none !important;
        }
        .mlt-table-container {
          border-bottom: none !important;
        }
        .mlt-table-container table {
          border-bottom: none !important;
        }
        .mlt-table-container tbody {
          border-bottom: none !important;
        }
        .mlt-table-container tbody tr:last-child {
          border-bottom: none !important;
          border: none !important;
        }
        .mlt-table-container tbody tr:last-child td {
          border-bottom: none !important;
          border: none !important;
        }
      `}),n.jsx("div",{className:"mlt-table-container overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x bg-slate-50",style:{backgroundColor:"#f8fafc",borderBottom:"none",boxShadow:"none"},children:n.jsxs("table",{className:"mlt-table w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc",border:"none",borderBottom:"none"},children:[n.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:n.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[n.jsx("th",{className:"py-3 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),n.jsx("th",{className:"py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:"Player"}),E?n.jsx("th",{className:"px-4 py-3 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8"},children:"Form"}):n.jsxs(n.Fragment,{children:[n.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"W"}),n.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"D"}),n.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:t?"CP":"OCP"}),x.length>=3&&n.jsx("th",{className:"py-3 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""}),n.jsx("th",{className:"py-3 text-center font-normal text-xs",style:{backgroundColor:"#f8fafc",width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"0.75rem"},children:"PTS"})]})]})}),n.jsxs("tbody",{children:[m.map((u,o)=>{const y=u.user_id===s,v=o===m.length-1;return n.jsxs("tr",{className:y?"flash-user-row":"",style:{position:"relative",backgroundColor:"#f8fafc",...v?{}:{borderBottom:"1px solid #e2e8f0"}},children:[n.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:o+1}),n.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:u.name}),E?n.jsx("td",{className:"px-4 py-4",style:{backgroundColor:"#f8fafc"},children:n.jsx(us,{form:u.form})}):n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:u.wins}),n.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:u.draws}),n.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:u.ocp}),x.length>=3&&n.jsx("td",{className:"py-4 text-center tabular-nums",style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:u.unicorns}),n.jsx("td",{className:"py-4 text-center tabular-nums font-bold",style:{width:"40px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:u.mltPts})]})]},u.user_id)}),e&&n.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:n.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:E?3:x.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"Calculating"})}),!e&&!m.length&&n.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:n.jsx("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:E?3:x.length>=3?7:6,style:{backgroundColor:"#f8fafc"},children:"No gameweeks completed yet  this will populate after the first results are saved."})})]})]})})]})}function ms({rows:m,members:x,currentUserId:E,positionChangeKeys:s,isApiTestLeague:e,hasLiveFixtures:t,hasStartingSoonFixtures:u,hasStartedFixtures:o,allFixturesFinished:y,resGw:v}){return n.jsxs("div",{children:[n.jsx("style",{children:`
        @keyframes flash {
          0%, 100% {
            background-color: rgb(209, 250, 229);
          }
          25% {
            background-color: rgb(167, 243, 208);
          }
          50% {
            background-color: rgb(209, 250, 229);
          }
          75% {
            background-color: rgb(167, 243, 208);
          }
        }
        @keyframes pulse-score {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.7;
          }
        }
        @keyframes position-change {
          0% {
            background-color: rgb(254, 243, 199);
          }
          50% {
            background-color: rgb(253, 230, 138);
          }
          100% {
            background-color: transparent;
          }
        }
        .flash-user-row {
          animation: flash 1.5s ease-in-out 3;
        }
        .pulse-live-score {
          animation: pulse-score 2s ease-in-out infinite;
        }
        .position-changed {
          animation: position-change 1.5s ease-out;
        }
        .full-width-header-border::after {
          content: '';
          position: absolute;
          left: -1rem;
          right: -1rem;
          bottom: 0;
          height: 1px;
          background-color: #cbd5e1;
          z-index: 1;
        }
      `}),n.jsx("div",{className:"overflow-y-auto overflow-x-hidden -mx-4 sm:mx-0 rounded-none sm:rounded-2xl border-x-0 sm:border-x border-b border-slate-200 bg-slate-50 shadow-sm",style:{backgroundColor:"#f8fafc"},children:n.jsxs("table",{className:"w-full text-sm border-collapse",style:{tableLayout:"fixed",backgroundColor:"#f8fafc"},children:[n.jsx("thead",{className:"sticky top-0",style:{position:"sticky",top:0,zIndex:25,backgroundColor:"#f8fafc",display:"table-header-group"},children:n.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"none"},children:[n.jsx("th",{className:"py-4 text-left font-normal",style:{backgroundColor:"#f8fafc",width:"30px",paddingLeft:"0.75rem",paddingRight:"0.5rem",color:"#94a3b8"},children:"#"}),n.jsx("th",{className:"py-4 text-left font-normal text-xs",style:{backgroundColor:"#f8fafc",color:"#94a3b8",paddingLeft:"0.5rem",paddingRight:"1rem"},children:n.jsxs("div",{className:"flex items-center gap-2",children:["Player",e&&t&&n.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-red-600 text-white shadow-md shadow-red-500/30",children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),n.jsx("span",{className:"text-[10px] font-medium",children:"LIVE"})]}),e&&!y&&u&&!t&&n.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-amber-500 text-white shadow-md shadow-amber-500/30",children:[n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.jsx("span",{className:"text-[10px] font-medium",children:o?"Next Game Starting Soon":"Starting soon"})]})]})}),n.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8"},children:"Score"}),x.length>=3&&n.jsx("th",{className:"py-4 text-center font-normal",style:{backgroundColor:"#f8fafc",width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",color:"#94a3b8",fontSize:"1rem"},children:""})]})}),n.jsxs("tbody",{children:[m.map((a,i)=>{const r=a.user_id===E,l=i===m.length-1,h=s.has(a.user_id);return n.jsxs("tr",{className:`${r?"flash-user-row":""} ${h?"position-changed":""}`,style:{position:"relative",backgroundColor:"#f8fafc",...l?{}:{borderBottom:"1px solid #e2e8f0"}},children:[n.jsx("td",{className:"py-4 text-left tabular-nums whitespace-nowrap relative",style:{paddingLeft:"0.75rem",paddingRight:"0.5rem",backgroundColor:"#f8fafc",width:"30px"},children:i+1}),n.jsx("td",{className:"py-4 truncate whitespace-nowrap",style:{backgroundColor:"#f8fafc",paddingLeft:"0.5rem",paddingRight:"1rem",overflow:"hidden",textOverflow:"ellipsis"},children:n.jsxs("div",{className:"flex items-center gap-2",children:[e&&t&&n.jsx("div",{className:"w-2 h-2 bg-red-600 rounded-full animate-pulse flex-shrink-0",style:{minWidth:"8px",minHeight:"8px"}}),e&&!t&&u&&n.jsx("svg",{className:"w-3 h-3 text-amber-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),n.jsx("span",{children:a.name})]})}),n.jsx("td",{className:`py-4 text-center tabular-nums font-bold ${e&&t?"pulse-live-score":""}`,style:{width:"50px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc",color:"#1C8376"},children:a.score}),x.length>=3&&n.jsx("td",{className:`py-4 text-center tabular-nums ${e&&t?"pulse-live-score":""}`,style:{width:"35px",paddingLeft:"0.25rem",paddingRight:"0.25rem",backgroundColor:"#f8fafc"},children:a.unicorns})]},a.user_id)}),!m.length&&n.jsx("tr",{style:{backgroundColor:"#f8fafc"},children:n.jsxs("td",{className:"px-4 py-6 text-slate-500 text-center",colSpan:x.length>=3?4:3,style:{backgroundColor:"#f8fafc"},children:["No results recorded for GW ",v," yet."]})})]})]})})]})}function hs(m){const x=Tn(),E=encodeURIComponent(m),s=!1;if(console.log("[WhatsApp] Opening WhatsApp, isDespia:",x),x){const e=`whatsapp://send?text=${E}`;console.log("[WhatsApp] Attempting to open deep link:",e);let t=!1,u=!1;try{const o=document.createElement("a");o.href=e,o.style.display="none",document.body.appendChild(o),o.click(),t=!0,setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},100)}catch(o){console.log("[WhatsApp] Anchor method failed:",o)}if(!t)try{window.open(e),u=!0}catch(o){console.log("[WhatsApp] window.open failed:",o)}if(!t&&!u)try{window.location.href=e}catch(o){console.log("[WhatsApp] window.location.href failed:",o),window.open(`https://wa.me/?text=${E}`,"_blank")}}else{const e=`https://wa.me/?text=${E}`;try{window.open(e,"_blank")}catch{navigator.clipboard.writeText(m).then(()=>{alert("Message copied to clipboard! You can now paste it in WhatsApp or Messages.")}).catch(()=>{alert(`Unable to open WhatsApp. Please copy this message manually:

`+m)})}}}function gs(m,x){const E=new Date(x.find(i=>i.gw===m)?.kickoff_time||""),s=new Date(E.getTime()-4500*1e3),e=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],t=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],u=e[s.getUTCDay()],o=s.getUTCDate(),y=t[s.getUTCMonth()],v=s.getUTCHours().toString().padStart(2,"0"),a=s.getUTCMinutes().toString().padStart(2,"0");return`Gameweek ${m} Predictions Reminder!

DEADLINE: THIS ${u} ${o} ${y}, ${v}:${a} BST

Don't forget!
playtotl.com`}function ps(m,x){console.log("[SubmissionStatusTable] handleShareReminder called, picksGw:",m);try{const E=gs(m,x);console.log("[SubmissionStatusTable] Generated message:",E),hs(E)}catch(E){console.error("[SubmissionStatusTable] Error in handleShareReminder:",E),alert("Error sharing reminder. Please try again.")}}function rn({members:m,submittedMap:x,picksGw:E,allSubmitted:s,remaining:e,fixtures:t,onShareReminder:u,variant:o="full"}){const y=u||(()=>ps(E,t)),v=t.map(h=>h.kickoff_time).filter(h=>!!h).map(h=>new Date(h)).filter(h=>!isNaN(h.getTime())),a=v.length>0?new Date(Math.min(...v.map(h=>h.getTime()))):null,i=a?new Date(a.getTime()-4500*1e3):null,r=i?new Date>=i:!1;let l="";if(i){const h=o==="compact"?["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=h[i.getUTCDay()],j=i.getUTCDate(),F=N[i.getUTCMonth()],U=i.getUTCHours().toString().padStart(2,"0"),C=i.getUTCMinutes().toString().padStart(2,"0");l=`${T} ${j} ${F}, ${U}:${C} BST`}return o==="compact"?n.jsxs("div",{className:"mt-2 pt-2",children:[n.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[n.jsx("div",{className:"text-sm font-medium text-slate-700",children:n.jsxs(n.Fragment,{children:["Waiting for ",n.jsx("span",{className:"font-semibold",children:e})," of ",m.length," to submit."]})}),!s&&n.jsxs("button",{type:"button",onClick:h=>{h.preventDefault(),h.stopPropagation(),console.log("[SubmissionStatusTable] Button clicked (compact variant)"),y()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white rounded-lg text-sm font-medium hover:bg-emerald-700 transition-colors",children:[n.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),l&&n.jsxs("div",{className:`mb-3 text-xs font-medium ${r?"text-orange-600":"text-slate-600"} flex items-center gap-1.5`,children:[n.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),r?"Deadline Passed: ":"Deadline: ",l]}),n.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white",children:n.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[n.jsx("thead",{className:"bg-slate-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),n.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),n.jsx("tbody",{children:m.slice().sort((h,N)=>h.name.localeCompare(N.name)).map(h=>{const N=`${h.id}:${E}`,T=!!x.get(N);return n.jsxs("tr",{className:"border-t border-slate-200",children:[n.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:h.name}),n.jsx("td",{className:"px-4 py-3",children:T?n.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2.5 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:[n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submitted"]}):n.jsxs("span",{className:"inline-flex items-center gap-1.5 justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2.5 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:[n.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Not yet"]})})]},h.id)})})]})})]}):n.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-700",children:[n.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[n.jsx("div",{children:s?n.jsxs(n.Fragment,{children:["All ",m.length," members have submitted."]}):n.jsxs(n.Fragment,{children:["Waiting for ",n.jsx("span",{className:"font-semibold",children:e})," of ",m.length," to submit."]})}),!s&&n.jsxs("button",{type:"button",onClick:h=>{h.preventDefault(),h.stopPropagation(),console.log("[SubmissionStatusTable] Button clicked (full variant)"),y()},className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors",children:[n.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"})}),"Share Reminder"]})]}),l&&n.jsxs("div",{className:`mb-3 text-sm ${r?"text-orange-600 font-semibold":"text-slate-600"}`,children:[r?" Deadline Passed: ":" Deadline: ",l]}),n.jsx("div",{className:"overflow-hidden rounded-lg border",children:n.jsxs("table",{className:"w-full text-sm",style:{tableLayout:"fixed"},children:[n.jsx("thead",{className:"bg-slate-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"text-left px-4 py-3 w-2/3 font-semibold text-slate-600",children:"Player"}),n.jsx("th",{className:"text-left px-4 py-3 font-semibold text-slate-600",children:"Status"})]})}),n.jsx("tbody",{children:m.slice().sort((h,N)=>h.name.localeCompare(N.name)).map(h=>{const N=`${h.id}:${E}`,T=!!x.get(N);return n.jsxs("tr",{className:"border-t border-slate-200",children:[n.jsx("td",{className:"px-4 py-3 font-bold text-slate-900 truncate whitespace-nowrap",style:{overflow:"hidden",textOverflow:"ellipsis"},children:h.name}),n.jsx("td",{className:"px-4 py-3",children:T?n.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-xs px-2 py-1 border border-emerald-300 font-bold shadow-sm whitespace-nowrap w-24",children:" Submitted"}):n.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-amber-50 text-amber-700 text-xs px-2 py-1 border border-amber-200 font-semibold whitespace-nowrap w-24",children:" Not yet"})})]},h.id)})})]})})]})}function an({letter:m,correct:x,unicorn:E,hasSubmitted:s,isLive:e,isOngoing:t,isFinished:u}){let o;return x===!0?e||t?o="bg-emerald-600 text-white border-emerald-600 animate-pulse shadow-lg shadow-emerald-500/50":u?o="bg-gradient-to-br from-yellow-400 via-orange-500 via-pink-500 to-purple-600 text-white shadow-xl shadow-yellow-400/40 relative overflow-hidden animate-pulse before:absolute before:inset-0 before:bg-gradient-to-r before:from-transparent before:via-white/70 before:to-transparent before:animate-[shimmer_1.2s_ease-in-out_infinite] after:absolute after:inset-0 after:bg-gradient-to-r after:from-transparent after:via-yellow-200/50 after:to-transparent after:animate-[shimmer_1.8s_ease-in-out_infinite_0.4s]":o="bg-emerald-600 text-white border-emerald-600":s?o="bg-emerald-600 text-white border-emerald-600":o="bg-slate-100 text-slate-600 border-slate-200",n.jsx("span",{className:["inline-flex items-center justify-center h-5 min-w-[18px] px-1.5","rounded-full border text-[11px] font-semibold mb-0.5","align-middle",o].join(" "),title:E?"Correct!":void 0,children:m})}function xs(m,x){return m==="FINISHED"?"FT":m==="PAUSED"?"HT":m==="IN_PLAY"?x==null?"LIVE":`${x}'`:"LIVE"}function bs(m){const x=(m||"?").trim().split(/\s+/);return x.length?x.length===1?x[0].slice(0,1).toUpperCase():(x[0][0]+x[x.length-1][0]).toUpperCase():"?"}function ws({fixture:m,picks:x,members:E,outcome:s,liveScore:e,submittedMap:t,picksGw:u,isApiTestLeague:o=!1}){const y=m.home_code||m.home_team||m.home_name||"",v=m.away_code||m.away_team||m.away_name||"",a=Qt(y)||m.home_name||m.home_team||"Home",i=Qt(v)||m.away_name||m.away_team||"Away",l=(C=>{if(!C)return"";const R=new Date(C);if(isNaN(R.getTime()))return"";const p=String(R.getUTCHours()).padStart(2,"0"),M=String(R.getUTCMinutes()).padStart(2,"0");return`${p}:${M}`})(m.kickoff_time),h=!!(e&&e.status==="IN_PLAY"),N=!!(e&&(e.status==="PAUSED"||e.status==="HALF_TIME"||e.status==="HT")),T=!!(e&&e.status==="FINISHED"),j=h||N;let F=null;o&&e?e.homeScore>e.awayScore?F="H":e.awayScore>e.homeScore?F="A":e.homeScore===e.awayScore&&(F="D"):F=s;const U=C=>{const R=x.filter(d=>d.pick===C),p=x.length===E.length&&R.length===E.length,M=4,c=[];for(let d=0;d<R.length;d+=M){const _=R.slice(d,d+M);c.push(_)}return n.jsx("div",{className:"flex flex-col gap-1",children:c.map((d,_)=>n.jsx("div",{className:"flex items-center justify-center",children:d.map((A,b)=>{const k=E.find(f=>f.id===A.user_id),w=bs(k?.name??"?"),L=t.has(`${A.user_id}:${u}`),g=F&&F===C?!0:null;return p?n.jsx("span",{className:"inline-block",style:{marginLeft:b>0?"-8px":"0",position:"relative",zIndex:b},children:n.jsx(an,{letter:w,correct:g,unicorn:g===!0,hasSubmitted:L,isLive:h,isOngoing:j,isFinished:T})},A.user_id):n.jsx(an,{letter:w,correct:g,unicorn:g===!0,hasSubmitted:L,isLive:h,isOngoing:j,isFinished:T},A.user_id)})},_))})};return n.jsx("li",{className:"border-t first:border-t-0",children:n.jsxs("div",{className:"p-4 bg-white relative",children:[(h||N)&&n.jsxs("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:[n.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),n.jsx("span",{className:"text-xs font-bold text-red-600",children:"LIVE"})]}),T&&!h&&!N&&n.jsx("div",{className:"absolute top-3 left-3 flex items-center gap-2 z-10 pb-6",children:n.jsx("span",{className:"text-xs font-semibold text-slate-500",children:"FT"})}),n.jsxs("div",{className:`grid grid-cols-3 items-center ${j?"pt-4":""}`,children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:a})}),n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx(en,{code:m.home_code||void 0,crest:m.home_crest||void 0,size:24,className:"h-6 w-6"}),n.jsx("div",{className:"text-[15px] sm:text-base font-semibold text-slate-600",children:e&&(h||N||T)?n.jsxs("span",{className:"font-bold text-base text-slate-900",children:[e.homeScore," - ",e.awayScore]}):n.jsx("span",{children:l})}),n.jsx(en,{code:m.away_code||void 0,crest:m.away_crest||void 0,size:24,className:"h-6 w-6"})]}),n.jsx("div",{className:"flex items-center justify-center",children:n.jsx("span",{className:"text-sm sm:text-base font-medium text-slate-900 truncate",children:i})})]}),e&&(j||T)&&n.jsx("div",{className:"flex justify-center mt-1",children:n.jsx("span",{className:`text-[10px] font-semibold ${j?"text-red-600":"text-slate-500"}`,children:xs(e.status,e.minute)})}),n.jsxs("div",{className:"mt-2 grid grid-cols-3",children:[n.jsx("div",{className:"relative min-h-6",children:n.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("H")})}),n.jsx("div",{className:"relative min-h-6",children:n.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("D")})}),n.jsx("div",{className:"relative min-h-6",children:n.jsx("div",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",children:U("A")})})]})]})})}function on({label:m,fixtures:x,picksByFixture:E,members:s,outcomes:e,liveScores:t,submittedMap:u,picksGw:o,isApiTestLeague:y=!1,isFirstSection:v=!1,hasLiveGames:a=!1,allGamesFinished:i=!1,allSubmitted:r=!1,resultsPublished:l=!1,deadlinePassed:h=!1,whoDidntSubmit:N=[],liveFixturesCount:T,hasStarted:j=!1}){return n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx(Mn,{date:m,className:"text-lg font-normal"}),v&&n.jsxs(n.Fragment,{children:[y&&a&&T!==void 0&&n.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-red-600 text-white text-sm font-bold border border-red-700 shadow-sm",style:{marginTop:"-2px"},children:[n.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full animate-pulse"}),n.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"Live"}),n.jsxs("span",{className:"flex items-baseline gap-0.5",children:[n.jsx("span",{className:"text-base sm:text-lg font-extrabold",children:T}),n.jsx("span",{className:"text-xs sm:text-sm font-medium opacity-90",children:"/"}),n.jsx("span",{className:"text-sm sm:text-base font-semibold opacity-80",children:x.length})]})]}),y&&i&&n.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),y&&!j&&n.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),!y&&r&&l&&n.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-[#1C8376]/10 text-[#1C8376]/90 text-sm font-bold border border-emerald-300 shadow-sm",style:{marginTop:"-2px"},children:"Round Complete!"}),!y&&r&&!l&&n.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-blue-100 text-blue-800 text-sm font-bold border border-blue-300 shadow-sm",style:{marginTop:"-2px"},children:"All Submitted"}),!y&&h&&!r&&n.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full bg-orange-100 text-orange-800 text-sm font-bold border border-orange-300 shadow-sm",style:{marginTop:"-2px"},children:["Deadline Passed ",N.length>0&&`(${N.join(", ")} didn't submit)`]})]})]}),n.jsx("div",{className:"rounded-2xl border bg-slate-50 overflow-hidden",children:n.jsxs("ul",{children:[x.map(F=>{try{const U=E.get(F.fixture_index)??[],C=e.get(F.fixture_index)||null,R=t[F.fixture_index]||null;return n.jsx(ws,{fixture:F,picks:U,members:s,outcome:C,liveScore:R,submittedMap:u,picksGw:o,isApiTestLeague:y},`${F.gw}-${F.fixture_index}`)}catch(U){return console.error("Error rendering fixture:",U,F),n.jsxs("li",{className:"p-4 text-red-500",children:["Error loading fixture: ",F.fixture_index]},`${F.gw}-${F.fixture_index}`)}}),!x.length&&n.jsx("li",{className:"p-4 text-slate-500",children:"No fixtures."})]})})]})}const At=8;function Gt(m){return m.result==="H"||m.result==="D"||m.result==="A"?m.result:typeof m.home_goals=="number"&&typeof m.away_goals=="number"?m.home_goals>m.away_goals?"H":m.home_goals<m.away_goals?"A":"D":null}function vs({chat:m,userId:x,nameById:E,isMember:s,newMsg:e,setNewMsg:t,onSend:u,leagueCode:o,memberCount:y,maxMembers:v,notificationStatus:a}){const i=D.useRef(null),r=D.useRef(null),l=D.useRef(null),h=D.useRef(null),[N,T]=D.useState(0),j=()=>{i.current&&(i.current.scrollTop=i.current.scrollHeight)},F=D.useCallback((p=[0,100,300,500,700])=>{requestAnimationFrame(()=>{p.forEach(M=>{setTimeout(()=>j(),M)})})},[]),U=D.useCallback((p,M=[0,100,300,500,700])=>{if(p>0){if(T(p),i.current){const c=Math.max(p+(l.current?.offsetHeight||0)+16,80);i.current.style.paddingBottom=`${c}px`}}else T(0),i.current&&(i.current.style.paddingBottom="");F(M)},[F]);D.useEffect(()=>{m.length>0&&setTimeout(()=>j(),100)},[m.length]),D.useEffect(()=>{!e&&l.current&&(l.current.style.height="auto",l.current.style.height="42px")},[e]),D.useEffect(()=>{const p=window.visualViewport;if(!p)return;let M=null,c=0;const d=()=>{M&&(clearTimeout(M),M=null),M=setTimeout(()=>{const b=window.innerHeight,k=p.height,w=p.offsetTop+k,L=b-w;Math.abs(L-c)<10&&L>0||(c=L,U(L))},50)};p.addEventListener("resize",d),p.addEventListener("scroll",d);const _=()=>{setTimeout(d,100),setTimeout(d,300)},A=setTimeout(()=>{l.current&&l.current.addEventListener("focus",_)},100);return d(),()=>{M&&clearTimeout(M),clearTimeout(A),p.removeEventListener("resize",d),p.removeEventListener("scroll",d),l.current&&l.current.removeEventListener("focus",_)}},[U]);const C=()=>{const p=window.visualViewport;p&&setTimeout(()=>{const M=window.innerHeight,c=p.height,d=p.offsetTop+c,_=M-d;U(_,[0,200,400,600,800])},100),F([200,400,600])};D.useEffect(()=>{if(typeof window>"u")return;const p=window.innerHeight,M=()=>{const c=p-window.innerHeight;U(c>0?c:0)};return window.addEventListener("resize",M),()=>window.removeEventListener("resize",M)},[U]);const R=p=>{const M=p.target;!(M.tagName==="A"||M.tagName==="BUTTON"||M.closest("a, button"))&&l.current&&document.activeElement===l.current&&l.current.blur()};return n.jsxs("div",{className:"flex flex-col chat-container",style:{height:"100%"},children:[n.jsxs("div",{ref:i,className:"flex-1 overflow-y-auto px-3 pt-3 pb-4 min-h-0 messages-container",onClick:R,style:{WebkitOverflowScrolling:"touch",overscrollBehavior:"contain",marginBottom:N>0?"0":"auto",cursor:"pointer"},children:[m.map((p,M)=>{const c=p.user_id===x,d=E.get(p.user_id)??"Unknown",_=new Date(p.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),A=m[M-1],b=m[M+1],k=A?.user_id===p.user_id,w=b?.user_id===p.user_id,L=!k,g=!w,f=!k&&!w,$=L&&w,I=k&&g,H=!c&&(f||I),X=d.split(/\s+/).map(G=>G[0]).join("").toUpperCase(),V=c?"flex justify-end":"flex items-end gap-2",Z=f?"single":$?"top":I?"bottom":"middle";return n.jsxs("div",{className:V,style:{marginTop:L?24:4},children:[!c&&n.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex justify-center self-end",children:H?n.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center text-xs font-semibold text-slate-500",children:X}):n.jsx("div",{className:"w-8 h-8"})}),n.jsx("div",{className:`flex flex-col gap-1 ${c?"items-end":"items-start"}`,children:n.jsx(vn,{author:!c&&L?d:void 0,text:p.content,time:_,isOwnMessage:c,shape:Z})})]},p.id)}),n.jsx("div",{ref:r,style:{height:"1px",width:"100%"}})]}),n.jsxs("div",{ref:h,className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-3",style:{paddingBottom:"calc(0.75rem + env(safe-area-inset-bottom, 0px))",position:N>0?"fixed":"relative",bottom:N>0?`${N}px`:"auto",left:N>0?"0":"auto",right:N>0?"0":"auto",width:N>0?"100%":"auto",zIndex:N>0?1e3:"auto"},children:[s?n.jsxs("form",{onSubmit:p=>{p.preventDefault(),u()},className:"flex items-center gap-2",children:[n.jsx("textarea",{ref:l,value:e,onChange:p=>{t(p.target.value),l.current&&(l.current.style.height="auto",l.current.style.height=`${Math.min(l.current.scrollHeight,120)}px`)},onFocus:C,onKeyDown:p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),e.trim()&&u())},placeholder:"Start typing...",maxLength:2e3,rows:1,className:"flex-1 rounded-xl border border-slate-300 px-4 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-[#1C8376] focus:border-transparent resize-none overflow-hidden",style:{minHeight:"42px",maxHeight:"120px",lineHeight:"1.5"}}),n.jsx("button",{type:"submit",className:"flex-shrink-0 w-10 h-10 rounded-full bg-[#1C8376] text-white flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e.trim(),style:{backgroundColor:e.trim()?"#1C8376":"#94a3b8"},children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})})]}):n.jsx("div",{className:"rounded-md border border-amber-200 bg-amber-50 text-amber-800 p-3 text-sm",children:"Join this league to chat with other members."}),a&&n.jsx("div",{className:`w-full rounded px-2 py-1 text-xs mt-2 ${a.type==="success"?"bg-green-50 text-green-700 border border-green-200":a.type==="warning"?"bg-amber-50 text-amber-700 border border-amber-200":"bg-red-50 text-red-700 border border-red-200"}`,children:a.message})]})]})}function _s(){const{code:m=""}=In(),{user:x}=ln(),[E]=D.useState(()=>{const S=localStorage.getItem("oldSchoolMode");return S?JSON.parse(S):!1});D.useEffect(()=>{localStorage.setItem("oldSchoolMode",JSON.stringify(E))},[E]),D.useEffect(()=>{document.body.classList.add("league-page-active"),document.documentElement.classList.add("league-page-active");const S=()=>{const O=document.querySelector(".league-header-fixed");if(O){const Y=O.style.top||window.getComputedStyle(O).top;Y!=="0px"&&Y!=="0"&&(O.style.top="0",O.style.transform="translate3d(0, 0, 0)")}},z=()=>{S(),(window.scrollY!==0||window.pageYOffset!==0)&&window.scrollTo(0,0)},K=O=>{const Y=O.target;Y.closest(".league-content-wrapper")||Y.closest(".league-header-fixed")||Y.closest(".chat-tab-wrapper")||O.preventDefault()};window.addEventListener("scroll",z,{passive:!0}),document.addEventListener("touchmove",K,{passive:!1});const Q=setInterval(S,100);return S(),()=>{document.body.classList.remove("league-page-active"),document.documentElement.classList.remove("league-page-active"),window.removeEventListener("scroll",z),document.removeEventListener("touchmove",K),clearInterval(Q)}},[]),D.useEffect(()=>{const S=K=>{const Q=K.target;(Q.tagName==="INPUT"||Q.tagName==="TEXTAREA")&&setTimeout(()=>{window.scrollTo(0,0);const O=document.querySelector(".league-header-fixed");O&&(O.style.top="0")},100)},z=()=>{const K=document.querySelector(".league-header-fixed");K&&(K.style.top="0")};return document.addEventListener("focusin",S),window.addEventListener("resize",z),window.addEventListener("orientationchange",z),()=>{document.removeEventListener("focusin",S),window.removeEventListener("resize",z),window.removeEventListener("orientationchange",z)}},[]),D.useEffect(()=>{if(typeof window>"u")return;const S=window.visualViewport;if(!S)return;let z=null;const K=()=>{const O=l.current;if(!O)return;const Y=S.offsetTop??0;O.style.setProperty("transform",`translate3d(0, ${Y}px, 0)`,"important")},Q=()=>{z&&cancelAnimationFrame(z),z=window.requestAnimationFrame(K)};return Q(),S.addEventListener("resize",Q),S.addEventListener("scroll",Q),()=>{z&&cancelAnimationFrame(z),S.removeEventListener("resize",Q),S.removeEventListener("scroll",Q),l.current&&l.current.style.removeProperty("transform")}},[]);const[s,e]=D.useState(null),[t,u]=D.useState([]),[o,y]=D.useState(!0),[v,a]=D.useState("chat-beta"),i=D.useRef(!1),r=D.useRef(!1),l=D.useRef(null),[h,N]=D.useState(!1),[T,j]=D.useState(!1),[F,U]=D.useState(!1),[C,R]=D.useState(null),[p,M]=D.useState(null),[c,d]=D.useState(null),[_,A]=D.useState([]),b=D.useRef({}),k=D.useRef(new Map),[w,L]=D.useState(new Set),[g,f]=D.useState(!1),[$,I]=D.useState(!1),[H,X]=D.useState(0),[V,Z]=D.useState(!1),[G,P]=D.useState(!1),[se,xe]=D.useState(!1),[fe,oe]=D.useState(!1),[be,he]=D.useState(null),[Le,qe]=D.useState(!1),[Ye,Ne]=D.useState(!1),[Ue,we]=D.useState(!1),[ge,Ee]=D.useState(!1),[Fe,ve]=D.useState(!1),[ze,Se]=D.useState(!1),[je,Re]=D.useState(!1),[Ve,ut]=D.useState(null),[Te,nt]=D.useState(!1),[Ie,We]=D.useState(!1),[De,Xe]=D.useState(null),[Qe,Je]=D.useState([]),[ft,xt]=D.useState(""),[bt,Be]=D.useState(null),mt=D.useMemo(()=>!!x?.id&&t.some(S=>S.id===x.id),[x?.id,t]),at=D.useMemo(()=>!!x?.id&&!!De&&De.id===x.id,[x?.id,De]),st=D.useMemo(()=>De?.name??"League admin",[De]),et=D.useMemo(()=>{const S=new Map;return t.forEach(z=>S.set(z.id,z.name)),S},[t]),it=D.useCallback(()=>{if(!s?.code||typeof window>"u"||typeof navigator>"u")return;const S=`Join my mini league "${s.name}" on TotL!`,z=`${window.location.origin}/league/${s.code}`,K=navigator;if(typeof K.share=="function"){K.share({title:`Join ${s.name}`,text:S,url:z}).catch(O=>{console.warn("[League] Share cancelled",O)});return}const Q=`${S}
${z}`;navigator.clipboard?.writeText?navigator.clipboard.writeText(Q).then(()=>window.alert?.("League link copied to clipboard!")).catch(()=>{window.prompt?.("Share this league code:",s.code)}):window.prompt?.("Share this league code:",s.code)},[s]),ht=D.useCallback(async()=>{if(!(!s?.id||!x?.id)){U(!0);try{const{error:S}=await re.from("league_members").delete().eq("league_id",s.id).eq("user_id",x.id);if(S)throw S;typeof window<"u"&&(window.location.href="/leagues")}catch(S){console.error("[League] Error leaving league:",S),typeof window<"u"&&window.alert?.(S?.message??"Failed to leave league. Please try again.")}finally{U(!1),j(!1)}}},[s?.id,x?.id]),jt=D.useCallback(async()=>{if(!(!s?.id||!x?.id)){Ee(!0);try{if(t.length>=At){typeof window<"u"&&window.alert?.("League is full (max 8 members)."),we(!1);return}const{error:S}=await re.from("league_members").insert({league_id:s.id,user_id:x.id});if(S)throw S;typeof window<"u"&&window.location.reload()}catch(S){console.error("[League] Error joining league:",S),typeof window<"u"&&window.alert?.(S?.message??"Failed to join league.")}finally{Ee(!1)}}},[s?.id,x?.id,t.length]),ot=D.useCallback(async()=>{if(!(!Ve||!s?.id||!x?.id)){nt(!0);try{const{error:S}=await re.from("league_members").delete().eq("league_id",s.id).eq("user_id",Ve.id);if(S)throw S;typeof window<"u"&&window.location.reload()}catch(S){console.error("[League] Error removing member:",S),typeof window<"u"&&window.alert?.(S?.message??"Failed to remove member.")}finally{nt(!1),Se(!1),ut(null)}}},[s?.id,Ve,x?.id]),lt=D.useCallback(async()=>{if(!(!s?.id||!x?.id)){We(!0);try{const{error:S}=await re.from("league_members").delete().eq("league_id",s.id);if(S)throw S;const{error:z}=await re.from("leagues").delete().eq("id",s.id);if(z)throw z;typeof window<"u"&&(window.location.href="/leagues")}catch(S){console.error("[League] Error ending league:",S),typeof window<"u"&&window.alert?.(S?.message??"Failed to end league.")}finally{We(!1),Re(!1)}}},[s?.id,x?.id]),yn=D.useCallback(async S=>{if(!s?.id||!at){he("Only league admins can upload avatars.");return}if(!new Set(["image/png","image/jpeg","image/jpg","image/webp"]).has(S.type)){he("Please upload a PNG, JPG, or WebP image.");return}if(S.size>2*1024*1024){he("Please choose an image smaller than 2MB.");return}he(null),qe(!1),oe(!0);try{const K=await He(S,{maxSizeMB:.02,maxWidthOrHeight:256,useWebWorker:!0,initialQuality:.8});if(K.size>20*1024)throw new Error("Compressed image is still larger than 20KB. Try a smaller image.");const O={"image/png":"png","image/jpeg":"jpg","image/jpg":"jpg","image/webp":"webp"}[K.type]??"jpg",Y=`${s.id}-${Date.now()}.${O}`,{error:te}=await re.storage.from("league-avatars").upload(Y,K,{cacheControl:"3600",upsert:!0,contentType:K.type});if(te)throw te;const{data:ue}=re.storage.from("league-avatars").getPublicUrl(Y),ke=ue?.publicUrl;if(!ke)throw new Error("Unable to get public URL for avatar.");const{error:me}=await re.from("leagues").update({avatar:ke}).eq("id",s.id);if(me)throw me;e(ce=>ce&&{...ce,avatar:ke}),qe(!0)}catch(K){console.error("[League] Error uploading avatar:",K),he(K?.message??"Failed to upload avatar. Please try again.")}finally{oe(!1)}},[at,s?.id]),jn=D.useCallback(async()=>{if(!(!s?.id||!at)){he(null),qe(!1),oe(!0);try{const{error:S}=await re.from("leagues").update({avatar:null}).eq("id",s.id);if(S)throw S;e(z=>z&&{...z,avatar:null}),qe(!0)}catch(S){console.error("[League] Error removing avatar:",S),he(S?.message??"Failed to remove avatar. Please try again.")}finally{oe(!1)}}},[at,s?.id]),[Ut,_n]=D.useState(new Map);D.useEffect(()=>{(async()=>{const S=new Map,{data:z}=await re.from("app_fixtures").select("gw, kickoff_time").order("gw",{ascending:!0}),{data:K}=await re.from("app_fixtures").select("gw, kickoff_time").eq("gw",1).order("fixture_index",{ascending:!0}),Q=new Map;if(z&&z.forEach(O=>{(!Q.has(O.gw)||O.kickoff_time&&new Date(O.kickoff_time)<new Date(Q.get(O.gw)))&&O.kickoff_time&&Q.set(O.gw,O.kickoff_time)}),K&&K.length>0){const O=K.find(Y=>Y.kickoff_time)?.kickoff_time;if(O){const Y=Q.get(1);(!Y||new Date(O)<new Date(Y))&&Q.set(1,O)}}Q.forEach((O,Y)=>{const te=new Date(O),ue=new Date(te.getTime()-4500*1e3);S.set(Y,ue)}),_n(S)})()},[]),D.useEffect(()=>{const S=z=>{const K=z.target;g&&!K.closest(".gw-dropdown-container")&&f(!1)};return g&&document.addEventListener("click",S),()=>document.removeEventListener("click",S)},[g]),D.useEffect(()=>{let S=!0;return(async()=>{const{data:z}=await re.from("app_meta").select("current_gw").eq("id",1).maybeSingle();if(!S)return;R(z?.current_gw??null);const{data:K}=await re.from("app_gw_results").select("gw").order("gw",{ascending:!1}).limit(1);if(!S)return;M(K&&K.length?K[0].gw:null);const{data:Q}=await re.from("app_gw_results").select("gw").order("gw",{ascending:!1});if(!S)return;const O=Q?[...new Set(Q.map(te=>te.gw))].sort((te,ue)=>ue-te):[],Y=z?.current_gw;Y&&!O.includes(Y)&&O.unshift(Y),A(O),O.length>0&&!c&&d(O[0])})(),()=>{S=!1}},[H]);const ct=D.useMemo(()=>t.map(S=>S.id),[t]),[Ae,Ot]=D.useState([]),[wt,Ft]=D.useState([]),[Dt,Rt]=D.useState([]),[_t,Pt]=D.useState([]),qt=D.useMemo(()=>!Ae||Ae.length===0?[]:Ae.map(S=>S.api_match_id).filter(S=>S!=null),[Ae]),Nt=D.useMemo(()=>s?.name==="API Test",[s?.name]),[Ze,Vt]=D.useState(null);D.useEffect(()=>{if(!Nt){Vt(null);return}let S=!0;return(async()=>{const{data:z}=await re.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();let K=z?.current_test_gw??1;if(K&&K!==1){const{data:Q}=await re.from("app_fixtures").select("gw").eq("gw",K).limit(1).maybeSingle();if(!Q){const{data:O}=await re.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();O&&(K=1)}}S&&Vt(K)})(),()=>{S=!1}},[Nt]);const Nn=D.useMemo(()=>Nt&&Ze!==null?Ze:C||c||void 0,[Nt,Ze,C,c]),{liveScores:Kt}=Un(Nn,qt.length>0?qt:void 0),$e=D.useMemo(()=>{const S={};return!Ae||Ae.length===0||Ae.forEach(z=>{const K=z.api_match_id;if(K){const Q=Kt.get(K);Q&&(S[z.fixture_index]={homeScore:Q.home_score??0,awayScore:Q.away_score??0,status:Q.status||"SCHEDULED",minute:Q.minute??null})}}),S},[Kt,Ae]),[Yt,vt]=D.useState([]),[kn,yt]=D.useState(!1);D.useEffect(()=>{let S=!0;return(async()=>{y(!0);const{data:z}=await re.from("leagues").select("id,name,code,created_at").eq("code",m).maybeSingle();if(!S)return;if(!z){e(null),u([]),y(!1);return}e(z);const{data:K}=await re.from("league_members").select("users(id,name),created_at").eq("league_id",z.id).order("created_at",{ascending:!0}),Q=K?.map(te=>({id:te.users.id,name:te.users.name??"(no name)"}))??[],O=[...Q].sort((te,ue)=>te.name.localeCompare(ue.name));u(O);const Y=Q[0];Xe(Y),x?.id&&!Q.some(te=>te.id===x.id)&&we(!0),y(!1)})(),()=>{S=!1}},[m]),D.useEffect(()=>{},[s,v]),D.useEffect(()=>{if(v!=="chat"&&v!=="chat-beta"||!s?.id||!x?.id)return;(async()=>{await re.from("league_message_reads").upsert({league_id:s.id,user_id:x.id,last_read_at:new Date().toISOString()},{onConflict:"league_id,user_id"})})()},[v,s?.id,x?.id]);const Sn=D.useCallback(async(S,z=!1)=>{const{data:K,error:Q}=await re.from("league_messages").select("id, league_id, user_id, content, created_at").eq("league_id",S).order("created_at",{ascending:!1}).limit(500);if(!Q&&K){const Y=(K??[]).reverse();z&&console.log("[Chat] Loaded messages:",Y.length,"from database (most recent)"),Je(te=>{const ue=new Set(te.map(J=>J.id)),ke=Y.filter(J=>!ue.has(J.id));if(te.length===0)return z&&console.log("[Chat] Initial load, setting",Y.length,"messages"),Y;const ce=[...te,...ke].sort((J,pe)=>new Date(J.created_at).getTime()-new Date(pe.created_at).getTime()),B=ce.length>500?ce.slice(-500):ce;return z&&console.log("[Chat] Merged messages. Previous:",te.length,"New from DB:",ke.length,"Total:",ce.length,"After limit:",B.length),B})}else Q&&console.error("[Chat] Error loading messages:",Q)},[]);D.useEffect(()=>{if(!s?.id)return;let S=!0;const z=async()=>{S&&await Sn(s.id,!0)};z();const K=re.channel(`league-messages:${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"league_messages",filter:`league_id=eq.${s.id}`},Y=>{const te=Y.new;console.log("[Chat] Realtime message received:",te.id,te.content.substring(0,50)),Je(ue=>{if(ue.some(me=>me.id===te.id))return console.log("[Chat] Message already exists, skipping"),ue;const ke=[...ue,te];return console.log("[Chat] Added realtime message. Total messages:",ke.length),ke})}).subscribe(),Q=()=>{!document.hidden&&s?.id&&S&&(console.log("[Chat] App became visible, refetching messages..."),z())},O=()=>{s?.id&&S&&(console.log("[Chat] Window gained focus, refetching messages..."),z())};return document.addEventListener("visibilitychange",Q),window.addEventListener("focus",O),()=>{S=!1,re.removeChannel(K),document.removeEventListener("visibilitychange",Q),window.removeEventListener("focus",O)}},[s?.id]);const An=D.useCallback(async()=>{if(!s||!x?.id)return;const S=ft.trim();if(!S)return;xt("");const{data:z,error:K}=await re.from("league_messages").insert({league_id:s.id,user_id:x.id,content:S}).select("id, league_id, user_id, content, created_at").single();K?(console.error(K),alert("Failed to send message.")):z&&Je(O=>[...O,z]),window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||setTimeout(async()=>{try{const O=x.user_metadata?.display_name||x.email||"User",Y=await fetch("/.netlify/functions/notifyLeagueMessageV2",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:s.id,senderId:x.id,senderName:O,content:S})}),te=await Y.json().catch(()=>({}));te.ok===!0?te.sent&&te.sent>0?Be({message:` Message sent to ${te.sent} device${te.sent===1?"":"s"}`,type:"success"}):te.message==="No subscribed devices"?Be({message:` No subscribed devices (${te.eligibleRecipients||0} eligible recipient${te.eligibleRecipients===1?"":"s"})`,type:"warning"}):te.message==="No devices"?Be({message:` No devices registered (${te.eligibleRecipients||0} eligible recipient${te.eligibleRecipients===1?"":"s"})`,type:"warning"}):te.message==="No eligible recipients"?Be({message:" All members are currently active",type:"success"}):Be({message:` ${te.message||"Notification sent"}`,type:"success"}):te.ok===!1||te.error?Be({message:` Failed to send notification: ${te.error||"Unknown error"}`,type:"error"}):Y.ok||Be({message:` Notification error (HTTP ${Y.status})`,type:"error"}),setTimeout(()=>Be(null),5e3)}catch(O){console.error("[Chat] Notification exception:",O),Be({message:" Failed to send notification",type:"error"}),setTimeout(()=>Be(null),5e3)}},100)},[s,x,ft,xt,Je,Be]);D.useEffect(()=>{let S=!0;return(async()=>{const z=s?.name==="API Test";let K=Ze??1;if(z){const{data:me}=await re.from("test_api_meta").select("current_test_gw").eq("id",1).maybeSingle();if(K=me?.current_test_gw??1,K&&K!==1){const{data:ce}=await re.from("app_fixtures").select("gw").eq("gw",K).limit(1).maybeSingle();if(ce)console.log("[League] Using current_test_gw from meta:",K);else{const{data:B}=await re.from("app_fixtures").select("gw").eq("gw",1).limit(1).maybeSingle();B&&(K=1,console.log("[League] No fixtures for current_test_gw, falling back to GW T1"))}}else console.log("[League] Using GW T1 or current_test_gw:",K)}const Q=z&&(v==="gw"||v==="gwr");console.log("[League] Data fetch:",{isApiTestLeague:z,tab:v,useTestFixtures:Q,leagueName:s?.name,testGwForData:K,willUseTestTables:Q,willUseMainTables:!Q});let O=v==="gwr"?r.current?c:C||c:C;if(z&&(v==="gw"||v==="gwr")&&(O=K),console.log("[League] gwForData calculation:",{tab:v,manualGwSelected:r.current,selectedGw:c,currentGw:C,gwForData:O,isApiTestLeague:z}),v==="gw"&&!z&&ct.length>0){const{data:me}=await re.from("app_gw_submissions").select("gw").in("user_id",ct).not("submitted_at","is",null).order("gw",{ascending:!1}).limit(10);if(me&&me.length>0){const ce=[...new Set(me.map(B=>B.gw))].sort((B,J)=>(J||0)-(B||0));for(const B of ce)if(B){const{data:J}=await re.from("app_fixtures").select("gw").eq("gw",B).limit(1);if(J&&J.length>0){console.log("[League] Found fixtures for GW",B,"from submissions - using this GW (currentGw was",O,")"),O=B;break}}}!O&&C&&(O=C,console.log("[League] Using currentGw as fallback:",C))}if(console.log("[League] gwForData:",O,"memberIds:",ct),!O&&!Q){Ot([]),Ft([]),Rt([]),Pt([]);return}let Y;if(Q){const{data:me}=await re.from("app_fixtures").select("id,test_gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,home_crest,away_crest,kickoff_time,api_match_id").eq("test_gw",K).order("fixture_index",{ascending:!0});Y=me?.map(ce=>({...ce,gw:ce.test_gw}))||null}else{console.log("[League] Fetching from MAIN database table (app_fixtures) for regular league, GW:",O);const{data:me}=await re.from("app_fixtures").select("id,gw,fixture_index,home_team,away_team,home_code,away_code,home_name,away_name,kickoff_time,api_match_id").eq("gw",O).order("fixture_index",{ascending:!0});Y=me||null,console.log("[League] Fetched fixtures from main database:",me?.length||0,"fixtures")}if(!S)return;if(Ot(Y??[]),!ct.length){Ft([]),Rt([]),Pt([]);return}let te=null,ue;if(Q){const{data:me}=await re.from("app_picks").select("user_id,matchday,fixture_index,pick").eq("matchday",K).in("user_id",ct);te=me?.map(q=>({...q,gw:q.matchday}))||null;const{data:ce,error:B}=await re.from("app_gw_submissions").select("user_id,matchday,submitted_at").eq("matchday",K).not("submitted_at","is",null).in("user_id",ct);B&&console.error("Error fetching test_api_submissions:",B);const{data:J}=await re.from("app_fixtures").select("fixture_index,home_team,away_team,home_code,away_code,kickoff_time").eq("test_gw",K).order("fixture_index",{ascending:!0}),pe=new Set((J||[]).map(q=>q.fixture_index));console.log("[League] Current fixture indices from test_api_fixtures:",Array.from(pe)),console.log("[League] Current fixtures:",J?.map(q=>({index:q.fixture_index,home:q.home_team,away:q.away_team})));const W=[];if(ce&&te&&J){const q=pe.size;console.log("[League] Required fixture count for valid submission:",q);const le=(J||[]).map(ee=>ee.kickoff_time?new Date(ee.kickoff_time):null).filter(ee=>ee!==null&&!isNaN(ee.getTime())),ne=le.length>0?new Date(Math.min(...le.map(ee=>ee.getTime()))):null,_e=new Date("2025-11-18T00:00:00Z");console.log("[League] Submission cutoff date (submissions before this are old):",_e.toISOString()),console.log("[League] Earliest kickoff:",ne?.toISOString()),ce.forEach(ee=>{const ye=(te||[]).filter(Ce=>Ce.user_id===ee.user_id&&Ce.matchday===K),ae=ye.filter(Ce=>pe.has(Ce.fixture_index)),ie=ae.length===q&&q>0,de=new Set(ae.map(Ce=>Ce.fixture_index)),Ke=de.size===q,dt=ee.submitted_at?new Date(ee.submitted_at):null,Me=dt&&dt>=_e;if(ie&&Ke&&Me)W.push(ee),console.log("[League]  VALID submission (has picks for ALL current fixtures AND recent submission):",{user_id:ee.user_id,submitted_at:ee.submitted_at,submissionDate:dt?.toISOString(),cutoffDate:_e.toISOString(),picksCount:ye.length,picksForCurrentFixtures:ae.length,uniqueIndices:de.size,requiredCount:q});else{const Ce=[];ie||Ce.push("missing picks"),Ke||Ce.push("duplicate/extra picks"),Me||Ce.push(`old submission (${dt?.toISOString()} < ${_e.toISOString()})`),console.log("[League]  INVALID submission:",{user_id:ee.user_id,submitted_at:ee.submitted_at,submissionDate:dt?.toISOString(),cutoffDate:_e.toISOString(),picksCount:ye.length,picksForCurrentFixtures:ae.length,uniqueIndices:de.size,requiredCount:q,hasAllRequired:ie,hasExactMatch:Ke,isRecent:Me,reason:Ce.join(", ")})}})}ue=W.map(q=>({...q,gw:q.matchday}))||null,console.log("[League] Test API submissions fetched (filtered to only current fixtures):",ue),console.log("[League] Valid submissions count:",W.length,"out of",ce?.length||0,"total")}else{console.log("[League] Fetching from MAIN database tables (picks, gw_submissions) for regular league");const{data:me}=await re.from("app_picks").select("user_id,gw,fixture_index,pick").eq("gw",O).in("user_id",ct);te=me,console.log("[League] Fetched picks from main database:",me?.length||0,"picks");const{data:ce}=await re.from("app_gw_submissions").select("user_id,gw,submitted_at").eq("gw",O).in("user_id",ct);ue=ce,console.log("[League] Fetched submissions from main database:",ce?.length||0,"submissions")}if(!S)return;Ft(te??[]),Rt(ue??[]);const{data:ke}=await re.from("app_gw_results").select("gw,fixture_index,result").eq("gw",Q?1:O||0);S&&Pt(ke??[])})(),()=>{S=!1}},[v,C,p,c,ct]),D.useEffect(()=>{b.current=$e},[$e]);const Ge=D.useMemo(()=>{const S=new Map;return console.log("[League] Building submittedMap from subs:",Dt),Dt.forEach(z=>{if(z.submitted_at){const K=`${z.user_id}:${z.gw}`;console.log(`[League] Adding submission key: ${K}`,z),S.set(K,!0)}else console.log("[League] Skipping submission with null submitted_at:",z)}),console.log("[League] Final submittedMap:",Array.from(S.entries())),S},[Dt]),kt=D.useCallback(S=>S.map(z=>({user_id:z.id,name:z.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]})),[]);D.useEffect(()=>{const S=re.channel("app-gw-results-changes").on("postgres_changes",{event:"*",schema:"public",table:"app_gw_results"},()=>{X(z=>z+1)}).subscribe();return()=>{re.removeChannel(S)}},[]),D.useEffect(()=>{let S=!0;return(async()=>{if(!t.length){vt([]);return}if(s?.name==="API Test"){vt(kt(t)),yt(!1);return}if(C===null)return;yt(!0);const{data:z}=await re.from("app_gw_results").select("gw,fixture_index,result"),K=z??[],Q=new Map;if(K.forEach(ee=>{const ye=Gt(ee);ye&&Q.set(`${ee.gw}:${ee.fixture_index}`,ye)}),Q.size===0){vt(kt(t)),yt(!1);return}const O=[...new Set(Array.from(Q.keys()).map(ee=>parseInt(ee.split(":")[0],10)))].sort((ee,ye)=>ee-ye),Y=["Prem Predictions","FC Football","Easy League"],te=["The Bird league"],ue=await Fn(s,C),ke=O.filter(ee=>ee>=ue);if(!Y.includes(s?.name||"")&&!te.includes(s?.name||"")&&ke.length===0){vt(kt(t)),yt(!1);return}const{data:me}=await re.from("app_picks").select("user_id,gw,fixture_index,pick").in("user_id",t.map(ee=>ee.id)).in("gw",ke),ce=me??[],B=new Map;ke.forEach(ee=>{const ye=new Map;t.forEach(ae=>ye.set(ae.id,{user_id:ae.id,score:0,unicorns:0})),B.set(ee,ye)}),ke.forEach(ee=>{Array.from(Q.entries()).filter(([ae])=>parseInt(ae.split(":")[0],10)===ee).map(([ae,ie])=>({idx:parseInt(ae.split(":")[1],10),out:ie})).forEach(({idx:ae,out:ie})=>{const de=ce.filter(Me=>Me.gw===ee&&Me.fixture_index===ae),Ke=de.filter(Me=>Me.pick===ie).map(Me=>Me.user_id),dt=B.get(ee);if(de.forEach(Me=>{if(Me.pick===ie){const Ce=dt.get(Me.user_id);Ce.score+=1}}),Ke.length===1&&t.length>=3){const Me=Ke[0],Ce=dt.get(Me);Ce.unicorns+=1}})});const J=new Map,pe=new Map,W=new Map,q=new Map,le=new Map,ne=new Map;t.forEach(ee=>{J.set(ee.id,0),pe.set(ee.id,0),W.set(ee.id,0),q.set(ee.id,0),le.set(ee.id,0),ne.set(ee.id,[])}),ke.forEach(ee=>{const ye=Array.from(B.get(ee).values());if(ye.forEach(de=>{pe.set(de.user_id,(pe.get(de.user_id)??0)+de.score),W.set(de.user_id,(W.get(de.user_id)??0)+de.unicorns)}),ye.sort((de,Ke)=>Ke.score-de.score||Ke.unicorns-de.unicorns),!ye.length)return;const ae=ye[0],ie=ye.filter(de=>de.score===ae.score&&de.unicorns===ae.unicorns);ie.length===1?(J.set(ae.user_id,(J.get(ae.user_id)??0)+3),q.set(ae.user_id,(q.get(ae.user_id)??0)+1),ne.get(ae.user_id).push("W"),ye.slice(1).forEach(de=>ne.get(de.user_id).push("L"))):(ie.forEach(de=>{J.set(de.user_id,(J.get(de.user_id)??0)+1),le.set(de.user_id,(le.get(de.user_id)??0)+1),ne.get(de.user_id).push("D")}),ye.filter(de=>!ie.find(Ke=>Ke.user_id===de.user_id)).forEach(de=>ne.get(de.user_id).push("L")))});const _e=t.map(ee=>({user_id:ee.id,name:ee.name,mltPts:J.get(ee.id)??0,ocp:pe.get(ee.id)??0,unicorns:W.get(ee.id)??0,wins:q.get(ee.id)??0,draws:le.get(ee.id)??0,form:ne.get(ee.id)??[]}));_e.sort((ee,ye)=>ye.mltPts-ee.mltPts||ye.unicorns-ee.unicorns||ye.ocp-ee.ocp||ee.name.localeCompare(ye.name)),S&&(vt(_e),yt(!1))})(),()=>{S=!1}},[t,s,C,kt,H]);function Cn(){const S=["Prem Predictions","FC Football","Easy League"],z=["The Bird league"],K=["gregVjofVcarl","Let Down"],Q=!!(s&&!S.includes(s.name)&&!z.includes(s.name)&&!K.includes(s.name)),O=Yt.length?Yt:t.map(Y=>({user_id:Y.id,name:Y.name,mltPts:0,ocp:0,unicorns:0,wins:0,draws:0,form:[]}));return t.length===1?n.jsxs("div",{className:"text-center p-8 bg-white rounded-xl border border-slate-200 shadow-sm",children:[n.jsx("div",{className:"text-6xl mb-4",children:""}),n.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Invite at least one more user to make the ML start"}),n.jsx("p",{className:"text-slate-600 mb-4",children:"Share your league code with friends to get the competition going!"}),n.jsx("button",{onClick:()=>Ne(!0),className:"px-4 py-2 bg-[#1C8376] text-white font-semibold rounded-lg hover:bg-emerald-700 transition-colors",children:"Share League Code"})]}):n.jsxs("div",{className:"pt-4",children:[n.jsx(fs,{rows:O,members:t,showForm:h,currentUserId:x?.id,loading:kn,isLateStartingLeague:Q}),n.jsx("div",{className:"mt-6 flex justify-between items-center",children:n.jsxs("div",{className:"flex items-center justify-between w-full",children:[n.jsx(ds,{showForm:h,onToggle:N}),n.jsxs("button",{onClick:()=>Z(!0),className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[n.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),n.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),s?.name==="API Test"&&n.jsx("div",{className:"mt-4",style:{marginLeft:"-1rem",marginRight:"-1rem",width:"calc(100% + 2rem)",paddingLeft:0,paddingRight:0},children:n.jsx("video",{src:"/assets/Animation/Unicorn_Small.mov",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,style:{width:"100%",height:"auto",display:"block",padding:0,margin:0}})})]})}function Ln(){const S=s?.name==="API Test"?Ze??1:C;if(!S)return n.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No current gameweek available."});if(!Xt(s,S,Ut))return n.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Predictions Available"}),n.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),n.jsxs("div",{className:"text-sm",children:["GW",S," predictions are not included in this league."]})]})});const z=new Map;_t.forEach(W=>{if(W.gw!==S)return;const q=Gt(W);q&&z.set(W.fixture_index,q)}),Ae.forEach(W=>{if(W.gw!==S)return;const q=$e[W.fixture_index];q&&(q.status==="IN_PLAY"||q.status==="PAUSED"||q.status==="FINISHED")&&(q.homeScore>q.awayScore?z.set(W.fixture_index,"H"):q.awayScore>q.homeScore?z.set(W.fixture_index,"A"):z.set(W.fixture_index,"D"))});const K=D.useMemo(()=>{const W=ne=>{if(!ne)return"Fixtures";const _e=new Date(ne);return isNaN(_e.getTime())?"Fixtures":_e.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})},q=new Map;Ae.filter(ne=>ne.gw===S).forEach(ne=>{const _e=W(ne.kickoff_time),ee=ne.kickoff_time?new Date(ne.kickoff_time).getTime():Number.MAX_SAFE_INTEGER;q.has(_e)||q.set(_e,{label:_e,key:ee,items:[]}),q.get(_e).items.push(ne)});const le=Array.from(q.values());return le.forEach(ne=>ne.items.sort((_e,ee)=>_e.fixture_index-ee.fixture_index)),le.sort((ne,_e)=>ne.key-_e.key),le},[Ae,S]),Q=new Set(Ae.filter(W=>W.gw===S).map(W=>W.fixture_index)),O=s?.name==="API Test",Y=t.length>0&&t.every(W=>Ge.get(`${W.id}:${S}`));if(O&&S===(Ze??1)){console.log("[League] API Test filtering:",{currentFixtureIndices:Array.from(Q),totalPicks:wt.length,picksForGw:wt.filter(q=>q.gw===S).length,submittedMapSize:Ge.size,allSubmitted:Y,members:t.map(q=>({id:q.id,name:q.name,submitted:Ge.get(`${q.id}:${S}`)})),fixturesCount:Ae.filter(q=>q.gw===S).length});const W=wt.filter(q=>q.gw===S);console.log(`[League] All picks for GW${S}:`,W.map(q=>({user_id:q.user_id,userName:t.find(le=>le.id===q.user_id)?.name,fixture_index:q.fixture_index,pick:q.pick,hasSubmitted:!!Ge.get(`${q.user_id}:${S}`),inCurrentFixtures:Q.has(q.fixture_index)})))}const te=new Map;!O||Y?wt.forEach(W=>{if(W.gw!==S)return;if(O&&!Ge.get(`${W.user_id}:${S}`)){S===1&&console.log("[League] API Test: Filtering out unsubmitted pick:",{user_id:W.user_id,fixture_index:W.fixture_index,userName:t.find(ne=>ne.id===W.user_id)?.name});return}if(!Q.has(W.fixture_index)){O&&S===1&&console.log("[League] Filtering out old pick (not in current fixtures):",{fixture_index:W.fixture_index,currentIndices:Array.from(Q),userName:t.find(le=>le.id===W.user_id)?.name});return}const q=te.get(W.fixture_index)??[];q.push(W),te.set(W.fixture_index,q)}):console.log("[League] API Test: Not all submitted - skipping ALL picks processing. allSubmitted=",Y);const ue=p!==null&&p>=S,ke=t.filter(W=>!Ge.get(`${W.id}:${S}`)).length,me=t.filter(W=>!Ge.get(`${W.id}:${S}`)).map(W=>W.name),ce=Ut.get(S),B=ce?new Date>=ce:!1;if(O&&S===1){const W=t.map(ne=>{const _e=`${ne.id}:${S}`,ee=Ge.get(_e);return{id:ne.id,name:ne.name,submitted:!!ee,key:_e}});console.log(`[League] ===== API Test GW${S} SUBMISSION CHECK =====`),console.log("[League] All submitted:",Y),console.log("[League] Remaining:",ke),console.log("[League] Who didn't submit:",me),console.log("[League] Member submission status:",W),console.log("[League] Submitted map entries:",Array.from(Ge.entries())),console.log("[League] ================================================");const q=t.find(ne=>ne.name.toLowerCase().includes("steve")||ne.name.toLowerCase().includes("s")),le=t.find(ne=>ne.name.toLowerCase().includes("jof")||ne.name.toLowerCase().includes("j"));if(q){const ne=`${q.id}:${S}`;console.log(`[League] STEVE (${q.name}):`,{id:q.id,submitted:!!Ge.get(ne),key:ne})}if(le){const ne=`${le.id}:${S}`;console.log(`[League] JOF (${le.name}):`,{id:le.id,submitted:!!Ge.get(ne),key:ne})}}console.log(`GW${S} deadline check:`,{gwDeadline:ce,now:new Date,deadlinePassed:B,allSubmitted:Y,willShowPredictions:Y||B});const J=O?!Y:!Y&&!B;return(O?!Y:!Y&&!B)?(console.log(`[League] Not all submitted, showing ONLY "Who's submitted" view. Blocking all predictions/fixtures.`,{isApiTestLeague:O,allSubmitted:Y,deadlinePassed:B,remaining:ke}),n.jsx(rn,{members:t,submittedMap:Ge,picksGw:S,allSubmitted:Y,remaining:ke,fixtures:Ae.filter(W=>W.gw===S),variant:"compact"})):n.jsxs("div",{className:"mt-2 pt-2",children:[J?n.jsx(rn,{members:t,submittedMap:Ge,picksGw:S,allSubmitted:Y,remaining:ke,fixtures:Ae.filter(W=>W.gw===S),variant:"full"}):null,s?.name==="API Test"&&Y&&K.length>0&&!J&&(()=>{const W=K.flatMap(ae=>ae.items),q=new Set(W.map(ae=>ae.fixture_index)),le={};Object.keys($e).forEach(ae=>{const ie=parseInt(ae,10);q.has(ie)&&(le[ie]=$e[ie])});const ne=W.some(ae=>{const ie=le[ae.fixture_index];return ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED")}),_e=W.length>0&&W.every(ae=>{const ie=le[ae.fixture_index];return ie&&ie.status==="FINISHED"}),ee=ne||_e||W.some(ae=>le[ae.fixture_index]);let ye=0;return x?.id&&W.forEach(ae=>{const ie=le[ae.fixture_index],de=ie&&(ie.status==="IN_PLAY"||ie.status==="PAUSED"),Ke=ie&&ie.status==="FINISHED";if(ie&&(de||Ke)){const Me=(te.get(ae.fixture_index)??[]).find(Ce=>Ce.user_id===x.id);if(Me){let Ce=!1;(Me.pick==="H"&&ie.homeScore>ie.awayScore||Me.pick==="A"&&ie.awayScore>ie.homeScore||Me.pick==="D"&&ie.homeScore===ie.awayScore)&&(Ce=!0),Ce&&ye++}}}),n.jsx("div",{className:"mt-3 space-y-6",children:K.map((ae,ie)=>n.jsx(on,{label:ae.label,fixtures:ae.items,picksByFixture:te,members:t,outcomes:z,liveScores:le,submittedMap:Ge,picksGw:S,isApiTestLeague:!0,isFirstSection:ie===0,hasLiveGames:ne,allGamesFinished:_e,hasStarted:ee,liveFixturesCount:ye},ie))})})(),K.length>0&&s?.name!=="API Test"&&n.jsx("div",{className:"mt-3 space-y-6",children:K.map((W,q)=>n.jsx(on,{label:W.label,fixtures:W.items,picksByFixture:te,members:t,outcomes:z,liveScores:$e,submittedMap:Ge,picksGw:S,isApiTestLeague:!1,isFirstSection:q===0,allSubmitted:Y,resultsPublished:ue,deadlinePassed:B,whoDidntSubmit:me},q))}),!K.length&&!J&&n.jsxs("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-500",children:["No fixtures for GW ",S,"."]})]})}function En(){const S=s?.name==="API Test"?Ze??1:v==="gwr"?r.current?c:C||c:c;if(!S||_.length===0&&s?.name!=="API Test")return n.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:"No gameweek selected."});if(!Xt(s,S,Ut))return n.jsx("div",{className:"mt-3 rounded-2xl border bg-white shadow-sm p-4 text-slate-600",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-semibold mb-2",children:"No Results Available"}),n.jsx("div",{className:"text-sm",children:"This league started from a later gameweek."}),n.jsxs("div",{className:"text-sm",children:["GW",S," results are not included in this league."]})]})});const z=new Map,K=s?.name==="API Test",Q=Ae.filter(B=>B.gw===S),O=Q.some(B=>{const J=$e[B.fixture_index];return J&&(J.status==="IN_PLAY"||J.status==="PAUSED"||J.status==="FINISHED")});console.log("[League] Live Table calculation:",{resGw:S,currentGw:C,selectedGw:c,hasLiveScores:O,liveScoresCount:Object.keys($e).length,isApiTestLeague:K,fixturesCount:Ae.length,fixturesForGwCount:Q.length,manualGwSelected:r.current}),K&&S===(Ze??1)?Q.forEach(B=>{const J=$e[B.fixture_index];J&&(J.status==="IN_PLAY"||J.status==="PAUSED"||J.status==="FINISHED")&&(J.homeScore>J.awayScore?z.set(B.fixture_index,"H"):J.awayScore>J.homeScore?z.set(B.fixture_index,"A"):z.set(B.fixture_index,"D"))}):O&&S===C?(console.log("[League] Using live scores for regular league GW",S),Q.forEach(B=>{const J=$e[B.fixture_index];J&&(J.status==="IN_PLAY"||J.status==="PAUSED"||J.status==="FINISHED")&&(J.homeScore>J.awayScore?z.set(B.fixture_index,"H"):J.awayScore>J.homeScore?z.set(B.fixture_index,"A"):z.set(B.fixture_index,"D"))}),console.log("[League] Outcomes from live scores:",Array.from(z.entries()))):(console.log("[League] Using results table for GW",S,{hasLiveScores:O,resGwEqualsCurrentGw:S===C,resultsCount:_t.length,resultsForThisGw:_t.filter(B=>B.gw===S).length,manualGwSelected:r.current,selectedGw:c}),_t.forEach(B=>{if(B.gw!==S)return;const J=Gt(B);J&&z.set(B.fixture_index,J)}),console.log("[League] Outcomes from results:",Array.from(z.entries())));const Y=t.map(B=>({user_id:B.id,name:B.name,score:0,unicorns:0})),te=new Map;wt.forEach(B=>{if(B.gw!==S)return;const J=te.get(B.fixture_index)??[];J.push(B),te.set(B.fixture_index,J)}),Array.from(z.entries()).forEach(([B,J])=>{const W=(te.get(B)??[]).filter(q=>q.pick===J).map(q=>q.user_id);if(W.forEach(q=>{const le=Y.find(ne=>ne.user_id===q);le.score+=1}),W.length===1&&t.length>=3){const q=Y.find(le=>le.user_id===W[0]);q.unicorns+=1}}),Y.sort((B,J)=>J.score-B.score||J.unicorns-B.unicorns||B.name.localeCompare(J.name)),D.useEffect(()=>{if(Y.length===0)return;const B=new Map;Y.forEach((pe,W)=>{B.set(pe.user_id,W)});const J=new Set;if(B.forEach((pe,W)=>{const q=k.current.get(W);q!==void 0&&q!==pe&&J.add(W)}),k.current=B,J.size>0){L(J);const pe=setTimeout(()=>{L(new Set)},2e3);return()=>clearTimeout(pe)}},[Y.map(B=>`${B.user_id}-${B.score}-${B.unicorns}`).join(",")]);let ue=!1,ke=!1,me=!1,ce=!1;if(K&&S===(Ze??1)){const B=Ae;if(B.length>0&&(ue=B.every(pe=>{const W=$e[pe.fixture_index];return W&&W.status==="FINISHED"}),ke=!!B.find(pe=>{const W=$e[pe.fixture_index];return W&&(W.status==="IN_PLAY"||W.status==="PAUSED")}),ce=B.some(pe=>{const W=$e[pe.fixture_index];return W&&(W.status==="IN_PLAY"||W.status==="PAUSED"||W.status==="FINISHED")}),!ue)){const pe=new Date;me=B.some(W=>{if(!W.kickoff_time)return!1;const le=new Date(W.kickoff_time).getTime()-pe.getTime(),ne=$e[W.fixture_index];return(!ne||ne.status!=="IN_PLAY"&&ne.status!=="PAUSED"&&ne.status!=="FINISHED")&&le>0&&le<=1440*60*1e3})}}else{const B=Ae.filter(J=>J.gw===S);if(B.length>0){const J=B.every(W=>z.has(W.fixture_index)),pe=B.some(W=>{const q=$e[W.fixture_index];return q&&(q.status==="IN_PLAY"||q.status==="PAUSED")});ue=J&&!pe,console.log(`[League] GW ${S} finished check:`,{allHaveResults:J,hasActiveGames:pe,fixturesCount:B.length,outcomesCount:B.filter(W=>z.has(W.fixture_index)).length,allFixturesFinished:ue})}}return n.jsxs("div",{children:[n.jsx("style",{children:`
          @keyframes flash {
            0%, 100% {
              background-color: rgb(209, 250, 229);
            }
            25% {
              background-color: rgb(167, 243, 208);
            }
            50% {
              background-color: rgb(209, 250, 229);
            }
            75% {
              background-color: rgb(167, 243, 208);
            }
          }
          @keyframes pulse-score {
            0%, 100% {
              opacity: 1;
            }
            50% {
              opacity: 0.7;
            }
          }
          @keyframes position-change {
            0% {
              background-color: rgb(254, 243, 199);
            }
            50% {
              background-color: rgb(253, 230, 138);
            }
            100% {
              background-color: transparent;
            }
          }
          .flash-user-row {
            animation: flash 1.5s ease-in-out 3;
          }
          .pulse-live-score {
            animation: pulse-score 2s ease-in-out infinite;
          }
          .position-changed {
            animation: position-change 1.5s ease-out;
          }
          .full-width-header-border::after {
            content: '';
            position: absolute;
            left: -1rem;
            right: -1rem;
            bottom: 0;
            height: 1px;
            background-color: #cbd5e1;
            z-index: 1;
          }
        `}),Y.length>0&&ue&&n.jsx(ls,{winnerName:Y[0].name,isDraw:Y[0].score===Y[1]?.score&&Y[0].unicorns===Y[1]?.unicorns}),n.jsx(ms,{rows:Y,members:t,currentUserId:x?.id,positionChangeKeys:w,isApiTestLeague:K,hasLiveFixtures:ke,hasStartingSoonFixtures:me,hasStartedFixtures:ce,allFixturesFinished:ue,resGw:S}),_.length>1&&n.jsx("div",{className:"mt-6 mb-4 flex flex-col items-center gap-3 px-4",children:n.jsxs("div",{className:"flex items-center justify-center gap-3 w-full max-w-sm",children:[n.jsx(cs,{availableGws:_,selectedGw:S,onChange:B=>{r.current=!0,d(B)}}),n.jsxs("button",{onClick:()=>P(!0),className:"flex items-center justify-center gap-1.5 bg-white border-2 border-slate-300 hover:bg-slate-50 rounded-full text-slate-600 hover:text-slate-800 cursor-help transition-colors flex-shrink-0 px-3 py-2",children:[n.jsx("img",{src:"/assets/Icons/School--Streamline-Outlined-Material-Pr0_White.png",alt:"Rules",className:"w-4 h-4",style:{filter:"invert(40%) sepia(8%) saturate(750%) hue-rotate(180deg) brightness(95%) contrast(88%)"}}),n.jsx("span",{className:"text-sm font-medium",children:"Rules"})]})]})}),n.jsx(Zt,{isOpen:G,onClose:()=>P(!1),title:"Weekly Winner",description:` How to Win the Week

The player with the most correct predictions wins.

 Unicorns

In Mini-Leagues with 3 or more players, if you're the only person to correctly predict a fixture, that's a Unicorn. In ties, the player with most Unicorns wins!`})]})}return D.useEffect(()=>{typeof window<"u"&&window.scrollTo({top:0,behavior:"auto"})},[v]),o?n.jsx("div",{className:"max-w-5xl mx-auto px-4 py-10",children:n.jsx("div",{className:"text-slate-500",children:"Loading"})}):!s&&!o?n.jsx("div",{className:"max-w-3xl mx-auto px-4 py-10",children:n.jsxs("div",{className:"rounded border bg-white p-6",children:[n.jsx("div",{className:"font-semibold mb-2",children:"League not found"}),n.jsx(Jt,{to:"/leagues",className:"text-slate-600 underline",children:"Back to Mini Leagues"})]})}):s?n.jsxs("div",{className:`${E?"oldschool-theme":"bg-slate-50"}`,style:{position:"fixed",top:0,left:0,right:0,bottom:0,height:"100vh",maxHeight:"100vh",overflow:"hidden",touchAction:"none"},children:[n.jsx("style",{children:`
        /* Prevent body/html scrolling that could affect fixed header */
        body.league-page-active {
          overflow: hidden !important;
          position: fixed !important;
          width: 100% !important;
          height: 100% !important;
        }
        html.league-page-active {
          overflow: hidden !important;
        }
        .league-header-fixed {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          right: 0 !important;
          z-index: 50 !important;
          transform: translate3d(0, 0, 0) !important;
          -webkit-transform: translate3d(0, 0, 0) !important;
          will-change: transform !important;
          contain: layout style paint !important;
          touch-action: none !important;
          user-select: none !important;
          -webkit-user-select: none !important;
          pointer-events: auto !important;
          -webkit-overflow-scrolling: auto !important;
          overflow: visible !important;
        }
        .league-header-fixed a,
        .league-header-fixed button {
          touch-action: manipulation !important;
          user-select: none !important;
          -webkit-user-select: none !important;
        }
        .league-header-fixed .relative {
          position: relative !important;
          z-index: 100 !important;
        }
        @supports (height: 100dvh) {
          .league-header-fixed {
            top: env(safe-area-inset-top, 0px) !important;
          }
        }
        .league-content-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
          left: 0;
          right: 0;
          bottom: 0;
          overflow-y: auto;
          overflow-x: hidden;
          -webkit-overflow-scrolling: touch;
          overscroll-behavior: none;
          overscroll-behavior-y: none;
          overscroll-behavior-x: none;
          touch-action: pan-y;
          padding-bottom: 2rem;
          padding-left: 1rem;
          padding-right: 1rem;
        }
        .league-content-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
        }
        @media (max-width: 768px) {
          .league-content-wrapper {
            top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px) + 0.5rem);
            padding-bottom: 2rem;
            padding-left: 1rem;
            padding-right: 1rem;
          }
          .league-content-wrapper.has-banner {
            top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px) + 0.5rem);
          }
        }
        /* Chat tab - full height layout */
        .chat-tab-wrapper {
          position: fixed;
          top: calc(3.5rem + 3rem + env(safe-area-inset-top, 0px));
          left: 0;
          right: 0;
          bottom: 0;
          height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          z-index: 10;
          overflow: visible;
          pointer-events: none;
        }
        .chat-tab-wrapper.has-banner {
          top: calc(3.5rem + 3rem + 3.5rem + env(safe-area-inset-top, 0px));
          height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          max-height: calc(100vh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
        }
        .chat-tab-wrapper > * {
          pointer-events: auto;
        }
        @supports (height: 100dvh) {
          .chat-tab-wrapper {
            height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - env(safe-area-inset-top, 0px));
          }
          .chat-tab-wrapper.has-banner {
            height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
            max-height: calc(100dvh - 3.5rem - 3rem - 3.5rem - env(safe-area-inset-top, 0px));
          }
        }
      `}),n.jsx("div",{ref:l,className:"league-header-fixed bg-white border-b border-slate-200 shadow-sm",children:n.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[n.jsxs("div",{className:"flex items-center justify-between h-14",children:[n.jsx(Jt,{to:"/leagues",className:"flex items-center text-slate-600 hover:text-slate-900 transition-colors -ml-2 px-2 py-1",children:n.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),n.jsx("h1",{className:"text-lg font-normal text-slate-900 truncate flex-1 text-left px-2",children:s.name}),n.jsx("div",{className:"relative",style:{zIndex:100},children:n.jsx("button",{onClick:()=>ve(!Fe),className:"flex items-center justify-center w-8 h-8 rounded-full hover:bg-slate-100 transition-colors -mr-2","aria-label":"Menu",children:n.jsx("svg",{className:"w-5 h-5 text-slate-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})})})})]}),n.jsxs("div",{className:"flex border-b border-slate-200 bg-white gap-2",children:[n.jsxs("button",{onClick:()=>{i.current=!0,a("chat-beta")},className:"flex-1 min-w-0 px-2 sm:px-4 py-3 text-[12px] font-semibold transition-colors relative leading-tight whitespace-normal "+(v==="chat-beta"?"text-[#1C8376]":"text-slate-400"),children:[n.jsx("span",{className:"hidden sm:inline",children:"Chat (beta)"}),n.jsx("span",{className:"sm:hidden whitespace-pre-line text-center",children:`Chat
(beta)`}),v==="chat-beta"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(_.length>0||s?.name==="API Test")&&n.jsxs("button",{onClick:()=>{i.current=!0,a("gwr")},className:"flex-1 min-w-0 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight flex items-center justify-center gap-1.5 "+(v==="gwr"?"text-[#1C8376]":"text-slate-400"),children:[(()=>{const S=s?.name==="API Test"?Ze??1:C||c,z=s?.name==="API Test"?`T${S}`:S,K=new Date,Q=Ae[0],O=Q?.kickoff_time?new Date(Q.kickoff_time):null,Y=O&&O<=K,ue=Ae[Ae.length-1]?.fixture_index,me=(ue!==void 0?$e[ue]:null)?.status==="FINISHED",ce=Y&&!me,B=ce?"Live Table":"Results";return n.jsxs(n.Fragment,{children:[ce&&n.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse flex-shrink-0"}),n.jsx("span",{className:"hidden sm:inline",children:z?`GW ${z} ${B}`:`GW ${B}`}),n.jsx("span",{className:"sm:hidden whitespace-pre-line text-center",children:z?`GW${z}
${B.replace(" ","")}`:`GW
${B.replace(" ","")}`})]})})(),v==="gwr"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),(C||s?.name==="API Test")&&n.jsxs("button",{onClick:()=>{i.current=!0,a("gw")},className:"flex-1 min-w-0 px-2 sm:px-4 py-3 text-xs font-semibold transition-colors relative leading-tight "+(v==="gw"?"text-[#1C8376]":"text-slate-400"),children:[n.jsx("span",{className:"hidden sm:inline",children:s?.name==="API Test"?`GW T${Ze??1} Predictions`:C?`GW ${C} Predictions`:"GW Predictions"}),n.jsx("span",{className:"sm:hidden whitespace-pre-line",children:s?.name==="API Test"?`GWT${Ze??1}
Predictions`:C?`GW${C}
Predictions`:`GW
Predictions`}),v==="gw"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]}),n.jsxs("button",{onClick:()=>{i.current=!0,a("mlt")},className:"flex-1 min-w-0 px-2 sm:px-4 py-3 text-sm font-semibold transition-colors relative "+(v==="mlt"?"text-[#1C8376]":"text-slate-400"),children:["Table",v==="mlt"&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#1C8376]"})]})]})]})}),Fe&&typeof document<"u"&&document.body&&Dn.createPortal(n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"fixed inset-0",onClick:()=>ve(!1),style:{backgroundColor:"transparent",zIndex:99998}}),n.jsxs("div",{className:"fixed w-56 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden",style:{zIndex:99999,top:"calc(3.5rem + 0.5rem + env(safe-area-inset-top, 0px))",right:"1rem"},children:[at&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"px-4 py-3 border-b border-slate-100",children:[n.jsx("div",{className:"text-xs text-slate-600 mb-1",children:"Admin:"}),n.jsx("div",{className:"text-sm font-semibold text-slate-800",children:st})]}),n.jsx("button",{onClick:()=>{I(!0),ve(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Manage"}),n.jsx("button",{onClick:()=>{xe(!0),ve(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Upload avatar"})]}),n.jsx("button",{onClick:()=>{Ne(!0),ve(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:" Invite players"}),n.jsx("button",{onClick:()=>{it(),ve(!1)},className:"w-full text-left px-4 py-3 text-sm text-slate-700 hover:bg-slate-50 transition-colors border-b border-slate-100",children:"Share league code"}),n.jsx("button",{onClick:()=>{j(!0),ve(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors",children:"Leave"})]})]}),document.body),v==="chat"?n.jsx("div",{className:"chat-tab-wrapper",children:n.jsx(vs,{chat:Qe,userId:x?.id,nameById:et,isMember:mt,newMsg:ft,setNewMsg:xt,onSend:An,leagueCode:s?.code,memberCount:t.length,maxMembers:At,notificationStatus:bt})}):v==="chat-beta"?n.jsx("div",{className:"chat-tab-wrapper",children:n.jsx(os,{miniLeagueId:s?.id??null,memberNames:et})}):n.jsx("div",{className:"league-content-wrapper",children:n.jsxs("div",{className:"px-1 sm:px-2",children:[v==="mlt"&&n.jsx(Cn,{}),v==="gw"&&n.jsx(Ln,{}),v==="gwr"&&n.jsx(En,{})]})}),at&&$&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>I(!1),children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:S=>S.stopPropagation(),children:[n.jsx("button",{onClick:()=>I(!1),className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),n.jsxs("div",{className:"p-6 pt-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"League Management"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm text-slate-600 mb-3 font-semibold",children:"Remove Members:"}),n.jsxs("div",{className:"space-y-2",children:[t.filter(S=>S.id!==x?.id).map(S=>n.jsxs("div",{className:"flex items-center justify-between py-3 px-4 bg-slate-50 rounded-lg",children:[n.jsx("span",{className:"text-sm font-medium text-slate-800",children:S.name}),n.jsx("button",{onClick:()=>{ut(S),Se(!0),I(!1)},className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium",children:"Remove"})]},S.id)),t.filter(S=>S.id!==x?.id).length===0&&n.jsx("div",{className:"text-sm text-slate-500 italic py-4 text-center",children:"No other members to remove"})]})]}),n.jsx("div",{className:"pt-4 border-t border-slate-200",children:n.jsx("button",{onClick:()=>{Re(!0),I(!1)},className:"w-full px-4 py-3 text-sm bg-red-600 text-white hover:bg-red-700 rounded-lg transition-colors font-medium flex items-center justify-center gap-2",children:" End League"})})]})]})]})}),at&&se&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>xe(!1),children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 relative",onClick:S=>S.stopPropagation(),children:[n.jsx("button",{onClick:()=>{xe(!1),he(null),qe(!1)},className:"absolute top-4 right-4 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),n.jsxs("div",{className:"p-6 pt-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Upload League Avatar"}),n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"text-sm text-slate-600 mb-2 font-medium",children:"Current Avatar:"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden bg-slate-100 flex items-center justify-center",children:n.jsx("img",{src:s?Rn(s):"/assets/league-avatars/ML-avatar-1.png",alt:"League avatar",className:"w-full h-full object-cover",onError:S=>{const z=S.target;z.src="/assets/league-avatars/ML-avatar-1.png"}})}),s?.avatar&&n.jsx("button",{onClick:jn,disabled:fe,className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 hover:bg-red-200 rounded-md transition-colors font-medium disabled:opacity-50",children:"Remove Avatar"})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Upload New Avatar"}),n.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg,image/webp",onChange:S=>{const z=S.target.files?.[0];z&&yn(z)},disabled:fe,className:"block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#1C8376] file:text-white hover:file:bg-emerald-700 file:cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed"}),n.jsx("p",{className:"mt-2 text-xs text-slate-500",children:"Images will be automatically compressed to ~60KB and resized to 256x256px. Max file size: 2MB before compression."})]}),fe&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#1C8376]"}),n.jsx("span",{children:"Processing and uploading..."})]}),Le&&n.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-800",children:" Avatar uploaded successfully!"}),be&&n.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-800",children:be})]})]})]})}),n.jsx(Zt,{isOpen:V,onClose:()=>Z(!1),title:"League Points",description:`Win the week  3 points
Draw  1 point
Lose  0 points

 Ties

If two or more players are tied on Points in the table, the player with the most overall Unicorns in the mini league is ranked higher.${s&&(["The Bird league"].includes(s.name)||["gregVjofVcarl","Let Down"].includes(s.name))?`

Note: This mini league started after GW1, so the "CP" column shows correct predictions since this mini league began.`:""}`}),Ye&&n.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Invite players"}),n.jsxs("p",{className:"text-slate-600 text-sm",children:["Share this code (up to ",At," members):"]}),n.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[n.jsx("code",{className:"font-mono text-lg font-bold",children:s.code}),n.jsx("button",{onClick:()=>{navigator.clipboard.writeText(s.code)},className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Copy"}),n.jsx("button",{onClick:it,className:"px-3 py-1.5 border rounded-md text-sm hover:bg-slate-50",children:"Share"})]}),n.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:[t.length,"/",At," members"]}),n.jsx("div",{className:"mt-6 flex justify-end",children:n.jsx("button",{onClick:()=>Ne(!1),className:"px-4 py-2 border border-slate-300 rounded-md hover:bg-slate-50",children:"Close"})})]})}),T&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Leave League"}),n.jsxs("p",{className:"text-slate-600 mb-6",children:['Are you sure you want to leave "',s?.name,`"? You'll need the league code to rejoin later.`]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>j(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:F,children:"Cancel"}),n.jsx("button",{onClick:ht,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:F,children:F?"Leaving...":"Leave League"})]})]})}),Ue&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Join Mini League"}),n.jsxs("p",{className:"text-slate-600 mb-6",children:["You are about to join ",n.jsxs("strong",{children:['"',s?.name,'"']}),". Are you sure?"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>we(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:ge,children:"Cancel"}),n.jsx("button",{onClick:jt,className:"flex-1 px-4 py-2 bg-[#1C8376] text-white rounded-md hover:bg-emerald-700 transition-colors disabled:opacity-50",disabled:ge,children:ge?"Joining...":"Join League"})]})]})}),ze&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Remove Member"}),n.jsxs("p",{className:"text-slate-600 mb-6",children:["Are you sure you want to remove ",n.jsxs("strong",{children:['"',Ve?.name,'"']})," from the league? They will need the league code to rejoin."]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>Se(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Te,children:"Cancel"}),n.jsx("button",{onClick:ot,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:Te,children:Te?"Removing...":"Remove Member"})]})]})}),je&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md mx-4",children:[n.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:" End League"}),n.jsxs("p",{className:"text-slate-600 mb-4",children:["Are you absolutely sure you want to ",n.jsx("strong",{children:"permanently end"})," the league ",n.jsxs("strong",{children:['"',s?.name,'"']}),"?"]}),n.jsx("p",{className:"text-sm text-red-600 mb-6",children:"This will remove all members and delete the league forever. This action cannot be undone!"}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>Re(!1),className:"flex-1 px-4 py-2 border border-slate-300 text-slate-700 rounded-md hover:bg-slate-50 transition-colors",disabled:Ie,children:"Cancel"}),n.jsx("button",{onClick:lt,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50",disabled:Ie,children:Ie?"Ending...":"Yes, End League"})]})]})}),s?.name==="API Test"&&n.jsx("div",{className:"mt-6 mb-4 px-4 py-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:n.jsxs("div",{className:"text-sm text-yellow-800",children:[n.jsx("strong",{children:" Test League:"})," This league uses test API data and starts from Test GW 1 with zero points. It does not affect your main game scores."]})})]}):null}export{_s as default};
